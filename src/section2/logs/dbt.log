[0m14:50:28.618986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104126890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104500290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104500dd0>]}


============================== 14:50:28.621892 | bd78f756-7bff-4ef9-975b-1594b3cbf60e ==============================
[0m14:50:28.621892 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:50:28.622223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:29.490971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431d0690>]}
[0m14:50:29.513567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f430d0>]}
[0m14:50:29.514205 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:50:29.527851 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m14:50:29.528454 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:50:29.528693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143223390>]}
[0m14:50:30.164334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140e74950>]}
[0m14:50:30.215204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431c72d0>]}
[0m14:50:30.215557 [info ] [MainThread]: Found 32 models, 3 sources, 445 macros
[0m14:50:30.215783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ed7e50>]}
[0m14:50:30.217022 [info ] [MainThread]: 
[0m14:50:30.217418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:30.220373 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:50:30.220660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:50:30.227544 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:50:30.228688 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:50:30.228878 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:50:30.229075 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:50:30.229264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:30.229429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:31.102739 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:50:31.103721 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:50:31.115546 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:50:31.116400 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:50:31.247642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m14:50:31.247951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SILVER_LAYER)
[0m14:50:31.252524 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:50:31.253609 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:50:31.253818 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:50:31.253991 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:50:31.254162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:31.254341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:31.745170 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m14:50:31.746613 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:50:31.747882 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:50:31.748719 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:50:31.879624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433481d0>]}
[0m14:50:31.879998 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:31.880187 [info ] [MainThread]: 
[0m14:50:31.882172 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m14:50:31.883669 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m14:50:31.883293 [info ] [Thread-1 (]: 1 of 32 START sql table model SILVER_LAYER.clean_crm_data ...................... [RUN]
[0m14:50:31.884051 [info ] [Thread-2 (]: 2 of 32 START sql table model SILVER_LAYER.clean_device_data ................... [RUN]
[0m14:50:31.884375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_crm_data)
[0m14:50:31.884590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_device_data)
[0m14:50:31.884774 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m14:50:31.884950 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m14:50:31.888941 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m14:50:31.890402 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m14:50:31.891000 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m14:50:31.891167 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m14:50:31.907366 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m14:50:31.909138 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m14:50:31.910642 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m14:50:31.911405 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m14:50:31.911773 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql
WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m14:50:31.912169 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m14:50:31.912403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:31.912588 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:39.224808 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m14:50:39.235652 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m14:50:39.425761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14179e910>]}
[0m14:50:39.426199 [info ] [Thread-2 (]: 2 of 32 OK created sql table model SILVER_LAYER.clean_device_data .............. [[32mSUCCESS 1[0m in 7.54s]
[0m14:50:39.426515 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m14:50:53.321664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 21.0 seconds
[0m14:50:53.323705 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m14:50:53.498975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144424a90>]}
[0m14:50:53.499426 [info ] [Thread-1 (]: 1 of 32 OK created sql table model SILVER_LAYER.clean_crm_data ................. [[32mSUCCESS 1[0m in 21.61s]
[0m14:50:53.499742 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m14:50:53.500187 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m14:50:53.500385 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m14:50:53.500661 [info ] [Thread-4 (]: 3 of 32 START sql table model SILVER_LAYER.crm_device_data ..................... [RUN]
[0m14:50:53.500946 [info ] [Thread-3 (]: 4 of 32 START sql table model SILVER_LAYER.enriched_data ....................... [RUN]
[0m14:50:53.501270 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m14:50:53.501507 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.my_dbt_project.enriched_data'
[0m14:50:53.501697 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m14:50:53.501870 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m14:50:53.503542 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m14:50:53.505093 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m14:50:53.505631 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m14:50:53.505801 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m14:50:53.507101 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m14:50:53.508286 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m14:50:53.509066 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m14:50:53.509669 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m14:50:53.509871 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m14:50:53.510105 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
         as
        (WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.REV AS revenue
    LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m14:50:53.510294 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:50:53.510464 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:51:00.043865 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m14:51:00.045240 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m14:51:00.178115 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1440bfe90>]}
[0m14:51:00.178530 [info ] [Thread-3 (]: 4 of 32 OK created sql table model SILVER_LAYER.enriched_data .................. [[32mSUCCESS 1[0m in 6.68s]
[0m14:51:00.178856 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m14:51:00.179369 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m14:51:00.179555 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m14:51:00.179747 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:51:00.180022 [info ] [Thread-1 (]: 5 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m14:51:00.180282 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m14:51:00.180536 [info ] [Thread-3 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m14:51:00.180813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m14:51:00.181027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m14:51:00.181229 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m14:51:00.181413 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m14:51:00.181606 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m14:51:00.181779 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m14:51:00.183517 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m14:51:00.184943 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m14:51:00.186251 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m14:51:00.186755 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m14:51:00.196672 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m14:51:00.196898 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m14:51:00.197074 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m14:51:00.199070 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m14:51:00.201688 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m14:51:00.202386 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m14:51:00.202931 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m14:51:00.203346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:00.204619 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m14:51:00.205607 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m14:51:00.206611 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m14:51:00.207422 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m14:51:00.207732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:00.207945 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:00.802226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:00.803286 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m14:51:00.806315 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:00.807169 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m14:51:00.807896 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:00.808806 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m14:51:00.954946 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144069f90>]}
[0m14:51:00.955228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144075790>]}
[0m14:51:00.955573 [info ] [Thread-2 (]: 6 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.77s]
[0m14:51:00.955899 [info ] [Thread-1 (]: 5 of 32 OK created sql view model GOLD_LAYER.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.77s]
[0m14:51:00.956392 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m14:51:00.956683 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m14:51:00.956946 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:51:00.957225 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:51:00.957525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1440bfe90>]}
[0m14:51:00.957751 [info ] [Thread-2 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m14:51:00.957980 [info ] [Thread-1 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m14:51:00.958498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m14:51:00.958283 [info ] [Thread-3 (]: 7 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.78s]
[0m14:51:00.958735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m14:51:00.958912 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:51:00.959145 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:51:00.959321 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:51:00.961700 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m14:51:00.961911 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m14:51:00.963425 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m14:51:00.963771 [info ] [Thread-3 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ............... [RUN]
[0m14:51:00.964117 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_overall)
[0m14:51:00.964337 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:51:00.964496 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m14:51:00.964682 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:51:00.965996 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m14:51:00.967268 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m14:51:00.968489 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m14:51:00.969105 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m14:51:00.969294 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m14:51:00.969635 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m14:51:00.969821 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m14:51:00.971143 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m14:51:00.971347 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m14:51:00.971552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:00.971776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:00.972878 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m14:51:00.973294 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by os_name
  );
[0m14:51:00.973483 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:01.531784 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:01.532822 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m14:51:02.442616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:02.444819 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m14:51:02.445138 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144040310>]}
[0m14:51:02.445950 [info ] [Thread-3 (]: 10 of 32 OK created sql view model GOLD_LAYER.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 1.48s]
[0m14:51:02.446528 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m14:51:02.446789 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m14:51:02.447158 [info ] [Thread-3 (]: 11 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m14:51:02.447584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m14:51:02.447984 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m14:51:02.449857 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m14:51:02.450264 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m14:51:02.451602 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m14:51:02.452113 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m14:51:02.452298 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m14:51:02.452541 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:02.618449 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:51:02.619827 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m14:51:02.629985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101871f10>]}
[0m14:51:02.630331 [info ] [Thread-1 (]: 9 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 1.67s]
[0m14:51:02.630616 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:51:02.630814 [debug] [Thread-1 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m14:51:02.631045 [info ] [Thread-1 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m14:51:02.631243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.os_by_age_segment)
[0m14:51:02.631401 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m14:51:02.632944 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m14:51:02.633402 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m14:51:02.635885 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m14:51:02.637162 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m14:51:02.637393 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m14:51:02.637599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:02.762264 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14446ec10>]}
[0m14:51:02.762662 [info ] [Thread-2 (]: 8 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 1.80s]
[0m14:51:02.763012 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:51:02.763238 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m14:51:02.763500 [info ] [Thread-2 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m14:51:02.763732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.revenue_by_age_overall)
[0m14:51:02.763897 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m14:51:02.765390 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m14:51:02.765777 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m14:51:02.767043 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m14:51:02.767522 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m14:51:02.767694 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by age
order by age
  );
[0m14:51:02.767857 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:02.956802 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:02.957807 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m14:51:03.084859 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144419fd0>]}
[0m14:51:03.085237 [info ] [Thread-3 (]: 11 of 32 OK created sql view model GOLD_LAYER.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.64s]
[0m14:51:03.085526 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m14:51:03.085719 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:51:03.085986 [info ] [Thread-3 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m14:51:03.086183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_age_week_wise)
[0m14:51:03.086342 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m14:51:03.087700 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m14:51:03.088083 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m14:51:03.089620 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m14:51:03.090161 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m14:51:03.090354 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m14:51:03.090549 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:03.130088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:51:03.131173 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m14:51:03.255071 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:51:03.256057 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m14:51:03.269997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a9e50>]}
[0m14:51:03.270326 [info ] [Thread-1 (]: 12 of 32 OK created sql view model GOLD_LAYER.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.64s]
[0m14:51:03.270602 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m14:51:03.270797 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m14:51:03.271022 [info ] [Thread-1 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m14:51:03.271243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_overall)
[0m14:51:03.271418 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m14:51:03.273042 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m14:51:03.273489 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m14:51:03.274810 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m14:51:03.275322 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m14:51:03.275502 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m14:51:03.275667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:03.380392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021ccc90>]}
[0m14:51:03.380803 [info ] [Thread-2 (]: 13 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 0.62s]
[0m14:51:03.381137 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m14:51:03.381348 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:51:03.381586 [info ] [Thread-2 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m14:51:03.381798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m14:51:03.381975 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:51:03.383337 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m14:51:03.383692 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:51:03.385137 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m14:51:03.385666 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m14:51:03.385863 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m14:51:03.386035 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:03.596498 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:03.597479 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m14:51:03.743140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:51:03.744108 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m14:51:03.773713 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ead190>]}
[0m14:51:03.774118 [info ] [Thread-3 (]: 14 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.69s]
[0m14:51:03.774400 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:51:03.774704 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m14:51:03.774961 [info ] [Thread-3 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m14:51:03.775182 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_overall)
[0m14:51:03.775352 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m14:51:03.776965 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m14:51:03.777378 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m14:51:03.778738 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m14:51:03.779228 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m14:51:03.779409 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m14:51:03.779573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:03.794688 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 10.0 seconds
[0m14:51:03.795618 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m14:51:03.857032 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:51:03.858199 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m14:51:03.876224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ec6490>]}
[0m14:51:03.876551 [info ] [Thread-1 (]: 15 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.60s]
[0m14:51:03.876854 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m14:51:03.877080 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:51:03.877324 [info ] [Thread-1 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m14:51:03.877532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m14:51:03.877695 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:51:03.879047 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m14:51:03.879428 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:51:03.880825 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m14:51:03.881320 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m14:51:03.881501 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m14:51:03.881667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:03.921466 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144462a50>]}
[0m14:51:03.921854 [info ] [Thread-4 (]: 3 of 32 OK created sql table model SILVER_LAYER.crm_device_data ................ [[32mSUCCESS 1[0m in 10.42s]
[0m14:51:03.922175 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m14:51:03.922383 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:51:03.922628 [info ] [Thread-4 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m14:51:03.922852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m14:51:03.923040 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:51:03.924534 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m14:51:03.924906 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:51:03.926182 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m14:51:03.926763 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m14:51:03.927036 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m14:51:03.927224 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:51:04.006862 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14342fd50>]}
[0m14:51:04.007434 [info ] [Thread-2 (]: 16 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.63s]
[0m14:51:04.008292 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:51:04.008718 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:51:04.009153 [info ] [Thread-2 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m14:51:04.009410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m14:51:04.009603 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:51:04.011017 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m14:51:04.011416 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:51:04.012859 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m14:51:04.013524 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m14:51:04.013776 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m14:51:04.014123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:04.318560 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:04.320364 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m14:51:04.357628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:51:04.358467 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m14:51:04.448548 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444800d0>]}
[0m14:51:04.448956 [info ] [Thread-3 (]: 17 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.67s]
[0m14:51:04.449281 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m14:51:04.449480 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m14:51:04.449734 [info ] [Thread-3 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m14:51:04.449979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m14:51:04.450149 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m14:51:04.451699 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m14:51:04.452077 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m14:51:04.453385 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m14:51:04.453862 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m14:51:04.454039 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m14:51:04.454202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:04.513043 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:04.514322 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m14:51:04.514714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14455cc90>]}
[0m14:51:04.516062 [info ] [Thread-1 (]: 18 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.64s]
[0m14:51:04.516669 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:51:04.516924 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:51:04.517288 [info ] [Thread-1 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m14:51:04.517706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m14:51:04.518195 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:51:04.520041 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m14:51:04.520992 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:51:04.523137 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m14:51:04.524033 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m14:51:04.524297 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m14:51:04.524607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:04.533188 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:04.535250 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m14:51:04.698662 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144083c50>]}
[0m14:51:04.698989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144780050>]}
[0m14:51:04.699361 [info ] [Thread-4 (]: 19 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.78s]
[0m14:51:04.699687 [info ] [Thread-2 (]: 20 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.69s]
[0m14:51:04.700002 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:51:04.700255 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:51:04.700467 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:51:04.700713 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:51:04.700976 [info ] [Thread-4 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m14:51:04.701216 [info ] [Thread-2 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m14:51:04.701424 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m14:51:04.701607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m14:51:04.701791 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:51:04.701971 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m14:51:04.703356 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m14:51:04.704661 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m14:51:04.705067 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m14:51:04.705241 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:51:04.706726 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m14:51:04.708738 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m14:51:04.709328 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m14:51:04.709732 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m14:51:04.709911 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m14:51:04.710128 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m14:51:04.710332 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:04.710500 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:51:05.022031 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:05.023020 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m14:51:05.157787 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:05.158959 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m14:51:05.159239 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e19d0>]}
[0m14:51:05.160023 [info ] [Thread-3 (]: 21 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.71s]
[0m14:51:05.160499 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m14:51:05.160727 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:51:05.160929 [info ] [Thread-3 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m14:51:05.161208 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m14:51:05.161386 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:51:05.162940 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m14:51:05.163525 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:51:05.164916 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m14:51:05.165417 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m14:51:05.165598 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m14:51:05.165764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:05.208024 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:51:05.209093 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m14:51:05.231346 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:05.232519 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m14:51:05.299452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449b590>]}
[0m14:51:05.376665 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1445d1610>]}
[0m14:51:05.376968 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144082350>]}
[0m14:51:05.740131 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:05.741179 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m14:51:05.942521 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431e8dd0>]}
[0m14:51:06.872158 [info ] [Thread-1 (]: 22 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.78s]
[0m14:51:06.872438 [info ] [Thread-2 (]: 24 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.68s]
[0m14:51:06.872708 [info ] [Thread-4 (]: 23 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.68s]
[0m14:51:06.872901 [info ] [Thread-3 (]: 25 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.78s]
[0m14:51:06.873970 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:51:06.874221 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:51:06.874497 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:51:06.874741 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:51:06.874966 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:51:06.875159 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_overall
[0m14:51:06.875400 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m14:51:06.875607 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_overall
[0m14:51:06.875820 [info ] [Thread-1 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m14:51:06.876066 [info ] [Thread-2 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m14:51:06.876311 [info ] [Thread-4 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m14:51:06.876603 [info ] [Thread-3 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m14:51:06.876877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m14:51:06.877079 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_overall)
[0m14:51:06.877271 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m14:51:06.877483 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m14:51:06.877677 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:51:06.877847 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m14:51:06.878019 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m14:51:06.878197 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m14:51:06.879936 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m14:51:06.881239 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m14:51:06.882610 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m14:51:06.884014 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m14:51:06.884560 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:51:06.884723 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m14:51:06.884953 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m14:51:06.886254 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m14:51:06.888251 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m14:51:06.888439 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m14:51:06.889661 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m14:51:06.890933 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m14:51:06.891633 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m14:51:06.892247 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m14:51:06.892626 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m14:51:06.892798 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m14:51:06.893393 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m14:51:06.893587 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m14:51:06.893805 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m14:51:06.893986 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:06.894176 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m14:51:06.894358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:06.894511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:06.894706 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:51:07.438691 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:07.439047 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:07.440059 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m14:51:07.440958 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: Close
[0m14:51:07.441273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:07.443512 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m14:51:07.448171 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:07.449257 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_overall: Close
[0m14:51:07.582445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044aaf50>]}
[0m14:51:07.582776 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449b7d0>]}
[0m14:51:07.583015 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14473d750>]}
[0m14:51:07.583230 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143375a10>]}
[0m14:51:07.583555 [info ] [Thread-1 (]: 26 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.71s]
[0m14:51:07.583899 [info ] [Thread-3 (]: 29 of 32 OK created sql view model GOLD_LAYER.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.71s]
[0m14:51:07.584173 [info ] [Thread-2 (]: 27 of 32 OK created sql view model GOLD_LAYER.total_customers_overall .......... [[32mSUCCESS 1[0m in 0.71s]
[0m14:51:07.584443 [info ] [Thread-4 (]: 28 of 32 OK created sql view model GOLD_LAYER.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 0.71s]
[0m14:51:07.584743 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:51:07.585014 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m14:51:07.585288 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m14:51:07.585521 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m14:51:07.585730 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m14:51:07.585937 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:51:07.586135 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m14:51:07.586411 [info ] [Thread-1 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m14:51:07.586637 [info ] [Thread-3 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m14:51:07.586865 [info ] [Thread-2 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m14:51:07.587096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m14:51:07.587287 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m14:51:07.587471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m14:51:07.587644 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m14:51:07.587807 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m14:51:07.587980 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m14:51:07.589868 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m14:51:07.591286 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m14:51:07.592502 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m14:51:07.592953 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m14:51:07.593112 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m14:51:07.593250 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m14:51:07.594531 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m14:51:07.595784 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m14:51:07.598118 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m14:51:07.599115 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m14:51:07.599428 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    -- n
SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m14:51:07.600126 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m14:51:07.600488 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m14:51:07.600672 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:07.600873 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m14:51:07.601096 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    --m
SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m14:51:07.601334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:07.601813 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:08.146452 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:08.147462 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m14:51:11.986497 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m14:51:11.987588 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m14:51:12.037049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m14:51:12.037895 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m14:51:12.120853 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031a2cd0>]}
[0m14:51:12.121203 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1447c9b50>]}
[0m14:51:12.121571 [info ] [Thread-2 (]: 32 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 4.53s]
[0m14:51:12.122020 [info ] [Thread-3 (]: 31 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 4.53s]
[0m14:51:12.122361 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m14:51:12.122629 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:51:12.174250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd78f756-7bff-4ef9-975b-1594b3cbf60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144194650>]}
[0m14:51:12.174678 [info ] [Thread-1 (]: 30 of 32 OK created sql view model GOLD_LAYER.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 4.59s]
[0m14:51:12.174959 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m14:51:12.175697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:12.175874 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m14:51:12.176004 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m14:51:12.176119 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_week_wise' was properly closed.
[0m14:51:12.176231 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m14:51:12.176431 [info ] [MainThread]: 
[0m14:51:12.176594 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 41.96 seconds (41.96s).
[0m14:51:12.178433 [debug] [MainThread]: Command end result
[0m14:51:12.198394 [info ] [MainThread]: 
[0m14:51:12.198721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:12.198920 [info ] [MainThread]: 
[0m14:51:12.199084 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m14:51:12.201455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 43.617355, "process_user_time": 4.086522, "process_kernel_time": 1.23866, "process_mem_max_rss": "199229440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:12.201920 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:12.201870 after 43.62 seconds
[0m14:51:12.202124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010bc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100fee010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101026550>]}
[0m14:51:12.202303 [debug] [MainThread]: Flushing usage events
[0m18:41:21.074069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108910ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108911210>]}


============================== 18:41:21.076905 | 770dc6d4-ec3e-42bf-8840-d36f882054e7 ==============================
[0m18:41:21.076905 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:41:21.077273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:41:21.865074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12203d450>]}
[0m18:41:21.891537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834b210>]}
[0m18:41:21.892303 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:41:21.907636 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m18:41:22.005597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:22.005909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:22.024171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220315d0>]}
[0m18:41:22.078902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220b6750>]}
[0m18:41:22.079273 [info ] [MainThread]: Found 32 models, 3 sources, 445 macros
[0m18:41:22.079482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ee8110>]}
[0m18:41:22.080849 [info ] [MainThread]: 
[0m18:41:22.081190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:41:22.084243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m18:41:22.084571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m18:41:22.134267 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m18:41:22.135419 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m18:41:22.135632 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m18:41:22.135862 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m18:41:22.136053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:22.136227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:22.972357 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:41:22.972737 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:41:22.973635 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m18:41:22.974390 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m18:41:23.154987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m18:41:23.155606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SILVER_LAYER)
[0m18:41:23.160978 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m18:41:23.162262 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m18:41:23.162490 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m18:41:23.162673 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m18:41:23.162856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:23.163049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:23.615383 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:41:23.616394 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m18:41:23.730487 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m18:41:23.731831 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m18:41:23.871989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089367d0>]}
[0m18:41:23.872380 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:41:23.872570 [info ] [MainThread]: 
[0m18:41:23.874098 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m18:41:23.874815 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m18:41:23.874606 [info ] [Thread-1 (]: 1 of 32 START sql table model SILVER_LAYER.clean_crm_data ...................... [RUN]
[0m18:41:23.875109 [info ] [Thread-2 (]: 2 of 32 START sql table model SILVER_LAYER.clean_device_data ................... [RUN]
[0m18:41:23.875383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_crm_data)
[0m18:41:23.875594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_device_data)
[0m18:41:23.875794 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m18:41:23.875984 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m18:41:23.879822 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m18:41:23.881411 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m18:41:23.882173 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m18:41:23.882360 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m18:41:23.897015 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m18:41:23.898691 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m18:41:23.901281 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m18:41:23.902315 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m18:41:23.902635 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m18:41:23.902970 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql
WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m18:41:23.903265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:23.903458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:32.166143 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 8.0 seconds
[0m18:41:32.177685 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m18:41:32.300510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf9690>]}
[0m18:41:32.300938 [info ] [Thread-2 (]: 2 of 32 OK created sql table model SILVER_LAYER.clean_device_data .............. [[32mSUCCESS 1[0m in 8.42s]
[0m18:41:32.301271 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m18:41:47.526313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 24.0 seconds
[0m18:41:47.528192 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m18:41:47.979446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223106d0>]}
[0m18:41:47.979864 [info ] [Thread-1 (]: 1 of 32 OK created sql table model SILVER_LAYER.clean_crm_data ................. [[32mSUCCESS 1[0m in 24.10s]
[0m18:41:47.980151 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m18:41:47.980598 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m18:41:47.980804 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m18:41:47.981136 [info ] [Thread-4 (]: 3 of 32 START sql table model SILVER_LAYER.crm_device_data ..................... [RUN]
[0m18:41:47.981417 [info ] [Thread-3 (]: 4 of 32 START sql table model SILVER_LAYER.enriched_data ....................... [RUN]
[0m18:41:47.981704 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m18:41:47.981940 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.my_dbt_project.enriched_data'
[0m18:41:47.982125 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m18:41:47.982307 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m18:41:47.983984 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m18:41:47.985579 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m18:41:47.986238 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m18:41:47.986429 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m18:41:47.987694 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m18:41:47.988889 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m18:41:47.989576 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m18:41:47.989789 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m18:41:47.990409 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m18:41:47.990586 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:41:47.990787 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
         as
        (WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.REV AS revenue
    LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m18:41:47.991182 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:41:55.324718 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m18:41:55.325913 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m18:41:55.463185 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122748c10>]}
[0m18:41:55.463615 [info ] [Thread-3 (]: 4 of 32 OK created sql table model SILVER_LAYER.enriched_data .................. [[32mSUCCESS 1[0m in 7.48s]
[0m18:41:55.463904 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m18:41:55.464423 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m18:41:55.464617 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m18:41:55.464790 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m18:41:55.465026 [info ] [Thread-1 (]: 5 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m18:41:55.465280 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m18:41:55.465719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m18:41:55.465509 [info ] [Thread-3 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m18:41:55.465975 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m18:41:55.466169 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m18:41:55.466355 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m18:41:55.466533 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m18:41:55.468236 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m18:41:55.468412 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m18:41:55.469694 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m18:41:55.471784 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m18:41:55.472129 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m18:41:55.481806 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m18:41:55.482203 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m18:41:55.483910 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m18:41:55.484102 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m18:41:55.485069 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m18:41:55.486296 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m18:41:55.486562 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m18:41:55.487256 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m18:41:55.487472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:55.487757 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m18:41:55.488148 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m18:41:55.488544 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:55.488897 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m18:41:55.489761 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:41:56.106026 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:56.107070 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m18:41:56.133459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:56.134307 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m18:41:56.151349 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:56.152215 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m18:41:56.288633 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122761450>]}
[0m18:41:56.289025 [info ] [Thread-3 (]: 7 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.82s]
[0m18:41:56.289312 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m18:41:56.289531 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m18:41:56.289778 [info ] [Thread-3 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m18:41:56.289997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m18:41:56.290172 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m18:41:56.291759 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m18:41:56.293149 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m18:41:56.294546 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m18:41:56.295429 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m18:41:56.295621 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m18:41:56.295791 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:41:56.298606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc2f10>]}
[0m18:41:56.298859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12277b350>]}
[0m18:41:56.299195 [info ] [Thread-1 (]: 5 of 32 OK created sql view model GOLD_LAYER.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.83s]
[0m18:41:56.299561 [info ] [Thread-2 (]: 6 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.83s]
[0m18:41:56.299887 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m18:41:56.300131 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m18:41:56.300353 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m18:41:56.300597 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m18:41:56.300828 [info ] [Thread-1 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m18:41:56.301063 [info ] [Thread-2 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ............... [RUN]
[0m18:41:56.301290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m18:41:56.301487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_os_overall)
[0m18:41:56.301670 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m18:41:56.301838 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m18:41:56.303263 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m18:41:56.304600 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m18:41:56.305488 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m18:41:56.305747 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m18:41:56.308513 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m18:41:56.309751 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m18:41:56.310283 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m18:41:56.310655 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m18:41:56.310852 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by os_name
  );
[0m18:41:56.311066 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m18:41:56.311260 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:56.311431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:56.785647 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:56.786737 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m18:41:56.839543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:56.840482 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m18:41:56.850030 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:56.850879 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m18:41:56.924309 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d5e90>]}
[0m18:41:56.924804 [info ] [Thread-2 (]: 10 of 32 OK created sql view model GOLD_LAYER.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 0.62s]
[0m18:41:56.925260 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m18:41:56.925516 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m18:41:56.925746 [info ] [Thread-2 (]: 11 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m18:41:56.926129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m18:41:56.926330 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m18:41:56.928037 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m18:41:56.928919 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m18:41:56.930337 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m18:41:56.930883 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m18:41:56.931104 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m18:41:56.931293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:56.973990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fb6d0>]}
[0m18:41:56.974421 [info ] [Thread-1 (]: 9 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.67s]
[0m18:41:56.974747 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m18:41:56.975011 [debug] [Thread-1 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m18:41:56.975299 [info ] [Thread-1 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m18:41:56.975537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.os_by_age_segment)
[0m18:41:56.975714 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m18:41:56.977443 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m18:41:56.978345 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m18:41:56.979831 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m18:41:56.980088 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222d7150>]}
[0m18:41:56.980457 [info ] [Thread-3 (]: 8 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.69s]
[0m18:41:56.981036 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m18:41:56.981263 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m18:41:56.982033 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m18:41:56.982258 [info ] [Thread-3 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m18:41:56.982531 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m18:41:56.982805 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.revenue_by_age_overall)
[0m18:41:56.982991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:56.983157 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m18:41:56.984544 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m18:41:56.985337 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m18:41:56.986799 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m18:41:56.987502 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m18:41:56.987858 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by age
order by age
  );
[0m18:41:56.988063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:41:57.414142 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:57.415186 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m18:41:57.455406 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:57.456259 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m18:41:57.468291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:57.469196 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m18:41:57.543787 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12203d310>]}
[0m18:41:57.544179 [info ] [Thread-2 (]: 11 of 32 OK created sql view model GOLD_LAYER.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.62s]
[0m18:41:57.544454 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m18:41:57.544658 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m18:41:57.544912 [info ] [Thread-2 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m18:41:57.545146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_age_week_wise)
[0m18:41:57.545321 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m18:41:57.546841 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m18:41:57.547177 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m18:41:57.548446 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m18:41:57.548940 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m18:41:57.549126 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m18:41:57.549301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:57.585134 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080db590>]}
[0m18:41:57.585613 [info ] [Thread-3 (]: 13 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 0.60s]
[0m18:41:57.585900 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m18:41:57.586101 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m18:41:57.586356 [info ] [Thread-3 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m18:41:57.586594 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_brand_overall)
[0m18:41:57.586782 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m18:41:57.588316 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m18:41:57.589059 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m18:41:57.590383 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m18:41:57.590878 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m18:41:57.591060 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m18:41:57.591230 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:41:57.603469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc2f10>]}
[0m18:41:57.603930 [info ] [Thread-1 (]: 12 of 32 OK created sql view model GOLD_LAYER.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.63s]
[0m18:41:57.604268 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m18:41:57.604578 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m18:41:57.604870 [info ] [Thread-1 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m18:41:57.605148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m18:41:57.605349 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m18:41:57.606717 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m18:41:57.607028 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m18:41:57.608533 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m18:41:57.609066 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m18:41:57.609264 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m18:41:57.609478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:58.031821 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:58.032856 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m18:41:58.080874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:58.081818 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m18:41:58.096227 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:58.097123 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m18:41:58.167847 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227d7090>]}
[0m18:41:58.168281 [info ] [Thread-2 (]: 14 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.62s]
[0m18:41:58.168625 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m18:41:58.168988 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m18:41:58.169345 [info ] [Thread-2 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m18:41:58.169576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_overall)
[0m18:41:58.169753 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m18:41:58.171278 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m18:41:58.171660 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m18:41:58.173738 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m18:41:58.174248 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m18:41:58.174436 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m18:41:58.174606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:58.211850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122628150>]}
[0m18:41:58.212256 [info ] [Thread-1 (]: 16 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.61s]
[0m18:41:58.212534 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m18:41:58.212736 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m18:41:58.212993 [info ] [Thread-1 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m18:41:58.213236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m18:41:58.213415 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m18:41:58.214922 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m18:41:58.215278 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m18:41:58.216570 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m18:41:58.217074 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m18:41:58.217276 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m18:41:58.217457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:58.249070 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122651410>]}
[0m18:41:58.249479 [info ] [Thread-3 (]: 15 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.66s]
[0m18:41:58.249764 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m18:41:58.249967 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m18:41:58.250211 [info ] [Thread-3 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m18:41:58.250431 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m18:41:58.250600 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m18:41:58.251944 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m18:41:58.252285 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m18:41:58.253662 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m18:41:58.254123 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m18:41:58.254308 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m18:41:58.254477 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:41:58.491967 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 11.0 seconds
[0m18:41:58.493024 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m18:41:58.629071 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122780f50>]}
[0m18:41:58.629446 [info ] [Thread-4 (]: 3 of 32 OK created sql table model SILVER_LAYER.crm_device_data ................ [[32mSUCCESS 1[0m in 10.65s]
[0m18:41:58.629718 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m18:41:58.629927 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m18:41:58.630182 [info ] [Thread-4 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m18:41:58.630419 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m18:41:58.630597 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m18:41:58.632098 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m18:41:58.632493 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m18:41:58.633791 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m18:41:58.634281 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m18:41:58.634467 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m18:41:58.634638 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:41:58.667073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:58.668058 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m18:41:58.722606 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:58.722944 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:58.723844 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m18:41:58.724875 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m18:41:58.792599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b22e90>]}
[0m18:41:58.793032 [info ] [Thread-1 (]: 18 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.58s]
[0m18:41:58.793339 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m18:41:58.793545 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m18:41:58.793803 [info ] [Thread-1 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m18:41:58.794327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_overall)
[0m18:41:58.794534 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m18:41:58.802169 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m18:41:58.802880 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m18:41:58.804263 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m18:41:58.804735 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m18:41:58.804920 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m18:41:58.805089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:58.862476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122696310>]}
[0m18:41:58.862777 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227799d0>]}
[0m18:41:58.863144 [info ] [Thread-2 (]: 17 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.69s]
[0m18:41:58.863557 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m18:41:58.863822 [info ] [Thread-3 (]: 19 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.61s]
[0m18:41:58.864171 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m18:41:58.864469 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m18:41:58.864686 [info ] [Thread-2 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m18:41:58.864968 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m18:41:58.865217 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m18:41:58.865442 [info ] [Thread-3 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m18:41:58.865746 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m18:41:58.865945 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m18:41:58.867333 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m18:41:58.867522 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m18:41:58.868940 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m18:41:58.869501 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m18:41:58.869716 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m18:41:58.871095 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m18:41:58.872360 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m18:41:58.872964 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m18:41:58.873159 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m18:41:58.873365 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:41:58.874132 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m18:41:58.874323 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m18:41:58.874491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:59.130507 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:59.131500 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m18:41:59.257865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:59.258849 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m18:41:59.261404 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224aa250>]}
[0m18:41:59.261827 [info ] [Thread-4 (]: 20 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.63s]
[0m18:41:59.262133 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m18:41:59.262430 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m18:41:59.262747 [info ] [Thread-4 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m18:41:59.262993 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m18:41:59.263219 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m18:41:59.264719 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m18:41:59.265109 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m18:41:59.266386 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m18:41:59.266866 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m18:41:59.267047 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m18:41:59.267212 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:41:59.328712 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:59.329678 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m18:41:59.398015 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:59.399854 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m18:41:59.410194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc2f10>]}
[0m18:41:59.410563 [info ] [Thread-1 (]: 21 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.62s]
[0m18:41:59.410869 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m18:41:59.411081 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m18:41:59.411310 [info ] [Thread-1 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m18:41:59.411556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m18:41:59.411724 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m18:41:59.413061 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m18:41:59.413450 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m18:41:59.414878 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m18:41:59.415336 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m18:41:59.415522 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m18:41:59.415694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:59.467460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122786650>]}
[0m18:41:59.467850 [info ] [Thread-2 (]: 22 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.60s]
[0m18:41:59.468200 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m18:41:59.468467 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m18:41:59.468715 [info ] [Thread-2 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m18:41:59.468947 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m18:41:59.469193 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m18:41:59.470593 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m18:41:59.470987 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m18:41:59.472415 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m18:41:59.473224 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m18:41:59.473431 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m18:41:59.473613 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:59.535746 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122734250>]}
[0m18:41:59.790268 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:59.791282 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m18:41:59.912468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:59.914692 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m18:41:59.922841 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216f7b90>]}
[0m18:42:00.034795 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:42:00.035804 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m18:42:00.041390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b2c10>]}
[0m18:42:00.167050 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b0f910>]}
[0m18:42:01.120285 [info ] [Thread-3 (]: 23 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.67s]
[0m18:42:01.120565 [info ] [Thread-4 (]: 24 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.66s]
[0m18:42:01.120857 [info ] [Thread-1 (]: 25 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.63s]
[0m18:42:01.121161 [info ] [Thread-2 (]: 26 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.70s]
[0m18:42:01.121555 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m18:42:01.121828 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m18:42:01.122075 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m18:42:01.122308 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m18:42:01.122521 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_overall
[0m18:42:01.122747 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m18:42:01.122990 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_overall
[0m18:42:01.123211 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m18:42:01.123455 [info ] [Thread-3 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m18:42:01.123721 [info ] [Thread-4 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m18:42:01.123969 [info ] [Thread-1 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m18:42:01.124233 [info ] [Thread-2 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m18:42:01.124521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m18:42:01.124755 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m18:42:01.124981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m18:42:01.125191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m18:42:01.125388 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m18:42:01.125572 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m18:42:01.125752 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m18:42:01.125959 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m18:42:01.128706 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m18:42:01.129281 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m18:42:01.130747 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m18:42:01.132366 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m18:42:01.132893 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m18:42:01.134362 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m18:42:01.134548 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m18:42:01.134726 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m18:42:01.134992 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m18:42:01.137077 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m18:42:01.138426 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m18:42:01.139043 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m18:42:01.140265 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m18:42:01.140585 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m18:42:01.141144 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m18:42:01.141351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:42:01.141594 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m18:42:01.142112 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m18:42:01.142774 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m18:42:01.142965 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:42:01.144132 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m18:42:01.144522 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m18:42:01.145158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:01.145932 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:42:01.660811 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:42:01.661298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:42:01.661636 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:42:01.662625 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m18:42:01.663436 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: Close
[0m18:42:01.664180 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_overall: Close
[0m18:42:01.687478 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:42:01.688353 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m18:42:01.789636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227aac90>]}
[0m18:42:01.790032 [info ] [Thread-2 (]: 30 of 32 OK created sql view model GOLD_LAYER.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 0.66s]
[0m18:42:01.790367 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m18:42:01.790809 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m18:42:01.791161 [info ] [Thread-2 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m18:42:01.791428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m18:42:01.791658 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m18:42:01.793336 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m18:42:01.793598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121703990>]}
[0m18:42:01.793930 [info ] [Thread-1 (]: 29 of 32 OK created sql view model GOLD_LAYER.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.67s]
[0m18:42:01.794198 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m18:42:01.794427 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m18:42:01.794651 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m18:42:01.794893 [info ] [Thread-1 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m18:42:01.796241 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m18:42:01.796454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m18:42:01.796672 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m18:42:01.797950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m18:42:01.798328 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m18:42:01.798593 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    --m
SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m18:42:01.798819 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:42:01.799029 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m18:42:01.800273 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m18:42:01.801230 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m18:42:01.801503 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    -- n
SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m18:42:01.801675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:01.806779 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227e8650>]}
[0m18:42:01.807234 [info ] [Thread-3 (]: 27 of 32 OK created sql view model GOLD_LAYER.total_customers_overall .......... [[32mSUCCESS 1[0m in 0.68s]
[0m18:42:01.807583 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m18:42:01.825583 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220a7b50>]}
[0m18:42:01.825956 [info ] [Thread-4 (]: 28 of 32 OK created sql view model GOLD_LAYER.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 0.70s]
[0m18:42:01.826227 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m18:42:02.318786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:42:02.319177 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:42:02.320165 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m18:42:02.320990 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m18:42:02.495259 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a8dd0>]}
[0m18:42:02.495597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770dc6d4-ec3e-42bf-8840-d36f882054e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0d890>]}
[0m18:42:02.495918 [info ] [Thread-2 (]: 31 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 0.70s]
[0m18:42:02.496234 [info ] [Thread-1 (]: 32 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 0.70s]
[0m18:42:02.496523 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m18:42:02.496762 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m18:42:02.497521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:02.497669 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m18:42:02.497798 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m18:42:02.497916 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_week_wise' was properly closed.
[0m18:42:02.498033 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_overall' was properly closed.
[0m18:42:02.498250 [info ] [MainThread]: 
[0m18:42:02.498410 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 40.42 seconds (40.42s).
[0m18:42:02.500138 [debug] [MainThread]: Command end result
[0m18:42:02.518281 [info ] [MainThread]: 
[0m18:42:02.518547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:42:02.518720 [info ] [MainThread]: 
[0m18:42:02.518875 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m18:42:02.520301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 41.47976, "process_user_time": 3.298091, "process_kernel_time": 1.400227, "process_mem_max_rss": "196263936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:42:02.520590 [debug] [MainThread]: Command `dbt run` succeeded at 18:42:02.520547 after 41.48 seconds
[0m18:42:02.520781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107725d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d0590>]}
[0m18:42:02.520952 [debug] [MainThread]: Flushing usage events
[0m13:48:47.844115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107393e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073eb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107400c90>]}


============================== 13:48:47.847023 | 3d5d581e-44a2-40cd-a5fd-3739674fa4ec ==============================
[0m13:48:47.847023 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:48:47.847373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:48.977429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d5d581e-44a2-40cd-a5fd-3739674fa4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433169d0>]}
[0m13:48:49.000473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d5d581e-44a2-40cd-a5fd-3739674fa4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d43090>]}
[0m13:48:49.001081 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m13:48:49.014043 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:48:49.074534 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:48:49.074902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d5d581e-44a2-40cd-a5fd-3739674fa4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609a390>]}
[0m13:48:49.556649 [error] [MainThread]: Encountered an error:
A seed must have a materialized value of 'seed'
[0m13:48:49.560241 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/parser/manifest.py", line 435, in load
    self.parse_project(
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/parser/manifest.py", line 733, in parse_project
    parser.parse_file(block)
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/parser/base.py", line 484, in parse_file
    self.parse_node(file_block)
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/parser/base.py", line 439, in parse_node
    node = self._create_parsetime_node(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/parser/base.py", line 241, in _create_parsetime_node
    "config": self.config_dict(config),
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/parser/base.py", line 415, in config_dict
    config_dict = config.build_config_dict(base=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/context/context_config.py", line 362, in build_config_dict
    return src.calculate_node_config_dict(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/context/context_config.py", line 241, in calculate_node_config_dict
    finalized = config.finalize_and_validate()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt_common/contracts/config/base.py", line 174, in finalize_and_validate
    self.validate(dct)
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/artifacts/resources/v1/seed.py", line 19, in validate
    raise ValidationError("A seed must have a materialized value of 'seed'")
dbt_common.dataclass_schema.ValidationError: A seed must have a materialized value of 'seed'

[0m13:48:49.562471 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.7534218, "process_user_time": 2.19767, "process_kernel_time": 1.329243, "process_mem_max_rss": "185614336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:48:49.562828 [debug] [MainThread]: Command `dbt seed` failed at 13:48:49.562736 after 1.75 seconds
[0m13:48:49.563063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073df790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14366b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103628490>]}
[0m13:48:49.563252 [debug] [MainThread]: Flushing usage events
[0m13:49:04.004907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107893ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078eba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079010d0>]}


============================== 13:49:04.007667 | eb796682-f819-4d76-a66f-796ff884142d ==============================
[0m13:49:04.007667 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:49:04.008001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m13:49:04.735029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584b8810>]}
[0m13:49:04.757447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107243110>]}
[0m13:49:04.758584 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m13:49:04.769925 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:49:04.830070 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:49:04.830515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ceb5450>]}
[0m13:49:05.441062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d403610>]}
[0m13:49:05.491487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d5dbf10>]}
[0m13:49:05.491783 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 446 macros
[0m13:49:05.491957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cdcd910>]}
[0m13:49:05.492938 [info ] [MainThread]: 
[0m13:49:05.493243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:49:05.495235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m13:49:05.501532 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m13:49:05.501730 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m13:49:05.501881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:06.357863 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:49:06.358763 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m13:49:06.511057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now create_PROJECT_SEC2_DB_SEEDS)
[0m13:49:06.511367 [debug] [ThreadPool]: Creating schema "database: "PROJECT_SEC2_DB"
schema: "SEEDS"
"
[0m13:49:06.513832 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_SEC2_DB_SEEDS"
[0m13:49:06.514010 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "create_PROJECT_SEC2_DB_SEEDS"} */
create schema if not exists PROJECT_SEC2_DB.SEEDS
[0m13:49:06.514153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:07.073921 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:07.074590 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_SEEDS: Close
[0m13:49:07.282607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PROJECT_SEC2_DB_SEEDS, now list_PROJECT_SEC2_DB_SEEDS)
[0m13:49:07.282932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m13:49:07.283208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m13:49:07.287103 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m13:49:07.288053 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m13:49:07.288961 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m13:49:07.289140 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m13:49:07.289317 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m13:49:07.289465 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m13:49:07.289610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:07.289766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:07.289940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:07.740426 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m13:49:07.741272 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m13:49:07.790307 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:49:07.791154 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m13:49:07.818897 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m13:49:07.820060 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m13:49:07.963174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789add0>]}
[0m13:49:07.963529 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:07.963742 [info ] [MainThread]: 
[0m13:49:07.965768 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.input_crm
[0m13:49:07.965976 [debug] [Thread-2 (]: Began running node seed.my_dbt_project.input_device
[0m13:49:07.966367 [debug] [Thread-3 (]: Began running node seed.my_dbt_project.input_enriched_data
[0m13:49:07.966210 [info ] [Thread-1 (]: 1 of 4 START seed file SEEDS.input_crm ......................................... [RUN]
[0m13:49:07.966583 [debug] [Thread-4 (]: Began running node seed.my_dbt_project.input_rev
[0m13:49:07.966798 [info ] [Thread-2 (]: 2 of 4 START seed file SEEDS.input_device ...................................... [RUN]
[0m13:49:07.967021 [info ] [Thread-3 (]: 3 of 4 START seed file SEEDS.input_enriched_data ............................... [RUN]
[0m13:49:07.967260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now seed.my_dbt_project.input_crm)
[0m13:49:07.967475 [info ] [Thread-4 (]: 4 of 4 START seed file SEEDS.input_rev ......................................... [RUN]
[0m13:49:07.967917 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now seed.my_dbt_project.input_enriched_data)
[0m13:49:07.968130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now seed.my_dbt_project.input_device)
[0m13:49:07.968288 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.input_crm
[0m13:49:07.968509 [debug] [Thread-4 (]: Acquiring new snowflake connection 'seed.my_dbt_project.input_rev'
[0m13:49:07.968670 [debug] [Thread-3 (]: Began compiling node seed.my_dbt_project.input_enriched_data
[0m13:49:07.968815 [debug] [Thread-2 (]: Began compiling node seed.my_dbt_project.input_device
[0m13:49:07.968968 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.input_crm
[0m13:49:07.969190 [debug] [Thread-4 (]: Began compiling node seed.my_dbt_project.input_rev
[0m13:49:07.969371 [debug] [Thread-3 (]: Began executing node seed.my_dbt_project.input_enriched_data
[0m13:49:07.969543 [debug] [Thread-2 (]: Began executing node seed.my_dbt_project.input_device
[0m13:49:07.979629 [debug] [Thread-4 (]: Began executing node seed.my_dbt_project.input_rev
[0m13:49:07.990040 [debug] [Thread-1 (]: Using snowflake connection "seed.my_dbt_project.input_crm"
[0m13:49:07.991890 [debug] [Thread-2 (]: Using snowflake connection "seed.my_dbt_project.input_device"
[0m13:49:07.993589 [debug] [Thread-3 (]: Using snowflake connection "seed.my_dbt_project.input_enriched_data"
[0m13:49:07.994089 [debug] [Thread-1 (]: On seed.my_dbt_project.input_crm: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_crm"} */
create table PROJECT_SEC2_DB.SEEDS.input_crm (msisdn text,gender text,year_of_birth integer,system_status text,mobile_type text,value_segment text)
[0m13:49:07.995500 [debug] [Thread-4 (]: Using snowflake connection "seed.my_dbt_project.input_rev"
[0m13:49:07.995759 [debug] [Thread-2 (]: On seed.my_dbt_project.input_device: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_device"} */
create table PROJECT_SEC2_DB.SEEDS.input_device (msisdn text,imei_tac text,brand_name text,model_name text,os_name text,os_vendor text)
[0m13:49:07.996057 [debug] [Thread-3 (]: On seed.my_dbt_project.input_enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_enriched_data"} */
create table PROJECT_SEC2_DB.SEEDS.input_enriched_data (MSISDN text,REVENUE_USD float8,WEEK_NUMBER integer,GENDER text,MOBILE_TYPE text,SYSTEM_STATUS text,VALUE_SEGMENT text,YEAR_OF_BIRTH integer,BRAND_NAME text,IMEI_TAC text,MODEL_NAME text,OS_NAME text,OS_VENDOR text)
[0m13:49:07.996324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:07.996547 [debug] [Thread-4 (]: On seed.my_dbt_project.input_rev: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_rev"} */
create table PROJECT_SEC2_DB.SEEDS.input_rev (msisdn text,week_number integer,revenue_usd float8)
[0m13:49:07.996757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:07.996939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:07.998008 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:49:08.559853 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:08.560200 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:08.567882 [debug] [Thread-3 (]: Using snowflake connection "seed.my_dbt_project.input_enriched_data"
[0m13:49:08.568211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:08.569412 [debug] [Thread-2 (]: Using snowflake connection "seed.my_dbt_project.input_device"
[0m13:49:08.569628 [debug] [Thread-3 (]: On seed.my_dbt_project.input_enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_enriched_data"} */
BEGIN
[0m13:49:08.570827 [debug] [Thread-1 (]: Using snowflake connection "seed.my_dbt_project.input_crm"
[0m13:49:08.571007 [debug] [Thread-2 (]: On seed.my_dbt_project.input_device: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_device"} */
BEGIN
[0m13:49:08.571508 [debug] [Thread-1 (]: On seed.my_dbt_project.input_crm: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_crm"} */
BEGIN
[0m13:49:08.573437 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:08.574753 [debug] [Thread-4 (]: Using snowflake connection "seed.my_dbt_project.input_rev"
[0m13:49:08.575370 [debug] [Thread-4 (]: On seed.my_dbt_project.input_rev: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_rev"} */
BEGIN
[0m13:49:08.666690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:49:08.667890 [debug] [Thread-1 (]: Using snowflake connection "seed.my_dbt_project.input_crm"
[0m13:49:08.668065 [debug] [Thread-1 (]: On seed.my_dbt_project.input_crm: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_crm"} */
insert into PROJECT_SEC2_DB.SEEDS.input_crm (msisdn, gender, year_of_birth, system_status, mobile_type, value_segment) values
            (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,...
[0m13:49:08.670277 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:49:08.670546 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:49:08.671789 [debug] [Thread-2 (]: Using snowflake connection "seed.my_dbt_project.input_device"
[0m13:49:08.672912 [debug] [Thread-4 (]: Using snowflake connection "seed.my_dbt_project.input_rev"
[0m13:49:08.673177 [debug] [Thread-2 (]: On seed.my_dbt_project.input_device: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_device"} */
insert into PROJECT_SEC2_DB.SEEDS.input_device (msisdn, imei_tac, brand_name, model_name, os_name, os_vendor) values
            (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)...
[0m13:49:08.673441 [debug] [Thread-4 (]: On seed.my_dbt_project.input_rev: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_rev"} */
insert into PROJECT_SEC2_DB.SEEDS.input_rev (msisdn, week_number, revenue_usd) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:49:08.674701 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:49:08.677657 [debug] [Thread-3 (]: Using snowflake connection "seed.my_dbt_project.input_enriched_data"
[0m13:49:08.677974 [debug] [Thread-3 (]: On seed.my_dbt_project.input_enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_enriched_data"} */
insert into PROJECT_SEC2_DB.SEEDS.input_enriched_data (MSISDN, REVENUE_USD, WEEK_NUMBER, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT, YEAR_OF_BIRTH, BRAND_NAME, IMEI_TAC, MODEL_NAME, OS_NAME, OS_VENDOR) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m13:49:09.447933 [debug] [Thread-2 (]: SQL status: SUCCESS 75 in 1.0 seconds
[0m13:49:09.448272 [debug] [Thread-2 (]: Using snowflake connection "seed.my_dbt_project.input_device"
[0m13:49:09.448441 [debug] [Thread-2 (]: On seed.my_dbt_project.input_device: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_device"} */
COMMIT
[0m13:49:09.532356 [debug] [Thread-3 (]: SQL status: SUCCESS 64 in 1.0 seconds
[0m13:49:09.532745 [debug] [Thread-4 (]: SQL status: SUCCESS 120 in 1.0 seconds
[0m13:49:09.532972 [debug] [Thread-3 (]: Using snowflake connection "seed.my_dbt_project.input_enriched_data"
[0m13:49:09.533458 [debug] [Thread-1 (]: SQL status: SUCCESS 74 in 1.0 seconds
[0m13:49:09.533660 [debug] [Thread-4 (]: Using snowflake connection "seed.my_dbt_project.input_rev"
[0m13:49:09.533842 [debug] [Thread-3 (]: On seed.my_dbt_project.input_enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_enriched_data"} */
COMMIT
[0m13:49:09.534050 [debug] [Thread-1 (]: Using snowflake connection "seed.my_dbt_project.input_crm"
[0m13:49:09.534226 [debug] [Thread-4 (]: On seed.my_dbt_project.input_rev: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_rev"} */
COMMIT
[0m13:49:09.534531 [debug] [Thread-1 (]: On seed.my_dbt_project.input_crm: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.my_dbt_project.input_crm"} */
COMMIT
[0m13:49:09.684444 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:49:09.687155 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.my_dbt_project.input_device"
[0m13:49:09.698946 [debug] [Thread-2 (]: On seed.my_dbt_project.input_device: Close
[0m13:49:09.788886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:49:09.789386 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:49:09.789705 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_dbt_project.input_crm"
[0m13:49:09.790061 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.my_dbt_project.input_rev"
[0m13:49:09.791408 [debug] [Thread-1 (]: On seed.my_dbt_project.input_crm: Close
[0m13:49:09.836386 [debug] [Thread-4 (]: On seed.my_dbt_project.input_rev: Close
[0m13:49:09.836926 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:49:09.838779 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.my_dbt_project.input_enriched_data"
[0m13:49:09.839874 [debug] [Thread-3 (]: On seed.my_dbt_project.input_enriched_data: Close
[0m13:49:09.891833 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161b37a10>]}
[0m13:49:09.892167 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file SEEDS.input_device .................................. [[32mINSERT 75[0m in 1.92s]
[0m13:49:09.892467 [debug] [Thread-2 (]: Finished running node seed.my_dbt_project.input_device
[0m13:49:09.964760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d79d490>]}
[0m13:49:09.965114 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d748d0>]}
[0m13:49:09.965464 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file SEEDS.input_enriched_data ........................... [[32mINSERT 64[0m in 2.00s]
[0m13:49:09.965734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb796682-f819-4d76-a66f-796ff884142d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161b35f10>]}
[0m13:49:09.965985 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file SEEDS.input_rev ..................................... [[32mINSERT 120[0m in 2.00s]
[0m13:49:09.966278 [debug] [Thread-3 (]: Finished running node seed.my_dbt_project.input_enriched_data
[0m13:49:09.966533 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file SEEDS.input_crm ..................................... [[32mINSERT 74[0m in 2.00s]
[0m13:49:09.966802 [debug] [Thread-4 (]: Finished running node seed.my_dbt_project.input_rev
[0m13:49:09.967154 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.input_crm
[0m13:49:09.967929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:09.968079 [debug] [MainThread]: Connection 'seed.my_dbt_project.input_crm' was properly closed.
[0m13:49:09.968202 [debug] [MainThread]: Connection 'seed.my_dbt_project.input_device' was properly closed.
[0m13:49:09.968314 [debug] [MainThread]: Connection 'seed.my_dbt_project.input_enriched_data' was properly closed.
[0m13:49:09.968422 [debug] [MainThread]: Connection 'seed.my_dbt_project.input_rev' was properly closed.
[0m13:49:09.968567 [info ] [MainThread]: 
[0m13:49:09.968709 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m13:49:09.969122 [debug] [MainThread]: Command end result
[0m13:49:09.998032 [info ] [MainThread]: 
[0m13:49:09.998823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:09.999183 [info ] [MainThread]: 
[0m13:49:09.999422 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:49:10.005510 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.031609, "process_user_time": 2.835348, "process_kernel_time": 1.307854, "process_mem_max_rss": "202948608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:49:10.005980 [debug] [MainThread]: Command `dbt seed` succeeded at 13:49:10.005931 after 6.03 seconds
[0m13:49:10.006188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103014490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103014350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d49d4d0>]}
[0m13:49:10.006429 [debug] [MainThread]: Flushing usage events
[0m13:54:43.563519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d53d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da6890>]}


============================== 13:54:43.566735 | fee138fa-b19a-4464-b391-f4564005f674 ==============================
[0m13:54:43.566735 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:54:43.567082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile --models silver/clean_crm_data.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:54:44.356457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fee138fa-b19a-4464-b391-f4564005f674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da6e10>]}
[0m13:54:44.379155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fee138fa-b19a-4464-b391-f4564005f674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780b010>]}
[0m13:54:44.379767 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m13:54:44.391869 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:54:44.483169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:44.483620 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m13:54:44.638763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fee138fa-b19a-4464-b391-f4564005f674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e99150>]}
[0m13:54:44.687174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fee138fa-b19a-4464-b391-f4564005f674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d478d0>]}
[0m13:54:44.687462 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 446 macros
[0m13:54:44.687637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fee138fa-b19a-4464-b391-f4564005f674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130fe4ed0>]}
[0m13:54:44.688244 [warn ] [MainThread]: The selection criterion 'silver/clean_crm_data.sql' does not match any enabled nodes
[0m13:54:44.688714 [info ] [MainThread]: 
[0m13:54:44.688870 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:54:44.689085 [debug] [MainThread]: Command end result
[0m13:54:44.705530 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.1751055, "process_user_time": 1.992715, "process_kernel_time": 1.205538, "process_mem_max_rss": "188104704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:54:44.705868 [debug] [MainThread]: Command `dbt compile` succeeded at 13:54:44.705820 after 1.18 seconds
[0m13:54:44.706079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104984710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fe590>]}
[0m13:54:44.706263 [debug] [MainThread]: Flushing usage events
[0m13:54:59.999306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cde410>]}


============================== 13:55:00.001603 | 1396f670-7ea7-4f4a-99d7-79866201d511 ==============================
[0m13:55:00.001603 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:55:00.001946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --models models/silver/clean_crm_data.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:00.642903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1396f670-7ea7-4f4a-99d7-79866201d511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074aff50>]}
[0m13:55:00.666267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1396f670-7ea7-4f4a-99d7-79866201d511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066430d0>]}
[0m13:55:00.666679 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m13:55:00.677933 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:55:00.756980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:00.757241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:00.777539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1396f670-7ea7-4f4a-99d7-79866201d511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1637df790>]}
[0m13:55:00.830595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1396f670-7ea7-4f4a-99d7-79866201d511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1636807d0>]}
[0m13:55:00.830914 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 446 macros
[0m13:55:00.831099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1396f670-7ea7-4f4a-99d7-79866201d511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbd6d0>]}
[0m13:55:00.832291 [info ] [MainThread]: 
[0m13:55:00.832711 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:55:00.835879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m13:55:00.836279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m13:55:00.880744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m13:55:00.887556 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m13:55:00.888656 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m13:55:00.889625 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m13:55:00.889799 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m13:55:00.889975 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m13:55:00.890130 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m13:55:00.890273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:00.890404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:00.890607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:01.842048 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:55:01.843143 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m13:55:01.892112 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m13:55:01.893443 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m13:55:01.902502 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:55:01.903545 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m13:55:02.099943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1396f670-7ea7-4f4a-99d7-79866201d511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e07e10>]}
[0m13:55:02.100292 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:02.100460 [info ] [MainThread]: 
[0m13:55:02.102388 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m13:55:02.102622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m13:55:02.102795 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m13:55:02.106631 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m13:55:02.107379 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m13:55:02.107709 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m13:55:02.108262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:02.108441 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m13:55:02.108578 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m13:55:02.108698 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m13:55:02.108957 [debug] [MainThread]: Command end result
[0m13:55:02.126422 [info ] [MainThread]: Compiled node 'clean_crm_data' is:
-- models/marts/clean_crm_data.sql
{ % set import_crm=select_table(source('my_source','CRM'),ref('input_crm')) %}
WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
[0m13:55:02.128417 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1564507, "process_user_time": 2.012178, "process_kernel_time": 1.015303, "process_mem_max_rss": "194985984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:55:02.128705 [debug] [MainThread]: Command `dbt compile` succeeded at 13:55:02.128658 after 2.16 seconds
[0m13:55:02.128910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103000710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16359c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16359f3d0>]}
[0m13:55:02.129098 [debug] [MainThread]: Flushing usage events
[0m13:55:54.559685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a41e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab1350>]}


============================== 13:55:54.562625 | e434ffaf-3d7c-434e-87c1-809ca9452256 ==============================
[0m13:55:54.562625 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:55:54.562953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile --models models/silver/clean_crm_data.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:55.511155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e434ffaf-3d7c-434e-87c1-809ca9452256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10496d0d0>]}
[0m13:55:55.535319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e434ffaf-3d7c-434e-87c1-809ca9452256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f3150>]}
[0m13:55:55.535918 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m13:55:55.547822 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:55:55.640886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:55.641323 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m13:55:55.800544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e434ffaf-3d7c-434e-87c1-809ca9452256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270392d0>]}
[0m13:55:55.852910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e434ffaf-3d7c-434e-87c1-809ca9452256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3ad50>]}
[0m13:55:55.853210 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 446 macros
[0m13:55:55.853412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e434ffaf-3d7c-434e-87c1-809ca9452256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f6f3d0>]}
[0m13:55:55.854467 [info ] [MainThread]: 
[0m13:55:55.854750 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:55:55.857554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m13:55:55.864982 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m13:55:55.865258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m13:55:55.865563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m13:55:55.865740 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m13:55:55.866909 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m13:55:55.867903 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m13:55:55.868066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:55.868264 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m13:55:55.868409 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m13:55:55.869503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:55.869698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:56.622776 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m13:55:56.623144 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:55:56.623448 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:55:56.624880 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m13:55:56.625694 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m13:55:56.626413 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m13:55:56.778186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e434ffaf-3d7c-434e-87c1-809ca9452256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3a890>]}
[0m13:55:56.778508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:56.778677 [info ] [MainThread]: 
[0m13:55:56.779908 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m13:55:56.780112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_crm_data)
[0m13:55:56.780271 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m13:55:56.783802 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m13:55:56.784521 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m13:55:56.784848 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m13:55:56.785392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:56.785555 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m13:55:56.785684 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m13:55:56.785799 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m13:55:56.786056 [debug] [MainThread]: Command end result
[0m13:55:56.804151 [info ] [MainThread]: Compiled node 'clean_crm_data' is:
-- models/marts/clean_crm_data.sql
{ % set import_crm=select_table(source('my_source','CRM'),ref('input_crm')) %}
WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM import_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
[0m13:55:56.806903 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.2782598, "process_user_time": 2.147807, "process_kernel_time": 1.237391, "process_mem_max_rss": "195411968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:55:56.807339 [debug] [MainThread]: Command `dbt compile` succeeded at 13:55:56.807286 after 2.28 seconds
[0m13:55:56.807552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a980d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10166c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10166c5d0>]}
[0m13:55:56.807742 [debug] [MainThread]: Flushing usage events
[0m13:57:02.370921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f7f90>]}


============================== 13:57:02.373835 | 3f3f9f3c-45b8-4b5e-b7f9-660120c3b6ac ==============================
[0m13:57:02.373835 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:57:02.374163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models models/silver/clean_crm_data.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:03.090435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f3f9f3c-45b8-4b5e-b7f9-660120c3b6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d7bd350>]}
[0m13:57:03.113465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f3f9f3c-45b8-4b5e-b7f9-660120c3b6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070430d0>]}
[0m13:57:03.114159 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m13:57:03.126202 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:57:03.215370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:03.215626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:03.235239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f3f9f3c-45b8-4b5e-b7f9-660120c3b6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d9dfc50>]}
[0m13:57:03.285142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f3f9f3c-45b8-4b5e-b7f9-660120c3b6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d879dd0>]}
[0m13:57:03.285451 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 446 macros
[0m13:57:03.285636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f3f9f3c-45b8-4b5e-b7f9-660120c3b6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14db64250>]}
[0m13:57:03.286684 [info ] [MainThread]: 
[0m13:57:03.286979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:57:03.287409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m13:57:03.337792 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m13:57:03.338081 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m13:57:03.338235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:04.109419 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:57:04.110357 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m13:57:04.304909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m13:57:04.305678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m13:57:04.309246 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m13:57:04.309533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m13:57:04.310514 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m13:57:04.310726 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m13:57:04.311711 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m13:57:04.311884 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m13:57:04.312036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:04.312187 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m13:57:04.312338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:04.312544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:04.864364 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:57:04.865391 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m13:57:05.029765 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m13:57:05.030142 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:57:05.031448 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m13:57:05.032154 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m13:57:05.228522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f3f9f3c-45b8-4b5e-b7f9-660120c3b6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105804250>]}
[0m13:57:05.228879 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:05.229058 [info ] [MainThread]: 
[0m13:57:05.230518 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m13:57:05.230801 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.clean_crm_data ....................... [RUN]
[0m13:57:05.231061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_crm_data)
[0m13:57:05.231259 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m13:57:05.235237 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m13:57:05.235640 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m13:57:05.249519 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m13:57:05.251569 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m13:57:05.251858 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql
{ % set import_crm=select_table(source('my_source','CRM'),ref('input_crm')) %}
WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM import_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m13:57:05.252079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:05.843631 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e3db-3201-1b5f-0008-eb7e00045f8e
[0m13:57:05.843907 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected '{'.
syntax error line 4 at position 57 unexpected ','.
[0m13:57:05.844156 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m13:57:06.045177 [debug] [Thread-1 (]: Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected '{'.
  syntax error line 4 at position 57 unexpected ','.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m13:57:06.045971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f3f9f3c-45b8-4b5e-b7f9-660120c3b6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d88f710>]}
[0m13:57:06.046297 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_LAYER.clean_crm_data .............. [[31mERROR[0m in 0.81s]
[0m13:57:06.046613 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m13:57:06.047409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:06.047577 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m13:57:06.047708 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m13:57:06.047822 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m13:57:06.047956 [info ] [MainThread]: 
[0m13:57:06.048117 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m13:57:06.048443 [debug] [MainThread]: Command end result
[0m13:57:06.065123 [info ] [MainThread]: 
[0m13:57:06.065422 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:57:06.065642 [info ] [MainThread]: 
[0m13:57:06.065876 [error] [MainThread]:   Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected '{'.
  syntax error line 4 at position 57 unexpected ','.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m13:57:06.066077 [info ] [MainThread]: 
[0m13:57:06.066281 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:57:06.068251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7261558, "process_user_time": 2.151542, "process_kernel_time": 1.036777, "process_mem_max_rss": "193757184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:57:06.068538 [debug] [MainThread]: Command `dbt run` failed at 13:57:06.068496 after 3.73 seconds
[0m13:57:06.068899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a30710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075de910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107603e10>]}
[0m13:57:06.069132 [debug] [MainThread]: Flushing usage events
[0m13:57:34.538711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a96d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a96c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105addb90>]}


============================== 13:57:34.541680 | 9f46bb13-0b80-46dd-b3d8-333a7e915565 ==============================
[0m13:57:34.541680 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:57:34.542029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models models/silver/clean_crm_data.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:35.324346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f46bb13-0b80-46dd-b3d8-333a7e915565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b9d3fd0>]}
[0m13:57:35.346343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f46bb13-0b80-46dd-b3d8-333a7e915565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105343090>]}
[0m13:57:35.347532 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m13:57:35.359491 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:57:35.449249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:35.449661 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m13:57:35.604694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f46bb13-0b80-46dd-b3d8-333a7e915565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c101350>]}
[0m13:57:35.654016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f46bb13-0b80-46dd-b3d8-333a7e915565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512bf10>]}
[0m13:57:35.654317 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 446 macros
[0m13:57:35.654495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f46bb13-0b80-46dd-b3d8-333a7e915565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bf9e550>]}
[0m13:57:35.655526 [info ] [MainThread]: 
[0m13:57:35.655804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:57:35.656228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m13:57:35.662485 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m13:57:35.662700 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m13:57:35.662847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:36.403234 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:57:36.404190 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m13:57:36.609720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m13:57:36.610103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m13:57:36.610402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m13:57:36.614470 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m13:57:36.615440 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m13:57:36.616367 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m13:57:36.616531 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m13:57:36.616693 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m13:57:36.616856 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m13:57:36.616997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:36.617131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:36.617257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:37.075341 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:57:37.076341 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m13:57:37.118306 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m13:57:37.119506 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m13:57:37.135099 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:57:37.135894 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m13:57:37.326349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f46bb13-0b80-46dd-b3d8-333a7e915565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ba05110>]}
[0m13:57:37.326677 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:37.326847 [info ] [MainThread]: 
[0m13:57:37.328750 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m13:57:37.329018 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.clean_crm_data ....................... [RUN]
[0m13:57:37.329251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m13:57:37.329450 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m13:57:37.333287 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m13:57:37.333701 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m13:57:37.348055 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m13:57:37.349704 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m13:57:37.350254 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql
{ % set import_crm=select_table(source('my_source','CRM'),ref('input_crm')) %}
WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM 
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m13:57:37.350732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:37.841454 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e3db-3201-1b5f-0008-eb7e00045f9a
[0m13:57:37.841725 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected '{'.
syntax error line 4 at position 57 unexpected ','.
[0m13:57:37.841973 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m13:57:38.011325 [debug] [Thread-1 (]: Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected '{'.
  syntax error line 4 at position 57 unexpected ','.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m13:57:38.012163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f46bb13-0b80-46dd-b3d8-333a7e915565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c40f310>]}
[0m13:57:38.012520 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_LAYER.clean_crm_data .............. [[31mERROR[0m in 0.68s]
[0m13:57:38.012828 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m13:57:38.013573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:38.013739 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m13:57:38.013866 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m13:57:38.013983 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m13:57:38.014145 [info ] [MainThread]: 
[0m13:57:38.014342 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m13:57:38.014675 [debug] [MainThread]: Command end result
[0m13:57:38.031209 [info ] [MainThread]: 
[0m13:57:38.031725 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:57:38.031924 [info ] [MainThread]: 
[0m13:57:38.032309 [error] [MainThread]:   Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected '{'.
  syntax error line 4 at position 57 unexpected ','.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m13:57:38.032539 [info ] [MainThread]: 
[0m13:57:38.032790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:57:38.034997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5252702, "process_user_time": 2.248603, "process_kernel_time": 1.180116, "process_mem_max_rss": "197640192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:57:38.035292 [debug] [MainThread]: Command `dbt run` failed at 13:57:38.035248 after 3.53 seconds
[0m13:57:38.035498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b006d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101344710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f81ed50>]}
[0m13:57:38.035673 [debug] [MainThread]: Flushing usage events
[0m14:01:33.536996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108953bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108968ed0>]}


============================== 14:01:33.539928 | 1122c4fa-69eb-41fa-9430-870104a514c7 ==============================
[0m14:01:33.539928 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:01:33.540301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --models models/silver/clean_crm_data.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:01:34.365319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1122c4fa-69eb-41fa-9430-870104a514c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147206750>]}
[0m14:01:34.387716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1122c4fa-69eb-41fa-9430-870104a514c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ab090>]}
[0m14:01:34.388313 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:01:34.400385 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m14:01:34.489846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:34.490307 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m14:01:34.560631 [info ] [MainThread]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.clean_crm_data
[0m14:01:34.652375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1122c4fa-69eb-41fa-9430-870104a514c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14778a290>]}
[0m14:01:34.705903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1122c4fa-69eb-41fa-9430-870104a514c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147666890>]}
[0m14:01:34.706204 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 446 macros
[0m14:01:34.706372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1122c4fa-69eb-41fa-9430-870104a514c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14763cf50>]}
[0m14:01:34.707351 [info ] [MainThread]: 
[0m14:01:34.707642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:01:34.710441 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m14:01:34.717013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m14:01:34.717912 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:01:34.718194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m14:01:34.719272 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:01:34.719477 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:01:34.720511 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:01:34.720802 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:01:34.720970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:34.721125 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:01:34.721268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:34.722478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:35.437753 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:01:35.438821 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:01:35.489052 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:01:35.489910 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:01:35.490339 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:01:35.491974 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:01:35.678692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1122c4fa-69eb-41fa-9430-870104a514c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146b97910>]}
[0m14:01:35.679007 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:01:35.679210 [info ] [MainThread]: 
[0m14:01:35.681396 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m14:01:35.681657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m14:01:35.681829 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m14:01:35.687233 [info ] [Thread-1 (]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.CRM
[0m14:01:35.687602 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m14:01:35.688047 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m14:01:35.688646 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m14:01:35.689506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:35.689665 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m14:01:35.689855 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m14:01:35.689987 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m14:01:35.690416 [debug] [MainThread]: Command end result
[0m14:01:35.709011 [info ] [MainThread]: Compiled node 'clean_crm_data' is:
-- models/marts/clean_crm_data.sql
WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
[0m14:01:35.711309 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.2050927, "process_user_time": 2.138401, "process_kernel_time": 1.113825, "process_mem_max_rss": "195952640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:01:35.711677 [debug] [MainThread]: Command `dbt compile` succeeded at 14:01:35.711630 after 2.21 seconds
[0m14:01:35.711883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105524710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105456250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548e790>]}
[0m14:01:35.712088 [debug] [MainThread]: Flushing usage events
[0m14:02:10.451083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107090f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107100550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107101050>]}


============================== 14:02:10.453961 | 7bf6a42b-ba38-442e-af27-33330c6362eb ==============================
[0m14:02:10.453961 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:02:10.454311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models models/silver/clean_crm_data.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:02:11.202973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bf6a42b-ba38-442e-af27-33330c6362eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1647efdd0>]}
[0m14:02:11.225083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bf6a42b-ba38-442e-af27-33330c6362eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164887090>]}
[0m14:02:11.225655 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:02:11.238141 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m14:02:11.329176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:02:11.329428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:02:11.349490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bf6a42b-ba38-442e-af27-33330c6362eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1649f2650>]}
[0m14:02:11.400133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bf6a42b-ba38-442e-af27-33330c6362eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164d359d0>]}
[0m14:02:11.400433 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 446 macros
[0m14:02:11.400607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf6a42b-ba38-442e-af27-33330c6362eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f67390>]}
[0m14:02:11.401678 [info ] [MainThread]: 
[0m14:02:11.401988 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:02:11.402425 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:02:11.450940 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:02:11.451211 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:02:11.451366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:12.299132 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:02:12.300048 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:02:12.507836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m14:02:12.508471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m14:02:12.509386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m14:02:12.513496 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:02:12.514728 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:02:12.515779 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:02:12.515982 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:02:12.516156 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:02:12.516319 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:02:12.516475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:12.516636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:12.516767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:13.015435 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m14:02:13.016835 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:02:13.065806 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:02:13.066626 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:02:13.099575 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:02:13.100391 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:02:13.272885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf6a42b-ba38-442e-af27-33330c6362eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107100a50>]}
[0m14:02:13.273241 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:13.273450 [info ] [MainThread]: 
[0m14:02:13.274808 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m14:02:13.275064 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.clean_crm_data ....................... [RUN]
[0m14:02:13.275281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m14:02:13.275444 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m14:02:13.280767 [info ] [Thread-1 (]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.CRM
[0m14:02:13.281016 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m14:02:13.281396 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m14:02:13.297185 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m14:02:13.298325 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m14:02:13.298561 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql
WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m14:02:13.298772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:33.186187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 20.0 seconds
[0m14:02:33.196998 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m14:02:33.434137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf6a42b-ba38-442e-af27-33330c6362eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf6650>]}
[0m14:02:33.434555 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_LAYER.clean_crm_data .................. [[32mSUCCESS 1[0m in 20.16s]
[0m14:02:33.434854 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m14:02:33.435556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:33.435722 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m14:02:33.435849 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m14:02:33.435961 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m14:02:33.436111 [info ] [MainThread]: 
[0m14:02:33.436265 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.03 seconds (22.03s).
[0m14:02:33.436587 [debug] [MainThread]: Command end result
[0m14:02:33.454330 [info ] [MainThread]: 
[0m14:02:33.454709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:33.454929 [info ] [MainThread]: 
[0m14:02:33.455188 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:02:33.457359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.03616, "process_user_time": 2.099479, "process_kernel_time": 1.198231, "process_mem_max_rss": "194641920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:02:33.457623 [debug] [MainThread]: Command `dbt run` succeeded at 14:02:33.457582 after 23.04 seconds
[0m14:02:33.457834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b5c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a8e250>]}
[0m14:02:33.458043 [debug] [MainThread]: Flushing usage events
[0m14:31:06.747020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f489d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f26110>]}


============================== 14:31:06.749944 | 165a90af-0bfb-47c9-85f6-f404470ba747 ==============================
[0m14:31:06.749944 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:31:06.750264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --models models/silver/clean_crm_data.sql', 'send_anonymous_usage_stats': 'True'}
[0m14:31:07.555299 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ select_schema('SILVER_LAYER','TEST_SILVER_LAYER') }}: 'select_schema' is undefined
[0m14:31:07.557449 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.84154975, "process_user_time": 1.611285, "process_kernel_time": 1.170255, "process_mem_max_rss": "176078848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:31:07.557743 [debug] [MainThread]: Command `dbt compile` failed at 14:31:07.557694 after 0.84 seconds
[0m14:31:07.557944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f18290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b04710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f48ed0>]}
[0m14:31:07.558136 [debug] [MainThread]: Flushing usage events
[0m14:32:43.628803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ea490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108936450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108943bd0>]}


============================== 14:32:43.631710 | 5e5b3a6c-4e18-4fa0-82e4-1246c203125c ==============================
[0m14:32:43.631710 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:32:43.632045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --models models/silver/clean_crm_data.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:32:44.398482 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ select_schema('SILVER_LAYER','TEST_SILVER_LAYER') }}: 'select_schema' is undefined
[0m14:32:44.400376 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.8006172, "process_user_time": 1.617236, "process_kernel_time": 1.127656, "process_mem_max_rss": "177422336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:32:44.400674 [debug] [MainThread]: Command `dbt compile` failed at 14:32:44.400627 after 0.80 seconds
[0m14:32:44.400875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108937410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105514710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222ce3d0>]}
[0m14:32:44.401069 [debug] [MainThread]: Flushing usage events
[0m14:36:08.785262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106751e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c11d0>]}


============================== 14:36:08.788575 | 3334a972-0e79-447c-a925-f6e5abfa9f08 ==============================
[0m14:36:08.788575 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:36:08.788953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile --models models/silver/clean_crm_data.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:09.773037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3334a972-0e79-447c-a925-f6e5abfa9f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d0e4690>]}
[0m14:36:09.795278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3334a972-0e79-447c-a925-f6e5abfa9f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106203010>]}
[0m14:36:09.795850 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:36:09.807579 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m14:36:09.899383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:36:09.899787 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros/select_schema.sql
[0m14:36:09.899989 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_device_data.sql
[0m14:36:09.971040 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m14:36:10.065080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3334a972-0e79-447c-a925-f6e5abfa9f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d700d50>]}
[0m14:36:10.114947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3334a972-0e79-447c-a925-f6e5abfa9f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d7215d0>]}
[0m14:36:10.115240 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m14:36:10.115410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3334a972-0e79-447c-a925-f6e5abfa9f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d301b90>]}
[0m14:36:10.116389 [info ] [MainThread]: 
[0m14:36:10.116663 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:10.119405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m14:36:10.119662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m14:36:10.119915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m14:36:10.127029 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:36:10.128076 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:36:10.129100 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:36:10.129273 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:36:10.129450 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:36:10.129622 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:36:10.129767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:10.129904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:10.130027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:10.945032 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:36:10.945394 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:36:10.946954 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:36:10.947163 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:36:10.947959 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:36:10.949203 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:36:11.077288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3334a972-0e79-447c-a925-f6e5abfa9f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d76c590>]}
[0m14:36:11.077607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:36:11.077773 [info ] [MainThread]: 
[0m14:36:11.079653 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m14:36:11.079890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_crm_data)
[0m14:36:11.080061 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m14:36:11.084571 [info ] [Thread-1 (]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.CRM
[0m14:36:11.084817 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m14:36:11.085496 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m14:36:11.085811 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m14:36:11.086440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:11.086583 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m14:36:11.086699 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m14:36:11.086815 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m14:36:11.087075 [debug] [MainThread]: Command end result
[0m14:36:11.105783 [info ] [MainThread]: Compiled node 'clean_crm_data' is:
-- models/marts/clean_crm_data.sql
WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
[0m14:36:11.108042 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.361547, "process_user_time": 1.954543, "process_kernel_time": 0.979536, "process_mem_max_rss": "195756032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:36:11.108459 [debug] [MainThread]: Command `dbt compile` succeeded at 14:36:11.108348 after 2.36 seconds
[0m14:36:11.108744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067abc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10337c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032ae250>]}
[0m14:36:11.109014 [debug] [MainThread]: Flushing usage events
[0m14:41:15.331178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111356350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113aff10>]}


============================== 14:41:15.334140 | b12d457d-5b45-4da4-b7eb-e238bec982e1 ==============================
[0m14:41:15.334140 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:41:15.334461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile --models models/silver/enriched__data.sql', 'send_anonymous_usage_stats': 'True'}
[0m14:41:16.152997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b12d457d-5b45-4da4-b7eb-e238bec982e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162275810>]}
[0m14:41:16.178308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b12d457d-5b45-4da4-b7eb-e238bec982e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b43110>]}
[0m14:41:16.178986 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:41:16.192098 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m14:41:16.284739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:16.285155 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/enriched_data.sql
[0m14:41:16.357298 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m14:41:16.454136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b12d457d-5b45-4da4-b7eb-e238bec982e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16785ed90>]}
[0m14:41:16.508967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b12d457d-5b45-4da4-b7eb-e238bec982e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167a1f650>]}
[0m14:41:16.509275 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m14:41:16.509451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b12d457d-5b45-4da4-b7eb-e238bec982e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167618110>]}
[0m14:41:16.510087 [warn ] [MainThread]: The selection criterion 'models/silver/enriched__data.sql' does not match any enabled nodes
[0m14:41:16.510552 [info ] [MainThread]: 
[0m14:41:16.510705 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:41:16.510912 [debug] [MainThread]: Command end result
[0m14:41:16.528860 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.2293829, "process_user_time": 2.120694, "process_kernel_time": 1.129591, "process_mem_max_rss": "187514880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:41:16.529217 [debug] [MainThread]: Command `dbt compile` succeeded at 14:41:16.529168 after 1.23 seconds
[0m14:41:16.529436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105704710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ae250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1678b5990>]}
[0m14:41:16.529622 [debug] [MainThread]: Flushing usage events
[0m14:41:29.238793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f551d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fafc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fac7d0>]}


============================== 14:41:29.241119 | 6f8553d1-8abe-4fa2-a2c6-32cb5bdefa25 ==============================
[0m14:41:29.241119 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:41:29.241440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile --models models/silver/enriched_data.sql', 'send_anonymous_usage_stats': 'True'}
[0m14:41:29.919646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f8553d1-8abe-4fa2-a2c6-32cb5bdefa25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b145510>]}
[0m14:41:29.944193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f8553d1-8abe-4fa2-a2c6-32cb5bdefa25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047430d0>]}
[0m14:41:29.944902 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:41:29.957753 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m14:41:30.048833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:30.049078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:30.070742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f8553d1-8abe-4fa2-a2c6-32cb5bdefa25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b16f650>]}
[0m14:41:30.122549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f8553d1-8abe-4fa2-a2c6-32cb5bdefa25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b1756d0>]}
[0m14:41:30.122859 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m14:41:30.123042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8553d1-8abe-4fa2-a2c6-32cb5bdefa25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b0d5410>]}
[0m14:41:30.124119 [info ] [MainThread]: 
[0m14:41:30.124462 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:30.127271 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m14:41:30.127523 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m14:41:30.127760 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m14:41:30.177058 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:41:30.178161 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:41:30.179181 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:41:30.179379 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:41:30.179572 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:41:30.179737 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:41:30.179898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:30.180066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:30.180197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:30.977168 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:41:30.978293 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:41:30.978856 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:41:30.980248 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:41:31.062163 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:41:31.063619 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:41:31.199861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8553d1-8abe-4fa2-a2c6-32cb5bdefa25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5b850>]}
[0m14:41:31.200190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:31.200370 [info ] [MainThread]: 
[0m14:41:31.202305 [debug] [Thread-1 (]: Began running node model.my_dbt_project.enriched_data
[0m14:41:31.202550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.enriched_data)
[0m14:41:31.202731 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.enriched_data
[0m14:41:31.208050 [info ] [Thread-1 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m14:41:31.208397 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m14:41:31.209201 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.enriched_data
[0m14:41:31.209574 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.enriched_data
[0m14:41:31.210134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:31.210290 [debug] [MainThread]: Connection 'model.my_dbt_project.enriched_data' was properly closed.
[0m14:41:31.210423 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m14:41:31.210550 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m14:41:31.210822 [debug] [MainThread]: Command end result
[0m14:41:31.230984 [info ] [MainThread]: Compiled node 'enriched_data' is:


WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.REV AS revenue
    LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
[0m14:41:31.232929 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.022392, "process_user_time": 1.91678, "process_kernel_time": 0.964072, "process_mem_max_rss": "192200704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:41:31.233198 [debug] [MainThread]: Command `dbt compile` succeeded at 14:41:31.233155 after 2.02 seconds
[0m14:41:31.233387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101294710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1011c6250>]}
[0m14:41:31.233565 [debug] [MainThread]: Flushing usage events
[0m14:43:01.461043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045268d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104900810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104901310>]}


============================== 14:43:01.464068 | 02a2ac6b-7334-433a-a350-dbd91bf69647 ==============================
[0m14:43:01.464068 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:43:01.464419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --vars {"unit_testing": true} --models models/silver/enriched_data.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:43:02.289858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02a2ac6b-7334-433a-a350-dbd91bf69647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125ae4ed0>]}
[0m14:43:02.314461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02a2ac6b-7334-433a-a350-dbd91bf69647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104343150>]}
[0m14:43:02.315152 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:43:02.332886 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m14:43:02.407859 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:43:02.408240 [debug] [MainThread]: previous checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, current checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838
[0m14:43:02.408461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02a2ac6b-7334-433a-a350-dbd91bf69647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103676690>]}
[0m14:43:02.893636 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m14:43:02.903881 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m14:43:02.909303 [info ] [MainThread]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.clean_crm_data
[0m14:43:03.099312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02a2ac6b-7334-433a-a350-dbd91bf69647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125cf8c50>]}
[0m14:43:03.154121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02a2ac6b-7334-433a-a350-dbd91bf69647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126aa2590>]}
[0m14:43:03.154439 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m14:43:03.154725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02a2ac6b-7334-433a-a350-dbd91bf69647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126943410>]}
[0m14:43:03.155866 [info ] [MainThread]: 
[0m14:43:03.156184 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:03.159374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m14:43:03.159678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m14:43:03.168853 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:43:03.169174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m14:43:03.170430 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:43:03.170644 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:43:03.171719 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:43:03.171911 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:43:03.172100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:03.172270 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:43:03.172428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:03.173660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:03.849214 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:43:03.849472 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:43:03.850480 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:43:03.851297 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:43:03.860688 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:43:03.862043 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:43:04.006664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02a2ac6b-7334-433a-a350-dbd91bf69647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dc6ad0>]}
[0m14:43:04.007032 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:43:04.007209 [info ] [MainThread]: 
[0m14:43:04.009143 [debug] [Thread-1 (]: Began running node model.my_dbt_project.enriched_data
[0m14:43:04.009388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.enriched_data)
[0m14:43:04.009570 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.enriched_data
[0m14:43:04.014531 [info ] [Thread-1 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m14:43:04.014924 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m14:43:04.015345 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.enriched_data
[0m14:43:04.015686 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.enriched_data
[0m14:43:04.016379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:04.016542 [debug] [MainThread]: Connection 'model.my_dbt_project.enriched_data' was properly closed.
[0m14:43:04.016668 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m14:43:04.016783 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m14:43:04.017108 [debug] [MainThread]: Command end result
[0m14:43:04.036391 [info ] [MainThread]: Compiled node 'enriched_data' is:


WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
[0m14:43:04.038385 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.6110861, "process_user_time": 2.703009, "process_kernel_time": 1.224669, "process_mem_max_rss": "200769536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:43:04.038697 [debug] [MainThread]: Command `dbt compile` succeeded at 14:43:04.038649 after 2.61 seconds
[0m14:43:04.038903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104526c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101134750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010661d0>]}
[0m14:43:04.039088 [debug] [MainThread]: Flushing usage events
[0m14:50:23.256591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107952f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d17910>]}


============================== 14:50:23.259515 | 2d9d0a5a-87ed-447c-b177-d2aca3addcd2 ==============================
[0m14:50:23.259515 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:50:23.259846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile --vars {"unit_testing": true} --models models/silver/clean_crm_data.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:24.210259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d9d0a5a-87ed-447c-b177-d2aca3addcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a3ae90>]}
[0m14:50:24.235482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d9d0a5a-87ed-447c-b177-d2aca3addcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776f190>]}
[0m14:50:24.236140 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:50:24.251125 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m14:50:24.356204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:50:24.356630 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros/set_table_name.sql
[0m14:50:24.356840 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m14:50:24.428474 [info ] [MainThread]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.clean_crm_data
[0m14:50:24.561961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d9d0a5a-87ed-447c-b177-d2aca3addcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247a5990>]}
[0m14:50:24.618082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d9d0a5a-87ed-447c-b177-d2aca3addcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247b1110>]}
[0m14:50:24.618441 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m14:50:24.618645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d9d0a5a-87ed-447c-b177-d2aca3addcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243b57d0>]}
[0m14:50:24.619804 [info ] [MainThread]: 
[0m14:50:24.620258 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:24.623289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m14:50:24.623549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m14:50:24.630129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m14:50:24.631438 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:50:24.632629 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:50:24.634361 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:50:24.634644 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:50:24.634863 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:50:24.635078 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:50:24.635250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:24.635404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:24.635538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:25.482099 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:50:25.483186 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:50:25.484588 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:50:25.485798 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:50:25.492892 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:50:25.493851 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:50:25.629996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d9d0a5a-87ed-447c-b177-d2aca3addcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124773710>]}
[0m14:50:25.630321 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:25.630479 [info ] [MainThread]: 
[0m14:50:25.632321 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m14:50:25.632536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_crm_data)
[0m14:50:25.632715 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m14:50:25.637544 [info ] [Thread-1 (]: import_crm: PROJECT_SEC2_DB.SEEDS.input_crm
[0m14:50:25.637824 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m14:50:25.638448 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m14:50:25.638779 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m14:50:25.639335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:25.639501 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m14:50:25.639641 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m14:50:25.639765 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m14:50:25.640035 [debug] [MainThread]: Command end result
[0m14:50:25.659169 [info ] [MainThread]: Compiled node 'clean_crm_data' is:
-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final

select * from crm_final as test_clean_crm_data
[0m14:50:25.661195 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.4372501, "process_user_time": 2.097047, "process_kernel_time": 1.28187, "process_mem_max_rss": "195641344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:50:25.661471 [debug] [MainThread]: Command `dbt compile` succeeded at 14:50:25.661428 after 2.44 seconds
[0m14:50:25.661662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107853250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e8610>]}
[0m14:50:25.661836 [debug] [MainThread]: Flushing usage events
[0m14:51:25.573680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a914d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aebb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aebf90>]}


============================== 14:51:25.576698 | 4c1afdaf-d837-4efd-bbcd-9a8b79fb6eb1 ==============================
[0m14:51:25.576698 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:51:25.577057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile --vars {"unit_testing": true} --models models/silver/clean_device_data.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:26.558114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c1afdaf-d837-4efd-bbcd-9a8b79fb6eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166bf4810>]}
[0m14:51:26.581299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c1afdaf-d837-4efd-bbcd-9a8b79fb6eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083430d0>]}
[0m14:51:26.581909 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:51:26.594699 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m14:51:26.693083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:26.693542 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_device_data.sql
[0m14:51:26.767839 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m14:51:26.861340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c1afdaf-d837-4efd-bbcd-9a8b79fb6eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167163e50>]}
[0m14:51:26.916119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c1afdaf-d837-4efd-bbcd-9a8b79fb6eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166edebd0>]}
[0m14:51:26.916447 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m14:51:26.916649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c1afdaf-d837-4efd-bbcd-9a8b79fb6eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166de0d90>]}
[0m14:51:26.917724 [info ] [MainThread]: 
[0m14:51:26.918016 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:51:26.921165 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m14:51:26.921507 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m14:51:26.929127 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:51:26.929393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m14:51:26.930558 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:51:26.930765 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:51:26.932278 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:51:26.932460 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:51:26.932627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:26.932801 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:51:26.932999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:26.934039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:28.300205 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:51:28.300602 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:51:28.302058 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:51:28.302803 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:51:28.308180 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:51:28.308933 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:51:28.436336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c1afdaf-d837-4efd-bbcd-9a8b79fb6eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1667b71d0>]}
[0m14:51:28.436712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:28.436881 [info ] [MainThread]: 
[0m14:51:28.438802 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_device_data
[0m14:51:28.439027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_device_data)
[0m14:51:28.439196 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m14:51:28.444130 [info ] [Thread-1 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m14:51:28.444455 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m14:51:28.445198 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_device_data
[0m14:51:28.445553 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_device_data
[0m14:51:28.446134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:28.446319 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m14:51:28.446492 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m14:51:28.446626 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m14:51:28.446914 [debug] [MainThread]: Command end result
[0m14:51:28.467139 [info ] [MainThread]: Compiled node 'clean_device_data' is:
-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os

select * from as device_with_os as test_device_crm_data
[0m14:51:28.469527 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.9299421, "process_user_time": 2.380464, "process_kernel_time": 1.513975, "process_mem_max_rss": "197132288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:28.470037 [debug] [MainThread]: Command `dbt compile` succeeded at 14:51:28.469948 after 2.93 seconds
[0m14:51:28.470506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108862cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d60750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d60690>]}
[0m14:51:28.470749 [debug] [MainThread]: Flushing usage events
[0m14:53:06.185517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069fc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a17910>]}


============================== 14:53:06.188621 | f04f9b82-64b2-47e1-b32d-b6b6b1c30db8 ==============================
[0m14:53:06.188621 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:53:06.188997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --vars {"unit_testing": true} --models models/silver/crm_device_data.sql', 'send_anonymous_usage_stats': 'True'}
[0m14:53:06.953944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f04f9b82-64b2-47e1-b32d-b6b6b1c30db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9fd1d0>]}
[0m14:53:06.979006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f04f9b82-64b2-47e1-b32d-b6b6b1c30db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646f150>]}
[0m14:53:06.979670 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:53:06.992212 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m14:53:07.084857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:07.085283 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/crm_device_data.sql
[0m14:53:07.245846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f04f9b82-64b2-47e1-b32d-b6b6b1c30db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bf95e90>]}
[0m14:53:07.297877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f04f9b82-64b2-47e1-b32d-b6b6b1c30db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12be3ed90>]}
[0m14:53:07.298181 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m14:53:07.298370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04f9b82-64b2-47e1-b32d-b6b6b1c30db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9ccc90>]}
[0m14:53:07.299344 [info ] [MainThread]: 
[0m14:53:07.299614 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:07.302488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m14:53:07.302742 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m14:53:07.309177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m14:53:07.311522 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:53:07.312844 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:53:07.313861 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:53:07.314039 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:53:07.314224 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:53:07.314381 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:53:07.314528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:07.314664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:07.314786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:08.203740 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:53:08.203999 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:53:08.204387 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:53:08.205390 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:53:08.206140 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:53:08.207291 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:53:08.375066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04f9b82-64b2-47e1-b32d-b6b6b1c30db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105225d10>]}
[0m14:53:08.375409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:53:08.375587 [info ] [MainThread]: 
[0m14:53:08.377527 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m14:53:08.377775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.crm_device_data)
[0m14:53:08.377962 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m14:53:08.381958 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m14:53:08.382457 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m14:53:08.382826 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m14:53:08.383334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:08.383468 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m14:53:08.383588 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m14:53:08.383702 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m14:53:08.383953 [debug] [MainThread]: Command end result
[0m14:53:08.402442 [info ] [MainThread]: Compiled node 'crm_device_data' is:
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM test_clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM test_device_crm_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
[0m14:53:08.404426 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.2498174, "process_user_time": 2.075415, "process_kernel_time": 1.237938, "process_mem_max_rss": "194707456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:53:08.404709 [debug] [MainThread]: Command `dbt compile` succeeded at 14:53:08.404665 after 2.25 seconds
[0m14:53:08.404905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a14410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e8610>]}
[0m14:53:08.405083 [debug] [MainThread]: Flushing usage events
[0m14:54:29.754737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064110d0>]}


============================== 14:54:29.757635 | c92dda27-55f7-42df-998c-295d11dc9e37 ==============================
[0m14:54:29.757635 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:54:29.757968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile --vars {"unit_testing": true} --models models/silver/crm_device_data.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:54:30.536924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c92dda27-55f7-42df-998c-295d11dc9e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aadcc90>]}
[0m14:54:30.561590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c92dda27-55f7-42df-998c-295d11dc9e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4b2d0>]}
[0m14:54:30.562229 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:54:30.575348 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m14:54:30.670997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:30.671441 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/crm_device_data.sql
[0m14:54:30.839152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c92dda27-55f7-42df-998c-295d11dc9e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b89d0d0>]}
[0m14:54:30.899154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c92dda27-55f7-42df-998c-295d11dc9e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12af647d0>]}
[0m14:54:30.902142 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m14:54:30.902352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92dda27-55f7-42df-998c-295d11dc9e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ac796d0>]}
[0m14:54:30.903423 [info ] [MainThread]: 
[0m14:54:30.903726 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:54:30.906522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m14:54:30.906778 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m14:54:30.907033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m14:54:30.914647 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m14:54:30.915795 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:54:30.916829 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m14:54:30.917019 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m14:54:30.917214 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:54:30.917373 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m14:54:30.917525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:30.917669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:30.917806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:31.529384 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:54:31.529866 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:54:31.530077 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:54:31.531501 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m14:54:31.532318 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:54:31.533029 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m14:54:31.691823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92dda27-55f7-42df-998c-295d11dc9e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073377d0>]}
[0m14:54:31.692150 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:31.692325 [info ] [MainThread]: 
[0m14:54:31.694247 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m14:54:31.694465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.crm_device_data)
[0m14:54:31.694630 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m14:54:31.698739 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m14:54:31.699228 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m14:54:31.699563 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m14:54:31.700074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:31.700241 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m14:54:31.700371 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m14:54:31.700489 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m14:54:31.700743 [debug] [MainThread]: Command end result
[0m14:54:31.718790 [info ] [MainThread]: Compiled node 'crm_device_data' is:
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM test_clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM test_device_crm_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN as test_crm_device_data
[0m14:54:31.720722 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.996323, "process_user_time": 2.155088, "process_kernel_time": 1.191045, "process_mem_max_rss": "196804608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:54:31.721003 [debug] [MainThread]: Command `dbt compile` succeeded at 14:54:31.720959 after 2.00 seconds
[0m14:54:31.721193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fcc750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fcc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eda350>]}
[0m14:54:31.721370 [debug] [MainThread]: Flushing usage events
[0m15:05:03.575210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105291c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052de790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ebfd0>]}


============================== 15:05:03.578136 | 45e2df74-4216-4dc6-8521-f5116f08d5d2 ==============================
[0m15:05:03.578136 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:05:03.578488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile --vars {"unit_testing": true}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:05:04.499147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45e2df74-4216-4dc6-8521-f5116f08d5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1309d5a50>]}
[0m15:05:04.523021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45e2df74-4216-4dc6-8521-f5116f08d5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c43110>]}
[0m15:05:04.523673 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:05:04.536441 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:05:04.632058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 29 files changed.
[0m15:05:04.632482 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_os_week_wise.sql
[0m15:05:04.632680 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_vendor_week_wise.sql
[0m15:05:04.632855 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_devices_overall.sql
[0m15:05:04.633018 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/brand_by_age_segment.sql
[0m15:05:04.633182 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_mobile_type_week_wise.sql
[0m15:05:04.633344 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_overall.sql
[0m15:05:04.633506 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_age_overall.sql
[0m15:05:04.633673 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_customers_week_wise.sql
[0m15:05:04.633832 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_os_overall.sql
[0m15:05:04.633992 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_age_week_wise.sql
[0m15:05:04.634151 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_brand_overall.sql
[0m15:05:04.634311 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_mobile_type_overall.sql
[0m15:05:04.634467 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/os_by_age_segment.sql
[0m15:05:04.634626 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_brand_overall.sql
[0m15:05:04.634776 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/weekly_revenue_by_os.sql
[0m15:05:04.634933 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_mobile_type_overall.sql
[0m15:05:04.635089 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/enriched_data.sql
[0m15:05:04.635243 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_gender_week_wise.sql
[0m15:05:04.635393 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_value_segment_overall.sql
[0m15:05:04.635548 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_customers_overall.sql
[0m15:05:04.635701 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_vendor_overall.sql
[0m15:05:04.635859 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_brand_week_wise.sql
[0m15:05:04.636010 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_mobile_type_week_wise.sql
[0m15:05:04.636165 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_devices_week_wise.sql
[0m15:05:04.636317 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_week_wise.sql
[0m15:05:04.636466 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_gender_overall.sql
[0m15:05:04.636617 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_value_segment_week_wise.sql
[0m15:05:04.636770 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_brand_week_wise.sql
[0m15:05:04.636923 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/weekly_revenue_by_brand.sql
[0m15:05:04.796485 [error] [MainThread]: Encountered an error:
Compilation Error in model enriched_data (models/silver/enriched_data.sql)
  unexpected ')'
    line 36
      LEFT JOIN {{import_save_table_as_1)}} AS crm
[0m15:05:04.798660 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 1.257351, "process_user_time": 1.967726, "process_kernel_time": 1.229726, "process_mem_max_rss": "186662912", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:05:04.798966 [debug] [MainThread]: Command `dbt compile` failed at 15:05:04.798915 after 1.26 seconds
[0m15:05:04.799170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101620710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130b181d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130b1b8d0>]}
[0m15:05:04.799378 [debug] [MainThread]: Flushing usage events
[0m15:05:29.707686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ac3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080aced0>]}


============================== 15:05:29.710224 | 4e5bb93a-2db0-4283-a02e-925a4476ed9d ==============================
[0m15:05:29.710224 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:05:29.710537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --vars {"unit_testing": true}', 'send_anonymous_usage_stats': 'True'}
[0m15:05:30.468860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e5bb93a-2db0-4283-a02e-925a4476ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128dfc150>]}
[0m15:05:30.491572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e5bb93a-2db0-4283-a02e-925a4476ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aef110>]}
[0m15:05:30.492736 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:05:30.505786 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:05:30.597624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 29 files changed.
[0m15:05:30.598078 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_mobile_type_week_wise.sql
[0m15:05:30.598275 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_brand_overall.sql
[0m15:05:30.598454 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_age_overall.sql
[0m15:05:30.598631 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_devices_overall.sql
[0m15:05:30.598814 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_brand_overall.sql
[0m15:05:30.598988 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_age_week_wise.sql
[0m15:05:30.599163 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/enriched_data.sql
[0m15:05:30.599342 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_brand_week_wise.sql
[0m15:05:30.599520 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_mobile_type_overall.sql
[0m15:05:30.599688 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_mobile_type_week_wise.sql
[0m15:05:30.599862 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_overall.sql
[0m15:05:30.600030 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/weekly_revenue_by_os.sql
[0m15:05:30.600197 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_os_week_wise.sql
[0m15:05:30.600361 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_customers_overall.sql
[0m15:05:30.600528 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_customers_week_wise.sql
[0m15:05:30.600690 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_devices_week_wise.sql
[0m15:05:30.600855 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/os_by_age_segment.sql
[0m15:05:30.601018 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_value_segment_week_wise.sql
[0m15:05:30.601183 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_vendor_overall.sql
[0m15:05:30.601346 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/brand_by_age_segment.sql
[0m15:05:30.601509 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_vendor_week_wise.sql
[0m15:05:30.601672 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_mobile_type_overall.sql
[0m15:05:30.601838 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/weekly_revenue_by_brand.sql
[0m15:05:30.602002 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_gender_week_wise.sql
[0m15:05:30.602167 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_value_segment_overall.sql
[0m15:05:30.602329 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_brand_week_wise.sql
[0m15:05:30.602495 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_week_wise.sql
[0m15:05:30.602656 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_os_overall.sql
[0m15:05:30.602820 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_gender_overall.sql
[0m15:05:30.742313 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:05:30.841730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e5bb93a-2db0-4283-a02e-925a4476ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b3410>]}
[0m15:05:30.894746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e5bb93a-2db0-4283-a02e-925a4476ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e27510>]}
[0m15:05:30.895041 [info ] [MainThread]: Found 4 seeds, 32 models, 3 sources, 448 macros
[0m15:05:30.895219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e5bb93a-2db0-4283-a02e-925a4476ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292cfad0>]}
[0m15:05:30.896640 [info ] [MainThread]: 
[0m15:05:30.896922 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:05:30.899682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:05:30.899940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:05:30.900162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:05:30.908168 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:05:30.909655 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:05:30.910747 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:05:30.910963 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:05:30.911139 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:05:30.911313 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:05:30.911498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:30.911652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:30.911795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:31.576598 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:05:31.577826 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:05:31.578040 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:05:31.578402 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:05:31.579752 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:05:31.581065 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:05:31.715373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e5bb93a-2db0-4283-a02e-925a4476ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f05d90>]}
[0m15:05:31.715689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:31.715847 [info ] [MainThread]: 
[0m15:05:31.718008 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:05:31.718200 [debug] [Thread-2 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:05:31.718380 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:05:31.718569 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:31.718786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.brand_by_age_segment)
[0m15:05:31.718972 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.crm_device_data)
[0m15:05:31.719164 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.customers_by_brand_overall)
[0m15:05:31.719395 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.customers_by_brand_week_wise'
[0m15:05:31.719555 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:05:31.719731 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:05:31.719930 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:05:31.720097 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:31.724247 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:05:31.726388 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:05:31.729608 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:05:31.731326 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:05:31.732131 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:05:31.732536 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:05:31.732788 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:05:31.732993 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:05:31.733153 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:31.733357 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:31.733706 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:05:31.734008 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:05:31.734298 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:31.734487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:05:31.734684 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:31.734879 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:05:31.735074 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:31.735257 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:31.735440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:05:31.735626 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_os_overall)
[0m15:05:31.735809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:05:31.737148 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:05:31.737317 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:31.737468 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:05:31.737624 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:31.739010 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:05:31.741013 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:05:31.742777 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:05:31.743037 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:31.743269 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:31.743721 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:31.744584 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:31.744902 [debug] [Thread-2 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:05:31.745174 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:05:31.745517 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:05:31.745936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.os_by_age_segment)
[0m15:05:31.746140 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:31.746660 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:05:31.746949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:05:31.747172 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:05:31.747595 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:31.747888 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:31.748141 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:05:31.749748 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:05:31.749957 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:31.750165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:05:31.751628 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:05:31.751963 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:05:31.752181 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:31.752479 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:05:31.752761 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:31.753010 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:05:31.755202 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:05:31.755652 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:05:31.757333 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:05:31.757926 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:05:31.758198 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:31.758750 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:31.758975 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:31.759250 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:05:31.759413 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:31.759712 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:31.759891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:05:31.760060 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:31.760323 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:31.760505 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:31.760684 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:31.762088 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:05:31.762298 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:31.762592 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:05:31.764133 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:05:31.764565 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:05:31.764789 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:31.765116 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:31.765377 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:31.765620 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:31.767785 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:05:31.768201 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:31.770811 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:05:31.771154 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:31.771392 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:31.771615 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:31.771808 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:05:31.772069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:05:31.772242 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:31.772557 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:31.772753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:05:31.773001 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:31.773378 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:31.773570 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:05:31.773778 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:05:31.775296 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:05:31.775497 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:05:31.775705 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:05:31.777228 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:05:31.777666 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:05:31.777881 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:05:31.778034 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:31.778221 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:05:31.779721 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:05:31.780072 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:31.780218 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:05:31.781532 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:05:31.781773 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:05:31.782090 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:05:31.782228 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:05:31.782431 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:05:31.782646 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:05:31.782798 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:05:31.783058 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:05:31.783211 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:05:31.783384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:05:31.783647 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:05:31.783821 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:05:31.785168 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:05:31.785333 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:05:31.785513 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:05:31.785705 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:05:31.787043 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:05:31.787241 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:05:31.787426 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:05:31.787578 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:05:31.787784 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:05:31.789055 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:05:31.789424 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:05:31.791427 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:05:31.791785 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:05:31.792085 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:05:31.792428 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:05:31.792780 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:05:31.792990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:05:31.793310 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:05:31.793510 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:05:31.793698 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:05:31.793895 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:05:31.794069 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:05:31.794252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:05:31.795769 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:05:31.795993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m15:05:31.796355 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:05:31.796582 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:05:31.796831 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:05:31.797114 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:05:31.799065 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:05:31.799409 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:05:31.801149 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:05:31.801432 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:05:31.801960 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:05:31.802468 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:05:31.802727 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:05:31.802978 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:05:31.803187 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:05:31.805854 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:05:31.806236 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:05:31.806527 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:05:31.806716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:05:31.806952 [debug] [Thread-3 (]: Began running node seed.my_dbt_project.input_crm
[0m15:05:31.807151 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.input_device
[0m15:05:31.807338 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:05:31.807481 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:05:31.807649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_week_wise, now seed.my_dbt_project.input_crm)
[0m15:05:31.807825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now seed.my_dbt_project.input_device)
[0m15:05:31.809094 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:05:31.809479 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:05:31.809633 [debug] [Thread-3 (]: Began compiling node seed.my_dbt_project.input_crm
[0m15:05:31.809780 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.input_device
[0m15:05:31.809990 [debug] [Thread-4 (]: Began running node seed.my_dbt_project.input_enriched_data
[0m15:05:31.810856 [debug] [Thread-3 (]: Began executing node seed.my_dbt_project.input_crm
[0m15:05:31.811779 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.input_device
[0m15:05:31.812003 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:05:31.812238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.weekly_revenue_by_brand, now seed.my_dbt_project.input_enriched_data)
[0m15:05:31.812784 [debug] [Thread-3 (]: Finished running node seed.my_dbt_project.input_crm
[0m15:05:31.813362 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.input_device
[0m15:05:31.813776 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:05:31.814053 [debug] [Thread-4 (]: Began compiling node seed.my_dbt_project.input_enriched_data
[0m15:05:31.814294 [debug] [Thread-3 (]: Began running node seed.my_dbt_project.input_rev
[0m15:05:31.814614 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:05:31.814844 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:05:31.816024 [debug] [Thread-4 (]: Began executing node seed.my_dbt_project.input_enriched_data
[0m15:05:31.816262 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_crm, now seed.my_dbt_project.input_rev)
[0m15:05:31.816475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_device, now model.my_dbt_project.clean_crm_data)
[0m15:05:31.816691 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.weekly_revenue_by_os, now model.my_dbt_project.clean_device_data)
[0m15:05:31.817007 [debug] [Thread-4 (]: Finished running node seed.my_dbt_project.input_enriched_data
[0m15:05:31.817176 [debug] [Thread-3 (]: Began compiling node seed.my_dbt_project.input_rev
[0m15:05:31.817335 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:05:31.817488 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:05:31.818447 [debug] [Thread-3 (]: Began executing node seed.my_dbt_project.input_rev
[0m15:05:31.820495 [info ] [Thread-1 (]: import_crm: PROJECT_SEC2_DB.SEEDS.input_crm
[0m15:05:31.822803 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:05:31.823272 [debug] [Thread-3 (]: Finished running node seed.my_dbt_project.input_rev
[0m15:05:31.823462 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:05:31.823692 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:05:31.824033 [debug] [Thread-4 (]: Began running node model.my_dbt_project.enriched_data
[0m15:05:31.824314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_enriched_data, now model.my_dbt_project.enriched_data)
[0m15:05:31.824497 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:05:31.824664 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:05:31.824961 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:05:31.827365 [info ] [Thread-4 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:05:31.827552 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:05:31.827785 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:05:31.828069 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:05:31.828597 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:05:31.828872 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:05:31.829376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:31.829506 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:05:31.829620 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:05:31.829729 [debug] [MainThread]: Connection 'seed.my_dbt_project.input_rev' was properly closed.
[0m15:05:31.829836 [debug] [MainThread]: Connection 'model.my_dbt_project.enriched_data' was properly closed.
[0m15:05:31.831674 [debug] [MainThread]: Command end result
[0m15:05:31.854480 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.17559, "process_user_time": 2.261218, "process_kernel_time": 1.38562, "process_mem_max_rss": "198361088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:05:31.854818 [debug] [MainThread]: Command `dbt compile` succeeded at 15:05:31.854770 after 2.18 seconds
[0m15:05:31.855047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c68710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9a250>]}
[0m15:05:31.855271 [debug] [MainThread]: Flushing usage events
[0m15:05:44.109892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c82f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106047910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605d090>]}


============================== 15:05:44.112379 | ed44eb4e-a342-48cb-9a82-0b54be4489f8 ==============================
[0m15:05:44.112379 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:05:44.112769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile --vars {"unit_testing": false}', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:44.727842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed44eb4e-a342-48cb-9a82-0b54be4489f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c3e150>]}
[0m15:05:44.753461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed44eb4e-a342-48cb-9a82-0b54be4489f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9f110>]}
[0m15:05:44.754018 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:05:44.765165 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:05:44.834162 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:05:44.834543 [debug] [MainThread]: previous checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, current checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4
[0m15:05:44.834773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed44eb4e-a342-48cb-9a82-0b54be4489f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105162590>]}
[0m15:05:45.286462 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:05:45.295818 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:05:45.301766 [info ] [MainThread]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.clean_crm_data
[0m15:05:45.518586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed44eb4e-a342-48cb-9a82-0b54be4489f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133d19290>]}
[0m15:05:45.566286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed44eb4e-a342-48cb-9a82-0b54be4489f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134064210>]}
[0m15:05:45.566595 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:05:45.566778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed44eb4e-a342-48cb-9a82-0b54be4489f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133ef34d0>]}
[0m15:05:45.568300 [info ] [MainThread]: 
[0m15:05:45.568585 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:05:45.571529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:05:45.571832 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:05:45.578429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:05:45.579843 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:05:45.581012 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:05:45.582050 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:05:45.582247 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:05:45.582438 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:05:45.582612 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:05:45.582776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:45.582938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:45.583112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:46.153987 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:05:46.155060 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:05:46.168782 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:05:46.169589 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:05:46.371939 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:05:46.373262 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:05:46.521242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed44eb4e-a342-48cb-9a82-0b54be4489f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133b4d790>]}
[0m15:05:46.521590 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:46.521763 [info ] [MainThread]: 
[0m15:05:46.523184 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:05:46.523381 [debug] [Thread-2 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:05:46.523579 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:05:46.523773 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:46.523973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.brand_by_age_segment)
[0m15:05:46.524429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.crm_device_data)
[0m15:05:46.524642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.customers_by_brand_overall)
[0m15:05:46.524893 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.customers_by_brand_week_wise'
[0m15:05:46.525059 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:05:46.525226 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:05:46.525381 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:05:46.525556 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:46.529460 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:05:46.531182 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:05:46.532641 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:05:46.534028 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:05:46.535435 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:05:46.535646 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:05:46.535831 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:05:46.535983 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:46.536319 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:05:46.536637 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:05:46.536954 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:05:46.537238 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:46.537423 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:46.537660 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:46.537885 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:05:46.538122 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:46.538322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:05:46.538519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:05:46.538700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m15:05:46.538874 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:05:46.539049 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:46.539205 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:46.539376 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:05:46.539556 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:46.541047 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:05:46.542579 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:05:46.544161 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:05:46.547493 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:05:46.548749 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:46.548968 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:46.549152 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:46.549308 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:05:46.549657 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:46.549961 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:46.550280 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:46.550569 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:05:46.550758 [debug] [Thread-2 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:05:46.550967 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:05:46.551168 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:46.551368 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:46.551563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.os_by_age_segment)
[0m15:05:46.551734 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:05:46.551901 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:05:46.552084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:05:46.552249 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:05:46.552401 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:05:46.552555 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:46.552753 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:46.554396 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:05:46.555827 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:05:46.557909 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:05:46.560408 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:05:46.561154 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:05:46.561351 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:05:46.561908 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:05:46.562347 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:05:46.562530 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:46.562703 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:46.562884 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:46.563131 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:46.563506 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:46.563797 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:46.563986 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:05:46.564183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:05:46.564409 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:46.564666 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:46.564882 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:46.565048 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:46.565253 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:05:46.565554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:05:46.567730 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:05:46.569543 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:05:46.569818 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:46.570068 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:46.571984 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:05:46.572269 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:46.572502 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:46.573963 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:05:46.574355 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:46.574680 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:46.574826 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:46.575050 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:46.575289 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:05:46.575449 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:46.575723 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:46.576205 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:05:46.576493 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:05:46.577172 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:46.577434 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:05:46.577653 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:46.577872 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:05:46.578087 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:05:46.578338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:05:46.580003 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:05:46.581394 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:05:46.581618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:05:46.581803 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:05:46.582047 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:05:46.582264 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:05:46.583596 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:05:46.583744 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:46.585034 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:05:46.585339 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:05:46.585632 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:46.585874 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:05:46.586133 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:05:46.586275 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:05:46.586434 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:05:46.586618 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:05:46.586801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:05:46.587069 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:05:46.587340 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:05:46.587490 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:05:46.587642 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:05:46.587812 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:05:46.587993 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:05:46.590296 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:05:46.591601 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:05:46.591822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:05:46.592051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.total_customers_overall)
[0m15:05:46.592710 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:05:46.592972 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:05:46.593233 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:05:46.593505 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:05:46.595327 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:05:46.595674 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:05:46.597439 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:05:46.597859 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:05:46.598156 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:05:46.598451 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:05:46.598654 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:05:46.598884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_customers_week_wise)
[0m15:05:46.599357 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:05:46.599721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_devices_overall)
[0m15:05:46.599919 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:05:46.600422 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:05:46.600726 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:05:46.600919 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:05:46.601196 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:05:46.602883 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:05:46.603108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m15:05:46.604739 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:05:46.605054 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:05:46.605318 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:05:46.605542 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:05:46.605765 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:05:46.605944 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:05:46.607377 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:05:46.607681 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:05:46.607838 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:05:46.608112 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:05:46.608337 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:05:46.609608 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:05:46.609817 [debug] [Thread-4 (]: Began running node seed.my_dbt_project.input_crm
[0m15:05:46.609981 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:05:46.610266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:05:46.610488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now seed.my_dbt_project.input_crm)
[0m15:05:46.610789 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:05:46.610947 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:05:46.611086 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:05:46.611231 [debug] [Thread-4 (]: Began compiling node seed.my_dbt_project.input_crm
[0m15:05:46.611407 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.input_device
[0m15:05:46.612662 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:05:46.612946 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:05:46.613900 [debug] [Thread-4 (]: Began executing node seed.my_dbt_project.input_crm
[0m15:05:46.614079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_week_wise, now seed.my_dbt_project.input_device)
[0m15:05:46.614297 [debug] [Thread-3 (]: Began running node seed.my_dbt_project.input_enriched_data
[0m15:05:46.614573 [debug] [Thread-4 (]: Finished running node seed.my_dbt_project.input_crm
[0m15:05:46.614725 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.input_device
[0m15:05:46.614874 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:05:46.615047 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.weekly_revenue_by_brand, now seed.my_dbt_project.input_enriched_data)
[0m15:05:46.615221 [debug] [Thread-4 (]: Began running node seed.my_dbt_project.input_rev
[0m15:05:46.616289 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.input_device
[0m15:05:46.616887 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:05:46.617125 [debug] [Thread-3 (]: Began compiling node seed.my_dbt_project.input_enriched_data
[0m15:05:46.617525 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_crm, now seed.my_dbt_project.input_rev)
[0m15:05:46.618069 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.input_device
[0m15:05:46.618362 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:05:46.619528 [debug] [Thread-3 (]: Began executing node seed.my_dbt_project.input_enriched_data
[0m15:05:46.619792 [debug] [Thread-4 (]: Began compiling node seed.my_dbt_project.input_rev
[0m15:05:46.620101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.weekly_revenue_by_os, now model.my_dbt_project.clean_crm_data)
[0m15:05:46.620358 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:05:46.620712 [debug] [Thread-3 (]: Finished running node seed.my_dbt_project.input_enriched_data
[0m15:05:46.621701 [debug] [Thread-4 (]: Began executing node seed.my_dbt_project.input_rev
[0m15:05:46.621874 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:05:46.622067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_device, now model.my_dbt_project.clean_device_data)
[0m15:05:46.622398 [debug] [Thread-4 (]: Finished running node seed.my_dbt_project.input_rev
[0m15:05:46.625650 [info ] [Thread-2 (]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.CRM
[0m15:05:46.625885 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:05:46.626122 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:05:46.626311 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:05:46.628471 [info ] [Thread-1 (]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
[0m15:05:46.628771 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_enriched_data, now model.my_dbt_project.enriched_data)
[0m15:05:46.628984 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:05:46.629172 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:05:46.629320 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:05:46.631558 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m15:05:46.632021 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:05:46.632262 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:05:46.632444 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:05:46.632793 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:05:46.633080 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:05:46.633355 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:05:46.633869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:46.634007 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:05:46.634127 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:05:46.634239 [debug] [MainThread]: Connection 'model.my_dbt_project.enriched_data' was properly closed.
[0m15:05:46.634347 [debug] [MainThread]: Connection 'seed.my_dbt_project.input_rev' was properly closed.
[0m15:05:46.636089 [debug] [MainThread]: Command end result
[0m15:05:46.656307 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.5750287, "process_user_time": 2.548067, "process_kernel_time": 1.314085, "process_mem_max_rss": "202391552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:05:46.656659 [debug] [MainThread]: Command `dbt compile` succeeded at 15:05:46.656588 after 2.58 seconds
[0m15:05:46.656907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c18710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b4a250>]}
[0m15:05:46.657091 [debug] [MainThread]: Flushing usage events
[0m15:06:01.176003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067eb910>]}


============================== 15:06:01.178437 | aba21d32-1320-4e16-8710-d585cc07c7ce ==============================
[0m15:06:01.178437 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:06:01.178818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --vars {"unit_testing": true}', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:01.808648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba21d32-1320-4e16-8710-d585cc07c7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1303f4590>]}
[0m15:06:01.832231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aba21d32-1320-4e16-8710-d585cc07c7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106143150>]}
[0m15:06:01.832682 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:06:01.844178 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:06:01.913605 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:06:01.913969 [debug] [MainThread]: previous checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, current checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d
[0m15:06:01.914171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aba21d32-1320-4e16-8710-d585cc07c7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1304b7350>]}
[0m15:06:02.373578 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:06:02.383765 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:06:02.391123 [info ] [MainThread]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.clean_crm_data
[0m15:06:02.624212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aba21d32-1320-4e16-8710-d585cc07c7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306e6410>]}
[0m15:06:02.676638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aba21d32-1320-4e16-8710-d585cc07c7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13117c950>]}
[0m15:06:02.676951 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:06:02.677138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba21d32-1320-4e16-8710-d585cc07c7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13128ead0>]}
[0m15:06:02.678681 [info ] [MainThread]: 
[0m15:06:02.678960 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:02.681929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:06:02.682197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:06:02.688832 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:06:02.691213 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:06:02.692867 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:06:02.693923 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:06:02.694122 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:06:02.694291 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:06:02.694454 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:06:02.694608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:02.694739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:02.694883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:03.356352 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:06:03.357828 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:06:03.383930 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:06:03.384739 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:06:03.385602 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:06:03.386493 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:06:03.525899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba21d32-1320-4e16-8710-d585cc07c7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13065b450>]}
[0m15:06:03.526235 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:03.526407 [info ] [MainThread]: 
[0m15:06:03.528489 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:06:03.528679 [debug] [Thread-2 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:06:03.528873 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:06:03.529250 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:03.529477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.brand_by_age_segment)
[0m15:06:03.529689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.crm_device_data)
[0m15:06:03.529884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.customers_by_brand_overall)
[0m15:06:03.530108 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.customers_by_brand_week_wise'
[0m15:06:03.530279 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:06:03.530451 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:06:03.530635 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:06:03.530809 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:03.534792 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:06:03.536660 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:06:03.538105 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:06:03.539493 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:06:03.540326 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:06:03.540872 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:06:03.541125 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:06:03.541458 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:03.541671 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:06:03.541891 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:03.542288 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:06:03.542510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:06:03.542812 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:06:03.543080 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:03.543268 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:03.543463 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:03.543649 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:06:03.543848 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:03.544046 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:06:03.545579 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:06:03.545769 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_os_overall)
[0m15:06:03.545947 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:06:03.546110 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:03.546307 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:06:03.546466 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:03.547830 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:06:03.547996 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:03.549333 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:06:03.551474 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:06:03.552066 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:03.552742 [debug] [Thread-1 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:06:03.553025 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:03.553425 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:03.553926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.os_by_age_segment)
[0m15:06:03.554096 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:06:03.554487 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:03.555002 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:03.555316 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:06:03.555970 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:06:03.556470 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:06:03.557044 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:03.559768 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:06:03.560083 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:03.560314 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:06:03.560555 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:06:03.560851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:06:03.561084 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:06:03.561309 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:03.561505 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:03.561663 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:06:03.564138 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:06:03.566115 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:06:03.567864 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:06:03.568234 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:06:03.568607 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:03.568868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:06:03.569169 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:06:03.569372 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:03.569620 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:03.569864 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:03.570231 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:06:03.570533 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:03.572473 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:06:03.572944 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:03.573205 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:03.573539 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:03.573991 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:03.574452 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:06:03.574843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:06:03.575116 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:03.575451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:06:03.575787 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:03.576100 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:03.576513 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:03.576717 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:03.578386 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:06:03.579807 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:06:03.580035 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:03.581441 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:06:03.581780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:06:03.582075 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:03.582237 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:03.582426 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:03.582734 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:03.582907 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:03.583179 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:03.584523 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:06:03.584713 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:06:03.585005 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:03.585188 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:03.585410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_overall)
[0m15:06:03.585598 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:03.585784 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:06:03.585931 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:03.586129 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:06:03.586396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:06:03.586634 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:03.587027 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:03.589237 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:03.589608 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:03.591497 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:03.591748 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:03.593245 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:03.593503 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:06:03.593712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:06:03.593947 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:03.594232 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:06:03.594437 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:03.594638 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:03.595016 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:03.595346 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:03.598351 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:03.598775 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:03.598983 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:03.599193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:06:03.599428 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:06:03.599616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:06:03.599808 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:03.600065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:06:03.600258 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:03.600448 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:03.602042 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:03.602229 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:06:03.602535 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:03.603887 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:03.605305 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:06:03.605507 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:06:03.605859 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:03.606030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:06:03.606363 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:03.606524 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:06:03.606671 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:03.606813 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:06:03.606990 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:06:03.607263 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:06:03.607536 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:03.608936 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:06:03.609131 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:06:03.609315 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:06:03.609507 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:03.609713 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:06:03.609894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.total_devices_week_wise)
[0m15:06:03.610079 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:06:03.610220 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:06:03.611748 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:06:03.611956 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:06:03.612127 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:03.612524 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:06:03.614952 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:06:03.616531 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:03.616764 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:06:03.616968 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:03.617531 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:06:03.617874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:06:03.618778 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:03.618049 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:03.618551 [debug] [Thread-4 (]: Began running node seed.my_dbt_project.input_crm
[0m15:06:03.620521 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:03.618226 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:06:03.620923 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:03.621165 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now seed.my_dbt_project.input_crm)
[0m15:06:03.621597 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:06:03.621831 [debug] [Thread-3 (]: Began running node seed.my_dbt_project.input_device
[0m15:06:03.622068 [debug] [Thread-4 (]: Began compiling node seed.my_dbt_project.input_crm
[0m15:06:03.622239 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:03.622422 [debug] [Thread-2 (]: Began running node seed.my_dbt_project.input_enriched_data
[0m15:06:03.622766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.weekly_revenue_by_brand, now seed.my_dbt_project.input_device)
[0m15:06:03.623697 [debug] [Thread-4 (]: Began executing node seed.my_dbt_project.input_crm
[0m15:06:03.624038 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:03.624227 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_week_wise, now seed.my_dbt_project.input_enriched_data)
[0m15:06:03.624415 [debug] [Thread-3 (]: Began compiling node seed.my_dbt_project.input_device
[0m15:06:03.624796 [debug] [Thread-4 (]: Finished running node seed.my_dbt_project.input_crm
[0m15:06:03.625043 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.input_rev
[0m15:06:03.625229 [debug] [Thread-2 (]: Began compiling node seed.my_dbt_project.input_enriched_data
[0m15:06:03.626197 [debug] [Thread-3 (]: Began executing node seed.my_dbt_project.input_device
[0m15:06:03.626467 [debug] [Thread-4 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:06:03.626632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.weekly_revenue_by_os, now seed.my_dbt_project.input_rev)
[0m15:06:03.627515 [debug] [Thread-2 (]: Began executing node seed.my_dbt_project.input_enriched_data
[0m15:06:03.627794 [debug] [Thread-3 (]: Finished running node seed.my_dbt_project.input_device
[0m15:06:03.627966 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_crm, now model.my_dbt_project.clean_crm_data)
[0m15:06:03.628123 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.input_rev
[0m15:06:03.628374 [debug] [Thread-2 (]: Finished running node seed.my_dbt_project.input_enriched_data
[0m15:06:03.628596 [debug] [Thread-3 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:06:03.628740 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:06:03.629615 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.input_rev
[0m15:06:03.629840 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_device, now model.my_dbt_project.clean_device_data)
[0m15:06:03.632929 [info ] [Thread-4 (]: import_crm: PROJECT_SEC2_DB.SEEDS.input_crm
[0m15:06:03.633289 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.input_rev
[0m15:06:03.633463 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:06:03.633633 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:06:03.635683 [info ] [Thread-3 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:06:03.635895 [debug] [Thread-2 (]: Began running node model.my_dbt_project.enriched_data
[0m15:06:03.636135 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:06:03.636341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_enriched_data, now model.my_dbt_project.enriched_data)
[0m15:06:03.636545 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:06:03.636698 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:06:03.638991 [info ] [Thread-2 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:06:03.639184 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:06:03.639471 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:06:03.639635 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:06:03.639895 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:06:03.640247 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:06:03.640508 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:06:03.641016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:03.641143 [debug] [MainThread]: Connection 'seed.my_dbt_project.input_rev' was properly closed.
[0m15:06:03.641256 [debug] [MainThread]: Connection 'model.my_dbt_project.enriched_data' was properly closed.
[0m15:06:03.641364 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:06:03.641469 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:06:03.643198 [debug] [MainThread]: Command end result
[0m15:06:03.664828 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.5167131, "process_user_time": 2.632822, "process_kernel_time": 1.293288, "process_mem_max_rss": "201474048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:06:03.665164 [debug] [MainThread]: Command `dbt compile` succeeded at 15:06:03.665118 after 2.52 seconds
[0m15:06:03.665356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e32b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106426890>]}
[0m15:06:03.665526 [debug] [MainThread]: Flushing usage events
[0m15:06:26.601236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109293e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092de410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ebfd0>]}


============================== 15:06:26.603588 | 12e4112e-7e3e-4361-ae3c-1fdb8bc3de84 ==============================
[0m15:06:26.603588 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:06:26.603934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": false}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:06:27.260893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13683e390>]}
[0m15:06:27.284841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3f1d0>]}
[0m15:06:27.285290 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:06:27.296788 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:06:27.367814 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:06:27.368177 [debug] [MainThread]: previous checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, current checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4
[0m15:06:27.368377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b7c50>]}
[0m15:06:27.825744 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:06:27.835650 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:06:27.843074 [info ] [MainThread]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.clean_crm_data
[0m15:06:28.062204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b2eb10>]}
[0m15:06:28.114900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f986d0>]}
[0m15:06:28.115218 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:06:28.115423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137822990>]}
[0m15:06:28.116916 [info ] [MainThread]: 
[0m15:06:28.117208 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:28.120103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:06:28.120370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:06:28.127212 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:06:28.128332 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:06:28.128535 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:06:28.128708 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:06:28.128878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:28.129034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:28.706159 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:06:28.707179 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:06:28.709700 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:06:28.710613 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:06:28.860663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:06:28.861010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:06:28.861925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:06:28.865380 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:06:28.866364 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:06:28.867319 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:06:28.867495 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:06:28.867654 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:06:28.867829 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:06:28.868002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:28.868130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:28.868268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:29.322256 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:06:29.323670 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:06:29.382444 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:06:29.383252 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:06:29.387160 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:06:29.388020 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:06:29.515355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d47a10>]}
[0m15:06:29.515704 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:29.515869 [info ] [MainThread]: 
[0m15:06:29.518097 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:06:29.518296 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:06:29.518489 [debug] [Thread-3 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:06:29.518690 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:06:29.519119 [info ] [Thread-1 (]: 1 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m15:06:29.519373 [info ] [Thread-2 (]: 2 of 32 START sql table model SILVER_LAYER.clean_crm_data ...................... [RUN]
[0m15:06:29.519620 [info ] [Thread-3 (]: 3 of 32 START sql table model SILVER_LAYER.clean_device_data ................... [RUN]
[0m15:06:29.519857 [info ] [Thread-4 (]: 4 of 32 START sql table model SILVER_LAYER.crm_device_data ..................... [RUN]
[0m15:06:29.520084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.brand_by_age_segment)
[0m15:06:29.520390 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_crm_data)
[0m15:06:29.520654 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_device_data)
[0m15:06:29.520892 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m15:06:29.521074 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:06:29.521244 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:06:29.521407 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:06:29.521556 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:06:29.525350 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:06:29.527381 [info ] [Thread-2 (]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.CRM
[0m15:06:29.529467 [info ] [Thread-3 (]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
[0m15:06:29.531219 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:06:29.531484 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:06:29.531700 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:06:29.531964 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:06:29.532342 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:06:29.538932 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:06:29.539134 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:06:29.561455 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m15:06:29.561762 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:06:29.563156 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:06:29.564380 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:06:29.565561 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:06:29.565888 [debug] [Thread-3 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os

select * from as device_with_os as clean_device_data
        );
[0m15:06:29.566650 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m15:06:29.567205 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:06:29.567367 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:29.567598 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m15:06:29.568512 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:06:29.568702 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN as crm_device_data
        );
[0m15:06:29.569498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:29.569757 [debug] [Thread-2 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final

select * from crm_final as clean_crm_data
        );
[0m15:06:29.569984 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:06:29.570430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:30.001870 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e000461fe
[0m15:06:30.002131 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 0 unexpected 'select'.
[0m15:06:30.002422 [debug] [Thread-3 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:06:30.045087 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046202
[0m15:06:30.045369 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e000471e6
[0m15:06:30.045584 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 47 unexpected 'as'.
[0m15:06:30.045789 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 60 at position 0 unexpected 'select'.
[0m15:06:30.046073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e000471ea
[0m15:06:30.046319 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:06:30.046575 [debug] [Thread-2 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:06:30.046776 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:30.048427 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m15:06:30.142483 [debug] [Thread-3 (]: Database Error in model clean_device_data (models/silver/clean_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'select'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_device_data.sql
[0m15:06:30.143672 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137baaed0>]}
[0m15:06:30.144102 [error] [Thread-3 (]: 3 of 32 ERROR creating sql table model SILVER_LAYER.clean_device_data .......... [[31mERROR[0m in 0.62s]
[0m15:06:30.144519 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:06:30.144782 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:06:30.145029 [info ] [Thread-3 (]: 5 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m15:06:30.145533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m15:06:30.145735 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:06:30.149598 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:06:30.150409 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:06:30.153130 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:06:30.154279 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m15:06:30.154719 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m15:06:30.154989 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:30.180732 [debug] [Thread-2 (]: Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 0 unexpected 'select'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m15:06:30.184143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bdce10>]}
[0m15:06:30.186637 [error] [Thread-2 (]: 2 of 32 ERROR creating sql table model SILVER_LAYER.clean_crm_data ............. [[31mERROR[0m in 0.66s]
[0m15:06:30.187641 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:06:30.188261 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:30.191378 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m15:06:30.191704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:06:30.191897 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:30.190767 [debug] [Thread-1 (]: Database Error in model brand_by_age_segment (models/gold/brand_by_age_segment.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/brand_by_age_segment.sql
[0m15:06:30.195420 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:06:30.199625 [debug] [Thread-4 (]: Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:06:30.203954 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136db26d0>]}
[0m15:06:30.204445 [error] [Thread-4 (]: 4 of 32 ERROR creating sql table model SILVER_LAYER.crm_device_data ............ [[31mERROR[0m in 0.68s]
[0m15:06:30.201505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b9afd0>]}
[0m15:06:30.204954 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:06:30.210180 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:30.210492 [info ] [Thread-4 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m15:06:30.210768 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:06:30.210935 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:30.213469 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:06:30.207244 [error] [Thread-1 (]: 1 of 32 ERROR creating sql view model GOLD_LAYER.brand_by_age_segment .......... [[31mERROR[0m in 0.68s]
[0m15:06:30.214708 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:06:30.214968 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:30.215321 [info ] [Thread-1 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m15:06:30.215921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:06:30.216095 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:30.214070 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:30.219421 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:06:30.224611 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:06:30.203019 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:30.228368 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:06:30.229115 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:30.229708 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:06:30.232054 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:06:30.232637 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:06:30.232988 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m15:06:30.233751 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m15:06:30.234607 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:06:30.234863 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:30.235116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:30.235340 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m15:06:30.236258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:30.550257 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e000471ee
[0m15:06:30.550529 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:30.550778 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m15:06:30.619470 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e000471f2
[0m15:06:30.619661 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:30.619879 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m15:06:30.620991 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046206
[0m15:06:30.621219 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:30.621487 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m15:06:30.631849 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e0004620a
[0m15:06:30.632062 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:30.632297 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m15:06:30.707676 [debug] [Thread-3 (]: Database Error in model customers_by_brand_overall (models/gold/customers_by_brand_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_brand_overall.sql
[0m15:06:30.707983 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ce7f50>]}
[0m15:06:30.708293 [error] [Thread-3 (]: 5 of 32 ERROR creating sql view model GOLD_LAYER.customers_by_brand_overall .... [[31mERROR[0m in 0.56s]
[0m15:06:30.708566 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:06:30.708765 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:06:30.709005 [info ] [Thread-3 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ................ [RUN]
[0m15:06:30.709210 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_os_overall)
[0m15:06:30.709367 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:06:30.710969 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:06:30.711372 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:06:30.713115 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m15:06:30.713585 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m15:06:30.713759 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from enriched_data
where os_name is not null
group by os_name
  );
[0m15:06:30.713920 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:30.779364 [debug] [Thread-4 (]: Database Error in model customers_by_mobile_type_overall (models/gold/customers_by_mobile_type_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_mobile_type_overall.sql
[0m15:06:30.780477 [debug] [Thread-2 (]: Database Error in model customers_by_brand_week_wise (models/gold/customers_by_brand_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_brand_week_wise.sql
[0m15:06:30.780996 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c88fd0>]}
[0m15:06:30.781801 [debug] [Thread-1 (]: Database Error in model customers_by_mobile_type_week_wise (models/gold/customers_by_mobile_type_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_mobile_type_week_wise.sql
[0m15:06:30.782016 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105984310>]}
[0m15:06:30.782337 [error] [Thread-4 (]: 7 of 32 ERROR creating sql view model GOLD_LAYER.customers_by_mobile_type_overall  [[31mERROR[0m in 0.57s]
[0m15:06:30.782589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b9e0d0>]}
[0m15:06:30.782942 [error] [Thread-2 (]: 6 of 32 ERROR creating sql view model GOLD_LAYER.customers_by_brand_week_wise .. [[31mERROR[0m in 0.59s]
[0m15:06:30.783263 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:30.783526 [error] [Thread-1 (]: 8 of 32 ERROR creating sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[31mERROR[0m in 0.57s]
[0m15:06:30.783818 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:30.784022 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:30.784309 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:30.784511 [debug] [Thread-2 (]: Began running node model.my_dbt_project.enriched_data
[0m15:06:30.785028 [debug] [Thread-1 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:06:30.784780 [info ] [Thread-4 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m15:06:30.785311 [info ] [Thread-2 (]: 11 of 32 START sql table model SILVER_LAYER.enriched_data ...................... [RUN]
[0m15:06:30.785635 [info ] [Thread-1 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m15:06:30.785929 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:06:30.786148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.enriched_data)
[0m15:06:30.786385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.os_by_age_segment)
[0m15:06:30.786570 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:30.786730 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:06:30.786875 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:06:30.835024 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:06:30.839666 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:06:30.837612 [info ] [Thread-2 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m15:06:30.840298 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:06:30.840730 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:30.840898 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:06:30.841079 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:06:30.842527 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:06:30.843851 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:06:30.845223 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m15:06:30.845795 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m15:06:30.846028 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m15:06:30.846617 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:06:30.847294 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m15:06:30.847467 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:30.847665 [debug] [Thread-2 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.REV AS revenue
    LEFT JOIN clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN as enriched_data
        );
[0m15:06:30.847910 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m15:06:30.848144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:30.848624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:31.132361 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e0004620e
[0m15:06:31.132627 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:31.132873 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m15:06:31.308340 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046212
[0m15:06:31.308587 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:31.308827 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m15:06:31.379861 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e000471f6
[0m15:06:31.380097 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:31.380340 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m15:06:31.401062 [debug] [Thread-3 (]: Database Error in model customers_by_os_overall (models/gold/customers_by_os_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_os_overall.sql
[0m15:06:31.401316 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b6ac50>]}
[0m15:06:31.401619 [error] [Thread-3 (]: 9 of 32 ERROR creating sql view model GOLD_LAYER.customers_by_os_overall ....... [[31mERROR[0m in 0.69s]
[0m15:06:31.401890 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:06:31.402079 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:06:31.402385 [info ] [Thread-3 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m15:06:31.402623 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_overall)
[0m15:06:31.402797 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:06:31.404253 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:06:31.404647 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:06:31.406691 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:06:31.407213 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m15:06:31.407420 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from enriched_data
where age is not null
group by age
order by age
  );
[0m15:06:31.407603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:31.421518 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046216
[0m15:06:31.421748 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 35 at position 26 unexpected 'as'.
[0m15:06:31.421975 [debug] [Thread-2 (]: On model.my_dbt_project.enriched_data: Close
[0m15:06:31.452909 [debug] [Thread-4 (]: Database Error in model customers_by_os_week_wise (models/gold/customers_by_os_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_os_week_wise.sql
[0m15:06:31.453332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ff2150>]}
[0m15:06:31.453707 [error] [Thread-4 (]: 10 of 32 ERROR creating sql view model GOLD_LAYER.customers_by_os_week_wise .... [[31mERROR[0m in 0.67s]
[0m15:06:31.454054 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:31.454264 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:31.454532 [info ] [Thread-4 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m15:06:31.454870 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:06:31.455066 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:31.456956 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:06:31.457576 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:31.459242 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:06:31.459795 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:06:31.460088 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m15:06:31.460368 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:31.533866 [debug] [Thread-1 (]: Database Error in model os_by_age_segment (models/gold/os_by_age_segment.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/os_by_age_segment.sql
[0m15:06:31.534202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379d1e10>]}
[0m15:06:31.534514 [error] [Thread-1 (]: 12 of 32 ERROR creating sql view model GOLD_LAYER.os_by_age_segment ............ [[31mERROR[0m in 0.75s]
[0m15:06:31.534801 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:06:31.535000 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:31.535285 [info ] [Thread-1 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m15:06:31.535590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:06:31.535798 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:31.537271 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:06:31.537669 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:31.539189 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:06:31.539678 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m15:06:31.539859 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m15:06:31.540026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:31.558193 [debug] [Thread-2 (]: Database Error in model enriched_data (models/silver/enriched_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 26 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/enriched_data.sql
[0m15:06:31.558663 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c90910>]}
[0m15:06:31.559004 [error] [Thread-2 (]: 11 of 32 ERROR creating sql table model SILVER_LAYER.enriched_data ............. [[31mERROR[0m in 0.77s]
[0m15:06:31.559410 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:06:31.559743 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:31.560065 [info ] [Thread-2 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m15:06:31.560342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:06:31.560508 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:31.561981 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:06:31.562372 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:31.563835 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:06:31.564603 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:06:31.564797 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m15:06:31.564969 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:31.822330 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e000471fa
[0m15:06:31.822601 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:31.822842 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m15:06:31.854036 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e0004621a
[0m15:06:31.854247 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:31.854484 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m15:06:31.939685 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e0004621e
[0m15:06:31.939951 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:31.940187 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m15:06:31.943100 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e000471fe
[0m15:06:31.943311 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:31.943571 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m15:06:31.963395 [debug] [Thread-3 (]: Database Error in model revenue_by_age_overall (models/gold/revenue_by_age_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_age_overall.sql
[0m15:06:31.963684 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bc8ad0>]}
[0m15:06:31.964000 [error] [Thread-3 (]: 13 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_age_overall ....... [[31mERROR[0m in 0.56s]
[0m15:06:31.964318 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:06:31.964519 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:31.964803 [info ] [Thread-3 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m15:06:31.965114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:06:31.965295 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:31.967003 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:06:31.967363 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:31.969384 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:06:31.970190 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m15:06:31.970398 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m15:06:31.970568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:32.046748 [debug] [Thread-4 (]: Database Error in model revenue_by_age_week_wise (models/gold/revenue_by_age_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_age_week_wise.sql
[0m15:06:32.047080 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d27f50>]}
[0m15:06:32.047381 [error] [Thread-4 (]: 14 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_age_week_wise ..... [[31mERROR[0m in 0.59s]
[0m15:06:32.047729 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:32.047947 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:32.048242 [info ] [Thread-4 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m15:06:32.048488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:06:32.048660 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:32.050102 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:06:32.050507 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:32.052026 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:06:32.052494 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:06:32.052670 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m15:06:32.052834 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:32.113922 [debug] [Thread-1 (]: Database Error in model revenue_by_brand_overall (models/gold/revenue_by_brand_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_brand_overall.sql
[0m15:06:32.114506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ff2b50>]}
[0m15:06:32.115672 [debug] [Thread-2 (]: Database Error in model revenue_by_brand_week_wise (models/gold/revenue_by_brand_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_brand_week_wise.sql
[0m15:06:32.114845 [error] [Thread-1 (]: 15 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_brand_overall ..... [[31mERROR[0m in 0.58s]
[0m15:06:32.115956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b694d0>]}
[0m15:06:32.116240 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:32.116511 [error] [Thread-2 (]: 16 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_brand_week_wise ... [[31mERROR[0m in 0.56s]
[0m15:06:32.116793 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:32.117070 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:32.117293 [info ] [Thread-1 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m15:06:32.117537 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:32.117769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:06:32.117997 [info ] [Thread-2 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m15:06:32.118212 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:32.118385 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:06:32.120156 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:06:32.120377 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:32.122009 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:06:32.122361 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:32.122541 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:32.124520 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:06:32.126268 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:06:32.127131 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:06:32.127456 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:06:32.127671 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m15:06:32.127877 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m15:06:32.128072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:32.128231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:32.402531 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046222
[0m15:06:32.402808 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:32.403057 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m15:06:32.502079 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046226
[0m15:06:32.502311 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:32.502547 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m15:06:32.552086 [debug] [Thread-3 (]: Database Error in model revenue_by_gender_overall (models/gold/revenue_by_gender_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_gender_overall.sql
[0m15:06:32.552381 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f476d0>]}
[0m15:06:32.552679 [error] [Thread-3 (]: 17 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_gender_overall .... [[31mERROR[0m in 0.59s]
[0m15:06:32.552946 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:32.553130 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:06:32.553359 [info ] [Thread-3 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m15:06:32.553560 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:06:32.553719 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:06:32.555166 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:32.555547 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:06:32.557065 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:32.557521 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:32.557690 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m15:06:32.557848 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:32.578439 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e0004622a
[0m15:06:32.578763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e0004622e
[0m15:06:32.578985 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:32.579183 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:32.579464 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m15:06:32.579696 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m15:06:32.634977 [debug] [Thread-4 (]: Database Error in model revenue_by_gender_week_wise (models/gold/revenue_by_gender_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_gender_week_wise.sql
[0m15:06:32.635307 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378f0390>]}
[0m15:06:32.635627 [error] [Thread-4 (]: 18 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_gender_week_wise .. [[31mERROR[0m in 0.59s]
[0m15:06:32.635969 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:32.636175 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:32.636385 [info ] [Thread-4 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m15:06:32.636652 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:06:32.636822 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:32.639050 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:32.639460 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:32.640758 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:32.641244 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:32.641969 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m15:06:32.642267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:32.712439 [debug] [Thread-1 (]: Database Error in model revenue_by_mobile_type_overall (models/gold/revenue_by_mobile_type_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_mobile_type_overall.sql
[0m15:06:32.712756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bcb090>]}
[0m15:06:32.713076 [error] [Thread-1 (]: 19 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_mobile_type_overall  [[31mERROR[0m in 0.60s]
[0m15:06:32.713431 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:32.713670 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:32.713919 [info ] [Thread-1 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m15:06:32.714174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:06:32.714382 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:32.716038 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:32.716381 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:32.717688 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:32.718159 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:32.718333 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m15:06:32.718535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:32.730658 [debug] [Thread-2 (]: Database Error in model revenue_by_mobile_type_week_wise (models/gold/revenue_by_mobile_type_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_mobile_type_week_wise.sql
[0m15:06:32.730999 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13799c350>]}
[0m15:06:32.731311 [error] [Thread-2 (]: 20 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise  [[31mERROR[0m in 0.61s]
[0m15:06:32.731610 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:32.731829 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:32.732073 [info ] [Thread-2 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m15:06:32.732279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:06:32.732439 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:32.734033 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:32.734341 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:32.735640 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:32.736095 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:32.736264 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m15:06:32.736512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:33.022025 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e00047202
[0m15:06:33.022294 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:33.022538 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m15:06:33.066689 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046232
[0m15:06:33.066904 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:33.067137 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m15:06:33.130498 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e00047206
[0m15:06:33.130727 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:33.130958 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m15:06:33.161750 [debug] [Thread-3 (]: Database Error in model revenue_by_os_overall (models/gold/revenue_by_os_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_os_overall.sql
[0m15:06:33.162022 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bf4c50>]}
[0m15:06:33.162320 [error] [Thread-3 (]: 21 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_os_overall ........ [[31mERROR[0m in 0.61s]
[0m15:06:33.162591 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:06:33.162788 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:33.163052 [info ] [Thread-3 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m15:06:33.163314 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:06:33.163484 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:33.164921 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:33.165311 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:33.166804 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:33.167266 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:33.167445 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from enriched_data 
where value_segment is not null
group by value_segment
  );
[0m15:06:33.167611 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:33.180647 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e0004720a
[0m15:06:33.180883 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:33.181116 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m15:06:33.206559 [debug] [Thread-4 (]: Database Error in model revenue_by_os_vendor_overall (models/gold/revenue_by_os_vendor_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_os_vendor_overall.sql
[0m15:06:33.207061 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c68bd0>]}
[0m15:06:33.269245 [debug] [Thread-1 (]: Database Error in model revenue_by_os_vendor_week_wise (models/gold/revenue_by_os_vendor_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_os_vendor_week_wise.sql
[0m15:06:33.269545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ff2a90>]}
[0m15:06:33.302686 [debug] [Thread-2 (]: Database Error in model revenue_by_os_week_wise (models/gold/revenue_by_os_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_os_week_wise.sql
[0m15:06:33.302944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ca19d0>]}
[0m15:06:33.584910 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e0004720e
[0m15:06:33.585170 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:33.585414 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m15:06:33.748466 [debug] [Thread-3 (]: Database Error in model revenue_by_value_segment_overall (models/gold/revenue_by_value_segment_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_value_segment_overall.sql
[0m15:06:33.748794 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f78fd0>]}
[0m15:06:34.722321 [error] [Thread-4 (]: 22 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_os_vendor_overall . [[31mERROR[0m in 0.57s]
[0m15:06:34.722614 [error] [Thread-1 (]: 23 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise  [[31mERROR[0m in 0.56s]
[0m15:06:34.722889 [error] [Thread-2 (]: 24 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_os_week_wise ...... [[31mERROR[0m in 0.57s]
[0m15:06:34.723161 [error] [Thread-3 (]: 25 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_value_segment_overall  [[31mERROR[0m in 0.59s]
[0m15:06:34.723567 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:34.723810 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:34.724052 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:34.724311 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:34.724544 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:34.724806 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:06:34.725033 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:06:34.725245 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:06:34.725498 [info ] [Thread-4 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m15:06:34.725730 [info ] [Thread-1 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m15:06:34.725958 [info ] [Thread-2 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m15:06:34.726411 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:06:34.726199 [info ] [Thread-3 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m15:06:34.726652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:06:34.726842 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:06:34.727025 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:34.727194 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:06:34.727357 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:06:34.727521 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:06:34.730216 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:34.730427 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:06:34.731776 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:06:34.733181 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:06:34.734548 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:06:34.734938 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:34.735160 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:06:34.736579 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:34.736793 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:06:34.737081 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:06:34.738634 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m15:06:34.740304 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m15:06:34.742431 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m15:06:34.743110 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:34.743725 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m15:06:34.744276 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m15:06:34.744524 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m15:06:34.745182 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m15:06:34.745534 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m15:06:34.745975 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m15:06:34.746318 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:34.746583 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m15:06:34.746926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:34.747127 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:34.747973 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:35.217867 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e0004623e
[0m15:06:35.218204 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e00047212
[0m15:06:35.218457 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046236
[0m15:06:35.218678 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:35.218924 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:35.219209 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e0004623a
[0m15:06:35.219407 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:35.219664 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m15:06:35.219909 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: Close
[0m15:06:35.220093 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:35.220314 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m15:06:35.221959 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: Close
[0m15:06:35.353828 [debug] [Thread-4 (]: Database Error in model revenue_by_value_segment_week_wise (models/gold/revenue_by_value_segment_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_value_segment_week_wise.sql
[0m15:06:35.354135 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136cef150>]}
[0m15:06:35.354435 [error] [Thread-4 (]: 26 of 32 ERROR creating sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[31mERROR[0m in 0.63s]
[0m15:06:35.354711 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:35.354906 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:06:35.355133 [info ] [Thread-4 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m15:06:35.355347 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m15:06:35.355541 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:06:35.357987 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:06:35.358763 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:06:35.360600 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m15:06:35.363012 [debug] [Thread-2 (]: Database Error in model total_customers_week_wise (models/gold/total_customers_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/total_customers_week_wise.sql
[0m15:06:35.363286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee71750>]}
[0m15:06:35.363900 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m15:06:35.364917 [debug] [Thread-1 (]: Database Error in model total_customers_overall (models/gold/total_customers_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/total_customers_overall.sql
[0m15:06:35.365208 [error] [Thread-2 (]: 28 of 32 ERROR creating sql view model GOLD_LAYER.total_customers_week_wise .... [[31mERROR[0m in 0.64s]
[0m15:06:35.365447 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m15:06:35.365674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c8b8d0>]}
[0m15:06:35.365934 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:06:35.366113 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:35.366370 [error] [Thread-1 (]: 27 of 32 ERROR creating sql view model GOLD_LAYER.total_customers_overall ...... [[31mERROR[0m in 0.64s]
[0m15:06:35.366586 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:35.366893 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:06:35.367429 [info ] [Thread-2 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m15:06:35.367888 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:35.368147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:06:35.368362 [info ] [Thread-1 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m15:06:35.368566 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:35.368754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:06:35.370884 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:35.371406 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:35.374757 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:35.375168 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:35.377119 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:35.377642 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:35.379263 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:35.379698 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:35.379921 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m15:06:35.380120 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:35.380436 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:35.380648 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m15:06:35.381110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:35.387361 [debug] [Thread-3 (]: Database Error in model total_devices_overall (models/gold/total_devices_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/total_devices_overall.sql
[0m15:06:35.387722 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fce6010>]}
[0m15:06:35.388257 [error] [Thread-3 (]: 29 of 32 ERROR creating sql view model GOLD_LAYER.total_devices_overall ........ [[31mERROR[0m in 0.66s]
[0m15:06:35.388861 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:06:35.830910 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046246
[0m15:06:35.831257 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5f-0008-eb7e00046242
[0m15:06:35.831500 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:35.831718 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:35.832023 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m15:06:35.832571 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m15:06:35.834414 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b4e420-3201-1b5c-0008-eb7e00047216
[0m15:06:35.834667 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
[0m15:06:35.834895 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m15:06:35.969561 [debug] [Thread-4 (]: Database Error in model total_devices_week_wise (models/gold/total_devices_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/total_devices_week_wise.sql
[0m15:06:35.970451 [debug] [Thread-2 (]: Database Error in model weekly_revenue_by_brand (models/gold/weekly_revenue_by_brand.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/weekly_revenue_by_brand.sql
[0m15:06:35.971240 [debug] [Thread-1 (]: Database Error in model weekly_revenue_by_os (models/gold/weekly_revenue_by_os.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/weekly_revenue_by_os.sql
[0m15:06:35.971480 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b68650>]}
[0m15:06:35.971667 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105981790>]}
[0m15:06:35.971861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e4112e-7e3e-4361-ae3c-1fdb8bc3de84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107753990>]}
[0m15:06:35.972185 [error] [Thread-4 (]: 30 of 32 ERROR creating sql view model GOLD_LAYER.total_devices_week_wise ...... [[31mERROR[0m in 0.62s]
[0m15:06:35.972504 [error] [Thread-2 (]: 31 of 32 ERROR creating sql view model GOLD_LAYER.weekly_revenue_by_brand ...... [[31mERROR[0m in 0.60s]
[0m15:06:35.972789 [error] [Thread-1 (]: 32 of 32 ERROR creating sql view model GOLD_LAYER.weekly_revenue_by_os ......... [[31mERROR[0m in 0.60s]
[0m15:06:35.973061 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:06:35.973303 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:35.973522 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:35.974397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:35.974560 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:06:35.974688 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:06:35.974805 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_overall' was properly closed.
[0m15:06:35.974913 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m15:06:35.975104 [info ] [MainThread]: 
[0m15:06:35.975275 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m15:06:35.977212 [debug] [MainThread]: Command end result
[0m15:06:35.996804 [info ] [MainThread]: 
[0m15:06:35.997070 [info ] [MainThread]: [31mCompleted with 32 errors and 0 warnings:[0m
[0m15:06:35.997219 [info ] [MainThread]: 
[0m15:06:35.997418 [error] [MainThread]:   Database Error in model clean_device_data (models/silver/clean_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'select'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_device_data.sql
[0m15:06:35.997591 [info ] [MainThread]: 
[0m15:06:35.997760 [error] [MainThread]:   Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 0 unexpected 'select'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m15:06:35.997893 [info ] [MainThread]: 
[0m15:06:35.998047 [error] [MainThread]:   Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:06:35.998172 [info ] [MainThread]: 
[0m15:06:35.998325 [error] [MainThread]:   Database Error in model brand_by_age_segment (models/gold/brand_by_age_segment.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/brand_by_age_segment.sql
[0m15:06:35.998449 [info ] [MainThread]: 
[0m15:06:35.998626 [error] [MainThread]:   Database Error in model customers_by_brand_overall (models/gold/customers_by_brand_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_brand_overall.sql
[0m15:06:35.998795 [info ] [MainThread]: 
[0m15:06:35.998968 [error] [MainThread]:   Database Error in model customers_by_mobile_type_overall (models/gold/customers_by_mobile_type_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_mobile_type_overall.sql
[0m15:06:35.999104 [info ] [MainThread]: 
[0m15:06:35.999261 [error] [MainThread]:   Database Error in model customers_by_brand_week_wise (models/gold/customers_by_brand_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_brand_week_wise.sql
[0m15:06:35.999392 [info ] [MainThread]: 
[0m15:06:35.999572 [error] [MainThread]:   Database Error in model customers_by_mobile_type_week_wise (models/gold/customers_by_mobile_type_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_mobile_type_week_wise.sql
[0m15:06:35.999710 [info ] [MainThread]: 
[0m15:06:35.999864 [error] [MainThread]:   Database Error in model customers_by_os_overall (models/gold/customers_by_os_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_os_overall.sql
[0m15:06:35.999987 [info ] [MainThread]: 
[0m15:06:36.000135 [error] [MainThread]:   Database Error in model customers_by_os_week_wise (models/gold/customers_by_os_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/customers_by_os_week_wise.sql
[0m15:06:36.000257 [info ] [MainThread]: 
[0m15:06:36.000404 [error] [MainThread]:   Database Error in model os_by_age_segment (models/gold/os_by_age_segment.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/os_by_age_segment.sql
[0m15:06:36.000523 [info ] [MainThread]: 
[0m15:06:36.000684 [error] [MainThread]:   Database Error in model enriched_data (models/silver/enriched_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 26 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/enriched_data.sql
[0m15:06:36.000821 [info ] [MainThread]: 
[0m15:06:36.000979 [error] [MainThread]:   Database Error in model revenue_by_age_overall (models/gold/revenue_by_age_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_age_overall.sql
[0m15:06:36.001104 [info ] [MainThread]: 
[0m15:06:36.001256 [error] [MainThread]:   Database Error in model revenue_by_age_week_wise (models/gold/revenue_by_age_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_age_week_wise.sql
[0m15:06:36.001381 [info ] [MainThread]: 
[0m15:06:36.001591 [error] [MainThread]:   Database Error in model revenue_by_brand_overall (models/gold/revenue_by_brand_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_brand_overall.sql
[0m15:06:36.001743 [info ] [MainThread]: 
[0m15:06:36.001914 [error] [MainThread]:   Database Error in model revenue_by_brand_week_wise (models/gold/revenue_by_brand_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_brand_week_wise.sql
[0m15:06:36.002069 [info ] [MainThread]: 
[0m15:06:36.002228 [error] [MainThread]:   Database Error in model revenue_by_gender_overall (models/gold/revenue_by_gender_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_gender_overall.sql
[0m15:06:36.002349 [info ] [MainThread]: 
[0m15:06:36.002497 [error] [MainThread]:   Database Error in model revenue_by_gender_week_wise (models/gold/revenue_by_gender_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_gender_week_wise.sql
[0m15:06:36.002636 [info ] [MainThread]: 
[0m15:06:36.002793 [error] [MainThread]:   Database Error in model revenue_by_mobile_type_overall (models/gold/revenue_by_mobile_type_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_mobile_type_overall.sql
[0m15:06:36.002912 [info ] [MainThread]: 
[0m15:06:36.003149 [error] [MainThread]:   Database Error in model revenue_by_mobile_type_week_wise (models/gold/revenue_by_mobile_type_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_mobile_type_week_wise.sql
[0m15:06:36.003307 [info ] [MainThread]: 
[0m15:06:36.003465 [error] [MainThread]:   Database Error in model revenue_by_os_overall (models/gold/revenue_by_os_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_os_overall.sql
[0m15:06:36.003631 [info ] [MainThread]: 
[0m15:06:36.003803 [error] [MainThread]:   Database Error in model revenue_by_os_vendor_overall (models/gold/revenue_by_os_vendor_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_os_vendor_overall.sql
[0m15:06:36.003935 [info ] [MainThread]: 
[0m15:06:36.004154 [error] [MainThread]:   Database Error in model revenue_by_os_vendor_week_wise (models/gold/revenue_by_os_vendor_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_os_vendor_week_wise.sql
[0m15:06:36.004353 [info ] [MainThread]: 
[0m15:06:36.004575 [error] [MainThread]:   Database Error in model revenue_by_os_week_wise (models/gold/revenue_by_os_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_os_week_wise.sql
[0m15:06:36.004714 [info ] [MainThread]: 
[0m15:06:36.005018 [error] [MainThread]:   Database Error in model revenue_by_value_segment_overall (models/gold/revenue_by_value_segment_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_value_segment_overall.sql
[0m15:06:36.005196 [info ] [MainThread]: 
[0m15:06:36.005392 [error] [MainThread]:   Database Error in model revenue_by_value_segment_week_wise (models/gold/revenue_by_value_segment_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/revenue_by_value_segment_week_wise.sql
[0m15:06:36.005586 [info ] [MainThread]: 
[0m15:06:36.005800 [error] [MainThread]:   Database Error in model total_customers_week_wise (models/gold/total_customers_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/total_customers_week_wise.sql
[0m15:06:36.005937 [info ] [MainThread]: 
[0m15:06:36.006129 [error] [MainThread]:   Database Error in model total_customers_overall (models/gold/total_customers_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/total_customers_overall.sql
[0m15:06:36.006320 [info ] [MainThread]: 
[0m15:06:36.006630 [error] [MainThread]:   Database Error in model total_devices_overall (models/gold/total_devices_overall.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/total_devices_overall.sql
[0m15:06:36.006955 [info ] [MainThread]: 
[0m15:06:36.007180 [error] [MainThread]:   Database Error in model total_devices_week_wise (models/gold/total_devices_week_wise.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/total_devices_week_wise.sql
[0m15:06:36.007373 [info ] [MainThread]: 
[0m15:06:36.007577 [error] [MainThread]:   Database Error in model weekly_revenue_by_brand (models/gold/weekly_revenue_by_brand.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/weekly_revenue_by_brand.sql
[0m15:06:36.007805 [info ] [MainThread]: 
[0m15:06:36.008046 [error] [MainThread]:   Database Error in model weekly_revenue_by_os (models/gold/weekly_revenue_by_os.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_SEC2_DB.GOLD_LAYER.ENRICHED_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/gold/weekly_revenue_by_os.sql
[0m15:06:36.008214 [info ] [MainThread]: 
[0m15:06:36.008379 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=32 SKIP=0 TOTAL=32
[0m15:06:36.010640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.439043, "process_user_time": 3.995236, "process_kernel_time": 1.474813, "process_mem_max_rss": "206176256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:06:36.010902 [debug] [MainThread]: Command `dbt run` failed at 15:06:36.010863 after 9.44 seconds
[0m15:06:36.011101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ebb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104938710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093003d0>]}
[0m15:06:36.011268 [debug] [MainThread]: Flushing usage events
[0m15:07:53.195099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdd110>]}


============================== 15:07:53.197461 | f898087e-78fc-4cb6-b6d2-cb2423486f21 ==============================
[0m15:07:53.197461 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:07:53.197778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": false} --models models/silver/crm_device_data.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:07:53.883810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f898087e-78fc-4cb6-b6d2-cb2423486f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201358d0>]}
[0m15:07:53.906112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f898087e-78fc-4cb6-b6d2-cb2423486f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a171d0>]}
[0m15:07:53.907277 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:07:53.920110 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:07:54.007379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:54.007646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:54.027332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f898087e-78fc-4cb6-b6d2-cb2423486f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120240090>]}
[0m15:07:54.078418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f898087e-78fc-4cb6-b6d2-cb2423486f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201a0050>]}
[0m15:07:54.078734 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:07:54.078909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f898087e-78fc-4cb6-b6d2-cb2423486f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffdaf90>]}
[0m15:07:54.079953 [info ] [MainThread]: 
[0m15:07:54.080286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:07:54.080716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:07:54.131211 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:07:54.131488 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:07:54.131639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:54.664951 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:07:54.665888 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:07:54.801386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SILVER_LAYER)
[0m15:07:54.801735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:07:54.805754 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:07:54.805997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:07:54.807046 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:07:54.807216 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:07:54.808177 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:07:54.808352 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:07:54.808516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:54.808669 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:07:54.808804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:54.808979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:55.238148 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:07:55.239166 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:07:55.300797 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:07:55.301955 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:07:55.305209 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:07:55.306535 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:07:55.453619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f898087e-78fc-4cb6-b6d2-cb2423486f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e87410>]}
[0m15:07:55.453961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:55.454210 [info ] [MainThread]: 
[0m15:07:55.456137 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:07:55.456393 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.crm_device_data ...................... [RUN]
[0m15:07:55.456654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.crm_device_data)
[0m15:07:55.456843 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:07:55.462250 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:07:55.462655 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:07:55.478470 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:07:55.479259 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:07:55.479461 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN as crm_device_data
        );
[0m15:07:55.479638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:55.893156 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e421-3201-1b5c-0008-eb7e00047232
[0m15:07:55.893476 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 47 unexpected 'as'.
[0m15:07:55.893745 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:07:56.033475 [debug] [Thread-1 (]: Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:07:56.034338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f898087e-78fc-4cb6-b6d2-cb2423486f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120926410>]}
[0m15:07:56.034699 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_LAYER.crm_device_data ............. [[31mERROR[0m in 0.58s]
[0m15:07:56.034998 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:07:56.035776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:56.035942 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:07:56.036073 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:07:56.036189 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:07:56.036325 [info ] [MainThread]: 
[0m15:07:56.036481 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m15:07:56.036800 [debug] [MainThread]: Command end result
[0m15:07:56.053789 [info ] [MainThread]: 
[0m15:07:56.054095 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:56.054265 [info ] [MainThread]: 
[0m15:07:56.054548 [error] [MainThread]:   Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:07:56.054750 [info ] [MainThread]: 
[0m15:07:56.054947 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:07:56.057748 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8906956, "process_user_time": 2.117059, "process_kernel_time": 0.820897, "process_mem_max_rss": "193937408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:56.058175 [debug] [MainThread]: Command `dbt run` failed at 15:07:56.058125 after 2.89 seconds
[0m15:07:56.058392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fde810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b77610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b98610>]}
[0m15:07:56.058566 [debug] [MainThread]: Flushing usage events
[0m15:09:06.505899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104769650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104774790>]}


============================== 15:09:06.508777 | f7361214-a939-485e-863c-89c3d56e4f2d ==============================
[0m15:09:06.508777 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:09:06.509099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"unit_testing": false} --models models/silver/crm_device_data.sql', 'send_anonymous_usage_stats': 'True'}
[0m15:09:07.265934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7361214-a939-485e-863c-89c3d56e4f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128329050>]}
[0m15:09:07.290017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7361214-a939-485e-863c-89c3d56e4f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041cf150>]}
[0m15:09:07.290653 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:09:07.302978 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:09:07.396450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:07.396876 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m15:09:07.467625 [info ] [MainThread]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.clean_crm_data
[0m15:09:07.558586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7361214-a939-485e-863c-89c3d56e4f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128900c10>]}
[0m15:09:07.608937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7361214-a939-485e-863c-89c3d56e4f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285e9b90>]}
[0m15:09:07.609235 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:09:07.609409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7361214-a939-485e-863c-89c3d56e4f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1283347d0>]}
[0m15:09:07.610417 [info ] [MainThread]: 
[0m15:09:07.610693 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:09:07.611106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:09:07.617462 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:09:07.617710 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:09:07.617870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:08.813706 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:09:08.814643 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:09:08.945101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:09:08.945466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:09:08.946207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:09:08.949842 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:09:08.950916 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:09:08.951902 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:09:08.952098 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:09:08.952282 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:09:08.952463 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:09:08.952615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:08.952746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:08.952878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:09.637411 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:09:09.640337 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:09:09.769823 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:09:09.770182 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:09:09.771026 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:09:09.771772 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:09:09.905940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7361214-a939-485e-863c-89c3d56e4f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128636c10>]}
[0m15:09:09.906267 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:09.906438 [info ] [MainThread]: 
[0m15:09:09.908271 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:09:09.908538 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.crm_device_data ...................... [RUN]
[0m15:09:09.908769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.crm_device_data)
[0m15:09:09.908937 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:09:09.913272 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:09:09.913677 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:09:09.929072 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:09:09.929897 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:09:09.930117 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN as crm_device_data
        );
[0m15:09:09.930316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:10.325768 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e423-3201-1b5c-0008-eb7e0004723e
[0m15:09:10.326034 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 47 unexpected 'as'.
[0m15:09:10.326279 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:09:10.472856 [debug] [Thread-1 (]: Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:09:10.473649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7361214-a939-485e-863c-89c3d56e4f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104747890>]}
[0m15:09:10.473990 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_LAYER.crm_device_data ............. [[31mERROR[0m in 0.56s]
[0m15:09:10.474276 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:09:10.475022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:10.475162 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:09:10.475283 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m15:09:10.475395 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:09:10.475529 [info ] [MainThread]: 
[0m15:09:10.475671 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m15:09:10.475997 [debug] [MainThread]: Command end result
[0m15:09:10.493207 [info ] [MainThread]: 
[0m15:09:10.493511 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:10.493679 [info ] [MainThread]: 
[0m15:09:10.493864 [error] [MainThread]:   Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:09:10.494007 [info ] [MainThread]: 
[0m15:09:10.494150 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:09:10.495951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0197597, "process_user_time": 2.2182, "process_kernel_time": 1.133123, "process_mem_max_rss": "197591040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:10.496202 [debug] [MainThread]: Command `dbt run` failed at 15:09:10.496161 after 4.02 seconds
[0m15:09:10.496391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101348750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047743d0>]}
[0m15:09:10.496557 [debug] [MainThread]: Flushing usage events
[0m15:12:06.283702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e61e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed1250>]}


============================== 15:12:06.286711 | f4044ca0-fa4d-4a36-b275-e02ac165e9aa ==============================
[0m15:12:06.286711 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:12:06.287062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": false} --models models/silver/clean_crm_data.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:12:07.065081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4044ca0-fa4d-4a36-b275-e02ac165e9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c531b50>]}
[0m15:12:07.087813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4044ca0-fa4d-4a36-b275-e02ac165e9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790b210>]}
[0m15:12:07.088438 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:12:07.100631 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:12:07.189300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:07.189556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:07.208938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4044ca0-fa4d-4a36-b275-e02ac165e9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c6564d0>]}
[0m15:12:07.263057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4044ca0-fa4d-4a36-b275-e02ac165e9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9404d0>]}
[0m15:12:07.263391 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:12:07.263586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4044ca0-fa4d-4a36-b275-e02ac165e9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c6cff90>]}
[0m15:12:07.264664 [info ] [MainThread]: 
[0m15:12:07.264984 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:12:07.265406 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:12:07.318130 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:12:07.318412 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:12:07.318562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:07.900230 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:12:07.901146 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:12:08.043650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SILVER_LAYER)
[0m15:12:08.043940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:12:08.044183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:12:08.048179 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:12:08.049191 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:12:08.050151 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:12:08.050332 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:12:08.050501 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:12:08.050655 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:12:08.050797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:08.050945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:08.051116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:08.521776 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:12:08.522857 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:12:08.572736 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:12:08.574024 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:12:08.589860 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:12:08.590665 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:12:08.730283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4044ca0-fa4d-4a36-b275-e02ac165e9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d89ad0>]}
[0m15:12:08.730665 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:12:08.730833 [info ] [MainThread]: 
[0m15:12:08.732725 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:12:08.732989 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.clean_crm_data ....................... [RUN]
[0m15:12:08.733220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_crm_data)
[0m15:12:08.733404 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:12:08.739755 [info ] [Thread-1 (]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.CRM
[0m15:12:08.740017 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:12:08.740393 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:12:08.755547 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:12:08.756683 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:12:08.756917 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final as clean_crm_data
        );
[0m15:12:08.757128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:32.896152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 24.0 seconds
[0m15:12:32.908030 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:12:33.117748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4044ca0-fa4d-4a36-b275-e02ac165e9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5a3810>]}
[0m15:12:33.118146 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_LAYER.clean_crm_data .................. [[32mSUCCESS 1[0m in 24.38s]
[0m15:12:33.118431 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:12:33.119150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:33.119324 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:12:33.119454 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:12:33.119570 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:12:33.119716 [info ] [MainThread]: 
[0m15:12:33.119879 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 25.85 seconds (25.85s).
[0m15:12:33.120187 [debug] [MainThread]: Command end result
[0m15:12:33.139997 [info ] [MainThread]: 
[0m15:12:33.140281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:33.140428 [info ] [MainThread]: 
[0m15:12:33.140574 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:12:33.142753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.88796, "process_user_time": 2.097858, "process_kernel_time": 0.865027, "process_mem_max_rss": "191725568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:12:33.143034 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:33.142991 after 26.89 seconds
[0m15:12:33.143223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049be1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f6790>]}
[0m15:12:33.143392 [debug] [MainThread]: Flushing usage events
[0m15:13:26.999672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e57d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eaff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec5010>]}


============================== 15:13:27.002596 | a020dc8d-66b4-43cb-a5fe-f0d5218c7d91 ==============================
[0m15:13:27.002596 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:13:27.002943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": True} --models models/silver/clean_crm_data.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:13:27.910528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a020dc8d-66b4-43cb-a5fe-f0d5218c7d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d650fd0>]}
[0m15:13:27.933269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a020dc8d-66b4-43cb-a5fe-f0d5218c7d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743b1d0>]}
[0m15:13:27.933890 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:13:27.945918 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:13:28.013805 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:13:28.014218 [debug] [MainThread]: previous checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, current checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d
[0m15:13:28.014418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a020dc8d-66b4-43cb-a5fe-f0d5218c7d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a96510>]}
[0m15:13:28.468057 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:13:28.477799 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:13:28.484073 [info ] [MainThread]: import_crm: PROJECT_SEC2_DB.BRONZE_LAYER.clean_crm_data
[0m15:13:28.697350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a020dc8d-66b4-43cb-a5fe-f0d5218c7d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15db44090>]}
[0m15:13:28.749826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a020dc8d-66b4-43cb-a5fe-f0d5218c7d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dce7510>]}
[0m15:13:28.750137 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:13:28.750326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a020dc8d-66b4-43cb-a5fe-f0d5218c7d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dcccc50>]}
[0m15:13:28.751375 [info ] [MainThread]: 
[0m15:13:28.751684 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:13:28.752142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:13:28.758730 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:13:28.758943 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:13:28.759089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:29.315024 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:13:29.315929 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:13:29.440235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:13:29.440548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:13:29.444528 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:13:29.444775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:13:29.446238 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:13:29.446445 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:13:29.447416 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:13:29.447603 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:13:29.447773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:29.447931 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:13:29.448082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:29.448268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:29.913083 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:13:29.913575 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:13:29.914554 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:13:29.915738 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:13:29.987483 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:13:29.988323 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:13:30.138666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a020dc8d-66b4-43cb-a5fe-f0d5218c7d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c7d890>]}
[0m15:13:30.139001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:13:30.139163 [info ] [MainThread]: 
[0m15:13:30.141060 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:13:30.141337 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.clean_crm_data ....................... [RUN]
[0m15:13:30.141570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_crm_data)
[0m15:13:30.141738 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:13:30.146407 [info ] [Thread-1 (]: import_crm: PROJECT_SEC2_DB.SEEDS.input_crm
[0m15:13:30.146653 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:13:30.147022 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:13:30.161356 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:13:30.163459 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:13:30.163907 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final as test_clean_crm_data
        );
[0m15:13:30.164291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:31.367171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:13:31.377824 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:13:31.516585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a020dc8d-66b4-43cb-a5fe-f0d5218c7d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15df8c710>]}
[0m15:13:31.517049 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_LAYER.clean_crm_data .................. [[32mSUCCESS 1[0m in 1.37s]
[0m15:13:31.517462 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:13:31.518365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:31.518568 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:13:31.518701 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m15:13:31.518820 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:13:31.518959 [info ] [MainThread]: 
[0m15:13:31.519178 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m15:13:31.519482 [debug] [MainThread]: Command end result
[0m15:13:31.540278 [info ] [MainThread]: 
[0m15:13:31.540560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:31.540833 [info ] [MainThread]: 
[0m15:13:31.541029 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:13:31.544271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.576635, "process_user_time": 2.694183, "process_kernel_time": 1.271256, "process_mem_max_rss": "201424896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:13:31.544772 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:31.544710 after 4.58 seconds
[0m15:13:31.545195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103684750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035b61d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ee790>]}
[0m15:13:31.545526 [debug] [MainThread]: Flushing usage events
[0m15:14:06.619690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ebe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106543a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106558e50>]}


============================== 15:14:06.622607 | 4a096bba-ab65-4dc0-afb2-d6bf41079cec ==============================
[0m15:14:06.622607 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:14:06.622925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/silver/clean_crm_data.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:14:07.408514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a096bba-ab65-4dc0-afb2-d6bf41079cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8e9d0>]}
[0m15:14:07.432278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a096bba-ab65-4dc0-afb2-d6bf41079cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f9b110>]}
[0m15:14:07.433457 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:14:07.445933 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:14:07.535668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:07.535924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:07.555647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a096bba-ab65-4dc0-afb2-d6bf41079cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310d93d0>]}
[0m15:14:07.605951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a096bba-ab65-4dc0-afb2-d6bf41079cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13122b690>]}
[0m15:14:07.606246 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:14:07.606429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a096bba-ab65-4dc0-afb2-d6bf41079cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131180250>]}
[0m15:14:07.607540 [info ] [MainThread]: 
[0m15:14:07.607973 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:07.608391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:14:07.657788 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:14:07.658062 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:14:07.658211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:08.208819 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:14:08.209778 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:14:08.340324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:14:08.340623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:14:08.340859 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:14:08.344913 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:14:08.345890 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:14:08.346872 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:14:08.347067 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:14:08.347251 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:14:08.347405 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:14:08.347555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:08.347693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:08.347829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:08.788473 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:14:08.789886 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:14:08.855769 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:14:08.856685 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:14:08.887244 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:14:08.888044 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:14:09.023039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a096bba-ab65-4dc0-afb2-d6bf41079cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130fefad0>]}
[0m15:14:09.023377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:09.023543 [info ] [MainThread]: 
[0m15:14:09.025569 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:14:09.025996 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.clean_crm_data ....................... [RUN]
[0m15:14:09.026304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m15:14:09.026615 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:14:09.033416 [info ] [Thread-1 (]: import_crm: PROJECT_SEC2_DB.SEEDS.input_crm
[0m15:14:09.033727 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:14:09.034114 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:14:09.049878 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:14:09.051174 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:14:09.051440 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final as test_clean_crm_data
        );
[0m15:14:09.051654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:10.278249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:14:10.288813 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:14:10.449779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a096bba-ab65-4dc0-afb2-d6bf41079cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134bd3110>]}
[0m15:14:10.450159 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_LAYER.clean_crm_data .................. [[32mSUCCESS 1[0m in 1.42s]
[0m15:14:10.450443 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:14:10.451160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:10.451330 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:14:10.451457 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:14:10.451570 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m15:14:10.451718 [info ] [MainThread]: 
[0m15:14:10.451869 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m15:14:10.452148 [debug] [MainThread]: Command end result
[0m15:14:10.467874 [info ] [MainThread]: 
[0m15:14:10.468183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:10.468330 [info ] [MainThread]: 
[0m15:14:10.468474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:14:10.470386 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.88049, "process_user_time": 2.112062, "process_kernel_time": 1.277362, "process_mem_max_rss": "193183744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:14:10.470687 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:10.470642 after 3.88 seconds
[0m15:14:10.470879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103114750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030461d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421f310>]}
[0m15:14:10.471057 [debug] [MainThread]: Flushing usage events
[0m15:15:12.573889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fba490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106013a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106013910>]}


============================== 15:15:12.576812 | bac916ee-12b3-45bd-a5a9-10ec16bf219a ==============================
[0m15:15:12.576812 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:15:12.577189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/silver/clean_crm_data.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:15:13.346827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bac916ee-12b3-45bd-a5a9-10ec16bf219a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b7cfe50>]}
[0m15:15:13.371229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bac916ee-12b3-45bd-a5a9-10ec16bf219a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a671d0>]}
[0m15:15:13.372517 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:15:13.385014 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:15:13.475844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:15:13.476280 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m15:15:13.549037 [info ] [MainThread]: import_crm: test_clean_crm_data
[0m15:15:13.639600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bac916ee-12b3-45bd-a5a9-10ec16bf219a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ecc3850>]}
[0m15:15:13.688614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bac916ee-12b3-45bd-a5a9-10ec16bf219a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105858110>]}
[0m15:15:13.688916 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:15:13.689087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bac916ee-12b3-45bd-a5a9-10ec16bf219a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eb37410>]}
[0m15:15:13.690053 [info ] [MainThread]: 
[0m15:15:13.690319 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:15:13.690723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:15:13.697016 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:15:13.697240 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:15:13.697395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:14.314177 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:15:14.315140 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:15:14.484754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:15:14.485106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:15:14.485399 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:15:14.489824 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:15:14.491423 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:15:14.493413 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:15:14.493773 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:15:14.493981 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:15:14.494216 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:15:14.494372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:14.494545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:14.494695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:15.016935 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:15:15.018000 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:15:15.093061 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:15:15.094283 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:15:15.204434 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:15:15.205758 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:15:15.349503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bac916ee-12b3-45bd-a5a9-10ec16bf219a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0bb910>]}
[0m15:15:15.349894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:15:15.350090 [info ] [MainThread]: 
[0m15:15:15.352023 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:15:15.352299 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.clean_crm_data ....................... [RUN]
[0m15:15:15.352546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m15:15:15.352732 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:15:15.358292 [info ] [Thread-1 (]: import_crm: test_clean_crm_data
[0m15:15:15.358940 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:15:15.359751 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:15:15.377241 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:15:15.378640 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:15:15.379087 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final as test_clean_crm_data
        );
[0m15:15:15.379366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:16.630948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:15:16.641503 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:15:16.824703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bac916ee-12b3-45bd-a5a9-10ec16bf219a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12edfe390>]}
[0m15:15:16.825169 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_LAYER.clean_crm_data .................. [[32mSUCCESS 1[0m in 1.47s]
[0m15:15:16.825453 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:15:16.826235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:16.826405 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:15:16.826534 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:15:16.826651 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m15:15:16.826781 [info ] [MainThread]: 
[0m15:15:16.826930 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m15:15:16.827217 [debug] [MainThread]: Command end result
[0m15:15:16.844756 [info ] [MainThread]: 
[0m15:15:16.845037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:16.845187 [info ] [MainThread]: 
[0m15:15:16.845333 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:15:16.847212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.302088, "process_user_time": 2.156473, "process_kernel_time": 1.218332, "process_mem_max_rss": "194838528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:15:16.847490 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:16.847446 after 4.30 seconds
[0m15:15:16.847678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102be4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b161d0>]}
[0m15:15:16.847845 [debug] [MainThread]: Flushing usage events
[0m15:17:30.699620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108621010>]}


============================== 15:17:30.702579 | efb2b26e-a464-40fd-953e-d817d12028a1 ==============================
[0m15:17:30.702579 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:17:30.702964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/silver/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:31.428607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bd2910>]}
[0m15:17:31.451023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805b210>]}
[0m15:17:31.452182 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:17:31.464077 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:17:31.550792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:31.551046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:31.570704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dde9d0>]}
[0m15:17:31.620807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f84550>]}
[0m15:17:31.621127 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:17:31.621307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c8a510>]}
[0m15:17:31.622416 [info ] [MainThread]: 
[0m15:17:31.622724 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:17:31.624731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:17:31.672995 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:17:31.673284 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:17:31.673441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:32.295617 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:17:32.296558 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:17:32.422035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:17:32.422327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:17:32.422602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:17:32.426691 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:17:32.427686 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:17:32.428683 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:17:32.428863 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:17:32.429026 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:17:32.429173 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:17:32.429330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:32.429474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:32.429595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:32.868751 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:17:32.870271 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:17:32.971673 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:17:32.972055 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:17:32.972943 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:17:32.973712 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:17:33.126636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d24850>]}
[0m15:17:33.126998 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:33.127163 [info ] [MainThread]: 
[0m15:17:33.128671 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:17:33.129108 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:17:33.128947 [info ] [Thread-1 (]: 1 of 4 START sql table model SILVER_LAYER.clean_crm_data ....................... [RUN]
[0m15:17:33.129352 [debug] [Thread-3 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:17:33.129767 [info ] [Thread-2 (]: 2 of 4 START sql table model SILVER_LAYER.clean_device_data .................... [RUN]
[0m15:17:33.130059 [debug] [Thread-4 (]: Began running node model.my_dbt_project.enriched_data
[0m15:17:33.130262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m15:17:33.130496 [info ] [Thread-3 (]: 3 of 4 START sql table model SILVER_LAYER.crm_device_data ...................... [RUN]
[0m15:17:33.130703 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_device_data)
[0m15:17:33.130904 [info ] [Thread-4 (]: 4 of 4 START sql table model SILVER_LAYER.enriched_data ........................ [RUN]
[0m15:17:33.131156 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:17:33.131350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.crm_device_data)
[0m15:17:33.131515 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:17:33.131727 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.enriched_data'
[0m15:17:33.138037 [info ] [Thread-1 (]: import_crm: test_clean_crm_data
[0m15:17:33.138452 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:17:33.141239 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:17:33.141587 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:17:33.141804 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:17:33.143646 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:17:33.143897 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:17:33.146224 [info ] [Thread-4 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:17:33.146698 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:17:33.146896 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:17:33.147052 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:17:33.147250 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:17:33.164868 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:17:33.166511 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:17:33.166712 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:17:33.167928 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:17:33.169294 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:17:33.170340 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:17:33.171294 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:17:33.172274 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:17:33.172925 [debug] [Thread-3 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM test_clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM test_device_crm_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN as test_crm_device_data
        );
[0m15:17:33.174093 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:17:33.174505 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final as test_clean_crm_data
        );
[0m15:17:33.174895 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os

select * from as device_with_os as test_device_crm_data
        );
[0m15:17:33.175397 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:17:33.175717 [debug] [Thread-4 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN test_clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN test_clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN as test_enriched_data
        );
[0m15:17:33.175970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:33.176152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:17:33.176395 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:17:33.654270 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b4e42b-3201-1b5c-0008-eb7e0004741a
[0m15:17:33.654592 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b4e42b-3201-1b5f-0008-eb7e0004645a
[0m15:17:33.654807 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 0 unexpected 'select'.
[0m15:17:33.655001 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 47 unexpected 'as'.
[0m15:17:33.655277 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:17:33.655510 [debug] [Thread-3 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:17:33.768942 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e42b-3201-1b5c-0008-eb7e0004741e
[0m15:17:33.769181 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 35 at position 26 unexpected 'as'.
[0m15:17:33.769416 [debug] [Thread-4 (]: On model.my_dbt_project.enriched_data: Close
[0m15:17:33.815355 [debug] [Thread-2 (]: Database Error in model clean_device_data (models/silver/clean_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'select'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_device_data.sql
[0m15:17:33.816119 [debug] [Thread-3 (]: Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:17:33.816879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221524d0>]}
[0m15:17:33.817120 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f13b10>]}
[0m15:17:33.817444 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model SILVER_LAYER.clean_device_data ........... [[31mERROR[0m in 0.69s]
[0m15:17:33.817761 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model SILVER_LAYER.crm_device_data ............. [[31mERROR[0m in 0.69s]
[0m15:17:33.818099 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:17:33.818351 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:17:33.946056 [debug] [Thread-4 (]: Database Error in model enriched_data (models/silver/enriched_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 26 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/enriched_data.sql
[0m15:17:33.946391 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fd5d0>]}
[0m15:17:33.946690 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model SILVER_LAYER.enriched_data ............... [[31mERROR[0m in 0.81s]
[0m15:17:33.946963 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:17:34.544732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:17:34.555491 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:17:34.687084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb2b26e-a464-40fd-953e-d817d12028a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122130c10>]}
[0m15:17:34.687495 [info ] [Thread-1 (]: 1 of 4 OK created sql table model SILVER_LAYER.clean_crm_data .................. [[32mSUCCESS 1[0m in 1.56s]
[0m15:17:34.687851 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:17:34.688599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:34.688774 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:17:34.688903 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:17:34.689018 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:17:34.689128 [debug] [MainThread]: Connection 'model.my_dbt_project.enriched_data' was properly closed.
[0m15:17:34.689293 [info ] [MainThread]: 
[0m15:17:34.689445 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m15:17:34.689890 [debug] [MainThread]: Command end result
[0m15:17:34.707626 [info ] [MainThread]: 
[0m15:17:34.707907 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:17:34.708057 [info ] [MainThread]: 
[0m15:17:34.708239 [error] [MainThread]:   Database Error in model clean_device_data (models/silver/clean_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'select'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_device_data.sql
[0m15:17:34.708381 [info ] [MainThread]: 
[0m15:17:34.708538 [error] [MainThread]:   Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:17:34.708666 [info ] [MainThread]: 
[0m15:17:34.708818 [error] [MainThread]:   Database Error in model enriched_data (models/silver/enriched_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 26 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/enriched_data.sql
[0m15:17:34.708946 [info ] [MainThread]: 
[0m15:17:34.709083 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m15:17:34.710947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.040744, "process_user_time": 2.164665, "process_kernel_time": 1.263674, "process_mem_max_rss": "195919872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:17:34.711193 [debug] [MainThread]: Command `dbt run` failed at 15:17:34.711156 after 4.04 seconds
[0m15:17:34.711385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108246710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051dc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108620ed0>]}
[0m15:17:34.711545 [debug] [MainThread]: Flushing usage events
[0m15:18:18.712013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ca550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108328350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832b910>]}


============================== 15:18:18.714961 | 2f34a422-f350-4a3c-86c9-b89a8b8ca7ae ==============================
[0m15:18:18.714961 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:18:18.715339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/silver/clean_device_data.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:19.445296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f34a422-f350-4a3c-86c9-b89a8b8ca7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b0cfdd0>]}
[0m15:18:19.468930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f34a422-f350-4a3c-86c9-b89a8b8ca7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7b210>]}
[0m15:18:19.470127 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:18:19.482091 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:18:19.572468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:19.572885 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_device_data.sql
[0m15:18:19.643598 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:18:19.737051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f34a422-f350-4a3c-86c9-b89a8b8ca7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b48ff10>]}
[0m15:18:19.785692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f34a422-f350-4a3c-86c9-b89a8b8ca7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cad90>]}
[0m15:18:19.785995 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:18:19.786176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f34a422-f350-4a3c-86c9-b89a8b8ca7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b305d10>]}
[0m15:18:19.787189 [info ] [MainThread]: 
[0m15:18:19.787469 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:19.787877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:18:19.794188 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:18:19.794411 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:18:19.794552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:20.379825 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:18:20.380738 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:18:20.513929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:18:20.514248 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:18:20.514529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:18:20.518504 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:18:20.519524 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:18:20.520458 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:18:20.520629 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:18:20.520804 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:18:20.520960 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:18:20.521134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:20.521269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:20.521402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:21.046869 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:18:21.048366 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:18:21.049688 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:18:21.050493 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:18:21.058077 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:18:21.058831 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:18:21.209632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f34a422-f350-4a3c-86c9-b89a8b8ca7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b329d50>]}
[0m15:18:21.210003 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:21.210216 [info ] [MainThread]: 
[0m15:18:21.212117 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:18:21.212370 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.clean_device_data .................... [RUN]
[0m15:18:21.212586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_device_data)
[0m15:18:21.212748 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:18:21.218047 [info ] [Thread-1 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:18:21.218422 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:18:21.218835 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:18:21.234189 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:18:21.235326 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:18:21.235575 [debug] [Thread-1 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os

select * from as device_with_os as test_device_crm_data
        );
[0m15:18:21.235832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:21.667141 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e42c-3201-1b5c-0008-eb7e00047432
[0m15:18:21.667407 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 0 unexpected 'select'.
[0m15:18:21.667656 [debug] [Thread-1 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:18:21.820875 [debug] [Thread-1 (]: Database Error in model clean_device_data (models/silver/clean_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'select'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_device_data.sql
[0m15:18:21.821690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f34a422-f350-4a3c-86c9-b89a8b8ca7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a88d710>]}
[0m15:18:21.822018 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_LAYER.clean_device_data ........... [[31mERROR[0m in 0.61s]
[0m15:18:21.822304 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:18:21.823013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:21.823160 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:18:21.823277 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:18:21.823387 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m15:18:21.823514 [info ] [MainThread]: 
[0m15:18:21.823656 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m15:18:21.823934 [debug] [MainThread]: Command end result
[0m15:18:21.841328 [info ] [MainThread]: 
[0m15:18:21.841602 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:18:21.841749 [info ] [MainThread]: 
[0m15:18:21.841960 [error] [MainThread]:   Database Error in model clean_device_data (models/silver/clean_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected 'select'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_device_data.sql
[0m15:18:21.842122 [info ] [MainThread]: 
[0m15:18:21.842271 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:18:21.844062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1638665, "process_user_time": 2.131892, "process_kernel_time": 1.147874, "process_mem_max_rss": "197115904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:21.844317 [debug] [MainThread]: Command `dbt run` failed at 15:18:21.844277 after 3.16 seconds
[0m15:18:21.844508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efc750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082fa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d3f90>]}
[0m15:18:21.844677 [debug] [MainThread]: Flushing usage events
[0m15:18:42.422096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a8b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b00850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b01350>]}


============================== 15:18:42.424990 | 1005e3d4-9981-45ce-9b73-f58ff62f176d ==============================
[0m15:18:42.424990 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:18:42.425329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/silver/clean_device_data.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:43.303568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1005e3d4-9981-45ce-9b73-f58ff62f176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147291550>]}
[0m15:18:43.326552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1005e3d4-9981-45ce-9b73-f58ff62f176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11153b1d0>]}
[0m15:18:43.327096 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:18:43.339218 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:18:43.431534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:43.431978 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_device_data.sql
[0m15:18:43.505803 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:18:43.597881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1005e3d4-9981-45ce-9b73-f58ff62f176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14764bf50>]}
[0m15:18:43.651253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1005e3d4-9981-45ce-9b73-f58ff62f176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160010f50>]}
[0m15:18:43.651568 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:18:43.651753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1005e3d4-9981-45ce-9b73-f58ff62f176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1474d3810>]}
[0m15:18:43.652789 [info ] [MainThread]: 
[0m15:18:43.653083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:43.653552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:18:43.660170 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:18:43.660359 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:18:43.660507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:44.343425 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:18:44.344352 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:18:44.501153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SILVER_LAYER)
[0m15:18:44.501466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:18:44.501737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:18:44.505804 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:18:44.506825 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:18:44.507768 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:18:44.507941 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:18:44.508107 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:18:44.508265 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:18:44.508408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:44.508546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:44.508676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:45.101314 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:18:45.102378 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:18:45.120686 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:18:45.121497 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:18:45.211592 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:18:45.212818 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:18:45.368262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1005e3d4-9981-45ce-9b73-f58ff62f176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecefd0>]}
[0m15:18:45.368586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:45.368750 [info ] [MainThread]: 
[0m15:18:45.370650 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:18:45.370902 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.clean_device_data .................... [RUN]
[0m15:18:45.371107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_device_data)
[0m15:18:45.371270 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:18:45.376246 [info ] [Thread-1 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:18:45.376528 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:18:45.376911 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:18:45.392672 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:18:45.393834 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:18:45.394076 [debug] [Thread-1 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os as test_device_crm_data
        );
[0m15:18:45.394284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:46.528985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:18:46.539516 [debug] [Thread-1 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:18:46.698518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1005e3d4-9981-45ce-9b73-f58ff62f176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16032b350>]}
[0m15:18:46.698970 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_LAYER.clean_device_data ............... [[32mSUCCESS 1[0m in 1.33s]
[0m15:18:46.699311 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:18:46.700090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:46.700267 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:18:46.700400 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:18:46.700516 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:18:46.700648 [info ] [MainThread]: 
[0m15:18:46.700806 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m15:18:46.701090 [debug] [MainThread]: Command end result
[0m15:18:46.717603 [info ] [MainThread]: 
[0m15:18:46.717919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:46.718111 [info ] [MainThread]: 
[0m15:18:46.718319 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:46.720472 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.329486, "process_user_time": 2.151825, "process_kernel_time": 1.277595, "process_mem_max_rss": "195821568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:46.720947 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:46.720877 after 4.33 seconds
[0m15:18:46.721207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b00d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111adf8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111266510>]}
[0m15:18:46.721465 [debug] [MainThread]: Flushing usage events
[0m15:19:07.758369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086aa690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108703910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108718fd0>]}


============================== 15:19:07.760751 | 2eb39447-47f5-418f-b88d-13f00ec5ab2a ==============================
[0m15:19:07.760751 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:19:07.761088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/silver/crm_device_data.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:19:08.480991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb39447-47f5-418f-b88d-13f00ec5ab2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f617d0>]}
[0m15:19:08.503694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb39447-47f5-418f-b88d-13f00ec5ab2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108153250>]}
[0m15:19:08.504853 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:19:08.523330 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:19:08.612383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:08.612653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:08.632754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb39447-47f5-418f-b88d-13f00ec5ab2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136211d90>]}
[0m15:19:08.684714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb39447-47f5-418f-b88d-13f00ec5ab2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136384450>]}
[0m15:19:08.685025 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:19:08.685206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb39447-47f5-418f-b88d-13f00ec5ab2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136219950>]}
[0m15:19:08.686225 [info ] [MainThread]: 
[0m15:19:08.686519 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:08.686950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:19:08.737346 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:19:08.737643 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:19:08.737795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:09.330463 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:19:09.331393 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:19:09.455813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:19:09.456159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:19:09.460114 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:19:09.460401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:19:09.461431 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:19:09.461612 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:19:09.462559 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:19:09.462725 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:19:09.462872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:09.463025 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:19:09.463160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:09.463339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:09.889794 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:19:09.891342 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:19:09.970857 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:19:09.971810 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:19:09.972652 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:19:09.973425 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:19:10.104223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb39447-47f5-418f-b88d-13f00ec5ab2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136313e90>]}
[0m15:19:10.104675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:19:10.104938 [info ] [MainThread]: 
[0m15:19:10.106910 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:19:10.107219 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.crm_device_data ...................... [RUN]
[0m15:19:10.107466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.crm_device_data)
[0m15:19:10.107639 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:19:10.113089 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:19:10.113556 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:19:10.128961 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:19:10.130049 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:19:10.130275 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM test_clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM test_device_crm_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN as test_crm_device_data
        );
[0m15:19:10.130465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:10.556108 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e42d-3201-1b5f-0008-eb7e00046482
[0m15:19:10.556367 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 47 unexpected 'as'.
[0m15:19:10.556641 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:19:10.695846 [debug] [Thread-1 (]: Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:19:10.696669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb39447-47f5-418f-b88d-13f00ec5ab2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136454790>]}
[0m15:19:10.697009 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_LAYER.crm_device_data ............. [[31mERROR[0m in 0.59s]
[0m15:19:10.697332 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:19:10.698061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:10.698232 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:19:10.698372 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:19:10.698487 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m15:19:10.698630 [info ] [MainThread]: 
[0m15:19:10.698810 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m15:19:10.699103 [debug] [MainThread]: Command end result
[0m15:19:10.715261 [info ] [MainThread]: 
[0m15:19:10.715550 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:19:10.715740 [info ] [MainThread]: 
[0m15:19:10.715935 [error] [MainThread]:   Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:19:10.716079 [info ] [MainThread]: 
[0m15:19:10.716221 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:19:10.718120 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.987362, "process_user_time": 1.93562, "process_kernel_time": 1.314471, "process_mem_max_rss": "195657728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:19:10.718452 [debug] [MainThread]: Command `dbt run` failed at 15:19:10.718407 after 2.99 seconds
[0m15:19:10.718660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13607cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a8cd0>]}
[0m15:19:10.718845 [debug] [MainThread]: Flushing usage events
[0m15:19:51.077947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ee490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106547910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653a390>]}


============================== 15:19:51.080893 | 9de7b75f-75de-447e-99d8-6a24be2629ee ==============================
[0m15:19:51.080893 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:19:51.081241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/silver/crm_device_data.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:51.800536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9de7b75f-75de-447e-99d8-6a24be2629ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff013d0>]}
[0m15:19:51.823218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9de7b75f-75de-447e-99d8-6a24be2629ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f9b1d0>]}
[0m15:19:51.824398 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:19:51.836620 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:19:51.928784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:51.929052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:51.949376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9de7b75f-75de-447e-99d8-6a24be2629ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1281296d0>]}
[0m15:19:51.999839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9de7b75f-75de-447e-99d8-6a24be2629ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282c4210>]}
[0m15:19:52.000141 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:19:52.000326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9de7b75f-75de-447e-99d8-6a24be2629ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128112750>]}
[0m15:19:52.001377 [info ] [MainThread]: 
[0m15:19:52.001688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:52.002118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:19:52.052614 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:19:52.052911 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:19:52.053066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:52.590043 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:19:52.590983 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:19:52.725873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:19:52.726253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:19:52.726886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:19:52.730447 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:19:52.731526 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:19:52.732485 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:19:52.732655 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:19:52.732822 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:19:52.732987 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:19:52.733160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:52.733300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:52.733424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:53.233446 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:19:53.234675 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:19:53.241541 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:19:53.242819 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:19:53.312653 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:19:53.313492 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:19:53.437471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9de7b75f-75de-447e-99d8-6a24be2629ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ee490>]}
[0m15:19:53.437819 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:19:53.437987 [info ] [MainThread]: 
[0m15:19:53.439919 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:19:53.440186 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.crm_device_data ...................... [RUN]
[0m15:19:53.440405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.crm_device_data)
[0m15:19:53.440567 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:19:53.445962 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:19:53.446399 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:19:53.461445 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:19:53.462240 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:19:53.462443 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM test_clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM test_device_crm_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN as test_crm_device_data
        );
[0m15:19:53.462623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:53.850885 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e42d-3201-1b5f-0008-eb7e0004648e
[0m15:19:53.851141 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 47 unexpected 'as'.
[0m15:19:53.851386 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:19:53.987944 [debug] [Thread-1 (]: Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:19:53.988750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de7b75f-75de-447e-99d8-6a24be2629ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12902f410>]}
[0m15:19:53.989077 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_LAYER.crm_device_data ............. [[31mERROR[0m in 0.55s]
[0m15:19:53.989368 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:19:53.990091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:53.990238 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:19:53.990363 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m15:19:53.990475 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:19:53.990607 [info ] [MainThread]: 
[0m15:19:53.990795 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m15:19:53.991118 [debug] [MainThread]: Command end result
[0m15:19:54.007859 [info ] [MainThread]: 
[0m15:19:54.008136 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:19:54.008311 [info ] [MainThread]: 
[0m15:19:54.008550 [error] [MainThread]:   Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:19:54.008715 [info ] [MainThread]: 
[0m15:19:54.008866 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:19:54.010716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9619532, "process_user_time": 2.028965, "process_kernel_time": 1.201681, "process_mem_max_rss": "194920448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:19:54.010994 [debug] [MainThread]: Command `dbt run` failed at 15:19:54.010951 after 2.96 seconds
[0m15:19:54.011197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103118750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065478d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ecb10>]}
[0m15:19:54.011370 [debug] [MainThread]: Flushing usage events
[0m15:21:25.626825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10528b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052de790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ebc50>]}


============================== 15:21:25.629131 | 5be85cbf-7373-44e0-8cbd-4a54b60e5bb6 ==============================
[0m15:21:25.629131 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:21:25.629496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": false} --models models/silver/crm_device_data.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:21:26.278160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5be85cbf-7373-44e0-8cbd-4a54b60e5bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142404e50>]}
[0m15:21:26.302174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5be85cbf-7373-44e0-8cbd-4a54b60e5bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3b2d0>]}
[0m15:21:26.302832 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:21:26.317771 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:21:26.386241 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:21:26.386675 [debug] [MainThread]: previous checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, current checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4
[0m15:21:26.386896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5be85cbf-7373-44e0-8cbd-4a54b60e5bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408a7d0>]}
[0m15:21:26.824783 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:21:26.834226 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:21:26.840136 [info ] [MainThread]: import_crm: clean_crm_data
[0m15:21:27.046142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5be85cbf-7373-44e0-8cbd-4a54b60e5bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1428efcd0>]}
[0m15:21:27.094156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5be85cbf-7373-44e0-8cbd-4a54b60e5bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142a6be50>]}
[0m15:21:27.094447 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:21:27.094619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5be85cbf-7373-44e0-8cbd-4a54b60e5bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142724950>]}
[0m15:21:27.095585 [info ] [MainThread]: 
[0m15:21:27.095880 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:27.096323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:21:27.102866 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:21:27.103089 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:21:27.103235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:27.720240 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:21:27.721166 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:21:27.850851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:21:27.851179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:21:27.851803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:21:27.855256 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:21:27.856779 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:21:27.857749 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:21:27.857933 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:21:27.858094 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:21:27.858263 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:21:27.858404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:27.858533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:27.858663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:28.257324 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:21:28.258354 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:21:28.285951 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:21:28.287178 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:21:28.364707 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:21:28.365623 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:21:28.539545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5be85cbf-7373-44e0-8cbd-4a54b60e5bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142920550>]}
[0m15:21:28.539919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:21:28.540088 [info ] [MainThread]: 
[0m15:21:28.541427 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:21:28.541709 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.crm_device_data ...................... [RUN]
[0m15:21:28.541946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.crm_device_data)
[0m15:21:28.542115 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:21:28.546417 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:21:28.546799 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:21:28.560469 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:21:28.561243 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:21:28.561445 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN as crm_device_data
        );
[0m15:21:28.561629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:28.994129 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e42f-3201-1b5c-0008-eb7e00047452
[0m15:21:28.994420 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 47 unexpected 'as'.
[0m15:21:28.994679 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:21:29.134605 [debug] [Thread-1 (]: Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:21:29.135450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be85cbf-7373-44e0-8cbd-4a54b60e5bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142c43e50>]}
[0m15:21:29.135780 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_LAYER.crm_device_data ............. [[31mERROR[0m in 0.59s]
[0m15:21:29.136068 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:21:29.136827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:29.137001 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:21:29.137134 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:21:29.137256 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m15:21:29.137398 [info ] [MainThread]: 
[0m15:21:29.137553 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m15:21:29.137842 [debug] [MainThread]: Command end result
[0m15:21:29.155172 [info ] [MainThread]: 
[0m15:21:29.155455 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:21:29.155608 [info ] [MainThread]: 
[0m15:21:29.155795 [error] [MainThread]:   Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 47 unexpected 'as'.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:21:29.155941 [info ] [MainThread]: 
[0m15:21:29.156084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:29.157866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5592208, "process_user_time": 2.443182, "process_kernel_time": 1.371456, "process_mem_max_rss": "202407936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:21:29.158115 [debug] [MainThread]: Command `dbt run` failed at 15:21:29.158077 after 3.56 seconds
[0m15:21:29.158309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015d8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1425cdd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105290a10>]}
[0m15:21:29.158474 [debug] [MainThread]: Flushing usage events
[0m15:21:39.282246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104365050>]}


============================== 15:21:39.285073 | f6531c42-d467-4481-b086-93593d22f8ad ==============================
[0m15:21:39.285073 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:21:39.285394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --vars {"unit_testing": false} --models models/silver/crm_device_data.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:40.032065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6531c42-d467-4481-b086-93593d22f8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c957a90>]}
[0m15:21:40.054550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6531c42-d467-4481-b086-93593d22f8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da7190>]}
[0m15:21:40.055238 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:21:40.066699 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:21:40.154955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:40.155378 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/crm_device_data.sql
[0m15:21:40.312900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6531c42-d467-4481-b086-93593d22f8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d473ad0>]}
[0m15:21:40.363162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6531c42-d467-4481-b086-93593d22f8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d1fa590>]}
[0m15:21:40.363461 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:21:40.363641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6531c42-d467-4481-b086-93593d22f8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d4f07d0>]}
[0m15:21:40.364662 [info ] [MainThread]: 
[0m15:21:40.364950 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:40.365367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:21:40.371590 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:21:40.371774 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:21:40.371915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:40.877693 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:21:40.878634 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:21:41.011258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SILVER_LAYER)
[0m15:21:41.012055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:21:41.015612 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:21:41.015890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:21:41.016901 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:21:41.017084 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:21:41.018052 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:21:41.018214 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:21:41.018366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:41.018504 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:21:41.018642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:41.019185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:41.444270 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:21:41.445675 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:21:41.470208 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:21:41.471034 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:21:41.516888 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:21:41.517728 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:21:41.653179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6531c42-d467-4481-b086-93593d22f8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d76ed0>]}
[0m15:21:41.653529 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:21:41.653696 [info ] [MainThread]: 
[0m15:21:41.655647 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:21:41.655914 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.crm_device_data ...................... [RUN]
[0m15:21:41.656147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.crm_device_data)
[0m15:21:41.656312 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:21:41.660733 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:21:41.661134 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:21:41.674828 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:21:41.675593 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:21:41.675793 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:21:41.675975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:42.543693 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b4e42f-3201-1b5c-0008-eb7e0004745a
[0m15:21:42.543965 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CLEAN_CRM_DATA' does not exist or not authorized.
[0m15:21:42.544212 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:21:42.677918 [debug] [Thread-1 (]: Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'CLEAN_CRM_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:21:42.678731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6531c42-d467-4481-b086-93593d22f8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d4f9990>]}
[0m15:21:42.679064 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model SILVER_LAYER.crm_device_data ............. [[31mERROR[0m in 1.02s]
[0m15:21:42.679353 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:21:42.680024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:42.680167 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:21:42.680283 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:21:42.680399 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:21:42.680528 [info ] [MainThread]: 
[0m15:21:42.680671 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m15:21:42.680944 [debug] [MainThread]: Command end result
[0m15:21:42.697412 [info ] [MainThread]: 
[0m15:21:42.697790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:21:42.697992 [info ] [MainThread]: 
[0m15:21:42.698368 [error] [MainThread]:   Database Error in model crm_device_data (models/silver/crm_device_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'CLEAN_CRM_DATA' does not exist or not authorized.
  compiled Code at target/run/my_dbt_project/models/silver/crm_device_data.sql
[0m15:21:42.698619 [info ] [MainThread]: 
[0m15:21:42.698790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:42.701052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4479818, "process_user_time": 2.109992, "process_kernel_time": 1.288495, "process_mem_max_rss": "197181440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:21:42.701358 [debug] [MainThread]: Command `dbt run` failed at 15:21:42.701315 after 3.45 seconds
[0m15:21:42.701561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f20750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f7f50>]}
[0m15:21:42.701737 [debug] [MainThread]: Flushing usage events
[0m15:24:24.857497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c669d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c66e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc4790>]}


============================== 15:24:24.860428 | bad1c9f8-7f55-4a77-a442-19390a1a194e ==============================
[0m15:24:24.860428 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:24:24.860753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": false} --models models/silver/crm_device_data.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:24:25.668014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bad1c9f8-7f55-4a77-a442-19390a1a194e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13be4bdd0>]}
[0m15:24:25.690985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bad1c9f8-7f55-4a77-a442-19390a1a194e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067171d0>]}
[0m15:24:25.691667 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:24:25.704026 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:24:25.793560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:24:25.793979 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_device_data.sql
[0m15:24:25.794179 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m15:24:25.794354 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/crm_device_data.sql
[0m15:24:25.866107 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:24:25.874958 [info ] [MainThread]: import_crm: 
[0m15:24:25.964725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bad1c9f8-7f55-4a77-a442-19390a1a194e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c331ad0>]}
[0m15:24:26.016566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bad1c9f8-7f55-4a77-a442-19390a1a194e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c2d7b90>]}
[0m15:24:26.016864 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:24:26.017035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad1c9f8-7f55-4a77-a442-19390a1a194e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c01a490>]}
[0m15:24:26.017999 [info ] [MainThread]: 
[0m15:24:26.018254 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:24:26.018644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:24:26.024840 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:24:26.025049 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:24:26.025195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:26.691011 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:24:26.691943 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:24:26.837162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:24:26.837489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:24:26.837749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:24:26.841832 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:24:26.842846 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:24:26.844339 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:24:26.844535 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:24:26.844700 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:24:26.844865 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:24:26.845031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:26.845167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:26.845301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:27.328674 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:24:27.329765 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:24:27.333517 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:24:27.334337 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:24:27.413434 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:24:27.414680 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:24:27.559135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad1c9f8-7f55-4a77-a442-19390a1a194e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d3d50>]}
[0m15:24:27.559484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:24:27.559693 [info ] [MainThread]: 
[0m15:24:27.561654 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:24:27.561923 [info ] [Thread-1 (]: 1 of 1 START sql table model SILVER_LAYER.crm_device_data ...................... [RUN]
[0m15:24:27.562171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.crm_device_data)
[0m15:24:27.562349 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:24:27.566392 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:24:27.566809 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:24:27.580702 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:24:27.581480 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:24:27.581698 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:24:27.581907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:28.810719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:24:28.821658 [debug] [Thread-1 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:24:28.953218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad1c9f8-7f55-4a77-a442-19390a1a194e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bfa4d50>]}
[0m15:24:28.953638 [info ] [Thread-1 (]: 1 of 1 OK created sql table model SILVER_LAYER.crm_device_data ................. [[32mSUCCESS 1[0m in 1.39s]
[0m15:24:28.953949 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:24:28.954638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:28.954786 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:24:28.954910 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SILVER_LAYER' was properly closed.
[0m15:24:28.955023 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:24:28.955160 [info ] [MainThread]: 
[0m15:24:28.955310 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m15:24:28.955593 [debug] [MainThread]: Command end result
[0m15:24:28.973203 [info ] [MainThread]: 
[0m15:24:28.973487 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:28.973640 [info ] [MainThread]: 
[0m15:24:28.973859 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:24:28.975764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.149453, "process_user_time": 2.397847, "process_kernel_time": 1.037477, "process_mem_max_rss": "196296704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:24:28.976019 [debug] [MainThread]: Command `dbt run` succeeded at 15:24:28.975980 after 4.15 seconds
[0m15:24:28.976205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbaf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cac210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106799dd0>]}
[0m15:24:28.976368 [debug] [MainThread]: Flushing usage events
[0m15:26:01.081507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111393dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113de790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ebc10>]}


============================== 15:26:01.084391 | 0b5eeeab-93a8-4f2c-827e-4c5cb871cb95 ==============================
[0m15:26:01.084391 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:26:01.084714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/silver', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:01.907541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310fbe90>]}
[0m15:26:01.932144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c3b250>]}
[0m15:26:01.932811 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:26:01.946915 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:26:02.017967 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:26:02.018337 [debug] [MainThread]: previous checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, current checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d
[0m15:26:02.018557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11018e810>]}
[0m15:26:02.482154 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:26:02.491658 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:26:02.498554 [info ] [MainThread]: import_crm: 
[0m15:26:02.720640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13155b610>]}
[0m15:26:02.772039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14636c710>]}
[0m15:26:02.772352 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:26:02.772541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131267990>]}
[0m15:26:02.773613 [info ] [MainThread]: 
[0m15:26:02.773899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:02.776031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:26:02.782888 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:26:02.783136 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:26:02.783306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:03.554809 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:26:03.555717 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:26:03.871101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:26:03.871434 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:26:03.872278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:26:03.875604 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:26:03.876629 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:26:03.878065 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:26:03.878245 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:26:03.878416 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:26:03.878587 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:26:03.878734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:03.878878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:03.879010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:04.491645 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:26:04.493242 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:26:04.582142 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:26:04.583028 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:26:04.643121 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:26:04.643944 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:26:04.800975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313c1790>]}
[0m15:26:04.801345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:26:04.801518 [info ] [MainThread]: 
[0m15:26:04.803487 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:26:04.803692 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:26:04.803958 [info ] [Thread-1 (]: 1 of 4 START sql table model SILVER_LAYER.clean_crm_data ....................... [RUN]
[0m15:26:04.804188 [info ] [Thread-2 (]: 2 of 4 START sql table model SILVER_LAYER.clean_device_data .................... [RUN]
[0m15:26:04.804426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_crm_data)
[0m15:26:04.804852 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:26:04.809127 [info ] [Thread-1 (]: import_crm: 
[0m15:26:04.809433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_device_data)
[0m15:26:04.809679 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:26:04.809880 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:26:04.812790 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:26:04.812386 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:26:04.827007 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:26:04.827290 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:26:04.827917 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:26:04.828833 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:26:04.830268 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:26:04.830574 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:26:04.830944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:04.832293 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:26:04.832772 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:26:04.833064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:06.079400 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:06.090065 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:26:06.225464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:06.226406 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:26:06.242335 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14657e250>]}
[0m15:26:06.242677 [info ] [Thread-2 (]: 2 of 4 OK created sql table model SILVER_LAYER.clean_device_data ............... [[32mSUCCESS 1[0m in 1.44s]
[0m15:26:06.242961 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:26:06.362534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146463ad0>]}
[0m15:26:06.362937 [info ] [Thread-1 (]: 1 of 4 OK created sql table model SILVER_LAYER.clean_crm_data .................. [[32mSUCCESS 1[0m in 1.56s]
[0m15:26:06.363246 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:26:06.363683 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:26:06.363862 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:26:06.364100 [info ] [Thread-4 (]: 3 of 4 START sql table model SILVER_LAYER.crm_device_data ...................... [RUN]
[0m15:26:06.364329 [info ] [Thread-3 (]: 4 of 4 START sql table model SILVER_LAYER.enriched_data ........................ [RUN]
[0m15:26:06.364578 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m15:26:06.364762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.enriched_data)
[0m15:26:06.364937 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:26:06.365108 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:26:06.366810 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:26:06.368744 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:26:06.369074 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:26:06.369379 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:26:06.371447 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:26:06.371613 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:26:06.372824 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:26:06.373569 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:26:06.373787 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m15:26:06.374340 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:26:06.374492 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:26:06.374693 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:26:06.374936 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:26:07.653054 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:07.654068 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:26:07.751322 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:07.752193 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m15:26:07.804248 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14658d3d0>]}
[0m15:26:07.804601 [info ] [Thread-4 (]: 3 of 4 OK created sql table model SILVER_LAYER.crm_device_data ................. [[32mSUCCESS 1[0m in 1.44s]
[0m15:26:07.804883 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:26:07.885328 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5eeeab-93a8-4f2c-827e-4c5cb871cb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14614d210>]}
[0m15:26:07.885743 [info ] [Thread-3 (]: 4 of 4 OK created sql table model SILVER_LAYER.enriched_data ................... [[32mSUCCESS 1[0m in 1.52s]
[0m15:26:07.886038 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:26:07.886729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:07.886902 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:26:07.887030 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:26:07.887144 [debug] [MainThread]: Connection 'model.my_dbt_project.enriched_data' was properly closed.
[0m15:26:07.887253 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:26:07.887430 [info ] [MainThread]: 
[0m15:26:07.887593 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m15:26:07.888060 [debug] [MainThread]: Command end result
[0m15:26:07.951169 [info ] [MainThread]: 
[0m15:26:07.951464 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:07.951687 [info ] [MainThread]: 
[0m15:26:07.951849 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:26:07.953864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9011707, "process_user_time": 2.824231, "process_kernel_time": 1.283348, "process_mem_max_rss": "201719808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:26:07.954121 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:07.954078 after 6.90 seconds
[0m15:26:07.954305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055786d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105578590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e26d0>]}
[0m15:26:07.954471 [debug] [MainThread]: Flushing usage events
[0m15:31:38.705722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10964e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c5250>]}


============================== 15:31:38.708841 | cdd7d331-ddbe-4058-b06d-32e030c9adf7 ==============================
[0m15:31:38.708841 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:31:38.709274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:39.509526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431e32d0>]}
[0m15:31:39.535942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108743190>]}
[0m15:31:39.536671 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:31:39.552304 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:31:39.649021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 28 files changed.
[0m15:31:39.649470 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_week_wise.sql
[0m15:31:39.649678 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_mobile_type_overall.sql
[0m15:31:39.649866 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_age_week_wise.sql
[0m15:31:39.650044 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_vendor_week_wise.sql
[0m15:31:39.650220 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_devices_week_wise.sql
[0m15:31:39.650391 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_customers_week_wise.sql
[0m15:31:39.650562 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_brand_week_wise.sql
[0m15:31:39.650733 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_overall.sql
[0m15:31:39.650896 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/os_by_age_segment.sql
[0m15:31:39.651061 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_value_segment_week_wise.sql
[0m15:31:39.651225 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_brand_overall.sql
[0m15:31:39.651386 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_age_overall.sql
[0m15:31:39.651553 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_value_segment_overall.sql
[0m15:31:39.651718 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_brand_overall.sql
[0m15:31:39.651878 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_gender_overall.sql
[0m15:31:39.652037 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_mobile_type_week_wise.sql
[0m15:31:39.652196 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_gender_week_wise.sql
[0m15:31:39.652355 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_devices_overall.sql
[0m15:31:39.652515 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/weekly_revenue_by_brand.sql
[0m15:31:39.652680 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_os_vendor_overall.sql
[0m15:31:39.652843 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_os_week_wise.sql
[0m15:31:39.653001 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/total_customers_overall.sql
[0m15:31:39.653158 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_os_overall.sql
[0m15:31:39.653321 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_brand_week_wise.sql
[0m15:31:39.653483 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/weekly_revenue_by_os.sql
[0m15:31:39.653644 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/brand_by_age_segment.sql
[0m15:31:39.653807 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/customers_by_mobile_type_week_wise.sql
[0m15:31:39.653972 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/revenue_by_mobile_type_overall.sql
[0m15:31:39.855934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433dde90>]}
[0m15:31:39.910853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14365b290>]}
[0m15:31:39.911186 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:31:39.911379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752c9d0>]}
[0m15:31:39.912832 [info ] [MainThread]: 
[0m15:31:39.913142 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:31:39.916097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:31:39.916391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:31:39.923592 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:31:39.924924 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:31:39.925125 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:31:39.925326 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:31:39.925550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:39.925759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:40.548364 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:31:40.549360 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:31:40.561012 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:31:40.561736 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:31:40.695809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:31:40.696132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:31:40.696402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:31:40.700755 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:31:40.701669 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:31:40.702691 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:31:40.702877 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:31:40.703048 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:31:40.703242 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:31:40.703410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:40.703588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:40.703734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:41.173895 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:31:41.174922 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:31:41.176164 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:31:41.177029 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:31:41.202786 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:31:41.203959 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:31:41.362342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436f5d90>]}
[0m15:31:41.362705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:41.362884 [info ] [MainThread]: 
[0m15:31:41.364834 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:31:41.365050 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:31:41.365315 [info ] [Thread-1 (]: 1 of 32 START sql table model SILVER_LAYER.clean_crm_data ...................... [RUN]
[0m15:31:41.365600 [info ] [Thread-2 (]: 2 of 32 START sql table model SILVER_LAYER.clean_device_data ................... [RUN]
[0m15:31:41.365866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m15:31:41.366293 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:31:41.366548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_device_data)
[0m15:31:41.372746 [info ] [Thread-1 (]: import_crm: 
[0m15:31:41.373007 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:31:41.373207 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:31:41.375195 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:31:41.375537 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:31:41.376072 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:31:41.376316 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:31:41.392318 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:31:41.394068 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:31:41.395562 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:31:41.396580 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:31:41.396951 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:31:41.397280 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:31:41.397548 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:41.397819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:42.940130 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:31:42.951136 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:31:42.952225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:31:42.953342 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:31:43.083564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14544ba50>]}
[0m15:31:43.083869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1454073d0>]}
[0m15:31:43.084251 [info ] [Thread-1 (]: 1 of 32 OK created sql table model SILVER_LAYER.clean_crm_data ................. [[32mSUCCESS 1[0m in 1.72s]
[0m15:31:43.084563 [info ] [Thread-2 (]: 2 of 32 OK created sql table model SILVER_LAYER.clean_device_data .............. [[32mSUCCESS 1[0m in 1.72s]
[0m15:31:43.084843 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:31:43.085122 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:31:43.085637 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:31:43.085829 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:31:43.086054 [info ] [Thread-4 (]: 3 of 32 START sql table model SILVER_LAYER.crm_device_data ..................... [RUN]
[0m15:31:43.086286 [info ] [Thread-3 (]: 4 of 32 START sql table model SILVER_LAYER.enriched_data ....................... [RUN]
[0m15:31:43.086646 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m15:31:43.086836 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.enriched_data)
[0m15:31:43.087014 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:31:43.087179 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:31:43.088794 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:31:43.090713 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:31:43.091156 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:31:43.091438 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:31:43.092718 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:31:43.092939 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:31:43.094831 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:31:43.095642 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:31:43.096324 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:31:43.096543 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:31:43.096824 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m15:31:43.097024 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:31:43.097186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:44.535844 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:44.536228 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:44.537253 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m15:31:44.538025 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:31:44.683188 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d19a10>]}
[0m15:31:44.683487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1437fded0>]}
[0m15:31:44.683859 [info ] [Thread-3 (]: 4 of 32 OK created sql table model SILVER_LAYER.enriched_data .................. [[32mSUCCESS 1[0m in 1.60s]
[0m15:31:44.684160 [info ] [Thread-4 (]: 3 of 32 OK created sql table model SILVER_LAYER.crm_device_data ................ [[32mSUCCESS 1[0m in 1.60s]
[0m15:31:44.684504 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:31:44.684761 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:31:44.685353 [debug] [Thread-4 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:31:44.685541 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:31:44.685744 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:31:44.685916 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:31:44.686121 [info ] [Thread-4 (]: 5 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m15:31:44.686359 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m15:31:44.686567 [info ] [Thread-1 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m15:31:44.686831 [info ] [Thread-3 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m15:31:44.687129 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.brand_by_age_segment)
[0m15:31:44.687334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m15:31:44.687532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:31:44.687718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:31:44.687893 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:31:44.688073 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:31:44.688226 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:31:44.688386 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:31:44.690174 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:31:44.691566 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:31:44.693022 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:31:44.694722 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:31:44.695424 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:31:44.706897 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:31:44.707805 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:31:44.708057 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:31:44.708240 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:31:44.709692 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m15:31:44.711141 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:31:44.712861 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:31:44.713481 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m15:31:44.713906 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m15:31:44.714808 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m15:31:44.715165 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:31:44.715348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:44.715572 [debug] [Thread-4 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM 
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m15:31:44.715934 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:31:44.716184 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m15:31:44.716710 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:44.717077 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m15:31:44.717287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:44.717702 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:45.202800 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b4e439-3201-1b5f-0008-eb7e00046542
[0m15:31:45.203077 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 0 unexpected ')'.
[0m15:31:45.203324 [debug] [Thread-4 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m15:31:45.278852 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:45.279822 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m15:31:45.286489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:45.286784 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:45.287605 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m15:31:45.288391 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m15:31:45.382699 [debug] [Thread-4 (]: Database Error in model brand_by_age_segment (models/gold/brand_by_age_segment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 0 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/gold/brand_by_age_segment.sql
[0m15:31:45.383020 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f0b50>]}
[0m15:31:45.383325 [error] [Thread-4 (]: 5 of 32 ERROR creating sql view model GOLD_LAYER.brand_by_age_segment .......... [[31mERROR[0m in 0.70s]
[0m15:31:45.383607 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:31:45.383819 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:31:45.384116 [info ] [Thread-4 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m15:31:45.384332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:31:45.384502 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:31:45.386133 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:31:45.386517 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:31:45.387831 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:31:45.388320 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:31:45.388502 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m15:31:45.388669 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:45.454845 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145461d50>]}
[0m15:31:45.455303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145461010>]}
[0m15:31:45.455608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14543ab90>]}
[0m15:31:45.455954 [info ] [Thread-3 (]: 8 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.77s]
[0m15:31:45.456428 [info ] [Thread-2 (]: 6 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.77s]
[0m15:31:45.456742 [info ] [Thread-1 (]: 7 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.77s]
[0m15:31:45.457055 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:31:45.457305 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:31:45.457541 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:31:45.457765 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:31:45.458003 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:31:45.458235 [debug] [Thread-1 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:31:45.458490 [info ] [Thread-3 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ............... [RUN]
[0m15:31:45.458716 [info ] [Thread-2 (]: 11 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m15:31:45.459013 [info ] [Thread-1 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m15:31:45.459253 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_os_overall)
[0m15:31:45.459458 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:31:45.459641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.os_by_age_segment)
[0m15:31:45.459818 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:31:45.459972 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:31:45.460119 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:31:45.461745 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:31:45.463262 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:31:45.464744 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:31:45.465959 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:31:45.466129 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:31:45.467472 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m15:31:45.467637 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:31:45.468968 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:31:45.470372 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m15:31:45.471313 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m15:31:45.471534 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m15:31:45.471759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:45.472173 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m15:31:45.472529 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m15:31:45.473058 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m15:31:45.473530 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by os_name
  );
[0m15:31:45.473797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:45.473986 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:45.883999 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:31:45.885034 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m15:31:45.963127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:31:45.964077 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m15:31:46.016578 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:46.016875 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:46.017718 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m15:31:46.018479 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m15:31:46.067546 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14590c4d0>]}
[0m15:31:46.067964 [info ] [Thread-4 (]: 9 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.68s]
[0m15:31:46.068244 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:31:46.068446 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:31:46.068703 [info ] [Thread-4 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m15:31:46.068948 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:31:46.069123 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:31:46.070724 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:31:46.071693 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:31:46.072988 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:31:46.073767 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m15:31:46.073945 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by age
order by age
  );
[0m15:31:46.074113 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:46.118814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145580b50>]}
[0m15:31:46.119254 [info ] [Thread-1 (]: 12 of 32 OK created sql view model GOLD_LAYER.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.66s]
[0m15:31:46.119533 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:31:46.119731 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:31:46.119957 [info ] [Thread-1 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m15:31:46.120184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:31:46.120395 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:31:46.121858 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:31:46.122264 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:31:46.123835 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:31:46.124390 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:31:46.124621 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m15:31:46.124814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:46.148256 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145463f10>]}
[0m15:31:46.148715 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436d3e90>]}
[0m15:31:46.149057 [info ] [Thread-3 (]: 10 of 32 OK created sql view model GOLD_LAYER.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 0.69s]
[0m15:31:46.149406 [info ] [Thread-2 (]: 11 of 32 OK created sql view model GOLD_LAYER.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.69s]
[0m15:31:46.149835 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:31:46.150086 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:31:46.150302 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:31:46.150522 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:31:46.150755 [info ] [Thread-3 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m15:31:46.151007 [info ] [Thread-2 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m15:31:46.151299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:31:46.151505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:31:46.151675 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:31:46.151853 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:31:46.153231 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:31:46.154698 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:31:46.155389 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:31:46.155576 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:31:46.157088 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:31:46.158462 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:31:46.159076 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:31:46.159310 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m15:31:46.159698 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m15:31:46.159865 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:46.160070 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m15:31:46.160827 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:46.612331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:31:46.613329 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m15:31:46.792491 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:46.793598 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m15:31:46.886945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436d7f10>]}
[0m15:31:46.887382 [info ] [Thread-1 (]: 14 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.77s]
[0m15:31:46.887674 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:31:46.887900 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:31:46.888135 [info ] [Thread-1 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m15:31:46.888344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:31:46.888513 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:31:46.890085 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:31:46.890489 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:31:46.891812 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:31:46.892261 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m15:31:46.892442 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m15:31:46.892603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:46.971077 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431bc8d0>]}
[0m15:31:46.971595 [info ] [Thread-2 (]: 16 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.82s]
[0m15:31:46.971985 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:31:46.972238 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:31:46.972517 [info ] [Thread-2 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m15:31:46.972771 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:31:46.972953 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:31:46.974658 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:31:46.975101 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:31:46.976861 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:31:46.978133 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:31:46.978485 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m15:31:46.978834 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:47.056867 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:47.057856 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m15:31:47.120825 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:47.121820 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m15:31:47.200490 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145903c50>]}
[0m15:31:47.200895 [info ] [Thread-4 (]: 13 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 1.13s]
[0m15:31:47.201198 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:31:47.201438 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:31:47.201722 [info ] [Thread-4 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m15:31:47.201943 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:31:47.202108 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:31:47.203474 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:31:47.204525 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:31:47.205954 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:31:47.206578 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:31:47.206768 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m15:31:47.206932 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:47.278641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145461d50>]}
[0m15:31:47.279218 [info ] [Thread-3 (]: 15 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 1.13s]
[0m15:31:47.279667 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:31:47.280070 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:31:47.280359 [info ] [Thread-3 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m15:31:47.280659 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:31:47.280852 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:31:47.282455 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:31:47.283718 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:31:47.285987 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:31:47.287063 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:31:47.287361 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m15:31:47.287594 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:47.443218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:47.444281 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m15:31:47.469504 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:31:47.470547 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m15:31:47.576332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1432d9ed0>]}
[0m15:31:47.576700 [info ] [Thread-1 (]: 17 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.69s]
[0m15:31:47.576982 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:31:47.577184 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:31:47.577445 [info ] [Thread-1 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m15:31:47.577679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:31:47.577860 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:31:47.579468 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:31:47.579912 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:31:47.581316 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:31:47.581832 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m15:31:47.582003 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m15:31:47.582161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:47.609096 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143689750>]}
[0m15:31:47.609561 [info ] [Thread-2 (]: 18 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.64s]
[0m15:31:47.609888 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:31:47.610126 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:31:47.610578 [info ] [Thread-2 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m15:31:47.610937 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:31:47.611163 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:31:47.612885 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:31:47.613288 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:31:47.614628 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:31:47.615119 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:31:47.615318 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m15:31:47.615487 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:47.738854 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:47.739965 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m15:31:47.758034 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:31:47.759149 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m15:31:47.872924 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436b1510>]}
[0m15:31:47.873321 [info ] [Thread-4 (]: 19 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.67s]
[0m15:31:47.873628 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:31:47.873911 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:31:47.874155 [info ] [Thread-4 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m15:31:47.874410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:31:47.874610 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:31:47.876801 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:31:47.877441 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:31:47.878946 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:31:47.880312 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:31:47.880530 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m15:31:47.880826 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145404690>]}
[0m15:31:47.881026 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:47.881309 [info ] [Thread-3 (]: 20 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.60s]
[0m15:31:47.881630 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:31:47.882095 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:31:47.882504 [info ] [Thread-3 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m15:31:47.882757 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:31:47.882921 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:31:47.884849 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:31:47.885571 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:31:47.886890 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:31:47.887807 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:31:47.888117 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m15:31:47.888285 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:48.052673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:31:48.053694 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m15:31:48.213099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145983050>]}
[0m15:31:48.214388 [info ] [Thread-1 (]: 21 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.64s]
[0m15:31:48.214872 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:31:48.215116 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:31:48.215360 [info ] [Thread-1 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m15:31:48.216124 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:48.216415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:31:48.217332 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m15:31:48.217511 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:31:48.219527 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:31:48.220273 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:31:48.221813 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:31:48.222476 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:31:48.222683 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m15:31:48.222874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:48.349330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1427b1a90>]}
[0m15:31:48.349745 [info ] [Thread-2 (]: 22 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.74s]
[0m15:31:48.350026 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:31:48.350226 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:31:48.350485 [info ] [Thread-2 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m15:31:48.350733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:31:48.350913 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:31:48.352433 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:31:48.352924 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:31:48.354219 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:31:48.354731 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:31:48.354912 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m15:31:48.355087 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:48.423653 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:48.424885 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m15:31:48.627353 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14590cf90>]}
[0m15:31:48.708995 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:48.711189 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m15:31:48.883847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433c06d0>]}
[0m15:31:48.891062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:48.891949 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m15:31:49.004919 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:49.005925 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m15:31:49.051247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1427c0910>]}
[0m15:31:49.132592 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145910250>]}
[0m15:31:50.216478 [info ] [Thread-3 (]: 24 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.74s]
[0m15:31:50.216761 [info ] [Thread-4 (]: 23 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 1.01s]
[0m15:31:50.217558 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:31:50.217063 [info ] [Thread-1 (]: 25 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.83s]
[0m15:31:50.217891 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:31:50.217253 [info ] [Thread-2 (]: 26 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.78s]
[0m15:31:50.218183 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:31:50.218503 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:31:50.218713 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:31:50.218960 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:31:50.219171 [info ] [Thread-3 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m15:31:50.219398 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:31:50.219628 [info ] [Thread-4 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m15:31:50.219857 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:31:50.220097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:31:50.220308 [info ] [Thread-1 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m15:31:50.220516 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:31:50.220727 [info ] [Thread-2 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m15:31:50.220906 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:31:50.221112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:31:50.221318 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:31:50.221505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m15:31:50.223598 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:31:50.223783 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:31:50.225173 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:31:50.225365 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:31:50.228067 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:31:50.228578 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:31:50.230729 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:31:50.231344 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:31:50.232951 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m15:31:50.233220 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:31:50.234580 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m15:31:50.234755 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:31:50.236016 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m15:31:50.237332 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m15:31:50.238058 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m15:31:50.239071 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m15:31:50.239742 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m15:31:50.240702 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m15:31:50.241119 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m15:31:50.242010 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m15:31:50.242290 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:50.242645 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m15:31:50.242972 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:50.243435 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m15:31:50.245077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:50.247119 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:50.918888 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:50.920006 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m15:31:51.217658 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459759d0>]}
[0m15:31:51.218088 [info ] [Thread-2 (]: 30 of 32 OK created sql view model GOLD_LAYER.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 1.00s]
[0m15:31:51.218369 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:31:51.218568 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:31:51.218790 [info ] [Thread-2 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m15:31:51.218990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:31:51.219149 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:31:51.220680 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:31:51.221317 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:31:51.222683 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:31:51.223204 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:31:51.223396 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m15:31:51.223571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:51.309401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:51.310469 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: Close
[0m15:31:51.413447 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:51.415502 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m15:31:51.509423 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:51.510487 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_overall: Close
[0m15:31:51.676915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14342b890>]}
[0m15:31:51.677325 [info ] [Thread-1 (]: 29 of 32 OK created sql view model GOLD_LAYER.total_devices_overall ............ [[32mSUCCESS 1[0m in 1.46s]
[0m15:31:51.677607 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:31:51.677804 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:31:51.678036 [info ] [Thread-1 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m15:31:51.678230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:31:51.678388 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:31:51.679785 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:31:51.680174 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:31:51.681674 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:31:51.682208 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m15:31:51.682398 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m15:31:51.682578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:51.804048 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14548aed0>]}
[0m15:31:51.804415 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a3c50>]}
[0m15:31:51.804822 [info ] [Thread-4 (]: 28 of 32 OK created sql view model GOLD_LAYER.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 1.58s]
[0m15:31:51.805155 [info ] [Thread-3 (]: 27 of 32 OK created sql view model GOLD_LAYER.total_customers_overall .......... [[32mSUCCESS 1[0m in 1.58s]
[0m15:31:51.805545 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:31:51.805996 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:31:52.205418 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:52.206449 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m15:31:52.313226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:31:52.314331 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m15:31:52.417256 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145910b90>]}
[0m15:31:52.417852 [info ] [Thread-2 (]: 31 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 1.20s]
[0m15:31:52.418353 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:31:52.508858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd7d331-ddbe-4058-b06d-32e030c9adf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109694d90>]}
[0m15:31:52.509378 [info ] [Thread-1 (]: 32 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 0.83s]
[0m15:31:52.509706 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:31:52.510525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:52.510698 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:31:52.510832 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:31:52.510950 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_overall' was properly closed.
[0m15:31:52.511059 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_week_wise' was properly closed.
[0m15:31:52.511253 [info ] [MainThread]: 
[0m15:31:52.511409 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 12.60 seconds (12.60s).
[0m15:31:52.513139 [debug] [MainThread]: Command end result
[0m15:31:52.579634 [info ] [MainThread]: 
[0m15:31:52.579925 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:31:52.580079 [info ] [MainThread]: 
[0m15:31:52.580257 [error] [MainThread]:   Database Error in model brand_by_age_segment (models/gold/brand_by_age_segment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 0 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/gold/brand_by_age_segment.sql
[0m15:31:52.580413 [info ] [MainThread]: 
[0m15:31:52.580559 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=1 SKIP=0 TOTAL=32
[0m15:31:52.582718 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.911681, "process_user_time": 3.63445, "process_kernel_time": 1.442238, "process_mem_max_rss": "205029376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:31:52.582968 [debug] [MainThread]: Command `dbt run` failed at 15:31:52.582930 after 13.91 seconds
[0m15:31:52.583161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cc46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ab30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a33a90>]}
[0m15:31:52.583327 [debug] [MainThread]: Flushing usage events
[0m15:32:30.885467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f91750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106febc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107001210>]}


============================== 15:32:30.888339 | 94365b9c-8228-4633-8385-359b8f5bf5cf ==============================
[0m15:32:30.888339 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:32:30.888738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/', 'send_anonymous_usage_stats': 'True'}
[0m15:32:31.695125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13793d910>]}
[0m15:32:31.719219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3b2d0>]}
[0m15:32:31.719909 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:32:31.732288 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:32:31.826190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:32:31.826616 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/gold/brand_by_age_segment.sql
[0m15:32:31.988724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c7e9d0>]}
[0m15:32:32.041412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b94a50>]}
[0m15:32:32.041734 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:32:32.041926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b3d690>]}
[0m15:32:32.043260 [info ] [MainThread]: 
[0m15:32:32.043565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:32:32.046503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:32:32.046802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:32:32.053760 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:32:32.054889 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:32:32.055090 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:32:32.055291 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:32:32.055503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:32.055666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:32.659337 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:32:32.659738 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:32:32.661528 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:32:32.662221 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:32:32.865443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:32:32.865730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:32:32.866037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SILVER_LAYER'
[0m15:32:32.870160 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:32:32.871204 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:32:32.872763 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:32:32.872967 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:32:32.873146 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:32:32.873310 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:32:32.873473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:32.873610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:32.873749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:33.341765 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:32:33.342827 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:32:33.373482 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:32:33.374778 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:32:33.386994 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:32:33.387813 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:32:33.549387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105084290>]}
[0m15:32:33.549785 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:33.549963 [info ] [MainThread]: 
[0m15:32:33.551869 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:32:33.552066 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:32:33.552320 [info ] [Thread-1 (]: 1 of 32 START sql table model SILVER_LAYER.clean_crm_data ...................... [RUN]
[0m15:32:33.552579 [info ] [Thread-2 (]: 2 of 32 START sql table model SILVER_LAYER.clean_device_data ................... [RUN]
[0m15:32:33.552840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m15:32:33.553064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_device_data)
[0m15:32:33.553269 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:32:33.553440 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:32:33.559305 [info ] [Thread-1 (]: import_crm: 
[0m15:32:33.561347 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:32:33.561609 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:32:33.561820 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:32:33.562290 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:32:33.562477 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:32:33.583676 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:32:33.585010 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:32:33.586043 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:32:33.586307 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:32:33.587246 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:32:33.587436 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:33.587675 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:32:33.588362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:34.912122 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:34.922677 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:32:34.963231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:34.964117 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:32:35.062134 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14420f250>]}
[0m15:32:35.062537 [info ] [Thread-2 (]: 2 of 32 OK created sql table model SILVER_LAYER.clean_device_data .............. [[32mSUCCESS 1[0m in 1.51s]
[0m15:32:35.062824 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:32:35.112228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fae150>]}
[0m15:32:35.112650 [info ] [Thread-1 (]: 1 of 32 OK created sql table model SILVER_LAYER.clean_crm_data ................. [[32mSUCCESS 1[0m in 1.56s]
[0m15:32:35.112940 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:32:35.113322 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:32:35.113499 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:32:35.113751 [info ] [Thread-4 (]: 3 of 32 START sql table model SILVER_LAYER.crm_device_data ..................... [RUN]
[0m15:32:35.114023 [info ] [Thread-3 (]: 4 of 32 START sql table model SILVER_LAYER.enriched_data ....................... [RUN]
[0m15:32:35.114326 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m15:32:35.114554 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.enriched_data)
[0m15:32:35.114756 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:32:35.114942 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:32:35.116473 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:32:35.118627 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:32:35.119108 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:32:35.119449 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:32:35.119606 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:32:35.121419 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:32:35.122895 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:32:35.123785 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:32:35.124521 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:32:35.124910 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m15:32:35.125255 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:32:35.125615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:35.125945 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:32:36.396143 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:36.396491 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:36.397508 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m15:32:36.398259 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:32:36.521458 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378327d0>]}
[0m15:32:36.521826 [info ] [Thread-4 (]: 3 of 32 OK created sql table model SILVER_LAYER.crm_device_data ................ [[32mSUCCESS 1[0m in 1.41s]
[0m15:32:36.522165 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:32:36.523510 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379723d0>]}
[0m15:32:36.523801 [info ] [Thread-3 (]: 4 of 32 OK created sql table model SILVER_LAYER.enriched_data .................. [[32mSUCCESS 1[0m in 1.41s]
[0m15:32:36.524102 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:32:36.524694 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:32:36.524901 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:32:36.525088 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:32:36.525495 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:32:36.525333 [info ] [Thread-1 (]: 5 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m15:32:36.525765 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m15:32:36.526022 [info ] [Thread-4 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m15:32:36.526278 [info ] [Thread-3 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m15:32:36.526513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m15:32:36.526723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m15:32:36.526910 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:32:36.527102 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:32:36.527269 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:32:36.527430 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:32:36.527590 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:32:36.527799 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:32:36.529506 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:32:36.530880 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:32:36.532197 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:32:36.533519 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:32:36.534986 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:32:36.535161 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:32:36.535318 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:32:36.535465 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:32:36.547319 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m15:32:36.552076 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:32:36.553751 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:32:36.555138 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:32:36.556349 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m15:32:36.557019 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:32:36.557506 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m15:32:36.558347 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m15:32:36.558760 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:32:36.559026 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m15:32:36.559386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:36.559700 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m15:32:36.559982 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m15:32:36.560192 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:36.561565 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:36.561996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:37.104452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:37.105499 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m15:32:37.106612 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:37.107495 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m15:32:37.162326 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:37.162616 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:37.163484 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m15:32:37.164295 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m15:32:37.236018 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144279dd0>]}
[0m15:32:37.236388 [info ] [Thread-3 (]: 8 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.71s]
[0m15:32:37.236758 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:32:37.237154 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:32:37.237432 [info ] [Thread-3 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m15:32:37.237708 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:32:37.237900 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:32:37.239278 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:32:37.239541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144267950>]}
[0m15:32:37.239801 [info ] [Thread-1 (]: 5 of 32 OK created sql view model GOLD_LAYER.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.71s]
[0m15:32:37.240056 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:32:37.240252 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:32:37.240451 [info ] [Thread-1 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ............... [RUN]
[0m15:32:37.240701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m15:32:37.240882 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:32:37.242452 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:32:37.242661 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:32:37.244033 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:32:37.244668 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:32:37.245055 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:32:37.246259 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m15:32:37.246457 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m15:32:37.246683 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:37.247574 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m15:32:37.247831 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by os_name
  );
[0m15:32:37.247987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:37.295122 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1442653d0>]}
[0m15:32:37.295689 [info ] [Thread-4 (]: 7 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.77s]
[0m15:32:37.296120 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:32:37.296334 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:32:37.296610 [info ] [Thread-4 (]: 11 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m15:32:37.296866 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:32:37.297119 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144265350>]}
[0m15:32:37.297298 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:32:37.297548 [info ] [Thread-2 (]: 6 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.77s]
[0m15:32:37.299917 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:32:37.300264 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:32:37.300936 [debug] [Thread-2 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:32:37.301203 [info ] [Thread-2 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m15:32:37.301800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.os_by_age_segment)
[0m15:32:37.302056 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:32:37.302286 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:32:37.304893 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:32:37.307050 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:32:37.308191 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:32:37.308841 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m15:32:37.311143 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m15:32:37.311625 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m15:32:37.312316 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:37.315391 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m15:32:37.315964 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m15:32:37.316291 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:37.776249 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:37.776622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:37.777678 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m15:32:37.778458 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m15:32:37.825395 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:37.826229 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m15:32:37.835015 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:37.835795 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m15:32:37.906615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144264fd0>]}
[0m15:32:37.906920 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a25110>]}
[0m15:32:37.907290 [info ] [Thread-1 (]: 10 of 32 OK created sql view model GOLD_LAYER.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 0.67s]
[0m15:32:37.907614 [info ] [Thread-3 (]: 9 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.67s]
[0m15:32:37.907908 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:32:37.908174 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:32:37.908414 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:32:37.908658 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:32:37.908910 [info ] [Thread-1 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m15:32:37.909136 [info ] [Thread-3 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m15:32:37.909388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_overall)
[0m15:32:37.909587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:32:37.909771 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:32:37.909940 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:32:37.911544 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:32:37.912816 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:32:37.914188 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:32:37.914350 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:32:37.915683 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:32:37.916903 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:32:37.917630 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m15:32:37.917971 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:32:37.918156 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by age
order by age
  );
[0m15:32:37.918350 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m15:32:37.918530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:37.918684 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:37.965534 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d71390>]}
[0m15:32:37.965987 [info ] [Thread-4 (]: 11 of 32 OK created sql view model GOLD_LAYER.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.67s]
[0m15:32:37.966312 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:32:37.966575 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:32:37.966829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebcfd0>]}
[0m15:32:37.967082 [info ] [Thread-4 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m15:32:37.967389 [info ] [Thread-2 (]: 12 of 32 OK created sql view model GOLD_LAYER.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.67s]
[0m15:32:37.967626 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:32:37.967871 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:32:37.968050 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:32:37.968232 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:32:37.969620 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:32:37.969984 [info ] [Thread-2 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m15:32:37.970597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:32:37.970941 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:32:37.971146 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:32:37.974822 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:32:37.977487 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:32:37.978246 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:32:37.978882 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m15:32:37.980765 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:32:37.981101 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m15:32:37.981466 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:37.982568 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:32:37.983444 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m15:32:37.984026 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:38.400821 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:32:38.401845 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m15:32:38.405445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:32:38.406263 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m15:32:38.495720 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:38.496766 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m15:32:38.498102 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:38.499342 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m15:32:38.566219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1442ab890>]}
[0m15:32:38.566506 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144120950>]}
[0m15:32:38.566876 [info ] [Thread-1 (]: 13 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 0.66s]
[0m15:32:38.567186 [info ] [Thread-3 (]: 14 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.66s]
[0m15:32:38.567484 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:32:38.567773 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:32:38.568019 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:32:38.568254 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:32:38.568514 [info ] [Thread-1 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m15:32:38.568785 [info ] [Thread-3 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m15:32:38.569016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:32:38.569224 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:32:38.569418 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:32:38.569594 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:32:38.571284 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:32:38.572650 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:32:38.573137 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:32:38.573296 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:32:38.574732 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:32:38.576111 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:32:38.577229 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m15:32:38.578023 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:32:38.578288 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m15:32:38.578542 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m15:32:38.578806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:38.578974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:38.649837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b8f310>]}
[0m15:32:38.650357 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14425b8d0>]}
[0m15:32:38.650940 [info ] [Thread-4 (]: 15 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.68s]
[0m15:32:38.651523 [info ] [Thread-2 (]: 16 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.68s]
[0m15:32:38.651946 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:32:38.652266 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:32:38.652528 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:32:38.653019 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:32:38.653453 [info ] [Thread-4 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m15:32:38.653777 [info ] [Thread-2 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m15:32:38.654171 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:32:38.654483 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:32:38.654755 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:32:38.655024 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:32:38.656831 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:32:38.660882 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:32:38.661604 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:32:38.661862 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:32:38.663795 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:32:38.665875 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:32:38.666829 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:32:38.667442 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:32:38.667698 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m15:32:38.667995 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m15:32:38.668314 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:38.668519 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:39.083417 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:39.084473 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m15:32:39.109815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:39.110724 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m15:32:39.211224 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:39.211551 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:39.212494 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m15:32:39.213271 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m15:32:39.262726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1334d7dd0>]}
[0m15:32:39.263026 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d70b90>]}
[0m15:32:39.263390 [info ] [Thread-1 (]: 17 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.69s]
[0m15:32:39.263667 [info ] [Thread-3 (]: 18 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.69s]
[0m15:32:39.263968 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:32:39.264221 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:32:39.264431 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:32:39.264656 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:32:39.264949 [info ] [Thread-1 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m15:32:39.265234 [info ] [Thread-3 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m15:32:39.265477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:32:39.265658 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:32:39.265822 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:32:39.266001 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:32:39.267749 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:32:39.269154 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:32:39.269707 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:32:39.269902 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:32:39.271358 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:32:39.272728 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:32:39.273441 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:32:39.273809 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m15:32:39.274033 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m15:32:39.274261 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m15:32:39.274466 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:39.274649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:39.350522 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1442501d0>]}
[0m15:32:39.350932 [info ] [Thread-2 (]: 20 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.70s]
[0m15:32:39.351242 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:32:39.351457 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:32:39.351743 [info ] [Thread-2 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m15:32:39.352004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:32:39.352196 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:32:39.353760 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:32:39.354152 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:32:39.356450 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:32:39.357317 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:32:39.357563 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m15:32:39.357839 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444b3c10>]}
[0m15:32:39.358021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:39.358371 [info ] [Thread-4 (]: 19 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.70s]
[0m15:32:39.359134 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:32:39.359586 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:32:39.359894 [info ] [Thread-4 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m15:32:39.360247 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:32:39.360442 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:32:39.362017 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:32:39.362997 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:32:39.364577 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:32:39.365371 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:32:39.365711 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m15:32:39.366257 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:39.750774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:32:39.751826 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m15:32:39.756326 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:32:39.757170 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m15:32:39.845906 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:32:39.846836 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m15:32:39.887087 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:39.887957 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m15:32:39.930457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444b0c90>]}
[0m15:32:39.930723 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144106790>]}
[0m15:32:39.931044 [info ] [Thread-1 (]: 21 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.66s]
[0m15:32:39.931585 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:32:39.931310 [info ] [Thread-3 (]: 22 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.67s]
[0m15:32:39.931850 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:32:39.932147 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:32:39.932373 [info ] [Thread-1 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m15:32:39.932594 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:32:39.932811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:32:39.933026 [info ] [Thread-3 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m15:32:39.933225 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:32:39.933414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:32:39.935041 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:32:39.935230 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:32:39.936578 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:32:39.936932 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:32:39.937232 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:32:39.938612 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:32:39.939908 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:32:39.940543 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:32:39.940769 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m15:32:39.941218 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:32:39.941515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:39.941802 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m15:32:39.942078 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:39.995080 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14420f050>]}
[0m15:32:40.013649 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14416ea10>]}
[0m15:32:40.451918 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:40.453035 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m15:32:40.468480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:40.469399 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m15:32:40.633689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1442dbd50>]}
[0m15:32:40.633980 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144462e50>]}
[0m15:32:41.366725 [info ] [Thread-2 (]: 23 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.64s]
[0m15:32:41.367021 [info ] [Thread-4 (]: 24 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.65s]
[0m15:32:41.367297 [info ] [Thread-1 (]: 25 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.70s]
[0m15:32:41.367911 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:32:41.367664 [info ] [Thread-3 (]: 26 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.70s]
[0m15:32:41.368187 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:32:41.368463 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:32:41.368686 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:32:41.368952 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:32:41.369172 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:32:41.369358 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:32:41.369575 [info ] [Thread-2 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m15:32:41.369800 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:32:41.370035 [info ] [Thread-4 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m15:32:41.370280 [info ] [Thread-1 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m15:32:41.370528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:32:41.370761 [info ] [Thread-3 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m15:32:41.370978 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:32:41.371185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:32:41.371366 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:32:41.371548 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m15:32:41.371720 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:32:41.371875 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:32:41.373864 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:32:41.374859 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:32:41.376237 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:32:41.377651 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:32:41.379104 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:32:41.379623 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:32:41.379813 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:32:41.379998 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:32:41.381357 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m15:32:41.382658 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m15:32:41.382818 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:32:41.383990 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m15:32:41.385289 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m15:32:41.385905 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m15:32:41.386414 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m15:32:41.386680 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m15:32:41.387274 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m15:32:41.387485 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m15:32:41.387683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:41.387888 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m15:32:41.388485 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m15:32:41.388643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:41.388836 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:41.389334 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m15:32:41.390485 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:41.927377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:41.927706 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:41.928645 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: Close
[0m15:32:41.929404 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m15:32:41.929808 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:41.931882 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_overall: Close
[0m15:32:42.080694 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fdda90>]}
[0m15:32:42.080996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137cceed0>]}
[0m15:32:42.081222 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444a85d0>]}
[0m15:32:42.081542 [info ] [Thread-2 (]: 27 of 32 OK created sql view model GOLD_LAYER.total_customers_overall .......... [[32mSUCCESS 1[0m in 0.71s]
[0m15:32:42.081824 [info ] [Thread-1 (]: 29 of 32 OK created sql view model GOLD_LAYER.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.71s]
[0m15:32:42.082103 [info ] [Thread-3 (]: 30 of 32 OK created sql view model GOLD_LAYER.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 0.71s]
[0m15:32:42.082404 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:32:42.082628 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:32:42.082860 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:32:42.083087 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:32:42.083314 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:32:42.083595 [info ] [Thread-2 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m15:32:42.083837 [info ] [Thread-1 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m15:32:42.084046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:32:42.084244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:32:42.084412 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:32:42.084573 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:32:42.086465 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:32:42.087390 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:32:42.087680 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:32:42.090023 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:32:42.090267 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:32:42.091546 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:32:42.091918 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m15:32:42.092134 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m15:32:42.092328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:42.092667 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:32:42.092881 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m15:32:42.093339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:42.098815 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:42.100112 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m15:32:42.248720 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378dacd0>]}
[0m15:32:42.249143 [info ] [Thread-4 (]: 28 of 32 OK created sql view model GOLD_LAYER.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 0.88s]
[0m15:32:42.249432 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:32:42.645229 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:42.646368 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m15:32:42.647581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:42.648505 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m15:32:42.794782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1334d7dd0>]}
[0m15:32:42.795067 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94365b9c-8228-4633-8385-359b8f5bf5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144425290>]}
[0m15:32:42.795427 [info ] [Thread-1 (]: 32 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 0.71s]
[0m15:32:42.795740 [info ] [Thread-2 (]: 31 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 0.71s]
[0m15:32:42.796050 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:32:42.796300 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:32:42.797105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:42.797256 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:32:42.797379 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:32:42.797491 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m15:32:42.797605 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_week_wise' was properly closed.
[0m15:32:42.797809 [info ] [MainThread]: 
[0m15:32:42.797958 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 10.75 seconds (10.75s).
[0m15:32:42.799685 [debug] [MainThread]: Command end result
[0m15:32:42.818222 [info ] [MainThread]: 
[0m15:32:42.818515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:42.818729 [info ] [MainThread]: 
[0m15:32:42.818926 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m15:32:42.820936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.966661, "process_user_time": 3.464558, "process_kernel_time": 1.621129, "process_mem_max_rss": "203620352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:32:42.821210 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:42.821167 after 11.97 seconds
[0m15:32:42.821406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c27210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032686d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10319a210>]}
[0m15:32:42.821584 [debug] [MainThread]: Flushing usage events
[0m15:37:59.524957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119092b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190de410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190ebfd0>]}


============================== 15:37:59.527804 | b027156f-81b1-4cb7-b56b-b694a86b00f6 ==============================
[0m15:37:59.527804 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:37:59.528122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --vars {"unit_testing": true}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:38:00.362174 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{vars.schema}}: 'vars' is undefined
[0m15:38:00.364035 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.8702461, "process_user_time": 1.640246, "process_kernel_time": 1.173079, "process_mem_max_rss": "175538176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:38:00.364311 [debug] [MainThread]: Command `dbt compile` failed at 15:38:00.364263 after 0.87 seconds
[0m15:38:00.364503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c40710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119100dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1569d7390>]}
[0m15:38:00.364698 [debug] [MainThread]: Flushing usage events
[0m15:42:36.701413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108017fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108015b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108085150>]}


============================== 15:42:36.704051 | 91132038-069e-4a8d-9277-bb7c8803af1d ==============================
[0m15:42:36.704051 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:42:36.704461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile --vars {"unit_testing": false}', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:37.653740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91132038-069e-4a8d-9277-bb7c8803af1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe18a50>]}
[0m15:42:37.676465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91132038-069e-4a8d-9277-bb7c8803af1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac70d0>]}
[0m15:42:37.677075 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:42:37.689018 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:42:37.757287 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:42:37.757638 [debug] [MainThread]: previous checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, current checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4
[0m15:42:37.757798 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:42:37.757978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91132038-069e-4a8d-9277-bb7c8803af1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717e750>]}
[0m15:42:38.211757 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:42:38.221470 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:42:38.226652 [info ] [MainThread]: import_crm: 
[0m15:42:38.409028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91132038-069e-4a8d-9277-bb7c8803af1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129e67c90>]}
[0m15:42:38.468792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91132038-069e-4a8d-9277-bb7c8803af1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129ffbf10>]}
[0m15:42:38.469091 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:42:38.469264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91132038-069e-4a8d-9277-bb7c8803af1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff07010>]}
[0m15:42:38.470474 [info ] [MainThread]: 
[0m15:42:38.470746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:42:38.473691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_vars('unit_testing')'
[0m15:42:38.473968 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:42:38.474247 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:42:38.481932 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_vars('unit_testing')"
[0m15:42:38.483128 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:42:38.484725 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:42:38.484957 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars('unit_testing'): /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_vars('unit_testing')"} */
show objects in PROJECT_SEC2_DB.vars('unit_testing') limit 10000
[0m15:42:38.485172 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:42:38.485343 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:42:38.485495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.485650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.485819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:39.099285 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:42:39.100490 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:42:39.105862 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b4e444-3201-1b5f-0008-eb7e0004695e
[0m15:42:39.106054 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 37 unexpected ''unit_testing''.
[0m15:42:39.106271 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:42:39.106402 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:42:39.106545 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars('unit_testing'): Close
[0m15:42:39.123595 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:42:39.125477 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:42:39.258489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:39.258666 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_vars('unit_testing')' was properly closed.
[0m15:42:39.258790 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:42:39.258906 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:42:39.259116 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 37 unexpected ''unit_testing''.
[0m15:42:39.261589 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.5926933, "process_user_time": 2.51254, "process_kernel_time": 1.317437, "process_mem_max_rss": "199065600", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:42:39.261853 [debug] [MainThread]: Command `dbt compile` failed at 15:42:39.261813 after 2.59 seconds
[0m15:42:39.262034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c40710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108086e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129fb74d0>]}
[0m15:42:39.262205 [debug] [MainThread]: Flushing usage events
[0m15:44:03.069428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042aff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10431c5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10431d090>]}


============================== 15:44:03.072406 | 954739bc-5f45-4622-8e0d-378d558e4ec2 ==============================
[0m15:44:03.072406 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:44:03.072792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile --vars {"unit_testing": false}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:44:03.840289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '954739bc-5f45-4622-8e0d-378d558e4ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125ce47d0>]}
[0m15:44:03.864249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '954739bc-5f45-4622-8e0d-378d558e4ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d5b190>]}
[0m15:44:03.864869 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:44:03.877262 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:44:03.949514 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:44:03.949921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '954739bc-5f45-4622-8e0d-378d558e4ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10341a790>]}
[0m15:44:04.411639 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:44:04.421276 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:44:04.427021 [info ] [MainThread]: import_crm: 
[0m15:44:04.613198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '954739bc-5f45-4622-8e0d-378d558e4ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261ad2d0>]}
[0m15:44:04.666534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '954739bc-5f45-4622-8e0d-378d558e4ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10348d2d0>]}
[0m15:44:04.666855 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:44:04.667048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954739bc-5f45-4622-8e0d-378d558e4ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262f6e90>]}
[0m15:44:04.668341 [info ] [MainThread]: 
[0m15:44:04.668690 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:44:04.671675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_vars('unit_testing_cecw')'
[0m15:44:04.671958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:44:04.677930 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:44:04.679556 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_vars('unit_testing_cecw')"
[0m15:44:04.680856 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:44:04.682607 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:44:04.682905 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars('unit_testing_cecw'): /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_vars('unit_testing_cecw')"} */
show objects in PROJECT_SEC2_DB.vars('unit_testing_cecw') limit 10000
[0m15:44:04.683141 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:44:04.683337 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:44:04.683559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:04.683727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:04.683923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:05.375066 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:44:05.376616 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:44:05.381861 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b4e446-3201-1b5f-0008-eb7e0004696e
[0m15:44:05.382054 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 37 unexpected ''unit_testing_cecw''.
[0m15:44:05.382288 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:44:05.382432 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:44:05.382581 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars('unit_testing_cecw'): Close
[0m15:44:05.404388 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:44:05.405470 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:44:05.595093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:05.595332 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_vars('unit_testing_cecw')' was properly closed.
[0m15:44:05.595462 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m15:44:05.595581 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:44:05.595804 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 37 unexpected ''unit_testing_cecw''.
[0m15:44:05.598375 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.5573752, "process_user_time": 2.563604, "process_kernel_time": 1.254121, "process_mem_max_rss": "198197248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:44:05.598670 [debug] [MainThread]: Command `dbt compile` failed at 15:44:05.598624 after 2.56 seconds
[0m15:44:05.598864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10431ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126184cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043042d0>]}
[0m15:44:05.599043 [debug] [MainThread]: Flushing usage events
[0m15:44:25.650627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f42f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb9510>]}


============================== 15:44:25.653010 | 5d66e5f3-86d4-469e-b114-a1d09c9ef2ce ==============================
[0m15:44:25.653010 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:44:25.653327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile --vars {"unit_testing": false}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:26.361734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d66e5f3-86d4-469e-b114-a1d09c9ef2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243d6350>]}
[0m15:44:26.384777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d66e5f3-86d4-469e-b114-a1d09c9ef2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fb150>]}
[0m15:44:26.385940 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:44:26.400155 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:44:26.471900 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:44:26.472298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d66e5f3-86d4-469e-b114-a1d09c9ef2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c23d0>]}
[0m15:44:26.948456 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:44:26.958690 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:44:26.963497 [info ] [MainThread]: import_crm: 
[0m15:44:27.151091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d66e5f3-86d4-469e-b114-a1d09c9ef2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124374510>]}
[0m15:44:27.203538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d66e5f3-86d4-469e-b114-a1d09c9ef2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249833d0>]}
[0m15:44:27.203854 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:44:27.204040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d66e5f3-86d4-469e-b114-a1d09c9ef2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d3fc10>]}
[0m15:44:27.205315 [info ] [MainThread]: 
[0m15:44:27.205663 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:44:27.208661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_vars(unit_testing_cecw)'
[0m15:44:27.208912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m15:44:27.215028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:44:27.219720 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:44:27.221436 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_vars(unit_testing_cecw)"
[0m15:44:27.223050 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:44:27.223278 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:44:27.223456 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars(unit_testing_cecw): /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_vars(unit_testing_cecw)"} */
show objects in PROJECT_SEC2_DB.vars(unit_testing_cecw) limit 10000
[0m15:44:27.223622 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:44:27.223788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:27.223950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:27.224089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:27.833102 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b4e446-3201-1b5f-0008-eb7e00046976
[0m15:44:27.833350 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:44:27.833573 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:44:27.833710 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:44:27.833886 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars(unit_testing_cecw): Close
[0m15:44:27.866475 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:44:27.866815 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:44:27.868188 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:44:27.868970 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:44:28.003293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d66e5f3-86d4-469e-b114-a1d09c9ef2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122303190>]}
[0m15:44:28.003645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:44:28.003808 [info ] [MainThread]: 
[0m15:44:28.005150 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.input_crm
[0m15:44:28.005349 [debug] [Thread-2 (]: Began running node seed.my_dbt_project.input_device
[0m15:44:28.005527 [debug] [Thread-3 (]: Began running node seed.my_dbt_project.input_enriched_data
[0m15:44:28.005719 [debug] [Thread-4 (]: Began running node seed.my_dbt_project.input_rev
[0m15:44:28.006254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now seed.my_dbt_project.input_device)
[0m15:44:28.006506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_vars(unit_testing_cecw), now seed.my_dbt_project.input_crm)
[0m15:44:28.006688 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now seed.my_dbt_project.input_enriched_data)
[0m15:44:28.006920 [debug] [Thread-4 (]: Acquiring new snowflake connection 'seed.my_dbt_project.input_rev'
[0m15:44:28.007092 [debug] [Thread-2 (]: Began compiling node seed.my_dbt_project.input_device
[0m15:44:28.007248 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.input_crm
[0m15:44:28.007397 [debug] [Thread-3 (]: Began compiling node seed.my_dbt_project.input_enriched_data
[0m15:44:28.007539 [debug] [Thread-4 (]: Began compiling node seed.my_dbt_project.input_rev
[0m15:44:28.010974 [debug] [Thread-2 (]: Began executing node seed.my_dbt_project.input_device
[0m15:44:28.011854 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.input_crm
[0m15:44:28.012756 [debug] [Thread-3 (]: Began executing node seed.my_dbt_project.input_enriched_data
[0m15:44:28.013703 [debug] [Thread-4 (]: Began executing node seed.my_dbt_project.input_rev
[0m15:44:28.014079 [debug] [Thread-2 (]: Finished running node seed.my_dbt_project.input_device
[0m15:44:28.014397 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.input_crm
[0m15:44:28.014681 [debug] [Thread-3 (]: Finished running node seed.my_dbt_project.input_enriched_data
[0m15:44:28.014988 [debug] [Thread-4 (]: Finished running node seed.my_dbt_project.input_rev
[0m15:44:28.015681 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:44:28.015961 [debug] [Thread-3 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:44:28.016274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_device, now model.my_dbt_project.clean_device_data)
[0m15:44:28.016508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_enriched_data, now model.my_dbt_project.clean_crm_data)
[0m15:44:28.016759 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:44:28.016966 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:44:28.019384 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
[0m15:44:28.021493 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:44:28.021297 [info ] [Thread-3 (]: import_crm: 
[0m15:44:28.021798 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:44:28.022126 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:44:28.022442 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:44:28.022700 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:44:28.022988 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:44:28.023356 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:44:28.023559 [debug] [Thread-4 (]: Began running node model.my_dbt_project.enriched_data
[0m15:44:28.023764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_crm, now model.my_dbt_project.crm_device_data)
[0m15:44:28.023967 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_rev, now model.my_dbt_project.enriched_data)
[0m15:44:28.024135 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:44:28.024283 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:44:28.025763 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:44:28.027612 [info ] [Thread-4 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m15:44:28.027907 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:44:28.028120 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:44:28.028400 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:44:28.028630 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:44:28.028891 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:44:28.029359 [debug] [Thread-2 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:44:28.029532 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:44:28.029783 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:44:28.029968 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.brand_by_age_segment)
[0m15:44:28.030171 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:44:28.030362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.customers_by_brand_overall)
[0m15:44:28.030533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:44:28.030725 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:44:28.031041 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:44:28.031224 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:44:28.031385 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:44:28.033552 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:44:28.033979 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:44:28.036755 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:44:28.038596 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:44:28.041568 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:44:28.041979 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:44:28.042572 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:44:28.042918 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:44:28.043117 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:44:28.043339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:44:28.043517 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:44:28.043937 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:44:28.044135 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:44:28.044305 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:44:28.044663 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:44:28.044887 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:44:28.045311 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:44:28.048633 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:44:28.049222 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:44:28.049749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_overall)
[0m15:44:28.050126 [debug] [Thread-4 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:44:28.050499 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:44:28.050981 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:44:28.051694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.os_by_age_segment)
[0m15:44:28.052015 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:44:28.052264 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:44:28.054600 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:44:28.054918 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:44:28.055423 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:44:28.056981 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:44:28.058667 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:44:28.058928 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:44:28.059271 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:44:28.059507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:44:28.059868 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:44:28.060015 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:44:28.060187 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:44:28.060338 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:44:28.060517 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:44:28.060802 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:44:28.062146 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:44:28.062544 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:44:28.062789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:44:28.063041 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:44:28.064483 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:44:28.064715 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:44:28.063503 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:44:28.067060 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:44:28.063820 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:44:28.064140 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:44:28.068059 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:44:28.069988 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:44:28.070383 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:44:28.070568 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:44:28.070747 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:44:28.071007 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:44:28.072359 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:44:28.072523 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:44:28.072806 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:44:28.072993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:44:28.073312 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:44:28.073528 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:44:28.073702 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:44:28.073844 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:44:28.074028 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:44:28.074227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:44:28.074564 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:44:28.076469 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:44:28.076808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:44:28.076990 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:44:28.077200 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:44:28.077431 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:44:28.078970 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:44:28.079190 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:44:28.079446 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:44:28.081149 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:44:28.081727 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:44:28.081932 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:44:28.082647 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:44:28.082853 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:44:28.085111 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:44:28.085401 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:44:28.085657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:44:28.085981 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:44:28.086334 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:44:28.086512 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:44:28.086728 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:44:28.086938 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:44:28.087107 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:44:28.090289 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:44:28.090574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:44:28.090893 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:44:28.091079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:44:28.091328 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:44:28.091544 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:44:28.091750 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:44:28.093125 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:44:28.093325 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:44:28.093525 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:44:28.094832 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:44:28.095202 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:44:28.095391 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:44:28.095607 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:44:28.095786 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:44:28.097157 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:44:28.097479 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:44:28.097625 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:44:28.097807 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:44:28.098054 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:44:28.098368 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:44:28.098529 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:44:28.098715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:44:28.098916 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:44:28.099084 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:44:28.100315 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:44:28.100502 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:44:28.100708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:44:28.101137 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:44:28.103168 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:44:28.103467 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:44:28.103679 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:44:28.103880 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:44:28.105791 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:44:28.106120 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:44:28.106296 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:44:28.106760 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:44:28.106982 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:44:28.107274 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:44:28.107474 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:44:28.107632 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:44:28.109236 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:44:28.109507 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:44:28.109812 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:44:28.110298 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:44:28.110727 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m15:44:28.110929 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:44:28.111139 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:44:28.111482 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:44:28.111867 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:44:28.112571 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:44:28.114926 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:44:28.115284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:44:28.117072 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:44:28.117338 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:44:28.117593 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:44:28.117866 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:44:28.118027 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:44:28.119367 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:44:28.119571 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:44:28.119726 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:44:28.120051 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:44:28.121459 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:44:28.121807 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:44:28.122149 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:44:28.122555 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:44:28.122998 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:44:28.123398 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:44:28.124427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:28.124687 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:44:28.124861 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_overall' was properly closed.
[0m15:44:28.125105 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m15:44:28.125244 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:44:28.127203 [debug] [MainThread]: Command end result
[0m15:44:28.148168 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.5263374, "process_user_time": 2.640701, "process_kernel_time": 1.218237, "process_mem_max_rss": "201244672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:44:28.148487 [debug] [MainThread]: Command `dbt compile` succeeded at 15:44:28.148443 after 2.53 seconds
[0m15:44:28.148681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b74710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b745d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ade790>]}
[0m15:44:28.148851 [debug] [MainThread]: Flushing usage events
[0m15:44:49.095068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11108aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110de410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ebfd0>]}


============================== 15:44:49.097602 | fd878a7e-80d3-496a-b83a-d0b0987f6f41 ==============================
[0m15:44:49.097602 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:44:49.097950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": false}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:49.738241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd878a7e-80d3-496a-b83a-d0b0987f6f41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e2d950>]}
[0m15:44:49.763072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd878a7e-80d3-496a-b83a-d0b0987f6f41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f0050>]}
[0m15:44:49.764226 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:44:49.776752 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:44:49.848953 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:44:49.849331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd878a7e-80d3-496a-b83a-d0b0987f6f41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796a690>]}
[0m15:44:50.303910 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:44:50.313191 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:44:50.317760 [info ] [MainThread]: import_crm: 
[0m15:44:50.498111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd878a7e-80d3-496a-b83a-d0b0987f6f41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140cd2950>]}
[0m15:44:50.550237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd878a7e-80d3-496a-b83a-d0b0987f6f41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ff7e10>]}
[0m15:44:50.550553 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:44:50.550739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd878a7e-80d3-496a-b83a-d0b0987f6f41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1409d6310>]}
[0m15:44:50.551974 [info ] [MainThread]: 
[0m15:44:50.552260 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:44:50.555162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:44:50.555460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:44:50.562188 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:44:50.563654 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:44:50.563874 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:44:50.564061 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:44:50.564257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:50.564432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:51.220643 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:44:51.221575 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:44:51.223482 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:44:51.224205 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:44:51.369820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now create_PROJECT_SEC2_DB_vars(unit_testing))
[0m15:44:51.370119 [debug] [ThreadPool]: Creating schema "database: "PROJECT_SEC2_DB"
schema: "vars(unit_testing)"
"
[0m15:44:51.372639 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_SEC2_DB_vars(unit_testing)"
[0m15:44:51.372824 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_vars(unit_testing): /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "create_PROJECT_SEC2_DB_vars(unit_testing)"} */
create schema if not exists PROJECT_SEC2_DB.vars(unit_testing)
[0m15:44:51.372969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:51.810804 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b4e446-3201-1b5f-0008-eb7e00046986
[0m15:44:51.811059 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 48 unexpected '('.
[0m15:44:51.811275 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m15:44:51.811405 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:44:51.811551 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_vars(unit_testing): Close
[0m15:44:51.980389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:51.980633 [debug] [MainThread]: Connection 'create_PROJECT_SEC2_DB_vars(unit_testing)' was properly closed.
[0m15:44:51.980764 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB' was properly closed.
[0m15:44:51.980905 [info ] [MainThread]: 
[0m15:44:51.981102 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m15:44:51.981354 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 48 unexpected '('.
[0m15:44:51.983841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9173007, "process_user_time": 2.444101, "process_kernel_time": 1.30093, "process_mem_max_rss": "199786496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:44:51.984136 [debug] [MainThread]: Command `dbt run` failed at 15:44:51.984089 after 2.92 seconds
[0m15:44:51.984332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110e8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105438710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140f7f810>]}
[0m15:44:51.984512 [debug] [MainThread]: Flushing usage events
[0m15:45:23.352094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d01050>]}


============================== 15:45:23.354981 | 37a9c9bf-0212-4f5f-b856-df88fbb1e3e6 ==============================
[0m15:45:23.354981 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:45:23.355320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": false}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:45:24.099728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135da32d0>]}
[0m15:45:24.123938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067430d0>]}
[0m15:45:24.125139 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:45:24.141076 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m15:45:24.212170 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:45:24.212561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c96410>]}
[0m15:45:24.672914 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:45:24.683225 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:45:24.688964 [info ] [MainThread]: import_crm: 
[0m15:45:24.878749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145daa050>]}
[0m15:45:24.931970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145da5750>]}
[0m15:45:24.932282 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:45:24.932468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145f8a250>]}
[0m15:45:24.933818 [info ] [MainThread]: 
[0m15:45:24.934152 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:24.937262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:45:24.937590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:45:24.944353 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:45:24.945513 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:45:24.945725 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:45:24.945925 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:45:24.946096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:24.946353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:25.567316 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:45:25.568254 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:45:25.568481 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:45:25.569782 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:45:25.772749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:45:25.773041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SILVER_LAYER)
[0m15:45:25.773265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:45:25.777491 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SILVER_LAYER"
[0m15:45:25.778354 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:45:25.779809 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:45:25.779991 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SILVER_LAYER"} */
show objects in PROJECT_SEC2_DB.SILVER_LAYER limit 10000
[0m15:45:25.780167 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:45:25.780335 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:45:25.780485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:25.780622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:25.780767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:26.282814 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:45:26.283292 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:45:26.283976 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:45:26.285318 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:45:26.286016 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:45:26.286677 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SILVER_LAYER: Close
[0m15:45:26.417772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145d67590>]}
[0m15:45:26.418100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:45:26.418261 [info ] [MainThread]: 
[0m15:45:26.420117 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:45:26.420335 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:45:26.420568 [info ] [Thread-1 (]: 1 of 32 START sql table model SILVER_LAYER.clean_crm_data ...................... [RUN]
[0m15:45:26.421006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_crm_data)
[0m15:45:26.420815 [info ] [Thread-2 (]: 2 of 32 START sql table model SILVER_LAYER.clean_device_data ................... [RUN]
[0m15:45:26.421261 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:45:26.426603 [info ] [Thread-1 (]: import_crm: 
[0m15:45:26.426962 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:45:26.427268 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SILVER_LAYER, now model.my_dbt_project.clean_device_data)
[0m15:45:26.427554 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:45:26.430162 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
[0m15:45:26.430595 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:45:26.430785 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:45:26.446328 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:45:26.446752 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:45:26.448479 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:45:26.450074 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:45:26.450499 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:45:26.450873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:26.452212 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:45:26.452994 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:45:26.453229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:33.299011 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m15:45:33.310395 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:45:33.451721 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1461592d0>]}
[0m15:45:33.452114 [info ] [Thread-2 (]: 2 of 32 OK created sql table model SILVER_LAYER.clean_device_data .............. [[32mSUCCESS 1[0m in 7.03s]
[0m15:45:33.452401 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:45:47.995406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 22.0 seconds
[0m15:45:47.997129 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:45:48.452016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460f6950>]}
[0m15:45:48.452423 [info ] [Thread-1 (]: 1 of 32 OK created sql table model SILVER_LAYER.clean_crm_data ................. [[32mSUCCESS 1[0m in 22.03s]
[0m15:45:48.452701 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:45:48.453095 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:45:48.453320 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:45:48.453609 [info ] [Thread-4 (]: 3 of 32 START sql table model SILVER_LAYER.crm_device_data ..................... [RUN]
[0m15:45:48.453893 [info ] [Thread-3 (]: 4 of 32 START sql table model SILVER_LAYER.enriched_data ....................... [RUN]
[0m15:45:48.454194 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m15:45:48.454386 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.enriched_data)
[0m15:45:48.454557 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:45:48.454708 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:45:48.456377 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:45:48.458393 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m15:45:48.458777 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:45:48.459239 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:45:48.461474 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:45:48.461677 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:45:48.462888 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:45:48.463553 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:45:48.463755 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:45:48.463964 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:45:48.464562 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:45:48.464825 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.REV AS revenue
    LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.SILVER_LAYER.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m15:45:48.465710 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:45:55.265091 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m15:45:55.266181 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m15:45:55.391914 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146440a50>]}
[0m15:45:55.392312 [info ] [Thread-3 (]: 4 of 32 OK created sql table model SILVER_LAYER.enriched_data .................. [[32mSUCCESS 1[0m in 6.94s]
[0m15:45:55.392596 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:45:55.393117 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:45:55.393294 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:45:55.393455 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:45:55.393657 [info ] [Thread-1 (]: 5 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m15:45:55.393879 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m15:45:55.394116 [info ] [Thread-3 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m15:45:55.394443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m15:45:55.394675 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m15:45:55.394869 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:45:55.395050 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:45:55.395207 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:45:55.395370 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:45:55.397095 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:45:55.398365 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:45:55.399650 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:45:55.400150 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:45:55.400315 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:45:55.400478 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:45:55.410272 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:45:55.411773 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:45:55.413766 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m15:45:55.415163 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:45:55.415695 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m15:45:55.416019 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m15:45:55.416428 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m15:45:55.417360 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m15:45:55.417579 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:45:55.417857 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:55.418359 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m15:45:55.420443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:55.992744 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:55.994224 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m15:45:56.021555 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:56.022543 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m15:45:56.029481 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:56.030312 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m15:45:56.134513 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146485fd0>]}
[0m15:45:56.134888 [info ] [Thread-2 (]: 6 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.74s]
[0m15:45:56.135208 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:45:56.135421 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:45:56.135676 [info ] [Thread-2 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m15:45:56.135892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:45:56.136068 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:45:56.137625 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:45:56.138008 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:45:56.139330 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:45:56.139808 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:45:56.139982 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m15:45:56.140146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:56.153515 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146137ed0>]}
[0m15:45:56.153918 [info ] [Thread-3 (]: 7 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.76s]
[0m15:45:56.154192 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:45:56.154439 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:45:56.154714 [info ] [Thread-3 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m15:45:56.154969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:45:56.155150 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:45:56.156642 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:45:56.156973 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:45:56.158271 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:45:56.158751 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:45:56.158927 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m15:45:56.159089 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:45:56.167225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1464abc90>]}
[0m15:45:56.167639 [info ] [Thread-1 (]: 5 of 32 OK created sql view model GOLD_LAYER.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.77s]
[0m15:45:56.167922 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:45:56.168120 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:45:56.168379 [info ] [Thread-1 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ............... [RUN]
[0m15:45:56.168609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m15:45:56.168782 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:45:56.170148 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:45:56.170522 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:45:56.171948 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m15:45:56.172414 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m15:45:56.172588 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by os_name
  );
[0m15:45:56.172750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:56.629821 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:45:56.630869 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m15:45:56.695523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:56.697229 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m15:45:56.701757 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:56.702632 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m15:45:56.768015 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145da7850>]}
[0m15:45:56.768360 [info ] [Thread-2 (]: 8 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.63s]
[0m15:45:56.768633 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:45:56.768831 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:45:56.769079 [info ] [Thread-2 (]: 11 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m15:45:56.769303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:45:56.769471 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:45:56.770997 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:45:56.771399 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:45:56.773443 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:45:56.774345 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m15:45:56.774553 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m15:45:56.774730 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:56.830993 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14641f490>]}
[0m15:45:56.831443 [info ] [Thread-3 (]: 9 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.68s]
[0m15:45:56.831758 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:45:56.831958 [debug] [Thread-3 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:45:56.832183 [info ] [Thread-3 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m15:45:56.832380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.os_by_age_segment)
[0m15:45:56.832568 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:45:56.834250 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:45:56.834625 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:45:56.835919 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m15:45:56.837018 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m15:45:56.837224 [debug] [Thread-3 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.SILVER_LAYER.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m15:45:56.837416 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:45:56.850674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146153bd0>]}
[0m15:45:56.851427 [info ] [Thread-1 (]: 10 of 32 OK created sql view model GOLD_LAYER.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 0.68s]
[0m15:45:56.851879 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:45:56.852256 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:45:56.852601 [info ] [Thread-1 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m15:45:56.852861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_overall)
[0m15:45:56.853154 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:45:56.854668 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:45:56.854997 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:45:56.856460 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:45:56.857082 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m15:45:56.857258 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by age
order by age
  );
[0m15:45:56.857420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:57.310052 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:57.310395 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:45:57.311355 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m15:45:57.312149 [debug] [Thread-3 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m15:45:57.388995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:57.390042 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m15:45:57.464885 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146444f50>]}
[0m15:45:57.465168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145de2150>]}
[0m15:45:57.465526 [info ] [Thread-3 (]: 12 of 32 OK created sql view model GOLD_LAYER.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.63s]
[0m15:45:57.466064 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:45:57.465825 [info ] [Thread-2 (]: 11 of 32 OK created sql view model GOLD_LAYER.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.70s]
[0m15:45:57.466341 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:45:57.466649 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:45:57.466875 [info ] [Thread-3 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m15:45:57.467087 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:45:57.467316 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:45:57.467535 [info ] [Thread-2 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m15:45:57.467751 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:45:57.467942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:45:57.469546 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:45:57.469724 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:45:57.471116 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:45:57.471471 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:45:57.472802 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:45:57.473461 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:45:57.473633 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:45:57.473820 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m15:45:57.475804 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:45:57.475993 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:45:57.477092 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m15:45:57.477332 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m15:45:57.477559 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:57.531527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b62c90>]}
[0m15:45:57.531974 [info ] [Thread-1 (]: 13 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 0.68s]
[0m15:45:57.532295 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:45:57.532492 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:45:57.532721 [info ] [Thread-1 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m15:45:57.532974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:45:57.533173 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:45:57.534668 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:45:57.535033 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:45:57.536362 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:45:57.537282 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:45:57.537484 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m15:45:57.537654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:57.953616 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:45:57.954591 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m15:45:58.032902 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:58.033223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:45:58.034143 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m15:45:58.034938 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m15:45:58.131154 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146443990>]}
[0m15:45:58.131594 [info ] [Thread-3 (]: 14 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.66s]
[0m15:45:58.132216 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:45:58.132433 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:45:58.132650 [info ] [Thread-3 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m15:45:58.133157 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:45:58.133334 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:45:58.134873 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:45:58.135264 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:45:58.136556 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:45:58.137560 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m15:45:58.137744 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m15:45:58.137912 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:45:58.206848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146076e10>]}
[0m15:45:58.207142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14646dcd0>]}
[0m15:45:58.207502 [info ] [Thread-1 (]: 16 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.67s]
[0m15:45:58.207812 [info ] [Thread-2 (]: 15 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.74s]
[0m15:45:58.208153 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:45:58.208406 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:45:58.208638 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:45:58.208867 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:45:58.209095 [info ] [Thread-1 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m15:45:58.209330 [info ] [Thread-2 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m15:45:58.209548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:45:58.209752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:45:58.209923 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:45:58.210086 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:45:58.211450 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:45:58.212806 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:45:58.213235 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:45:58.213440 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:45:58.214912 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:45:58.216246 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:45:58.216769 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:45:58.216963 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m15:45:58.217153 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:58.217534 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:45:58.218025 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m15:45:58.218870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:58.466954 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 10.0 seconds
[0m15:45:58.467945 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:45:58.640332 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:58.641348 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m15:45:58.641613 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a23e50>]}
[0m15:45:58.642427 [info ] [Thread-4 (]: 3 of 32 OK created sql table model SILVER_LAYER.crm_device_data ................ [[32mSUCCESS 1[0m in 10.19s]
[0m15:45:58.643293 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:45:58.643525 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:45:58.643747 [info ] [Thread-4 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m15:45:58.644005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:45:58.644178 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:45:58.645826 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:45:58.646490 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:45:58.647847 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:45:58.648358 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:45:58.648540 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m15:45:58.648708 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:45:58.722883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:58.723873 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m15:45:58.728700 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:58.729761 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m15:45:58.770223 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145fac310>]}
[0m15:45:58.770582 [info ] [Thread-3 (]: 17 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.64s]
[0m15:45:58.770880 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:45:58.771108 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:45:58.771387 [info ] [Thread-3 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m15:45:58.771628 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:45:58.771812 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:45:58.773249 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:45:58.773656 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:45:58.775180 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:45:58.775648 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m15:45:58.775823 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m15:45:58.775985 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:45:58.858039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e62b90>]}
[0m15:45:58.858363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b0310>]}
[0m15:45:58.858715 [info ] [Thread-2 (]: 19 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.65s]
[0m15:45:58.859120 [info ] [Thread-1 (]: 18 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.65s]
[0m15:45:58.859465 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:45:58.859740 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:45:58.859968 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:45:58.860204 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:45:58.860451 [info ] [Thread-2 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m15:45:58.860685 [info ] [Thread-1 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m15:45:58.860966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:45:58.861152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:45:58.861339 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:45:58.861533 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:45:58.863008 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:45:58.864438 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:45:58.865032 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:45:58.865205 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:45:58.866640 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:45:58.868530 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:45:58.869159 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:45:58.869410 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m15:45:58.869765 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:45:58.869958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:58.870157 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m15:45:58.870720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:59.254248 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:59.255247 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m15:45:59.357581 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:59.358547 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m15:45:59.370699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:59.371551 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m15:45:59.422806 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a71810>]}
[0m15:45:59.423155 [info ] [Thread-4 (]: 20 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.78s]
[0m15:45:59.423458 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:45:59.423688 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:45:59.423944 [info ] [Thread-4 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m15:45:59.424187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:45:59.424353 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:45:59.425927 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:45:59.426329 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:45:59.427614 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:45:59.428108 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:45:59.428287 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m15:45:59.428452 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:45:59.435591 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:59.436638 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m15:45:59.484275 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145d55150>]}
[0m15:45:59.484936 [info ] [Thread-3 (]: 21 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.71s]
[0m15:45:59.485394 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:45:59.485755 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:45:59.486143 [info ] [Thread-3 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m15:45:59.486482 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:45:59.486727 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:45:59.488562 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:45:59.489111 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:45:59.491191 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:45:59.491979 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:45:59.492201 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m15:45:59.492409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:45:59.514040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e54b90>]}
[0m15:45:59.580716 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a73e10>]}
[0m15:45:59.958851 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:59.959889 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m15:46:00.001775 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:46:00.002743 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m15:46:00.089337 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e600d0>]}
[0m15:46:00.139637 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459d2f10>]}
[0m15:46:01.104766 [info ] [Thread-1 (]: 23 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.65s]
[0m15:46:01.105438 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:46:01.105157 [info ] [Thread-2 (]: 22 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.72s]
[0m15:46:01.105986 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:46:01.105773 [info ] [Thread-4 (]: 24 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.67s]
[0m15:46:01.106236 [info ] [Thread-3 (]: 25 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.65s]
[0m15:46:01.106597 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:46:01.106817 [info ] [Thread-1 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m15:46:01.107098 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:46:01.107337 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:46:01.107535 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:46:01.107785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:46:01.108060 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:46:01.108351 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:46:01.108752 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:46:01.108585 [info ] [Thread-2 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m15:46:01.109047 [info ] [Thread-4 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m15:46:01.109260 [info ] [Thread-3 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m15:46:01.110760 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:46:01.110997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.total_customers_overall)
[0m15:46:01.111246 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:46:01.111442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:46:01.111665 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:46:01.111877 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:46:01.112113 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:46:01.112287 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:46:01.113903 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:46:01.115279 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:46:01.117456 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:46:01.118801 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:46:01.119323 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:46:01.119541 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:46:01.120910 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m15:46:01.121303 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:46:01.122643 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m15:46:01.122909 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:46:01.123187 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m15:46:01.124410 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m15:46:01.126429 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m15:46:01.126950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:01.127244 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m15:46:01.128086 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m15:46:01.128950 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:46:01.129725 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m15:46:01.132819 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m15:46:01.134032 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m15:46:01.135725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:46:01.136707 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:46:01.712545 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:46:01.712914 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:46:01.713204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:46:01.714196 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m15:46:01.715014 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_overall: Close
[0m15:46:01.715838 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m15:46:01.720543 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:46:01.721349 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: Close
[0m15:46:01.850470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ccb110>]}
[0m15:46:01.850830 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d6b50>]}
[0m15:46:01.851063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146076e10>]}
[0m15:46:01.851282 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135d62a10>]}
[0m15:46:01.851641 [info ] [Thread-2 (]: 27 of 32 OK created sql view model GOLD_LAYER.total_customers_overall .......... [[32mSUCCESS 1[0m in 0.74s]
[0m15:46:01.851969 [info ] [Thread-4 (]: 28 of 32 OK created sql view model GOLD_LAYER.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 0.74s]
[0m15:46:01.852242 [info ] [Thread-1 (]: 26 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.74s]
[0m15:46:01.852615 [info ] [Thread-3 (]: 29 of 32 OK created sql view model GOLD_LAYER.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.74s]
[0m15:46:01.852937 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:46:01.853182 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:46:01.853424 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:46:01.853648 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:46:01.853849 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:46:01.854072 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:46:01.854269 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:46:01.854552 [info ] [Thread-2 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m15:46:01.854781 [info ] [Thread-4 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m15:46:01.855018 [info ] [Thread-1 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m15:46:01.855271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.total_devices_week_wise)
[0m15:46:01.855458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:46:01.855643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:46:01.855826 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:46:01.855995 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:46:01.856158 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:46:01.857662 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:46:01.859169 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:46:01.861187 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:46:01.861672 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:46:01.861841 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:46:01.862005 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:46:01.863279 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:46:01.864556 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m15:46:01.865852 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:46:01.866701 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m15:46:01.867037 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m15:46:01.867249 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m15:46:01.867480 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m15:46:01.867846 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:46:01.868013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:46:01.868181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:01.868365 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.SILVER_LAYER.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m15:46:01.869321 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:46:02.430896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:46:02.431311 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:46:02.431634 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:46:02.432547 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m15:46:02.433354 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m15:46:02.434090 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m15:46:02.584898 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e024d0>]}
[0m15:46:02.585293 [info ] [Thread-4 (]: 31 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 0.73s]
[0m15:46:02.585597 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:46:02.589417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145dd1250>]}
[0m15:46:02.589687 [info ] [Thread-1 (]: 32 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 0.73s]
[0m15:46:02.590080 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:46:02.591394 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a9c9bf-0212-4f5f-b856-df88fbb1e3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cfed0>]}
[0m15:46:02.591657 [info ] [Thread-2 (]: 30 of 32 OK created sql view model GOLD_LAYER.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 0.74s]
[0m15:46:02.591941 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:46:02.592638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:02.592779 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:46:02.592902 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m15:46:02.593013 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_overall' was properly closed.
[0m15:46:02.593121 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:46:02.593350 [info ] [MainThread]: 
[0m15:46:02.593569 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 37.66 seconds (37.66s).
[0m15:46:02.595902 [debug] [MainThread]: Command end result
[0m15:46:02.616147 [info ] [MainThread]: 
[0m15:46:02.616431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:02.616595 [info ] [MainThread]: 
[0m15:46:02.616744 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m15:46:02.618656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 39.295235, "process_user_time": 4.005452, "process_kernel_time": 1.215587, "process_mem_max_rss": "201179136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:46:02.618918 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:02.618877 after 39.30 seconds
[0m15:46:02.619104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030c4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030c4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10302e790>]}
[0m15:46:02.619271 [debug] [MainThread]: Flushing usage events
[0m15:48:48.281704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c93f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cdcc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cebfd0>]}


============================== 15:48:48.284649 | 7bb719c0-62f6-43f3-a79b-487abed482c5 ==============================
[0m15:48:48.284649 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:48:48.285080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'send_anonymous_usage_stats': 'True'}
[0m15:48:49.004930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd1310>]}
[0m15:48:49.027978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117430d0>]}
[0m15:48:49.028586 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:48:49.043316 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:48:49.107542 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:48:49.107875 [debug] [MainThread]: previous checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, current checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d
[0m15:48:49.108035 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:48:49.108204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110096410>]}
[0m15:48:49.545792 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:48:49.556030 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:48:49.561597 [info ] [MainThread]: import_crm: 
[0m15:48:49.736613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14473e2d0>]}
[0m15:48:49.787816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fa5410>]}
[0m15:48:49.788134 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:48:49.788358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144de3810>]}
[0m15:48:49.789635 [info ] [MainThread]: 
[0m15:48:49.789928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:48:49.792818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:48:49.793108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:48:49.799221 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:48:49.800340 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:48:49.800514 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:48:49.800679 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:48:49.800834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:49.800976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:50.717459 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:48:50.717828 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:48:50.718678 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:48:50.719361 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:48:50.876320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now create_PROJECT_SEC2_DB_vars)
[0m15:48:50.876654 [debug] [ThreadPool]: Creating schema "database: "PROJECT_SEC2_DB"
schema: "vars"
"
[0m15:48:50.879153 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_SEC2_DB_vars"
[0m15:48:50.879334 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_vars: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "create_PROJECT_SEC2_DB_vars"} */
create schema if not exists PROJECT_SEC2_DB.vars
[0m15:48:50.879472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:51.388784 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:51.389377 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_vars: Close
[0m15:48:51.516742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:48:51.518572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PROJECT_SEC2_DB_vars, now list_PROJECT_SEC2_DB_vars)
[0m15:48:51.521454 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:48:51.521724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:48:51.522774 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_vars"
[0m15:48:51.522960 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:48:51.523908 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:48:51.524066 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_vars"} */
show objects in PROJECT_SEC2_DB.vars limit 10000
[0m15:48:51.524206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:51.524355 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:48:51.524508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:51.525209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:51.949996 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:48:51.950332 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:48:51.951255 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:48:51.951885 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars: Close
[0m15:48:52.000441 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:48:52.001668 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:48:52.135547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f19bd0>]}
[0m15:48:52.135883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:52.136052 [info ] [MainThread]: 
[0m15:48:52.137993 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:48:52.138187 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:48:52.138451 [info ] [Thread-1 (]: 1 of 32 START sql table model vars.clean_crm_data .............................. [RUN]
[0m15:48:52.138745 [info ] [Thread-2 (]: 2 of 32 START sql table model vars.clean_device_data ........................... [RUN]
[0m15:48:52.138972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_crm_data)
[0m15:48:52.139181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_vars, now model.my_dbt_project.clean_device_data)
[0m15:48:52.139368 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:48:52.139556 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:48:52.144007 [info ] [Thread-1 (]: import_crm: 
[0m15:48:52.146081 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:48:52.145884 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:48:52.146368 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:48:52.146629 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:48:52.153107 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:48:52.161656 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:48:52.163370 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:48:52.164526 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:48:52.165442 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:48:52.165689 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.vars.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:48:52.165973 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.vars.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:48:52.166234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:48:52.166455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:53.231042 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:53.241032 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:48:53.374675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f84d10>]}
[0m15:48:53.375054 [info ] [Thread-2 (]: 2 of 32 OK created sql table model vars.clean_device_data ...................... [[32mSUCCESS 1[0m in 1.24s]
[0m15:48:53.375372 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:48:53.385103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:53.385949 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:48:53.536737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062132d0>]}
[0m15:48:53.537147 [info ] [Thread-1 (]: 1 of 32 OK created sql table model vars.clean_crm_data ......................... [[32mSUCCESS 1[0m in 1.40s]
[0m15:48:53.537461 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:48:53.537880 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:48:53.538092 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:48:53.538338 [info ] [Thread-4 (]: 3 of 32 START sql table model vars.crm_device_data ............................. [RUN]
[0m15:48:53.538631 [info ] [Thread-3 (]: 4 of 32 START sql table model vars.enriched_data ............................... [RUN]
[0m15:48:53.538926 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m15:48:53.539135 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.enriched_data)
[0m15:48:53.539306 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:48:53.539461 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:48:53.541231 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:48:53.543222 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:48:53.543576 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:48:53.543897 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:48:53.544078 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:48:53.545334 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:48:53.546533 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:48:53.547347 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:48:53.547855 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:48:53.548072 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.vars.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.vars.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.vars.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m15:48:53.548304 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.vars.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.vars.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.vars.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:48:53.548498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:48:53.548648 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:48:54.741175 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:54.742279 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m15:48:54.812998 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:54.817678 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:48:54.893517 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144faa810>]}
[0m15:48:54.895190 [info ] [Thread-3 (]: 4 of 32 OK created sql table model vars.enriched_data .......................... [[32mSUCCESS 1[0m in 1.35s]
[0m15:48:54.895828 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:48:54.897854 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:48:54.899287 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:48:54.899866 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:48:54.898970 [info ] [Thread-1 (]: 5 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m15:48:54.900420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m15:48:54.899548 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m15:48:54.901410 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:48:54.900075 [info ] [Thread-3 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m15:48:54.902965 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m15:48:54.908266 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:48:54.908605 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:48:54.908812 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:48:54.909051 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:48:54.910805 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:48:54.912787 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:48:54.913002 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:48:54.927179 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m15:48:54.927599 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:48:54.928020 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:48:54.930125 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:48:54.932842 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:48:54.933777 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m15:48:54.934259 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.vars.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.vars.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m15:48:54.934568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:54.934979 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m15:48:54.935323 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:48:54.935590 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m15:48:54.936215 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m15:48:54.936684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:48:54.936937 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:48:54.981123 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14755afd0>]}
[0m15:48:54.982327 [info ] [Thread-4 (]: 3 of 32 OK created sql table model vars.crm_device_data ........................ [[32mSUCCESS 1[0m in 1.44s]
[0m15:48:54.983207 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:48:54.983801 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:48:54.984436 [info ] [Thread-4 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m15:48:54.985130 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:48:54.985614 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:48:55.002604 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:48:55.007914 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:48:55.022501 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:48:55.026799 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:48:55.029906 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m15:48:55.030612 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:48:55.587593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:55.587953 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:55.590181 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m15:48:55.590958 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m15:48:55.595221 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:55.596377 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m15:48:55.737400 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:55.738528 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m15:48:55.768804 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aaebd0>]}
[0m15:48:55.769071 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f7850>]}
[0m15:48:55.769324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15404c510>]}
[0m15:48:55.769662 [info ] [Thread-3 (]: 7 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.86s]
[0m15:48:55.769967 [info ] [Thread-2 (]: 6 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.87s]
[0m15:48:55.770270 [info ] [Thread-1 (]: 5 of 32 OK created sql view model GOLD_LAYER.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.87s]
[0m15:48:55.770594 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:48:55.770844 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:48:55.771083 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:48:55.771299 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:48:55.771522 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:48:55.771738 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:48:55.771977 [info ] [Thread-3 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m15:48:55.772195 [info ] [Thread-2 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ............... [RUN]
[0m15:48:55.772440 [info ] [Thread-1 (]: 11 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m15:48:55.772697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:48:55.772884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_os_overall)
[0m15:48:55.773056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:48:55.773227 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:48:55.773390 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:48:55.773557 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:48:55.774924 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:48:55.776456 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:48:55.778556 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:48:55.779081 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:48:55.779268 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:48:55.780572 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m15:48:55.780729 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:48:55.782039 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:48:55.783354 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:48:55.783848 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m15:48:55.784049 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.vars.enriched_data
where os_name is not null
group by os_name
  );
[0m15:48:55.784278 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:48:55.784592 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m15:48:55.784933 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:48:55.785159 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m15:48:55.785654 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m15:48:55.786010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:55.786186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:48:55.863861 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154101590>]}
[0m15:48:55.864375 [info ] [Thread-4 (]: 8 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.88s]
[0m15:48:55.864737 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:48:55.864997 [debug] [Thread-4 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:48:55.865315 [info ] [Thread-4 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m15:48:55.865650 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.os_by_age_segment)
[0m15:48:55.865882 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:48:55.867717 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:48:55.868263 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:48:55.869715 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m15:48:55.870685 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m15:48:55.870913 [debug] [Thread-4 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.vars.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.vars.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m15:48:55.871108 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:48:56.318878 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:56.319894 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m15:48:56.329499 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:56.330314 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m15:48:56.351461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:56.352310 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m15:48:56.399964 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:56.400907 [debug] [Thread-4 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m15:48:56.467507 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14753fc10>]}
[0m15:48:56.467862 [info ] [Thread-3 (]: 9 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.69s]
[0m15:48:56.468142 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:48:56.468336 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:48:56.468556 [info ] [Thread-3 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m15:48:56.468759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:48:56.468922 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:48:56.470606 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:48:56.471219 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:48:56.472557 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:48:56.472819 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106724ad0>]}
[0m15:48:56.473117 [info ] [Thread-2 (]: 10 of 32 OK created sql view model GOLD_LAYER.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 0.70s]
[0m15:48:56.473564 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m15:48:56.473856 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:48:56.474036 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.vars.enriched_data
where age is not null
group by age
order by age
  );
[0m15:48:56.474253 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:48:56.474452 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:48:56.474657 [info ] [Thread-2 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m15:48:56.474918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:48:56.475100 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:48:56.477648 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:48:56.478410 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:48:56.479779 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:48:56.480351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15414fd90>]}
[0m15:48:56.480825 [info ] [Thread-1 (]: 11 of 32 OK created sql view model GOLD_LAYER.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.71s]
[0m15:48:56.481335 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:48:56.481606 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:48:56.481789 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.vars.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m15:48:56.482004 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:48:56.482235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:48:56.482489 [info ] [Thread-1 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m15:48:56.483475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:48:56.483839 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:48:56.485985 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:48:56.486538 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:48:56.489225 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:48:56.490906 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m15:48:56.491281 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m15:48:56.491500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:56.547150 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fa9850>]}
[0m15:48:56.547616 [info ] [Thread-4 (]: 12 of 32 OK created sql view model GOLD_LAYER.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.68s]
[0m15:48:56.547920 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:48:56.548149 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:48:56.548523 [info ] [Thread-4 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m15:48:56.548896 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:48:56.549426 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:48:56.551682 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:48:56.552171 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:48:56.554134 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:48:56.555176 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:48:56.555417 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.vars.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m15:48:56.555634 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:48:56.945493 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:56.946463 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m15:48:56.983529 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:56.984425 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m15:48:56.985532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:56.986363 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m15:48:57.122207 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:57.123732 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m15:48:57.124635 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147348550>]}
[0m15:48:57.125088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154119350>]}
[0m15:48:57.125321 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b8eb50>]}
[0m15:48:57.125626 [info ] [Thread-3 (]: 13 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 0.66s]
[0m15:48:57.125944 [info ] [Thread-1 (]: 15 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.64s]
[0m15:48:57.126235 [info ] [Thread-2 (]: 14 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.65s]
[0m15:48:57.126526 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:48:57.126860 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:48:57.127160 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:48:57.127507 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:48:57.127778 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:48:57.128006 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:48:57.128244 [info ] [Thread-3 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m15:48:57.128491 [info ] [Thread-1 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m15:48:57.128727 [info ] [Thread-2 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m15:48:57.128950 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:48:57.129149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:48:57.129336 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:48:57.129513 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:48:57.129704 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:48:57.129868 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:48:57.131471 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:48:57.133944 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:48:57.135248 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:48:57.135733 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:48:57.135914 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:48:57.136078 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:48:57.137425 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:48:57.138941 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:48:57.140560 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:48:57.141684 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:48:57.142076 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m15:48:57.142400 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:48:57.142606 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.vars.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m15:48:57.142810 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.vars.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m15:48:57.143007 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m15:48:57.143185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:57.143339 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:48:57.143492 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:48:57.255800 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fa9150>]}
[0m15:48:57.256228 [info ] [Thread-4 (]: 16 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.71s]
[0m15:48:57.256561 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:48:57.256793 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:48:57.257056 [info ] [Thread-4 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m15:48:57.257305 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:48:57.257483 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:48:57.258976 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:48:57.259351 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:48:57.260657 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:48:57.261125 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:48:57.261300 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.vars.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m15:48:57.261463 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:48:57.763235 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:57.764242 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m15:48:57.837925 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:57.838939 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m15:48:57.939710 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154317b10>]}
[0m15:48:57.940067 [info ] [Thread-4 (]: 20 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.68s]
[0m15:48:57.940368 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:48:57.940584 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:48:57.940814 [info ] [Thread-4 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m15:48:57.941018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_overall)
[0m15:48:57.941183 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:48:57.942737 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:48:57.943150 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:48:57.945292 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:48:57.945752 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m15:48:57.945925 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m15:48:57.946106 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:48:57.952868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:57.954042 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m15:48:57.970893 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:57.972366 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m15:48:57.972677 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154103450>]}
[0m15:48:57.973905 [info ] [Thread-3 (]: 17 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.84s]
[0m15:48:57.974676 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:48:57.974934 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:48:57.975192 [info ] [Thread-3 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m15:48:57.975441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:48:57.975613 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:48:58.029990 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:48:58.030806 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:48:58.032481 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:48:58.033274 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:48:58.034008 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m15:48:58.034311 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:48:58.101409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473638d0>]}
[0m15:48:58.101901 [info ] [Thread-1 (]: 18 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.97s]
[0m15:48:58.102335 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:48:58.102592 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:48:58.102922 [info ] [Thread-1 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m15:48:58.103223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:48:58.103416 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:48:58.104974 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:48:58.105341 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:48:58.106636 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:48:58.107120 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:48:58.107295 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.vars.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m15:48:58.107459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:58.162259 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b1b610>]}
[0m15:48:58.162672 [info ] [Thread-2 (]: 19 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 1.03s]
[0m15:48:58.162996 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:48:58.163242 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:48:58.163499 [info ] [Thread-2 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m15:48:58.163748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:48:58.163922 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:48:58.165291 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:48:58.165655 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:48:58.167069 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:48:58.167572 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:48:58.167769 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.vars.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m15:48:58.167965 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:48:58.464646 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:58.465627 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m15:48:58.553753 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:58.554677 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m15:48:58.605415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:58.606277 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m15:48:58.618804 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f71d0>]}
[0m15:48:58.619138 [info ] [Thread-4 (]: 21 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.68s]
[0m15:48:58.619455 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:48:58.619657 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:48:58.619893 [info ] [Thread-4 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m15:48:58.620098 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:48:58.620264 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:48:58.622390 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:48:58.622781 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:48:58.624068 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:48:58.624522 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:48:58.624700 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m15:48:58.624864 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:48:58.655803 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:58.657275 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m15:48:58.687222 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fe3f50>]}
[0m15:48:58.760176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147329a10>]}
[0m15:48:58.789124 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147488e50>]}
[0m15:48:59.167656 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:48:59.168668 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m15:48:59.295836 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473f7410>]}
[0m15:49:00.301424 [info ] [Thread-3 (]: 22 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.71s]
[0m15:49:00.301765 [info ] [Thread-1 (]: 23 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.66s]
[0m15:49:00.302480 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:49:00.302036 [info ] [Thread-2 (]: 24 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.63s]
[0m15:49:00.302703 [info ] [Thread-4 (]: 25 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.68s]
[0m15:49:00.303067 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:49:00.303279 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:49:00.303551 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:49:00.303780 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:49:00.303966 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:49:00.304188 [info ] [Thread-3 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m15:49:00.304406 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:49:00.304598 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:49:00.304816 [info ] [Thread-1 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m15:49:00.305089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:49:00.305295 [info ] [Thread-2 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m15:49:00.305511 [info ] [Thread-4 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m15:49:00.305710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:49:00.305878 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:49:00.306040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:49:00.306200 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:49:00.306354 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:49:00.307807 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:49:00.308296 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:49:00.308454 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:49:00.309833 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:49:00.311279 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:49:00.312774 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:49:00.313107 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:49:00.313350 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:49:00.314763 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:49:00.314930 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:49:00.316286 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m15:49:00.316448 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:49:00.317713 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m15:49:00.318146 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:49:00.319370 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m15:49:00.319915 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m15:49:00.320114 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.vars.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m15:49:00.320843 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m15:49:00.321087 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.vars.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.vars.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m15:49:00.321620 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m15:49:00.321782 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:49:00.321982 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.vars.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.vars.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m15:49:00.322181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:00.322357 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.vars.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.vars.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m15:49:00.323550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:00.327733 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:49:00.911156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:49:00.911504 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:49:00.912495 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: Close
[0m15:49:00.913304 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_overall: Close
[0m15:49:00.979866 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:49:00.980810 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m15:49:01.014253 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:49:01.015492 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m15:49:01.051191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11004c390>]}
[0m15:49:01.051459 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c92150>]}
[0m15:49:01.051807 [info ] [Thread-1 (]: 27 of 32 OK created sql view model GOLD_LAYER.total_customers_overall .......... [[32mSUCCESS 1[0m in 0.75s]
[0m15:49:01.052125 [info ] [Thread-4 (]: 29 of 32 OK created sql view model GOLD_LAYER.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.75s]
[0m15:49:01.052446 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:49:01.052706 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:49:01.052923 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:49:01.053132 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:49:01.053357 [info ] [Thread-1 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m15:49:01.053608 [info ] [Thread-4 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m15:49:01.053844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.total_devices_week_wise)
[0m15:49:01.054048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:49:01.054245 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:49:01.054439 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:49:01.055976 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:49:01.057422 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:49:01.057984 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:49:01.058145 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:49:01.059544 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m15:49:01.060815 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:49:01.061610 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m15:49:01.061953 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:49:01.062156 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.vars.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.vars.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m15:49:01.062368 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.vars.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m15:49:01.062555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:01.062715 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:49:01.158807 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d3ca50>]}
[0m15:49:01.159247 [info ] [Thread-2 (]: 28 of 32 OK created sql view model GOLD_LAYER.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 0.85s]
[0m15:49:01.159540 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:49:01.159741 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:49:01.159965 [info ] [Thread-2 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m15:49:01.160168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:49:01.160411 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:49:01.161956 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:49:01.162356 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:49:01.163667 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:49:01.164150 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m15:49:01.164333 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.vars.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m15:49:01.164493 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:01.618406 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:49:01.619459 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m15:49:01.829101 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14738ff50>]}
[0m15:49:01.829564 [info ] [Thread-3 (]: 26 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 1.52s]
[0m15:49:01.829900 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:49:01.882222 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1449346d0>]}
[0m15:49:01.882646 [info ] [Thread-4 (]: 31 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 0.83s]
[0m15:49:01.882933 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:49:02.038322 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:49:02.039308 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m15:49:02.182928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:49:02.183868 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m15:49:02.185512 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f85010>]}
[0m15:49:02.185837 [info ] [Thread-2 (]: 32 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 1.03s]
[0m15:49:02.186118 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:49:02.343002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb719c0-62f6-43f3-a79b-487abed482c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774a710>]}
[0m15:49:02.343406 [info ] [Thread-1 (]: 30 of 32 OK created sql view model GOLD_LAYER.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 1.29s]
[0m15:49:02.343732 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:49:02.344530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:02.344704 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m15:49:02.344833 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:49:02.344948 [debug] [MainThread]: Connection 'model.my_dbt_project.revenue_by_value_segment_week_wise' was properly closed.
[0m15:49:02.345062 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:49:02.345256 [info ] [MainThread]: 
[0m15:49:02.345439 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 12.56 seconds (12.56s).
[0m15:49:02.347170 [debug] [MainThread]: Command end result
[0m15:49:02.365052 [info ] [MainThread]: 
[0m15:49:02.365317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:02.365484 [info ] [MainThread]: 
[0m15:49:02.365632 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m15:49:02.367501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.115966, "process_user_time": 3.936165, "process_kernel_time": 1.391669, "process_mem_max_rss": "207011840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:49:02.367747 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:02.367707 after 14.12 seconds
[0m15:49:02.367922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105551690>]}
[0m15:49:02.368084 [debug] [MainThread]: Flushing usage events
[0m15:49:43.959202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c4e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110caffd0>]}


============================== 15:49:43.962097 | 0cb52606-a8cc-4a70-a978-b2a1ba3dadb5 ==============================
[0m15:49:43.962097 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:49:43.962419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'send_anonymous_usage_stats': 'True'}
[0m15:49:44.718829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb52606-a8cc-4a70-a978-b2a1ba3dadb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ba6d0>]}
[0m15:49:44.741017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb52606-a8cc-4a70-a978-b2a1ba3dadb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11043b190>]}
[0m15:49:44.741637 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:49:44.754499 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:49:44.821511 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:49:44.821940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cb52606-a8cc-4a70-a978-b2a1ba3dadb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bbd10>]}
[0m15:49:45.278855 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:49:45.288545 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:49:45.293829 [info ] [MainThread]: import_crm: 
[0m15:49:45.477909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb52606-a8cc-4a70-a978-b2a1ba3dadb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b459d0>]}
[0m15:49:45.529718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb52606-a8cc-4a70-a978-b2a1ba3dadb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ea5bd0>]}
[0m15:49:45.530018 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:49:45.530210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb52606-a8cc-4a70-a978-b2a1ba3dadb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144cbb2d0>]}
[0m15:49:45.531429 [info ] [MainThread]: 
[0m15:49:45.531723 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:49:45.534506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:49:45.534756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:49:45.540906 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:49:45.541937 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:49:45.542138 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:49:45.542323 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:49:45.542473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:45.542607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:46.142994 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m15:49:46.143942 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:49:46.172003 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m15:49:46.172716 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:49:46.371032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now create_PROJECT_SEC2_DB_vars.unit_testing)
[0m15:49:46.371358 [debug] [ThreadPool]: Creating schema "database: "PROJECT_SEC2_DB"
schema: "vars.unit_testing"
"
[0m15:49:46.373854 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_SEC2_DB_vars.unit_testing"
[0m15:49:46.374033 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_vars.unit_testing: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "create_PROJECT_SEC2_DB_vars.unit_testing"} */
create schema if not exists PROJECT_SEC2_DB.vars.unit_testing
[0m15:49:46.374173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:46.788894 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b4e44b-3201-1b5c-0008-eb7e000479de
[0m15:49:46.789132 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:49:46.789343 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m15:49:46.789477 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:49:46.789623 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_vars.unit_testing: Close
[0m15:49:46.988455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:46.988683 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB' was properly closed.
[0m15:49:46.988812 [debug] [MainThread]: Connection 'create_PROJECT_SEC2_DB_vars.unit_testing' was properly closed.
[0m15:49:46.988959 [info ] [MainThread]: 
[0m15:49:46.989121 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m15:49:46.989422 [error] [MainThread]: Encountered an error:
Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.
[0m15:49:46.992024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0615861, "process_user_time": 2.497386, "process_kernel_time": 1.287902, "process_mem_max_rss": "198688768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:49:46.992306 [debug] [MainThread]: Command `dbt run` failed at 15:49:46.992263 after 3.06 seconds
[0m15:49:46.992501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cd4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cafb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e86a50>]}
[0m15:49:46.992683 [debug] [MainThread]: Flushing usage events
[0m15:52:54.145473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104baff90>]}


============================== 15:52:54.148463 | 9ef13aac-fc71-4c23-97fd-829a8390a594 ==============================
[0m15:52:54.148463 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:52:54.148807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:55.040461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136fbc4d0>]}
[0m15:52:55.063476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104243110>]}
[0m15:52:55.064000 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:52:55.076359 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:52:55.147523 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:52:55.147945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10367e710>]}
[0m15:52:55.611840 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:52:55.621546 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:52:55.626967 [info ] [MainThread]: import_crm: 
[0m15:52:55.805817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137084a10>]}
[0m15:52:55.859343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379f7f10>]}
[0m15:52:55.859667 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 448 macros
[0m15:52:55.859863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137861650>]}
[0m15:52:55.861049 [info ] [MainThread]: 
[0m15:52:55.861343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:52:55.864033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:52:55.864318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:52:55.871009 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:52:55.871258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:52:55.872397 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:52:55.872584 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:52:55.873624 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:52:55.873804 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:52:55.873978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:55.874152 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:52:55.874315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:55.874537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:56.467045 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m15:52:56.467477 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m15:52:56.468456 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:52:56.469402 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:52:56.474733 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m15:52:56.475579 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:52:56.637604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now create_PROJECT_SEC2_DB_aman)
[0m15:52:56.637948 [debug] [ThreadPool]: Creating schema "database: "PROJECT_SEC2_DB"
schema: "aman"
"
[0m15:52:56.640467 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_SEC2_DB_aman"
[0m15:52:56.640642 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_aman: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "create_PROJECT_SEC2_DB_aman"} */
create schema if not exists PROJECT_SEC2_DB.aman
[0m15:52:56.640787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:57.062152 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:52:57.062780 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_aman: Close
[0m15:52:57.244221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:52:57.244557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PROJECT_SEC2_DB_aman, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m15:52:57.244870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_vars)
[0m15:52:57.245465 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_aman'
[0m15:52:57.249041 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:52:57.250140 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m15:52:57.251089 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_vars"
[0m15:52:57.252037 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_aman"
[0m15:52:57.252206 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:52:57.252369 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m15:52:57.252528 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_vars"} */
show objects in PROJECT_SEC2_DB.vars limit 10000
[0m15:52:57.252675 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_aman: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_aman"} */
show objects in PROJECT_SEC2_DB.aman limit 10000
[0m15:52:57.252804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:57.252946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:57.253073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:57.253207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:57.756856 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:52:57.757696 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_aman: Close
[0m15:52:57.763770 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:52:57.764564 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_vars: Close
[0m15:52:57.774434 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:52:57.775227 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:52:57.831905 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:52:57.833187 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m15:52:57.992655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5fc50>]}
[0m15:52:57.993011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:57.993185 [info ] [MainThread]: 
[0m15:52:57.994552 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:52:57.994741 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:52:57.995019 [info ] [Thread-1 (]: 1 of 32 START sql table model aman.clean_crm_data .............................. [RUN]
[0m15:52:57.995291 [info ] [Thread-2 (]: 2 of 32 START sql table model vars.clean_device_data ........................... [RUN]
[0m15:52:57.995544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m15:52:57.995750 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_device_data)
[0m15:52:57.995933 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:52:57.996098 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:52:58.000581 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:52:58.002538 [info ] [Thread-1 (]: import_crm: 
[0m15:52:58.002805 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:52:58.003014 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:52:58.003432 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:52:58.010247 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:52:58.021761 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:52:58.023216 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:52:58.024486 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:52:58.025366 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:52:58.025745 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.aman.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql





WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:52:58.026097 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.vars.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:52:58.026552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:58.026784 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:52:59.050057 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:52:59.060534 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:52:59.207944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13775d2d0>]}
[0m15:52:59.208347 [info ] [Thread-2 (]: 2 of 32 OK created sql table model vars.clean_device_data ...................... [[32mSUCCESS 1[0m in 1.21s]
[0m15:52:59.208681 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:52:59.237882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:52:59.238811 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:52:59.367766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137862b50>]}
[0m15:52:59.368224 [info ] [Thread-1 (]: 1 of 32 OK created sql table model aman.clean_crm_data ......................... [[32mSUCCESS 1[0m in 1.37s]
[0m15:52:59.368503 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:52:59.368892 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:52:59.369364 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:52:59.369199 [info ] [Thread-4 (]: 3 of 32 START sql table model vars.crm_device_data ............................. [RUN]
[0m15:52:59.369729 [info ] [Thread-3 (]: 4 of 32 START sql table model vars.enriched_data ............................... [RUN]
[0m15:52:59.369978 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_aman, now model.my_dbt_project.crm_device_data)
[0m15:52:59.370198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_vars, now model.my_dbt_project.enriched_data)
[0m15:52:59.370367 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:52:59.370526 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:52:59.372068 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:52:59.374135 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:52:59.374578 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:52:59.374859 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:52:59.376195 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:52:59.376387 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:52:59.377820 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:52:59.378839 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:52:59.379132 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.vars.crm_device_data
         as
        (-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.aman.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.vars.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:52:59.379400 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:52:59.380161 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:52:59.380595 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.vars.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.vars.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.aman.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m15:52:59.381547 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:00.536215 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:00.537318 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:53:00.560707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:00.561551 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m15:53:00.668739 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ae3490>]}
[0m15:53:00.669145 [info ] [Thread-4 (]: 3 of 32 OK created sql table model vars.crm_device_data ........................ [[32mSUCCESS 1[0m in 1.30s]
[0m15:53:00.669432 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:53:00.694477 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a6ba10>]}
[0m15:53:00.694846 [info ] [Thread-3 (]: 4 of 32 OK created sql table model vars.enriched_data .......................... [[32mSUCCESS 1[0m in 1.32s]
[0m15:53:00.695151 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:53:00.696156 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:53:00.696692 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:53:00.696478 [info ] [Thread-1 (]: 5 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m15:53:00.696973 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:53:00.697186 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:53:00.697473 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m15:53:00.697779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m15:53:00.698055 [info ] [Thread-4 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m15:53:00.698632 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m15:53:00.698357 [info ] [Thread-3 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m15:53:00.698937 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:53:00.699158 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:53:00.699345 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:53:00.699532 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:53:00.699963 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:53:00.701553 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:53:00.703669 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:53:00.703870 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:53:00.705143 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:53:00.706472 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:53:00.706830 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:53:00.706976 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:53:00.707214 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:53:00.719394 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m15:53:00.719743 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:53:00.721180 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:53:00.722611 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:53:00.724430 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:53:00.725315 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m15:53:00.725739 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m15:53:00.726044 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.vars.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.vars.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m15:53:00.726374 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m15:53:00.727011 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:53:00.727606 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:53:00.728011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:00.728392 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:00.728776 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m15:53:00.729466 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m15:53:00.731342 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:00.732160 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:01.255910 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:01.257013 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m15:53:01.297233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:01.298081 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m15:53:01.304707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:01.304995 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:01.305826 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m15:53:01.306632 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m15:53:01.401106 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379bc5d0>]}
[0m15:53:01.401549 [info ] [Thread-2 (]: 6 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.70s]
[0m15:53:01.401914 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:53:01.402142 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:53:01.402508 [info ] [Thread-2 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m15:53:01.403018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:53:01.403521 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:53:01.405319 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:53:01.405835 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:53:01.408177 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:53:01.408738 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:53:01.408923 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m15:53:01.409090 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:01.487109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e75290>]}
[0m15:53:01.487404 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e75cd0>]}
[0m15:53:01.487650 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e77b50>]}
[0m15:53:01.488006 [info ] [Thread-1 (]: 5 of 32 OK created sql view model GOLD_LAYER.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.79s]
[0m15:53:01.488311 [info ] [Thread-3 (]: 8 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.79s]
[0m15:53:01.488800 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:53:01.488531 [info ] [Thread-4 (]: 7 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.79s]
[0m15:53:01.489077 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:53:01.489272 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:53:01.489551 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:53:01.489766 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:53:01.490024 [info ] [Thread-1 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ............... [RUN]
[0m15:53:01.490266 [debug] [Thread-4 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:53:01.490506 [info ] [Thread-3 (]: 11 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m15:53:01.490725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m15:53:01.490957 [info ] [Thread-4 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m15:53:01.491163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:53:01.491335 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:53:01.491510 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.os_by_age_segment)
[0m15:53:01.491710 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:53:01.493067 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:53:01.493242 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:53:01.494825 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:53:01.496342 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:53:01.496723 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:53:01.496883 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:53:01.498253 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m15:53:01.499570 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:53:01.499749 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:53:01.501124 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m15:53:01.501536 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m15:53:01.501776 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.vars.enriched_data
where os_name is not null
group by os_name
  );
[0m15:53:01.502116 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m15:53:01.502819 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m15:53:01.502980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:01.503154 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.vars.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m15:53:01.503375 [debug] [Thread-4 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.vars.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.vars.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m15:53:01.503605 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:01.504049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:01.919231 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:01.921008 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m15:53:02.015724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:02.016153 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:02.017028 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m15:53:02.017941 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m15:53:02.036834 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:02.037823 [debug] [Thread-4 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m15:53:02.118062 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d745d0>]}
[0m15:53:02.118604 [info ] [Thread-2 (]: 9 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.72s]
[0m15:53:02.119230 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:53:02.119543 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:53:02.119943 [info ] [Thread-2 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m15:53:02.120208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:53:02.120388 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:53:02.122068 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:53:02.122558 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:53:02.126372 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:53:02.127064 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m15:53:02.127259 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.vars.enriched_data
where age is not null
group by age
order by age
  );
[0m15:53:02.127426 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:02.158236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137daea50>]}
[0m15:53:02.158537 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d3eed0>]}
[0m15:53:02.158963 [info ] [Thread-1 (]: 10 of 32 OK created sql view model GOLD_LAYER.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 0.67s]
[0m15:53:02.159404 [info ] [Thread-3 (]: 11 of 32 OK created sql view model GOLD_LAYER.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.67s]
[0m15:53:02.159771 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:53:02.160105 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:53:02.160493 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:53:02.160871 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:53:02.161201 [info ] [Thread-1 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m15:53:02.161499 [info ] [Thread-3 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m15:53:02.161910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:53:02.162134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:53:02.162336 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:53:02.162510 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:53:02.163918 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:53:02.165245 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:53:02.165656 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:53:02.167168 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:53:02.167422 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:53:02.168669 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:53:02.169087 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:53:02.169278 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.vars.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m15:53:02.169453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:02.169822 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m15:53:02.170288 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m15:53:02.170660 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:02.201648 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d63e10>]}
[0m15:53:02.202091 [info ] [Thread-4 (]: 12 of 32 OK created sql view model GOLD_LAYER.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.71s]
[0m15:53:02.202367 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:53:02.202565 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:53:02.202763 [info ] [Thread-4 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m15:53:02.203031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:53:02.203221 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:53:02.204728 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:53:02.205095 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:53:02.206408 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:53:02.206897 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:53:02.207075 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.vars.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m15:53:02.207239 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:02.628697 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:02.629681 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m15:53:02.668074 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:53:02.668376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:53:02.669214 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m15:53:02.669963 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m15:53:02.679393 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:53:02.680133 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m15:53:02.769733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137990210>]}
[0m15:53:02.770119 [info ] [Thread-2 (]: 13 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 0.65s]
[0m15:53:02.770423 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:53:02.770644 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:53:02.770882 [info ] [Thread-2 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m15:53:02.771109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:53:02.771274 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:53:02.772841 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:53:02.773214 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:53:02.775340 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:53:02.775817 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m15:53:02.775992 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.vars.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m15:53:02.776155 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:02.842072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d6c5d0>]}
[0m15:53:02.842542 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e8e250>]}
[0m15:53:02.842789 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379b44d0>]}
[0m15:53:02.843172 [info ] [Thread-1 (]: 14 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.68s]
[0m15:53:02.843493 [info ] [Thread-4 (]: 16 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.64s]
[0m15:53:02.844030 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:53:02.843762 [info ] [Thread-3 (]: 15 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.68s]
[0m15:53:02.844315 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:53:02.844528 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:53:02.844801 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:53:02.845002 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:53:02.845227 [info ] [Thread-1 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m15:53:02.845454 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:53:02.845885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:53:02.845681 [info ] [Thread-4 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m15:53:02.846169 [info ] [Thread-3 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m15:53:02.846397 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:53:02.846589 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:53:02.846759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:53:02.848285 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:53:02.848465 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:53:02.848640 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:53:02.850523 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:53:02.853208 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:53:02.853653 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:53:02.855648 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:53:02.856107 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:53:02.856305 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:53:02.858055 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:53:02.858775 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:53:02.860614 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:53:02.861146 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.vars.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m15:53:02.861850 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:53:02.862270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:02.863170 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:53:02.863608 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.vars.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m15:53:02.864149 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m15:53:02.864771 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:02.865471 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:03.293860 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:03.294904 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m15:53:03.380455 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:03.381389 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m15:53:03.398943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:03.399796 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m15:53:03.449450 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:03.450519 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m15:53:03.450800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a4ffd0>]}
[0m15:53:03.451584 [info ] [Thread-2 (]: 17 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.68s]
[0m15:53:03.452128 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:53:03.452492 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:53:03.452881 [info ] [Thread-2 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m15:53:03.453308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:53:03.453543 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:53:03.455133 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:53:03.455526 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:53:03.457720 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:53:03.458200 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m15:53:03.458406 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m15:53:03.458615 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:03.517189 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e33dd0>]}
[0m15:53:03.517588 [info ] [Thread-3 (]: 20 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.67s]
[0m15:53:03.517873 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:53:03.518068 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:53:03.518294 [info ] [Thread-3 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m15:53:03.518491 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:53:03.518649 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:53:03.520093 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:53:03.520442 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:53:03.521691 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:53:03.522142 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:53:03.522320 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m15:53:03.522477 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:03.529190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e82010>]}
[0m15:53:03.529602 [info ] [Thread-1 (]: 18 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.68s]
[0m15:53:03.529881 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:53:03.530145 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:53:03.530415 [info ] [Thread-1 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m15:53:03.530647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:53:03.530812 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:53:03.532521 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:53:03.532986 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:53:03.534649 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:53:03.535355 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:53:03.535541 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.vars.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m15:53:03.535753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:03.587555 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376c2490>]}
[0m15:53:03.588119 [info ] [Thread-4 (]: 19 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.74s]
[0m15:53:03.588538 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:53:03.588782 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:53:03.589068 [info ] [Thread-4 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m15:53:03.589337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:53:03.589657 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:53:03.591530 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:53:03.592054 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:53:03.593694 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:53:03.594201 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:53:03.594396 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.vars.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m15:53:03.594777 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:04.055000 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:04.055498 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:04.055801 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:53:04.056762 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m15:53:04.057556 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m15:53:04.058365 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m15:53:04.063125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:04.064220 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m15:53:04.195382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032e6710>]}
[0m15:53:04.195679 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fd9650>]}
[0m15:53:04.195921 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13782d850>]}
[0m15:53:04.196132 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f5ed0>]}
[0m15:53:04.196468 [info ] [Thread-1 (]: 23 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.66s]
[0m15:53:04.197292 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:53:04.197514 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:53:04.197808 [info ] [Thread-1 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m15:53:04.198049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:53:04.198230 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:53:04.200418 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:53:04.201031 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:53:04.202420 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:53:04.202912 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:53:04.203094 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.vars.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m15:53:04.203335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:04.706800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:04.707867 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m15:53:04.885610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b4c50>]}
[0m15:53:05.806638 [info ] [Thread-3 (]: 22 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.68s]
[0m15:53:05.806917 [info ] [Thread-4 (]: 24 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.61s]
[0m15:53:05.807192 [info ] [Thread-2 (]: 21 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.74s]
[0m15:53:05.807405 [info ] [Thread-1 (]: 25 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.69s]
[0m15:53:05.807834 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:53:05.808077 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:53:05.808347 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:53:05.808585 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:53:05.808805 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:53:05.809028 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:53:05.809257 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:53:05.809463 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:53:05.809712 [info ] [Thread-3 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m15:53:05.809921 [info ] [Thread-4 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m15:53:05.810177 [info ] [Thread-2 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m15:53:05.810457 [info ] [Thread-1 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m15:53:05.810752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:53:05.810944 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:53:05.811135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.total_customers_week_wise)
[0m15:53:05.811340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:53:05.811526 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:53:05.811692 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:53:05.811938 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:53:05.812108 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:53:05.813546 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:53:05.815095 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:53:05.816492 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:53:05.817994 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:53:05.818562 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:53:05.818777 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:53:05.818934 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:53:05.820324 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:53:05.820496 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:53:05.821800 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m15:53:05.822997 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m15:53:05.824198 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m15:53:05.824703 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:53:05.825289 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m15:53:05.825852 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m15:53:05.826028 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.vars.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m15:53:05.826235 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.vars.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.vars.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m15:53:05.826477 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.vars.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.vars.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m15:53:05.826676 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:05.827154 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m15:53:05.827324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:05.827496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:05.827739 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.vars.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.vars.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m15:53:05.829728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:06.418402 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:06.419116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:06.419409 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:06.420343 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_overall: Close
[0m15:53:06.420799 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:06.421585 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: Close
[0m15:53:06.422318 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m15:53:06.423533 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m15:53:06.571401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1317175d0>]}
[0m15:53:06.573281 [info ] [Thread-1 (]: 29 of 32 OK created sql view model GOLD_LAYER.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.76s]
[0m15:53:06.573749 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:53:06.575486 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376e7950>]}
[0m15:53:06.577039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376e69d0>]}
[0m15:53:06.577277 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:53:06.577820 [info ] [Thread-4 (]: 27 of 32 OK created sql view model GOLD_LAYER.total_customers_overall .......... [[32mSUCCESS 1[0m in 0.76s]
[0m15:53:06.580317 [info ] [Thread-3 (]: 26 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.77s]
[0m15:53:06.580656 [info ] [Thread-1 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m15:53:06.581121 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:53:06.581404 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f84d90>]}
[0m15:53:06.581660 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:53:06.581874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.total_devices_week_wise)
[0m15:53:06.582145 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:53:06.582469 [info ] [Thread-2 (]: 28 of 32 OK created sql view model GOLD_LAYER.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 0.77s]
[0m15:53:06.582703 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:53:06.582870 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:53:06.583177 [info ] [Thread-4 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m15:53:06.583538 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:53:06.583815 [info ] [Thread-3 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m15:53:06.586309 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:53:06.588236 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:53:06.592312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:53:06.595618 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:53:06.598175 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:53:06.599922 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:53:06.600115 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:53:06.603224 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:53:06.606726 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m15:53:06.607062 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:53:06.608399 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:53:06.608572 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:53:06.610548 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:53:06.611460 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m15:53:06.611790 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.vars.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.vars.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m15:53:06.612172 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:53:06.612374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:06.612703 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m15:53:06.612889 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.vars.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m15:53:06.613131 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.vars.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m15:53:06.613815 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:06.614006 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:07.179615 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:07.180615 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m15:53:07.197441 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:07.198311 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m15:53:07.208795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:07.209636 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m15:53:07.307199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6e390>]}
[0m15:53:07.307602 [info ] [Thread-4 (]: 31 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 0.72s]
[0m15:53:07.307909 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:53:07.339735 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424a110>]}
[0m15:53:07.340147 [info ] [Thread-3 (]: 32 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 0.75s]
[0m15:53:07.340465 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:53:07.341936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef13aac-fc71-4c23-97fd-829a8390a594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137780950>]}
[0m15:53:07.342241 [info ] [Thread-1 (]: 30 of 32 OK created sql view model GOLD_LAYER.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 0.76s]
[0m15:53:07.342639 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:53:07.344104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:07.344371 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m15:53:07.344512 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_week_wise' was properly closed.
[0m15:53:07.344631 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:53:07.344745 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:53:07.344960 [info ] [MainThread]: 
[0m15:53:07.345126 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 11.48 seconds (11.48s).
[0m15:53:07.347135 [debug] [MainThread]: Command end result
[0m15:53:07.366688 [info ] [MainThread]: 
[0m15:53:07.366968 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:07.367134 [info ] [MainThread]: 
[0m15:53:07.367280 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m15:53:07.369097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.194198, "process_user_time": 4.10505, "process_kernel_time": 1.313592, "process_mem_max_rss": "205422592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:53:07.369371 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:07.369329 after 13.19 seconds
[0m15:53:07.369561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c14710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b46250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b4c50>]}
[0m15:53:07.369726 [debug] [MainThread]: Flushing usage events
[0m16:00:02.225172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110692a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110692f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ebf90>]}


============================== 16:00:02.228092 | 21d78902-a05d-40a8-a40c-169104ebd184 ==============================
[0m16:00:02.228092 [info ] [MainThread]: Running with dbt=1.8.1
[0m16:00:02.228419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --vars {"unit_testing": true} --models models/silver/clean_crm_data.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:03.130071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21d78902-a05d-40a8-a40c-169104ebd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436d3150>]}
[0m16:00:03.153499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21d78902-a05d-40a8-a40c-169104ebd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11013f190>]}
[0m16:00:03.154087 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:00:03.166262 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m16:00:03.236619 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:00:03.237043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21d78902-a05d-40a8-a40c-169104ebd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738e890>]}
[0m16:00:03.695851 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m16:00:03.705241 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m16:00:03.712384 [info ] [MainThread]: import_crm: 
[0m16:00:03.891432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21d78902-a05d-40a8-a40c-169104ebd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1467a7cd0>]}
[0m16:00:03.944127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21d78902-a05d-40a8-a40c-169104ebd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146ff7ed0>]}
[0m16:00:03.944442 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m16:00:03.944637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d78902-a05d-40a8-a40c-169104ebd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a77b50>]}
[0m16:00:03.945685 [info ] [MainThread]: 
[0m16:00:03.945998 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:03.946472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:00:03.953137 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:00:03.953354 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:00:03.953496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:04.608776 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:00:04.609746 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:00:04.815131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now create_PROJECT_SEC2_DB_test_silver_layer)
[0m16:00:04.815472 [debug] [ThreadPool]: Creating schema "database: "PROJECT_SEC2_DB"
schema: "test_silver_layer"
"
[0m16:00:04.818142 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_SEC2_DB_test_silver_layer"
[0m16:00:04.818333 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "create_PROJECT_SEC2_DB_test_silver_layer"} */
create schema if not exists PROJECT_SEC2_DB.test_silver_layer
[0m16:00:04.818491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:05.276776 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:00:05.277454 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_test_silver_layer: Close
[0m16:00:05.432514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PROJECT_SEC2_DB_test_silver_layer, now list_PROJECT_SEC2_DB_None)
[0m16:00:05.432883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_test_silver_layer'
[0m16:00:05.433531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m16:00:05.437197 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_None"
[0m16:00:05.437473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_GOLD_LAYER'
[0m16:00:05.438455 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m16:00:05.439978 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m16:00:05.440176 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_None: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_None"} */
show objects in PROJECT_SEC2_DB.None limit 10000
[0m16:00:05.441282 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m16:00:05.441471 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m16:00:05.441648 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m16:00:05.441795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:05.441944 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m16:00:05.442086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.442215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.442405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.943056 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m16:00:05.943887 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m16:00:05.962331 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:00:05.963133 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m16:00:05.995601 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b4e456-3201-1b5c-0008-eb7e00047a8e
[0m16:00:05.995802 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:00:05.996016 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:00:05.996150 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:00:05.996307 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_None: Close
[0m16:00:06.005394 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m16:00:06.006798 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m16:00:06.151214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d78902-a05d-40a8-a40c-169104ebd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146ccd290>]}
[0m16:00:06.151564 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:06.151732 [info ] [MainThread]: 
[0m16:00:06.153660 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m16:00:06.153926 [info ] [Thread-1 (]: 1 of 1 START sql table model test_silver_layer.clean_crm_data .................. [RUN]
[0m16:00:06.154146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_None, now model.my_dbt_project.clean_crm_data)
[0m16:00:06.154312 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m16:00:06.159471 [info ] [Thread-1 (]: import_crm: 
[0m16:00:06.159846 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m16:00:06.160286 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m16:00:06.174616 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m16:00:06.176067 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m16:00:06.176341 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql





WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m16:00:06.176559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:08.503810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:00:08.513696 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m16:00:09.528000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21d78902-a05d-40a8-a40c-169104ebd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e4ea90>]}
[0m16:00:09.528446 [info ] [Thread-1 (]: 1 of 1 OK created sql table model test_silver_layer.clean_crm_data ............. [[32mSUCCESS 1[0m in 3.37s]
[0m16:00:09.528747 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m16:00:09.529529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:09.529704 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m16:00:09.529837 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_test_silver_layer' was properly closed.
[0m16:00:09.529954 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m16:00:09.530067 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_GOLD_LAYER' was properly closed.
[0m16:00:09.530210 [info ] [MainThread]: 
[0m16:00:09.530355 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m16:00:09.530638 [debug] [MainThread]: Command end result
[0m16:00:09.552019 [info ] [MainThread]: 
[0m16:00:09.552368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:09.552539 [info ] [MainThread]: 
[0m16:00:09.552712 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:00:09.554677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.361869, "process_user_time": 2.757183, "process_kernel_time": 1.160141, "process_mem_max_rss": "201900032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:00:09.554986 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:09.554939 after 7.36 seconds
[0m16:00:09.555189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104938750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a1690>]}
[0m16:00:09.555368 [debug] [MainThread]: Flushing usage events
[0m16:01:44.418669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114dd690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ebc10>]}


============================== 16:01:44.421654 | b5a9cb76-c327-4749-a62f-4ad8c1715e57 ==============================
[0m16:01:44.421654 [info ] [MainThread]: Running with dbt=1.8.1
[0m16:01:44.422000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:01:45.210677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1353cfd10>]}
[0m16:01:45.234074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e3f190>]}
[0m16:01:45.234706 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:01:45.246711 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m16:01:45.337904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m16:01:45.338407 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m16:01:45.338599 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/crm_device_data.sql
[0m16:01:45.338779 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_device_data.sql
[0m16:01:45.338952 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/enriched_data.sql
[0m16:01:45.413627 [info ] [MainThread]: import_crm: 
[0m16:01:45.425860 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m16:01:45.429507 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m16:01:45.516156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1355b8b90>]}
[0m16:01:45.568792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a8cdd0>]}
[0m16:01:45.569106 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m16:01:45.569290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135574250>]}
[0m16:01:45.570531 [info ] [MainThread]: 
[0m16:01:45.570839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:01:45.573799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:01:45.574104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:01:45.581265 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:01:45.582371 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:01:45.582604 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:01:45.582812 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:01:45.582991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:45.583150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:46.241192 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:01:46.241561 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:01:46.242441 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:01:46.243141 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:01:46.393774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now create_PROJECT_SEC2_DB_test_silver_layer)
[0m16:01:46.394068 [debug] [ThreadPool]: Creating schema "database: "PROJECT_SEC2_DB"
schema: "test_silver_layer"
"
[0m16:01:46.396515 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_SEC2_DB_test_silver_layer"
[0m16:01:46.396695 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "create_PROJECT_SEC2_DB_test_silver_layer"} */
create schema if not exists PROJECT_SEC2_DB.test_silver_layer
[0m16:01:46.396837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:46.805100 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:01:46.805725 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_test_silver_layer: Close
[0m16:01:46.957051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m16:01:46.957343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PROJECT_SEC2_DB_test_silver_layer, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m16:01:46.957638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_test_silver_layer'
[0m16:01:46.961608 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m16:01:46.962597 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m16:01:46.963541 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m16:01:46.963708 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m16:01:46.963881 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m16:01:46.964042 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m16:01:46.964199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:46.964323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:46.964461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:47.468262 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:01:47.468607 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m16:01:47.469544 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m16:01:47.470133 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m16:01:47.498406 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m16:01:47.499748 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m16:01:47.642583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13549efd0>]}
[0m16:01:47.642907 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:01:47.643076 [info ] [MainThread]: 
[0m16:01:47.644987 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m16:01:47.645183 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m16:01:47.645451 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m16:01:47.645712 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m16:01:47.645963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m16:01:47.646165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_device_data)
[0m16:01:47.646342 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m16:01:47.646511 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m16:01:47.652329 [info ] [Thread-1 (]: import_crm: 
[0m16:01:47.654388 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m16:01:47.654727 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m16:01:47.654993 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m16:01:47.655411 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m16:01:47.655597 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m16:01:47.670469 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m16:01:47.671931 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m16:01:47.673172 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m16:01:47.673980 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m16:01:47.674248 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m16:01:47.674577 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m16:01:47.674811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:47.675090 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:48.695907 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:48.705383 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m16:01:48.884173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a96d0>]}
[0m16:01:48.884592 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.24s]
[0m16:01:48.884877 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m16:01:49.005595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:49.006644 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m16:01:49.151392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465426d0>]}
[0m16:01:49.151784 [info ] [Thread-1 (]: 1 of 32 OK created sql table model test_silver_layer.clean_crm_data ............ [[32mSUCCESS 1[0m in 1.51s]
[0m16:01:49.152100 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m16:01:49.152489 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m16:01:49.152692 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m16:01:49.153050 [info ] [Thread-4 (]: 3 of 32 START sql table model test_silver_layer.crm_device_data ................ [RUN]
[0m16:01:49.153557 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m16:01:49.153317 [info ] [Thread-3 (]: 4 of 32 START sql table model test_silver_layer.enriched_data .................. [RUN]
[0m16:01:49.153818 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m16:01:49.154031 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_silver_layer, now model.my_dbt_project.enriched_data)
[0m16:01:49.156168 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m16:01:49.156362 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m16:01:49.158628 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m16:01:49.159078 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m16:01:49.159362 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m16:01:49.160629 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m16:01:49.160793 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m16:01:49.162041 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m16:01:49.162722 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m16:01:49.163320 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m16:01:49.164207 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.crm_device_data
         as
        (
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m16:01:49.164474 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m16:01:49.164757 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:01:49.164956 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:50.645011 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:50.645373 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:50.646301 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m16:01:50.647070 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m16:01:50.797596 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1355bbad0>]}
[0m16:01:50.797882 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1353f5c10>]}
[0m16:01:50.798229 [info ] [Thread-3 (]: 4 of 32 OK created sql table model test_silver_layer.enriched_data ............. [[32mSUCCESS 1[0m in 1.64s]
[0m16:01:50.798551 [info ] [Thread-4 (]: 3 of 32 OK created sql table model test_silver_layer.crm_device_data ........... [[32mSUCCESS 1[0m in 1.64s]
[0m16:01:50.798855 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m16:01:50.799084 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m16:01:50.799735 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m16:01:50.800002 [info ] [Thread-1 (]: 5 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m16:01:50.800193 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m16:01:50.800378 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:01:50.800564 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:01:50.800789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m16:01:50.801010 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m16:01:50.801228 [info ] [Thread-3 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m16:01:50.801471 [info ] [Thread-4 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m16:01:50.801672 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m16:01:50.801869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m16:01:50.802077 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m16:01:50.802267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m16:01:50.802720 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m16:01:50.804159 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m16:01:50.804471 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m16:01:50.804733 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:01:50.806058 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:01:50.807398 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:01:50.808684 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:01:50.808991 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m16:01:50.809193 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m16:01:50.809387 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m16:01:50.820235 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m16:01:50.821988 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:01:50.823320 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:01:50.823651 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:01:50.825675 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:01:50.826385 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m16:01:50.826899 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:01:50.827722 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m16:01:50.827946 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m16:01:50.828279 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m16:01:50.828922 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m16:01:50.829394 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:50.830382 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:01:50.830810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:50.831518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:50.832239 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m16:01:50.835056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:51.431468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:51.431965 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:51.432443 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:51.432740 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:51.434879 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m16:01:51.435654 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m16:01:51.436376 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m16:01:51.437197 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m16:01:51.603513 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1355c2cd0>]}
[0m16:01:51.603843 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1355c3fd0>]}
[0m16:01:51.604098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1461fb650>]}
[0m16:01:51.604340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466704d0>]}
[0m16:01:51.604689 [info ] [Thread-3 (]: 7 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.80s]
[0m16:01:51.605031 [info ] [Thread-1 (]: 5 of 32 OK created sql view model GOLD_LAYER.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.80s]
[0m16:01:51.605273 [info ] [Thread-4 (]: 8 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.80s]
[0m16:01:51.605844 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:01:51.605603 [info ] [Thread-2 (]: 6 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.80s]
[0m16:01:51.606128 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m16:01:51.606358 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:01:51.606571 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:01:51.606828 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m16:01:51.607007 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m16:01:51.607234 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m16:01:51.607465 [info ] [Thread-3 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m16:01:51.607672 [debug] [Thread-2 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m16:01:51.607908 [info ] [Thread-1 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ............... [RUN]
[0m16:01:51.608163 [info ] [Thread-4 (]: 11 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m16:01:51.608416 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m16:01:51.608618 [info ] [Thread-2 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m16:01:51.608829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m16:01:51.609032 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m16:01:51.609217 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:01:51.609416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.os_by_age_segment)
[0m16:01:51.609590 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m16:01:51.609765 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m16:01:51.611486 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:01:51.611709 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m16:01:51.612963 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m16:01:51.614275 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:01:51.615663 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m16:01:51.616111 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:01:51.616312 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m16:01:51.617654 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:01:51.617822 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m16:01:51.619149 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:01:51.619359 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m16:01:51.620555 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m16:01:51.621863 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m16:01:51.622237 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:01:51.622637 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m16:01:51.623033 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m16:01:51.623228 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m16:01:51.623428 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m16:01:51.624160 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m16:01:51.624355 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by os_name
  );
[0m16:01:51.624530 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:51.624687 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:51.624904 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m16:01:51.625107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:51.626173 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:52.156608 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:52.157633 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m16:01:52.177218 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:52.178008 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m16:01:52.230336 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:52.230681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:52.231568 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m16:01:52.232384 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m16:01:52.334414 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14690f990>]}
[0m16:01:52.335036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a8ca50>]}
[0m16:01:52.334796 [info ] [Thread-3 (]: 9 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.73s]
[0m16:01:52.335510 [info ] [Thread-2 (]: 12 of 32 OK created sql view model GOLD_LAYER.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.73s]
[0m16:01:52.335927 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:01:52.336241 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m16:01:52.336505 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m16:01:52.336740 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:01:52.336983 [info ] [Thread-3 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m16:01:52.337221 [info ] [Thread-2 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m16:01:52.337462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m16:01:52.337646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_age_week_wise)
[0m16:01:52.337814 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m16:01:52.337991 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m16:01:52.339582 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:01:52.340981 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:01:52.341438 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m16:01:52.341595 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m16:01:52.342922 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:01:52.344162 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:01:52.344688 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m16:01:52.344875 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by age
order by age
  );
[0m16:01:52.345230 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:01:52.345410 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:52.345597 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m16:01:52.346309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:52.398898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14654aa90>]}
[0m16:01:52.399805 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110222f10>]}
[0m16:01:52.400791 [info ] [Thread-1 (]: 10 of 32 OK created sql view model GOLD_LAYER.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 0.79s]
[0m16:01:52.404035 [info ] [Thread-4 (]: 11 of 32 OK created sql view model GOLD_LAYER.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.79s]
[0m16:01:52.407504 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m16:01:52.407994 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m16:01:52.408529 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m16:01:52.409120 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:01:52.409798 [info ] [Thread-1 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m16:01:52.410575 [info ] [Thread-4 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m16:01:52.411031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_brand_overall)
[0m16:01:52.411402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m16:01:52.411648 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m16:01:52.411861 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:01:52.414210 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:01:52.416246 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:01:52.416999 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m16:01:52.417210 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:01:52.419083 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:01:52.420875 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:01:52.421593 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:01:52.421853 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m16:01:52.422093 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:52.422458 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m16:01:52.422802 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m16:01:52.423028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:52.854612 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:52.855931 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m16:01:52.856836 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:52.857792 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m16:01:52.946343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:52.946635 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:52.947584 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m16:01:52.948546 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m16:01:53.037162 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146054990>]}
[0m16:01:53.037428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14653dc10>]}
[0m16:01:53.037771 [info ] [Thread-3 (]: 13 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 0.70s]
[0m16:01:53.038125 [info ] [Thread-2 (]: 14 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.70s]
[0m16:01:53.038440 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m16:01:53.038685 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:01:53.038908 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m16:01:53.039144 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:01:53.039369 [info ] [Thread-3 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m16:01:53.039658 [info ] [Thread-2 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m16:01:53.039874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m16:01:53.040056 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m16:01:53.040218 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m16:01:53.040405 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:01:53.041995 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:01:53.043287 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:01:53.043720 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:01:53.043911 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m16:01:53.045263 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:01:53.046464 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:01:53.046985 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:01:53.047301 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m16:01:53.047485 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m16:01:53.047677 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m16:01:53.047850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:53.048012 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:53.105387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146087610>]}
[0m16:01:53.105744 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146687cd0>]}
[0m16:01:53.106238 [info ] [Thread-1 (]: 15 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.69s]
[0m16:01:53.106768 [info ] [Thread-4 (]: 16 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.69s]
[0m16:01:53.107187 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m16:01:53.107551 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:01:53.107907 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:01:53.108157 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:01:53.108501 [info ] [Thread-1 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m16:01:53.108933 [info ] [Thread-4 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m16:01:53.109301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m16:01:53.109551 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m16:01:53.109760 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:01:53.110125 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:01:53.112013 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:01:53.114495 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:01:53.115224 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:01:53.115578 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:01:53.118763 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:01:53.120655 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:01:53.121562 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:01:53.122208 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:01:53.122685 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m16:01:53.122971 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m16:01:53.123243 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:53.123471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:53.562873 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:53.563218 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:53.564173 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m16:01:53.564915 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m16:01:53.660040 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:53.660985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:53.661837 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m16:01:53.662771 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m16:01:53.764505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146916410>]}
[0m16:01:53.764903 [info ] [Thread-2 (]: 18 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.72s]
[0m16:01:53.765193 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:01:53.765413 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m16:01:53.765667 [info ] [Thread-2 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m16:01:53.765915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_overall)
[0m16:01:53.766074 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m16:01:53.767666 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:01:53.768256 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m16:01:53.769592 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:01:53.769844 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146054d10>]}
[0m16:01:53.770178 [info ] [Thread-3 (]: 17 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.73s]
[0m16:01:53.770569 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m16:01:53.770819 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:01:53.771220 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m16:01:53.771608 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m16:01:53.771431 [info ] [Thread-3 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m16:01:53.771849 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:53.772050 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m16:01:53.772280 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:01:53.774185 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:01:53.774532 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:01:53.775878 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:01:53.776658 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:01:53.776971 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m16:01:53.777254 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:53.796777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13548fd10>]}
[0m16:01:53.797143 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460841d0>]}
[0m16:01:53.797500 [info ] [Thread-1 (]: 19 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.69s]
[0m16:01:53.797844 [info ] [Thread-4 (]: 20 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.69s]
[0m16:01:53.798118 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:01:53.798359 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:01:53.798584 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:01:53.798825 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:01:53.799061 [info ] [Thread-1 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m16:01:53.799306 [info ] [Thread-4 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m16:01:53.799531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m16:01:53.799733 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m16:01:53.799935 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:01:53.800108 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m16:01:53.801457 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:01:53.802833 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:01:53.803247 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m16:01:53.804694 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:01:53.804864 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:01:53.806210 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:01:53.806828 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:01:53.807055 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m16:01:53.807237 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:53.807701 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:01:53.807904 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m16:01:53.808484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:54.276708 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:01:54.277050 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:54.278015 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m16:01:54.278817 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m16:01:54.299143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:01:54.300140 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m16:01:54.300417 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:01:54.301605 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m16:01:54.409773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146644150>]}
[0m16:01:54.410145 [info ] [Thread-3 (]: 22 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.64s]
[0m16:01:54.410421 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:01:54.410615 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:01:54.410868 [info ] [Thread-3 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m16:01:54.411115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m16:01:54.411296 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:01:54.412843 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:01:54.413227 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:01:54.414519 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:01:54.415259 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:01:54.415463 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m16:01:54.415655 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:54.415867 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14655c390>]}
[0m16:01:54.416457 [info ] [Thread-2 (]: 21 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.65s]
[0m16:01:54.417173 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m16:01:54.417376 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:01:54.417617 [info ] [Thread-2 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m16:01:54.417836 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m16:01:54.418000 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:01:54.419489 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:01:54.420073 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:01:54.421410 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:01:54.421926 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:01:54.422109 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m16:01:54.422351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:54.430100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135403210>]}
[0m16:01:54.447373 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135411c10>]}
[0m16:01:54.924844 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:54.925865 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m16:01:54.987589 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:54.988487 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m16:01:55.106462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1461b0c10>]}
[0m16:01:55.138070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146b294d0>]}
[0m16:01:55.817229 [info ] [Thread-1 (]: 23 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.63s]
[0m16:01:55.817538 [info ] [Thread-4 (]: 24 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.65s]
[0m16:01:55.817821 [info ] [Thread-3 (]: 25 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.70s]
[0m16:01:55.818418 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:01:55.818013 [info ] [Thread-2 (]: 26 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.72s]
[0m16:01:55.818713 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:01:55.818979 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:01:55.819211 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_customers_overall
[0m16:01:55.819499 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:01:55.819697 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m16:01:55.819927 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_overall
[0m16:01:55.820165 [info ] [Thread-1 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m16:01:55.820438 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m16:01:55.820657 [info ] [Thread-4 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m16:01:55.820914 [info ] [Thread-3 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m16:01:55.821184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m16:01:55.821421 [info ] [Thread-2 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m16:01:55.821649 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m16:01:55.821883 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m16:01:55.822076 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m16:01:55.822257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m16:01:55.822434 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m16:01:55.822612 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m16:01:55.824198 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m16:01:55.824765 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m16:01:55.826093 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m16:01:55.827527 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m16:01:55.828888 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m16:01:55.829372 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m16:01:55.829540 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m16:01:55.829796 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m16:01:55.831160 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m16:01:55.831320 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m16:01:55.833442 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m16:01:55.834748 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m16:01:55.836077 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m16:01:55.836820 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m16:01:55.837447 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m16:01:55.837651 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m16:01:55.837948 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m16:01:55.838533 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m16:01:55.838708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:55.839282 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m16:01:55.839435 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:55.839627 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m16:01:55.840437 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m16:01:55.842462 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:55.843711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:56.477748 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:56.478764 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: Close
[0m16:01:56.529167 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:56.530088 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m16:01:56.734216 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:56.735258 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m16:01:56.750018 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146644510>]}
[0m16:01:56.750385 [info ] [Thread-3 (]: 29 of 32 OK created sql view model GOLD_LAYER.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.93s]
[0m16:01:56.750670 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m16:01:56.750892 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:01:56.751142 [info ] [Thread-3 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m16:01:56.751405 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m16:01:56.751576 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m16:01:56.753179 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:01:56.753693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:56.754556 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: Close
[0m16:01:56.755465 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m16:01:56.757144 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:01:56.757872 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:01:56.758089 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m16:01:56.758281 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:56.762994 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146075010>]}
[0m16:01:56.763469 [info ] [Thread-2 (]: 30 of 32 OK created sql view model GOLD_LAYER.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 0.94s]
[0m16:01:56.763942 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m16:01:56.764169 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m16:01:56.764449 [info ] [Thread-2 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m16:01:56.764952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_week_wise, now model.my_dbt_project.weekly_revenue_by_os)
[0m16:01:56.765218 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m16:01:56.767472 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:01:56.768174 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m16:01:56.771648 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:01:56.772319 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m16:01:56.772606 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m16:01:56.772833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:56.908841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146914950>]}
[0m16:01:56.909227 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146164f10>]}
[0m16:01:56.909654 [info ] [Thread-1 (]: 27 of 32 OK created sql view model GOLD_LAYER.total_customers_overall .......... [[32mSUCCESS 1[0m in 1.09s]
[0m16:01:56.910020 [info ] [Thread-4 (]: 28 of 32 OK created sql view model GOLD_LAYER.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 1.09s]
[0m16:01:56.910346 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m16:01:56.910609 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m16:01:57.258339 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:01:57.259381 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m16:01:57.265854 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:57.266675 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m16:01:57.396099 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bca90>]}
[0m16:01:57.397482 [info ] [Thread-3 (]: 31 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 0.64s]
[0m16:01:57.397864 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:01:57.402955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5a9cb76-c327-4749-a62f-4ad8c1715e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14662cd10>]}
[0m16:01:57.405789 [info ] [Thread-2 (]: 32 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 0.64s]
[0m16:01:57.408903 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m16:01:57.412338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:57.415165 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_overall' was properly closed.
[0m16:01:57.415351 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m16:01:57.415608 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m16:01:57.418362 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_week_wise' was properly closed.
[0m16:01:57.422320 [info ] [MainThread]: 
[0m16:01:57.422546 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 11.85 seconds (11.85s).
[0m16:01:57.425047 [debug] [MainThread]: Command end result
[0m16:01:57.444296 [info ] [MainThread]: 
[0m16:01:57.444573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:57.444737 [info ] [MainThread]: 
[0m16:01:57.444887 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m16:01:57.446756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.058446, "process_user_time": 3.580528, "process_kernel_time": 1.505415, "process_mem_max_rss": "203292672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:01:57.447016 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:57.446975 after 13.06 seconds
[0m16:01:57.447207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354848d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105602250>]}
[0m16:01:57.447375 [debug] [MainThread]: Flushing usage events
[0m16:02:11.738765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c92410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ceb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d00fd0>]}


============================== 16:02:11.741552 | dda7b703-6ea4-44dc-8824-d941042702e4 ==============================
[0m16:02:11.741552 [info ] [MainThread]: Running with dbt=1.8.1
[0m16:02:11.741867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": false}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:02:12.483434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150683010>]}
[0m16:02:12.506836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10473f1d0>]}
[0m16:02:12.507470 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:02:12.520566 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m16:02:12.593537 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:02:12.593897 [debug] [MainThread]: previous checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, current checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4
[0m16:02:12.594101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bbbc90>]}
[0m16:02:13.062289 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m16:02:13.072566 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m16:02:13.080627 [info ] [MainThread]: import_crm: 
[0m16:02:13.268455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15113a550>]}
[0m16:02:13.320850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15160fe50>]}
[0m16:02:13.321162 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m16:02:13.321348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1514b4c90>]}
[0m16:02:13.322584 [info ] [MainThread]: 
[0m16:02:13.322872 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:02:13.325773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:02:13.326086 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:02:13.332709 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:02:13.333828 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:02:13.334016 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:02:13.334213 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:02:13.334397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:13.334544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:13.938118 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:02:13.939058 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:02:13.995957 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:02:13.996712 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:02:14.126126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_silver_layer)
[0m16:02:14.126471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_GOLD_LAYER)
[0m16:02:14.127402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m16:02:14.130759 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m16:02:14.132274 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_GOLD_LAYER"
[0m16:02:14.133241 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m16:02:14.133418 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m16:02:14.133598 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_GOLD_LAYER"} */
show objects in PROJECT_SEC2_DB.GOLD_LAYER limit 10000
[0m16:02:14.133783 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m16:02:14.133937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:14.134086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:14.134215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:14.566333 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:02:14.567331 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m16:02:14.614757 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m16:02:14.616122 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_GOLD_LAYER: Close
[0m16:02:14.624753 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:02:14.625597 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m16:02:14.782299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15144f9d0>]}
[0m16:02:14.783013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:02:14.783242 [info ] [MainThread]: 
[0m16:02:14.788990 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m16:02:14.789385 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m16:02:14.790166 [info ] [Thread-1 (]: 1 of 32 START sql table model silver_layer.clean_crm_data ...................... [RUN]
[0m16:02:14.790747 [info ] [Thread-2 (]: 2 of 32 START sql table model silver_layer.clean_device_data ................... [RUN]
[0m16:02:14.791333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now model.my_dbt_project.clean_crm_data)
[0m16:02:14.791656 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_GOLD_LAYER, now model.my_dbt_project.clean_device_data)
[0m16:02:14.807061 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m16:02:14.805579 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m16:02:14.902256 [info ] [Thread-1 (]: import_crm: 
[0m16:02:14.904633 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
[0m16:02:14.905253 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m16:02:14.905799 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m16:02:14.906836 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m16:02:14.915044 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m16:02:14.954446 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m16:02:14.956093 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m16:02:14.957407 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m16:02:14.958385 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m16:02:14.958656 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m16:02:14.958990 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m16:02:14.959252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:14.959451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:22.237067 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m16:02:22.248055 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m16:02:22.384070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1511c1750>]}
[0m16:02:22.384442 [info ] [Thread-2 (]: 2 of 32 OK created sql table model silver_layer.clean_device_data .............. [[32mSUCCESS 1[0m in 7.59s]
[0m16:02:22.384761 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m16:02:36.720331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 22.0 seconds
[0m16:02:36.721448 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m16:02:36.941921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1513aed50>]}
[0m16:02:36.942320 [info ] [Thread-1 (]: 1 of 32 OK created sql table model silver_layer.clean_crm_data ................. [[32mSUCCESS 1[0m in 22.15s]
[0m16:02:36.942602 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m16:02:36.943025 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m16:02:36.943319 [info ] [Thread-4 (]: 3 of 32 START sql table model silver_layer.crm_device_data ..................... [RUN]
[0m16:02:36.943524 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m16:02:36.943751 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m16:02:36.943971 [info ] [Thread-3 (]: 4 of 32 START sql table model silver_layer.enriched_data ....................... [RUN]
[0m16:02:36.944192 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m16:02:36.944415 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.enriched_data)
[0m16:02:36.946482 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m16:02:36.946672 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m16:02:36.948918 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m16:02:36.949400 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m16:02:36.949655 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m16:02:36.950944 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m16:02:36.951203 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m16:02:36.952441 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m16:02:36.953073 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m16:02:36.953270 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.crm_device_data
         as
        (
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.silver_layer.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.silver_layer.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m16:02:36.953468 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:02:36.954613 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m16:02:36.955552 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.REV AS revenue
    LEFT JOIN PROJECT_SEC2_DB.silver_layer.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.silver_layer.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m16:02:36.955837 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:45.378999 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 8.0 seconds
[0m16:02:45.380925 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m16:02:45.565069 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1515ce310>]}
[0m16:02:45.565464 [info ] [Thread-3 (]: 4 of 32 OK created sql table model silver_layer.enriched_data .................. [[32mSUCCESS 1[0m in 8.62s]
[0m16:02:45.565789 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m16:02:45.566341 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m16:02:45.566536 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m16:02:45.566698 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:02:45.566916 [info ] [Thread-1 (]: 5 of 32 START sql view model GOLD_LAYER.brand_by_age_segment ................... [RUN]
[0m16:02:45.567179 [info ] [Thread-2 (]: 6 of 32 START sql view model GOLD_LAYER.customers_by_brand_overall ............. [RUN]
[0m16:02:45.567429 [info ] [Thread-3 (]: 7 of 32 START sql view model GOLD_LAYER.customers_by_brand_week_wise ........... [RUN]
[0m16:02:45.567667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m16:02:45.567871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m16:02:45.568035 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m16:02:45.568198 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m16:02:45.568381 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m16:02:45.568566 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m16:02:45.570297 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m16:02:45.571528 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:02:45.572955 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:02:45.573418 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m16:02:45.573589 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m16:02:45.584143 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:02:45.584351 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m16:02:45.586030 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m16:02:45.588624 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:02:45.589386 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m16:02:45.589938 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_overall
  
   as (
    select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m16:02:45.590218 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:45.590974 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:02:45.592161 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m16:02:45.592458 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_brand_week_wise
  
   as (
    select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m16:02:45.593272 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.brand_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m16:02:45.594171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:45.594521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:46.193328 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:46.194373 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m16:02:46.199564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:46.199859 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:46.200652 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m16:02:46.201453 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m16:02:46.325642 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531bf1d0>]}
[0m16:02:46.326013 [info ] [Thread-3 (]: 7 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.76s]
[0m16:02:46.326299 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:02:46.326502 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:02:46.326702 [info ] [Thread-3 (]: 8 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_overall ....... [RUN]
[0m16:02:46.326978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m16:02:46.327187 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:02:46.328760 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:02:46.329153 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:02:46.330461 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:02:46.330934 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:02:46.331118 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_overall
  
   as (
    select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m16:02:46.331285 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:46.333214 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1532146d0>]}
[0m16:02:46.333616 [info ] [Thread-2 (]: 6 of 32 OK created sql view model GOLD_LAYER.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.77s]
[0m16:02:46.334128 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m16:02:46.334326 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:02:46.334557 [info ] [Thread-2 (]: 9 of 32 START sql view model GOLD_LAYER.customers_by_mobile_type_week_wise ..... [RUN]
[0m16:02:46.334753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m16:02:46.334936 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:02:46.336378 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:02:46.337005 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:02:46.338491 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:02:46.338784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1534db210>]}
[0m16:02:46.339159 [info ] [Thread-1 (]: 5 of 32 OK created sql view model GOLD_LAYER.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.77s]
[0m16:02:46.339576 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m16:02:46.339814 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m16:02:46.340353 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:02:46.340956 [info ] [Thread-1 (]: 10 of 32 START sql view model GOLD_LAYER.customers_by_os_overall ............... [RUN]
[0m16:02:46.341478 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m16:02:46.341925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m16:02:46.342806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:46.343175 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m16:02:46.346083 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m16:02:46.346516 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m16:02:46.347977 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m16:02:46.348724 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m16:02:46.348910 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_overall
  
   as (
    select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.silver_layer.enriched_data
where os_name is not null
group by os_name
  );
[0m16:02:46.349074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:46.910138 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:46.910503 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:46.911476 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m16:02:46.912409 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m16:02:46.912703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:46.914773 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m16:02:47.066854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15372ba10>]}
[0m16:02:47.067142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15372e710>]}
[0m16:02:47.067357 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15372e510>]}
[0m16:02:47.067695 [info ] [Thread-1 (]: 10 of 32 OK created sql view model GOLD_LAYER.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 0.73s]
[0m16:02:47.067995 [info ] [Thread-2 (]: 9 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.73s]
[0m16:02:47.068298 [info ] [Thread-3 (]: 8 of 32 OK created sql view model GOLD_LAYER.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.74s]
[0m16:02:47.068564 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m16:02:47.068801 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:02:47.069062 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:02:47.069271 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m16:02:47.069497 [debug] [Thread-2 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m16:02:47.069722 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m16:02:47.069938 [info ] [Thread-1 (]: 11 of 32 START sql view model GOLD_LAYER.customers_by_os_week_wise ............. [RUN]
[0m16:02:47.070169 [info ] [Thread-2 (]: 12 of 32 START sql view model GOLD_LAYER.os_by_age_segment ..................... [RUN]
[0m16:02:47.070417 [info ] [Thread-3 (]: 13 of 32 START sql view model GOLD_LAYER.revenue_by_age_overall ................ [RUN]
[0m16:02:47.070651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m16:02:47.070852 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.os_by_age_segment)
[0m16:02:47.071031 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.revenue_by_age_overall)
[0m16:02:47.071203 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m16:02:47.071353 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m16:02:47.071499 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m16:02:47.073369 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m16:02:47.074447 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:02:47.075828 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:02:47.076319 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m16:02:47.076487 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m16:02:47.076627 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m16:02:47.077900 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:02:47.079134 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:02:47.080310 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m16:02:47.080885 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m16:02:47.081226 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m16:02:47.081487 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_overall
  
   as (
    select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data
where age is not null
group by age
order by age
  );
[0m16:02:47.082266 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m16:02:47.082450 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.customers_by_os_week_wise
  
   as (
    select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m16:02:47.082617 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:47.082820 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.os_by_age_segment
  
   as (
    WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m16:02:47.083026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:47.083229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:47.369408 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 10.0 seconds
[0m16:02:47.370345 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m16:02:47.516028 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103815350>]}
[0m16:02:47.518035 [info ] [Thread-4 (]: 3 of 32 OK created sql table model silver_layer.crm_device_data ................ [[32mSUCCESS 1[0m in 10.57s]
[0m16:02:47.520941 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m16:02:47.521183 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:02:47.521431 [info ] [Thread-4 (]: 14 of 32 START sql view model GOLD_LAYER.revenue_by_age_week_wise .............. [RUN]
[0m16:02:47.521686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.revenue_by_age_week_wise)
[0m16:02:47.521887 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m16:02:47.523411 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:02:47.523740 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m16:02:47.525082 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:02:47.526607 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:02:47.526839 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_age_week_wise
  
   as (
    select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m16:02:47.527017 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:47.718021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:47.718360 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:47.719308 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m16:02:47.720114 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m16:02:47.727066 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:47.727875 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m16:02:47.862988 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1534d3510>]}
[0m16:02:47.863279 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1515d6e90>]}
[0m16:02:47.863887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1515d6490>]}
[0m16:02:47.863660 [info ] [Thread-2 (]: 12 of 32 OK created sql view model GOLD_LAYER.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.79s]
[0m16:02:47.864228 [info ] [Thread-3 (]: 13 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 0.79s]
[0m16:02:47.864525 [info ] [Thread-1 (]: 11 of 32 OK created sql view model GOLD_LAYER.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.79s]
[0m16:02:47.864807 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m16:02:47.865056 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m16:02:47.865284 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m16:02:47.865488 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m16:02:47.865704 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:02:47.865928 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m16:02:47.866149 [info ] [Thread-2 (]: 15 of 32 START sql view model GOLD_LAYER.revenue_by_brand_overall .............. [RUN]
[0m16:02:47.866413 [info ] [Thread-3 (]: 16 of 32 START sql view model GOLD_LAYER.revenue_by_brand_week_wise ............ [RUN]
[0m16:02:47.866662 [info ] [Thread-1 (]: 17 of 32 START sql view model GOLD_LAYER.revenue_by_gender_overall ............. [RUN]
[0m16:02:47.866868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_overall)
[0m16:02:47.867038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m16:02:47.867203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_gender_overall)
[0m16:02:47.867364 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m16:02:47.867527 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:02:47.867683 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m16:02:47.870170 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:02:47.871389 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:02:47.872634 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:02:47.873094 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:02:47.873311 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m16:02:47.874622 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:02:47.874780 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m16:02:47.875995 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:02:47.877282 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:02:47.877761 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:02:47.877969 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_week_wise
  
   as (
    select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m16:02:47.878337 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m16:02:47.878498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:47.878680 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_overall
  
   as (
    select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.silver_layer.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m16:02:47.879018 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m16:02:47.879362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:47.879681 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_brand_overall
  
   as (
    select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m16:02:47.880432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:47.961794 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:02:47.962921 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m16:02:48.099136 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153200850>]}
[0m16:02:48.099540 [info ] [Thread-4 (]: 14 of 32 OK created sql view model GOLD_LAYER.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.58s]
[0m16:02:48.099876 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:02:48.100085 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:02:48.100317 [info ] [Thread-4 (]: 18 of 32 START sql view model GOLD_LAYER.revenue_by_gender_week_wise ........... [RUN]
[0m16:02:48.100541 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m16:02:48.100710 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:02:48.102066 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:02:48.102433 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:02:48.103837 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:02:48.104302 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:02:48.104479 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_gender_week_wise
  
   as (
    select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m16:02:48.104646 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:48.372174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:02:48.373165 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m16:02:48.447189 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:48.447875 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:48.448736 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m16:02:48.449838 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m16:02:48.517078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151472690>]}
[0m16:02:48.517460 [info ] [Thread-1 (]: 17 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.65s]
[0m16:02:48.517737 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m16:02:48.517952 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:02:48.518212 [info ] [Thread-1 (]: 19 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_overall ........ [RUN]
[0m16:02:48.518420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m16:02:48.518606 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:02:48.520853 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:02:48.521237 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:02:48.522606 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:02:48.523234 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:02:48.523423 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_overall
  
   as (
    select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m16:02:48.523592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:48.578011 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151491050>]}
[0m16:02:48.578321 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1516543d0>]}
[0m16:02:48.578736 [info ] [Thread-2 (]: 15 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.71s]
[0m16:02:48.579063 [info ] [Thread-3 (]: 16 of 32 OK created sql view model GOLD_LAYER.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.71s]
[0m16:02:48.579484 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m16:02:48.579753 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:02:48.579970 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:02:48.580188 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m16:02:48.580432 [info ] [Thread-2 (]: 20 of 32 START sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise ...... [RUN]
[0m16:02:48.580702 [info ] [Thread-3 (]: 21 of 32 START sql view model GOLD_LAYER.revenue_by_os_overall ................. [RUN]
[0m16:02:48.580954 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m16:02:48.581155 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_os_overall)
[0m16:02:48.581339 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:02:48.581509 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m16:02:48.583017 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:02:48.584301 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:02:48.584695 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m16:02:48.586271 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:02:48.586489 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:02:48.587931 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:02:48.588468 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m16:02:48.588739 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_overall
  
   as (
    select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m16:02:48.589048 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:48.589688 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:02:48.589958 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_mobile_type_week_wise
  
   as (
    select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m16:02:48.590548 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:48.651791 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:48.653193 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m16:02:48.822982 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151406a50>]}
[0m16:02:48.823381 [info ] [Thread-4 (]: 18 of 32 OK created sql view model GOLD_LAYER.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.72s]
[0m16:02:48.823691 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:02:48.823930 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:02:48.824169 [info ] [Thread-4 (]: 22 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_overall .......... [RUN]
[0m16:02:48.824427 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m16:02:48.824617 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:02:48.825981 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:02:48.826366 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:02:48.827765 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:02:48.828241 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:02:48.828419 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_overall
  
   as (
    select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m16:02:48.828590 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:49.071661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:49.072655 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m16:02:49.160056 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:49.161163 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:49.162253 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m16:02:49.163165 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m16:02:49.233872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e9550>]}
[0m16:02:49.234492 [info ] [Thread-1 (]: 19 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.72s]
[0m16:02:49.234830 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:02:49.235130 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:02:49.235490 [info ] [Thread-1 (]: 23 of 32 START sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ........ [RUN]
[0m16:02:49.235831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m16:02:49.236162 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:02:49.237787 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:02:49.238226 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:02:49.239567 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:02:49.240071 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:02:49.240262 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_vendor_week_wise
  
   as (
    select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m16:02:49.240435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:49.303449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153215450>]}
[0m16:02:49.304179 [info ] [Thread-2 (]: 20 of 32 OK created sql view model GOLD_LAYER.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.72s]
[0m16:02:49.304703 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:02:49.305066 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:02:49.305698 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1534ddc90>]}
[0m16:02:49.305395 [info ] [Thread-2 (]: 24 of 32 START sql view model GOLD_LAYER.revenue_by_os_week_wise ............... [RUN]
[0m16:02:49.306037 [info ] [Thread-3 (]: 21 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.72s]
[0m16:02:49.306299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m16:02:49.306560 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m16:02:49.306735 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m16:02:49.306935 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:02:49.308480 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:02:49.308717 [info ] [Thread-3 (]: 25 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_overall ...... [RUN]
[0m16:02:49.309327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m16:02:49.309555 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:02:49.311175 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:02:49.311533 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m16:02:49.313284 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:02:49.313857 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:02:49.315442 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:02:49.315890 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:02:49.316107 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_os_week_wise
  
   as (
    select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m16:02:49.316459 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:02:49.316635 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:49.316817 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_overall
  
   as (
    select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m16:02:49.317031 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:49.368114 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:49.369331 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m16:02:49.500249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1534d1790>]}
[0m16:02:49.774199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:49.775267 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m16:02:49.779850 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:02:49.780694 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m16:02:49.783624 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:02:49.784474 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m16:02:49.903563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15166fa90>]}
[0m16:02:49.930531 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151656850>]}
[0m16:02:49.930783 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1e910>]}
[0m16:02:50.906494 [info ] [Thread-4 (]: 22 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.68s]
[0m16:02:50.906783 [info ] [Thread-1 (]: 23 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.67s]
[0m16:02:50.907628 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:02:50.907049 [info ] [Thread-3 (]: 25 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.62s]
[0m16:02:50.907988 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:02:50.907274 [info ] [Thread-2 (]: 24 of 32 OK created sql view model GOLD_LAYER.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.62s]
[0m16:02:50.908280 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:02:50.908544 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:02:50.908742 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_customers_overall
[0m16:02:50.908992 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:02:50.909219 [info ] [Thread-4 (]: 26 of 32 START sql view model GOLD_LAYER.revenue_by_value_segment_week_wise .... [RUN]
[0m16:02:50.909434 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m16:02:50.909640 [info ] [Thread-1 (]: 27 of 32 START sql view model GOLD_LAYER.total_customers_overall ............... [RUN]
[0m16:02:50.909888 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_overall
[0m16:02:50.910139 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m16:02:50.910367 [info ] [Thread-3 (]: 28 of 32 START sql view model GOLD_LAYER.total_customers_week_wise ............. [RUN]
[0m16:02:50.910604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m16:02:50.911001 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:02:50.910827 [info ] [Thread-2 (]: 29 of 32 START sql view model GOLD_LAYER.total_devices_overall ................. [RUN]
[0m16:02:50.911321 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_customers_week_wise)
[0m16:02:50.911531 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m16:02:50.912815 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_devices_overall)
[0m16:02:50.913452 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:02:50.913634 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m16:02:50.914981 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m16:02:50.915202 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m16:02:50.917775 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m16:02:50.919347 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m16:02:50.919572 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:02:50.919871 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m16:02:50.921184 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:02:50.921359 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m16:02:50.922705 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m16:02:50.922876 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m16:02:50.924592 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m16:02:50.925521 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:02:50.927737 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m16:02:50.928635 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m16:02:50.929062 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.revenue_by_value_segment_week_wise
  
   as (
    select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m16:02:50.930156 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m16:02:50.930424 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_overall
  
   as (
    with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m16:02:50.931169 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m16:02:50.931521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:50.931742 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_customers_week_wise
  
   as (
    with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m16:02:50.931974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:50.932294 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_overall
  
   as (
    with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m16:02:50.932961 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:50.934732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:51.481667 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:51.482758 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m16:02:51.483669 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:51.484472 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_overall: Close
[0m16:02:51.495261 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:51.496117 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m16:02:51.497181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:51.497991 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: Close
[0m16:02:51.638205 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c4dcc90>]}
[0m16:02:51.638489 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104503990>]}
[0m16:02:51.639135 [info ] [Thread-3 (]: 28 of 32 OK created sql view model GOLD_LAYER.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 0.73s]
[0m16:02:51.639477 [info ] [Thread-4 (]: 26 of 32 OK created sql view model GOLD_LAYER.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.73s]
[0m16:02:51.639908 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m16:02:51.640238 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:02:51.640494 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105611090>]}
[0m16:02:51.640712 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m16:02:51.640926 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:02:51.641177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151694090>]}
[0m16:02:51.641441 [info ] [Thread-2 (]: 29 of 32 OK created sql view model GOLD_LAYER.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.73s]
[0m16:02:51.641728 [info ] [Thread-3 (]: 30 of 32 START sql view model GOLD_LAYER.total_devices_week_wise ............... [RUN]
[0m16:02:51.641959 [info ] [Thread-4 (]: 31 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_brand ............... [RUN]
[0m16:02:51.642220 [info ] [Thread-1 (]: 27 of 32 OK created sql view model GOLD_LAYER.total_customers_overall .......... [[32mSUCCESS 1[0m in 0.73s]
[0m16:02:51.642483 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m16:02:51.642678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m16:02:51.642877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m16:02:51.643102 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m16:02:51.643298 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m16:02:51.643478 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m16:02:51.643639 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m16:02:51.643875 [info ] [Thread-2 (]: 32 of 32 START sql view model GOLD_LAYER.weekly_revenue_by_os .................. [RUN]
[0m16:02:51.645547 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m16:02:51.646930 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:02:51.647137 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m16:02:51.647428 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m16:02:51.649583 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:02:51.649949 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m16:02:51.650104 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m16:02:51.650255 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m16:02:51.651622 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:02:51.652927 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m16:02:51.654227 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:02:51.654986 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m16:02:51.655679 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m16:02:51.656318 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:02:51.656569 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_os
  
   as (
    SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.silver_layer.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m16:02:51.656862 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.total_devices_week_wise
  
   as (
    with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m16:02:51.657133 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.GOLD_LAYER.weekly_revenue_by_brand
  
   as (
    SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.silver_layer.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m16:02:51.657376 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:51.657574 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:51.657784 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:52.183427 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:52.184107 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:52.184432 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:52.185341 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m16:02:52.186152 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m16:02:52.186893 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m16:02:52.338493 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531d8390>]}
[0m16:02:52.338772 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15372bed0>]}
[0m16:02:52.339008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda7b703-6ea4-44dc-8824-d941042702e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba6a90>]}
[0m16:02:52.339349 [info ] [Thread-2 (]: 32 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 0.69s]
[0m16:02:52.339673 [info ] [Thread-3 (]: 30 of 32 OK created sql view model GOLD_LAYER.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 0.70s]
[0m16:02:52.339992 [info ] [Thread-4 (]: 31 of 32 OK created sql view model GOLD_LAYER.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 0.70s]
[0m16:02:52.340268 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m16:02:52.340497 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m16:02:52.340739 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:02:52.341619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:52.341764 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_overall' was properly closed.
[0m16:02:52.341882 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m16:02:52.341993 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m16:02:52.342109 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m16:02:52.342306 [info ] [MainThread]: 
[0m16:02:52.342487 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 39.02 seconds (39.02s).
[0m16:02:52.344241 [debug] [MainThread]: Command end result
[0m16:02:52.363230 [info ] [MainThread]: 
[0m16:02:52.363497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:52.363706 [info ] [MainThread]: 
[0m16:02:52.363864 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m16:02:52.365734 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 40.655704, "process_user_time": 3.888607, "process_kernel_time": 1.529306, "process_mem_max_rss": "205635584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:02:52.365993 [debug] [MainThread]: Command `dbt run` succeeded at 16:02:52.365953 after 40.66 seconds
[0m16:02:52.366175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008cc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008cc5d0>]}
[0m16:02:52.366342 [debug] [MainThread]: Flushing usage events
[0m16:09:13.265824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c57d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cac690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca2410>]}


============================== 16:09:13.268764 | 1063079d-3fcd-450f-8734-8150a010b356 ==============================
[0m16:09:13.268764 [info ] [MainThread]: Running with dbt=1.8.1
[0m16:09:13.269113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"unit_testing": false}', 'send_anonymous_usage_stats': 'True'}
[0m16:09:14.078925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163399110>]}
[0m16:09:14.103953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106443050>]}
[0m16:09:14.104572 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:09:14.117837 [debug] [MainThread]: checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d, vars: {'unit_testing': False}, profile: , target: , version: 1.8.1
[0m16:09:14.192031 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:09:14.192454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7e690>]}
[0m16:09:14.668015 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m16:09:14.678499 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m16:09:14.686498 [info ] [MainThread]: import_crm: 
[0m16:09:14.922948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1636bf7d0>]}
[0m16:09:14.976915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162a66710>]}
[0m16:09:14.977250 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m16:09:14.977439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165552990>]}
[0m16:09:14.978734 [info ] [MainThread]: 
[0m16:09:14.979043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:09:14.981976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:09:14.988957 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:09:14.989223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:09:14.989428 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:09:14.990475 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:09:14.990653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:14.990824 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:09:14.991540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:15.684028 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:09:15.685027 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:09:15.692965 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:09:15.693756 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:09:15.832825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_gold_layer)
[0m16:09:15.833115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_silver_layer)
[0m16:09:15.833436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m16:09:15.837444 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m16:09:15.838431 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m16:09:15.839346 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m16:09:15.839515 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m16:09:15.839675 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m16:09:15.839829 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m16:09:15.839970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:15.840111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:15.840248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:16.280541 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:09:16.281679 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m16:09:16.295623 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:09:16.296429 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m16:09:16.304247 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m16:09:16.305466 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m16:09:16.446827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1660ee350>]}
[0m16:09:16.447175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:16.447341 [info ] [MainThread]: 
[0m16:09:16.449487 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m16:09:16.449691 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m16:09:16.450001 [info ] [Thread-1 (]: 1 of 32 START sql table model silver_layer.clean_crm_data ...................... [RUN]
[0m16:09:16.450425 [info ] [Thread-2 (]: 2 of 32 START sql table model silver_layer.clean_device_data ................... [RUN]
[0m16:09:16.450780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now model.my_dbt_project.clean_crm_data)
[0m16:09:16.451083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now model.my_dbt_project.clean_device_data)
[0m16:09:16.451652 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m16:09:16.451316 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m16:09:16.456774 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
[0m16:09:16.459225 [info ] [Thread-1 (]: import_crm: 
[0m16:09:16.459513 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m16:09:16.459707 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m16:09:16.460136 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m16:09:16.460352 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m16:09:16.475437 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m16:09:16.477077 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m16:09:16.478396 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m16:09:16.479225 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m16:09:16.479495 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m16:09:16.479798 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m16:09:16.480027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:16.480193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:22.936361 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m16:09:22.947254 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m16:09:23.072945 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1632f8790>]}
[0m16:09:23.073350 [info ] [Thread-2 (]: 2 of 32 OK created sql table model silver_layer.clean_device_data .............. [[32mSUCCESS 1[0m in 6.62s]
[0m16:09:23.073656 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m16:09:36.913531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 20.0 seconds
[0m16:09:36.914545 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m16:09:37.086976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1662a1450>]}
[0m16:09:37.087367 [info ] [Thread-1 (]: 1 of 32 OK created sql table model silver_layer.clean_crm_data ................. [[32mSUCCESS 1[0m in 20.64s]
[0m16:09:37.087654 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m16:09:37.088089 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m16:09:37.088295 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m16:09:37.088518 [info ] [Thread-4 (]: 3 of 32 START sql table model silver_layer.crm_device_data ..................... [RUN]
[0m16:09:37.088763 [info ] [Thread-3 (]: 4 of 32 START sql table model silver_layer.enriched_data ....................... [RUN]
[0m16:09:37.089102 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m16:09:37.089310 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.enriched_data)
[0m16:09:37.089487 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m16:09:37.089645 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m16:09:37.091700 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m16:09:37.094106 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m16:09:37.094504 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m16:09:37.094904 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m16:09:37.095086 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m16:09:37.096865 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m16:09:37.098278 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m16:09:37.099693 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m16:09:37.100341 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m16:09:37.100776 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.REV AS revenue
    LEFT JOIN PROJECT_SEC2_DB.silver_layer.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.silver_layer.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m16:09:37.101133 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.crm_device_data
         as
        (
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.silver_layer.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.silver_layer.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m16:09:37.101360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:37.101538 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:09:43.422880 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m16:09:43.424633 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m16:09:43.547313 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166192ad0>]}
[0m16:09:43.547699 [info ] [Thread-3 (]: 4 of 32 OK created sql table model silver_layer.enriched_data .................. [[32mSUCCESS 1[0m in 6.46s]
[0m16:09:43.547990 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m16:09:43.548484 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m16:09:43.548670 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m16:09:43.548835 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:09:43.549053 [info ] [Thread-1 (]: 5 of 32 START sql view model gold_layer.brand_by_age_segment ................... [RUN]
[0m16:09:43.549287 [info ] [Thread-2 (]: 6 of 32 START sql view model gold_layer.customers_by_brand_overall ............. [RUN]
[0m16:09:43.549529 [info ] [Thread-3 (]: 7 of 32 START sql view model gold_layer.customers_by_brand_week_wise ........... [RUN]
[0m16:09:43.549766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m16:09:43.549979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m16:09:43.550171 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m16:09:43.550362 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m16:09:43.550530 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m16:09:43.550699 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m16:09:43.552776 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m16:09:43.554460 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:09:43.556329 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:09:43.556867 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m16:09:43.557043 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m16:09:43.569033 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m16:09:43.569532 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:09:43.571761 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m16:09:43.573194 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:09:43.574485 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m16:09:43.574865 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m16:09:43.575186 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.brand_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m16:09:43.575464 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_brand_overall
  
   as (
    
select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m16:09:43.575826 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:09:43.576015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:43.576202 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:43.576381 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_brand_week_wise
  
   as (
    
select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m16:09:43.577592 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:44.088802 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:44.089923 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m16:09:44.103084 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:44.103935 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m16:09:44.132234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:44.133049 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m16:09:44.236295 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1662d0f10>]}
[0m16:09:44.236577 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1661ada50>]}
[0m16:09:44.236923 [info ] [Thread-3 (]: 7 of 32 OK created sql view model gold_layer.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.69s]
[0m16:09:44.237187 [info ] [Thread-2 (]: 6 of 32 OK created sql view model gold_layer.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.69s]
[0m16:09:44.237560 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:09:44.237802 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m16:09:44.238021 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:09:44.238256 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:09:44.238501 [info ] [Thread-3 (]: 8 of 32 START sql view model gold_layer.customers_by_mobile_type_overall ....... [RUN]
[0m16:09:44.238738 [info ] [Thread-2 (]: 9 of 32 START sql view model gold_layer.customers_by_mobile_type_week_wise ..... [RUN]
[0m16:09:44.238960 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m16:09:44.239163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m16:09:44.239338 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:09:44.239511 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:09:44.241595 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:09:44.243157 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:09:44.243576 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:09:44.243740 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:09:44.245205 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:09:44.246534 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:09:44.247351 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:09:44.247812 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:09:44.248013 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m16:09:44.248248 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_mobile_type_overall
  
   as (
    
select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m16:09:44.248490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:44.248933 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:44.261777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166022210>]}
[0m16:09:44.262247 [info ] [Thread-1 (]: 5 of 32 OK created sql view model gold_layer.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.71s]
[0m16:09:44.262618 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m16:09:44.262905 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m16:09:44.263336 [info ] [Thread-1 (]: 10 of 32 START sql view model gold_layer.customers_by_os_overall ............... [RUN]
[0m16:09:44.263850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m16:09:44.264072 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m16:09:44.266212 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m16:09:44.266605 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m16:09:44.267917 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m16:09:44.268366 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m16:09:44.268542 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_os_overall
  
   as (
    
select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.silver_layer.enriched_data
where os_name is not null
group by os_name
  );
[0m16:09:44.268736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:44.796960 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:44.797981 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m16:09:44.816183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:44.816477 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:44.817312 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m16:09:44.818129 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m16:09:44.954071 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16646a150>]}
[0m16:09:44.954373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3fa10>]}
[0m16:09:44.954598 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16644d9d0>]}
[0m16:09:44.954950 [info ] [Thread-3 (]: 8 of 32 OK created sql view model gold_layer.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.72s]
[0m16:09:44.955274 [info ] [Thread-1 (]: 10 of 32 OK created sql view model gold_layer.customers_by_os_overall .......... [[32mSUCCESS 1[0m in 0.69s]
[0m16:09:44.955572 [info ] [Thread-2 (]: 9 of 32 OK created sql view model gold_layer.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.72s]
[0m16:09:44.955867 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:09:44.956104 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m16:09:44.956335 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:09:44.956520 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m16:09:44.956743 [debug] [Thread-1 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m16:09:44.956987 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m16:09:44.957253 [info ] [Thread-3 (]: 11 of 32 START sql view model gold_layer.customers_by_os_week_wise ............. [RUN]
[0m16:09:44.957443 [info ] [Thread-1 (]: 12 of 32 START sql view model gold_layer.os_by_age_segment ..................... [RUN]
[0m16:09:44.957679 [info ] [Thread-2 (]: 13 of 32 START sql view model gold_layer.revenue_by_age_overall ................ [RUN]
[0m16:09:44.957950 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m16:09:44.958120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.os_by_age_segment)
[0m16:09:44.958296 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m16:09:44.958457 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m16:09:44.958628 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m16:09:44.958830 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m16:09:44.960837 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:09:44.962671 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m16:09:44.964338 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:09:44.964857 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m16:09:44.965036 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m16:09:44.965189 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m16:09:44.966481 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:09:44.967733 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:09:44.968926 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m16:09:44.969489 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m16:09:44.969838 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m16:09:44.970086 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_age_overall
  
   as (
    
select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data
where age is not null
group by age
order by age
  );
[0m16:09:44.970280 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_os_week_wise
  
   as (
    
select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m16:09:44.970492 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:44.971247 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m16:09:44.971412 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:44.971662 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.os_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m16:09:44.972770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:45.485069 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:45.485417 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:45.486438 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m16:09:45.487268 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m16:09:45.495374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:45.496198 [debug] [Thread-1 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m16:09:45.671696 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165598390>]}
[0m16:09:45.671969 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165599750>]}
[0m16:09:45.672189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1655998d0>]}
[0m16:09:45.672517 [info ] [Thread-3 (]: 11 of 32 OK created sql view model gold_layer.customers_by_os_week_wise ........ [[32mSUCCESS 1[0m in 0.71s]
[0m16:09:45.672822 [info ] [Thread-2 (]: 13 of 32 OK created sql view model gold_layer.revenue_by_age_overall ........... [[32mSUCCESS 1[0m in 0.71s]
[0m16:09:45.673127 [info ] [Thread-1 (]: 12 of 32 OK created sql view model gold_layer.os_by_age_segment ................ [[32mSUCCESS 1[0m in 0.71s]
[0m16:09:45.673429 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m16:09:45.673660 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m16:09:45.673878 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m16:09:45.674087 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:09:45.674310 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m16:09:45.674497 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:09:45.674719 [info ] [Thread-3 (]: 14 of 32 START sql view model gold_layer.revenue_by_age_week_wise .............. [RUN]
[0m16:09:45.674944 [info ] [Thread-2 (]: 15 of 32 START sql view model gold_layer.revenue_by_brand_overall .............. [RUN]
[0m16:09:45.675193 [info ] [Thread-1 (]: 16 of 32 START sql view model gold_layer.revenue_by_brand_week_wise ............ [RUN]
[0m16:09:45.675422 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_age_week_wise)
[0m16:09:45.675611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_brand_overall)
[0m16:09:45.675784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m16:09:45.675986 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m16:09:45.676157 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m16:09:45.676316 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:09:45.678557 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:09:45.680123 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:09:45.682701 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:09:45.683452 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m16:09:45.683623 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:09:45.683788 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m16:09:45.686227 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:09:45.687496 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:09:45.688714 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:09:45.689330 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:09:45.689723 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:09:45.689918 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_age_week_wise
  
   as (
    
select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m16:09:45.690260 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m16:09:45.690448 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_brand_week_wise
  
   as (
    
select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m16:09:45.690627 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:45.690816 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_brand_overall
  
   as (
    
select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m16:09:45.690984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:45.691501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:46.206671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:46.207691 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m16:09:46.213910 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:46.214726 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m16:09:46.231509 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:46.232349 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m16:09:46.351507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16556dc10>]}
[0m16:09:46.351871 [info ] [Thread-1 (]: 16 of 32 OK created sql view model gold_layer.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.68s]
[0m16:09:46.352156 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:09:46.352369 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m16:09:46.352629 [info ] [Thread-1 (]: 17 of 32 START sql view model gold_layer.revenue_by_gender_overall ............. [RUN]
[0m16:09:46.352829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_gender_overall)
[0m16:09:46.352991 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m16:09:46.354926 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:09:46.355538 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m16:09:46.356972 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:09:46.357245 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1661b3950>]}
[0m16:09:46.357582 [info ] [Thread-2 (]: 15 of 32 OK created sql view model gold_layer.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.68s]
[0m16:09:46.357915 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m16:09:46.358351 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m16:09:46.358580 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:09:46.358793 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_gender_overall
  
   as (
    
select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.silver_layer.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m16:09:46.359029 [info ] [Thread-2 (]: 18 of 32 START sql view model gold_layer.revenue_by_gender_week_wise ........... [RUN]
[0m16:09:46.359224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:46.359421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m16:09:46.359628 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:09:46.361726 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:09:46.362419 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:09:46.363928 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:09:46.364888 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:09:46.365496 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_gender_week_wise
  
   as (
    
select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m16:09:46.365721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:46.371577 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16603be50>]}
[0m16:09:46.372027 [info ] [Thread-3 (]: 14 of 32 OK created sql view model gold_layer.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.70s]
[0m16:09:46.372411 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:09:46.372670 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:09:46.372963 [info ] [Thread-3 (]: 19 of 32 START sql view model gold_layer.revenue_by_mobile_type_overall ........ [RUN]
[0m16:09:46.373394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m16:09:46.373601 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:09:46.375371 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:09:46.375679 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:09:46.377839 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:09:46.378313 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:09:46.378709 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_mobile_type_overall
  
   as (
    
select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m16:09:46.378955 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:46.849700 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:46.850724 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m16:09:46.864929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:46.865759 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m16:09:46.871890 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:46.872700 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m16:09:46.997436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5e550>]}
[0m16:09:46.997807 [info ] [Thread-2 (]: 18 of 32 OK created sql view model gold_layer.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.64s]
[0m16:09:46.998091 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:09:46.998330 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:09:46.998551 [info ] [Thread-2 (]: 20 of 32 START sql view model gold_layer.revenue_by_mobile_type_week_wise ...... [RUN]
[0m16:09:46.998814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m16:09:46.998995 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:09:47.000938 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:09:47.001328 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:09:47.002630 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:09:47.003159 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 10.0 seconds
[0m16:09:47.003945 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m16:09:47.004315 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:09:47.004999 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m16:09:47.005537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:47.010845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166115910>]}
[0m16:09:47.011196 [info ] [Thread-1 (]: 17 of 32 OK created sql view model gold_layer.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.66s]
[0m16:09:47.011494 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m16:09:47.011727 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m16:09:47.011991 [info ] [Thread-1 (]: 21 of 32 START sql view model gold_layer.revenue_by_os_overall ................. [RUN]
[0m16:09:47.012286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m16:09:47.012579 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m16:09:47.016337 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:09:47.018213 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m16:09:47.020196 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:09:47.020481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1661bb110>]}
[0m16:09:47.020825 [info ] [Thread-3 (]: 19 of 32 OK created sql view model gold_layer.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.65s]
[0m16:09:47.021130 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:09:47.021476 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m16:09:47.021688 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:09:47.021894 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_os_overall
  
   as (
    
select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m16:09:47.022118 [info ] [Thread-3 (]: 22 of 32 START sql view model gold_layer.revenue_by_os_vendor_overall .......... [RUN]
[0m16:09:47.022311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:47.022502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m16:09:47.022990 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:09:47.024929 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:09:47.025354 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:09:47.027556 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:09:47.028644 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:09:47.028875 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_os_vendor_overall
  
   as (
    
select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m16:09:47.029091 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:47.148239 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1662a3390>]}
[0m16:09:47.148665 [info ] [Thread-4 (]: 3 of 32 OK created sql table model silver_layer.crm_device_data ................ [[32mSUCCESS 1[0m in 10.06s]
[0m16:09:47.149033 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m16:09:47.149252 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:09:47.149514 [info ] [Thread-4 (]: 23 of 32 START sql view model gold_layer.revenue_by_os_vendor_week_wise ........ [RUN]
[0m16:09:47.149779 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m16:09:47.149955 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:09:47.151942 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:09:47.152323 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:09:47.153644 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:09:47.154157 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:09:47.154351 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_os_vendor_week_wise
  
   as (
    
select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m16:09:47.154528 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:47.485275 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:47.486263 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m16:09:47.582184 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:47.583123 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m16:09:47.592830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:47.593650 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m16:09:47.617814 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1636c9a50>]}
[0m16:09:47.618152 [info ] [Thread-2 (]: 20 of 32 OK created sql view model gold_layer.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.62s]
[0m16:09:47.618436 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:09:47.618649 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:09:47.618899 [info ] [Thread-2 (]: 24 of 32 START sql view model gold_layer.revenue_by_os_week_wise ............... [RUN]
[0m16:09:47.619097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m16:09:47.619257 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m16:09:47.621198 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:09:47.621600 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m16:09:47.622879 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:09:47.623359 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:09:47.623542 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_os_week_wise
  
   as (
    
select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m16:09:47.623708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:47.734040 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16528d750>]}
[0m16:09:47.734459 [info ] [Thread-3 (]: 22 of 32 OK created sql view model gold_layer.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.71s]
[0m16:09:47.734977 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:47.735288 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:09:47.736181 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m16:09:47.736409 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:09:47.737403 [info ] [Thread-3 (]: 25 of 32 START sql view model gold_layer.revenue_by_value_segment_overall ...... [RUN]
[0m16:09:47.737903 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m16:09:47.738159 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:09:47.738407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16565d110>]}
[0m16:09:47.740445 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:09:47.741810 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:09:47.743280 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:09:47.744212 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:09:47.744430 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_value_segment_overall
  
   as (
    
select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m16:09:47.744629 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:47.922087 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1662d1290>]}
[0m16:09:48.143709 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:48.144728 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m16:09:48.228430 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:48.229398 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m16:09:48.269417 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165598d50>]}
[0m16:09:48.357937 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1661b2710>]}
[0m16:09:49.317594 [info ] [Thread-1 (]: 21 of 32 OK created sql view model gold_layer.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.73s]
[0m16:09:49.317884 [info ] [Thread-4 (]: 23 of 32 OK created sql view model gold_layer.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.77s]
[0m16:09:49.318164 [info ] [Thread-2 (]: 24 of 32 OK created sql view model gold_layer.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.65s]
[0m16:09:49.318367 [info ] [Thread-3 (]: 25 of 32 OK created sql view model gold_layer.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.62s]
[0m16:09:49.319025 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m16:09:49.319313 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:09:49.319564 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:09:49.319805 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:09:49.320022 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:09:49.320248 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m16:09:49.320457 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m16:09:49.320650 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_overall
[0m16:09:49.320894 [info ] [Thread-1 (]: 26 of 32 START sql view model gold_layer.revenue_by_value_segment_week_wise .... [RUN]
[0m16:09:49.321141 [info ] [Thread-4 (]: 27 of 32 START sql view model gold_layer.total_customers_overall ............... [RUN]
[0m16:09:49.321382 [info ] [Thread-2 (]: 28 of 32 START sql view model gold_layer.total_customers_week_wise ............. [RUN]
[0m16:09:49.321635 [info ] [Thread-3 (]: 29 of 32 START sql view model gold_layer.total_devices_overall ................. [RUN]
[0m16:09:49.321879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m16:09:49.322066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m16:09:49.322270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m16:09:49.322431 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m16:09:49.322600 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:09:49.322753 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m16:09:49.322917 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m16:09:49.323075 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m16:09:49.325210 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:09:49.326878 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m16:09:49.329586 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m16:09:49.332434 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m16:09:49.333213 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:09:49.333515 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m16:09:49.333688 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m16:09:49.333912 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m16:09:49.335321 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:09:49.336593 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m16:09:49.337837 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m16:09:49.339014 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m16:09:49.339574 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:09:49.340057 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m16:09:49.340320 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_value_segment_week_wise
  
   as (
    
select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m16:09:49.340604 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.total_customers_overall
  
   as (
    
with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m16:09:49.341199 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m16:09:49.341718 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m16:09:49.341891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:49.342058 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:49.342251 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.total_customers_week_wise
  
   as (
    
with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m16:09:49.342473 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.total_devices_overall
  
   as (
    
with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m16:09:49.343703 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:49.343900 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:49.880531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:49.881578 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m16:09:49.961524 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:49.961830 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:49.962692 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m16:09:49.963519 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_overall: Close
[0m16:09:49.978068 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:49.979117 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: Close
[0m16:09:50.031458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16603b550>]}
[0m16:09:50.031823 [info ] [Thread-1 (]: 26 of 32 OK created sql view model gold_layer.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.71s]
[0m16:09:50.032100 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:09:50.032300 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m16:09:50.032516 [info ] [Thread-1 (]: 30 of 32 START sql view model gold_layer.total_devices_week_wise ............... [RUN]
[0m16:09:50.032716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m16:09:50.032875 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m16:09:50.034762 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m16:09:50.035593 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m16:09:50.038048 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m16:09:50.039143 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m16:09:50.039415 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.total_devices_week_wise
  
   as (
    
with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m16:09:50.039664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:50.098277 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1637e6d10>]}
[0m16:09:50.098715 [info ] [Thread-2 (]: 28 of 32 OK created sql view model gold_layer.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 0.78s]
[0m16:09:50.099034 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m16:09:50.099252 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:09:50.099510 [info ] [Thread-2 (]: 31 of 32 START sql view model gold_layer.weekly_revenue_by_brand ............... [RUN]
[0m16:09:50.099762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m16:09:50.099935 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m16:09:50.101879 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:09:50.102519 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m16:09:50.104293 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:09:50.104614 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16528d750>]}
[0m16:09:50.105107 [info ] [Thread-4 (]: 27 of 32 OK created sql view model gold_layer.total_customers_overall .......... [[32mSUCCESS 1[0m in 0.78s]
[0m16:09:50.105634 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m16:09:50.105983 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m16:09:50.106922 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:09:50.106297 [info ] [Thread-4 (]: 32 of 32 START sql view model gold_layer.weekly_revenue_by_os .................. [RUN]
[0m16:09:50.107414 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.weekly_revenue_by_brand
  
   as (
    
SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.silver_layer.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m16:09:50.107801 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m16:09:50.108050 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:50.108271 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m16:09:50.111368 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:09:50.113222 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m16:09:50.115343 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:09:50.115756 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1652a7c90>]}
[0m16:09:50.116507 [info ] [Thread-3 (]: 29 of 32 OK created sql view model gold_layer.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.79s]
[0m16:09:50.117141 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m16:09:50.117630 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m16:09:50.117894 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.weekly_revenue_by_os
  
   as (
    
SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.silver_layer.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m16:09:50.118202 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:50.532077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:50.533106 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m16:09:50.584776 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:50.585075 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:50.585915 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m16:09:50.586647 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m16:09:50.686638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16600cb90>]}
[0m16:09:50.687021 [info ] [Thread-1 (]: 30 of 32 OK created sql view model gold_layer.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 0.65s]
[0m16:09:50.687308 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m16:09:50.739469 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a04650>]}
[0m16:09:50.739771 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1063079d-3fcd-450f-8734-8150a010b356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a48650>]}
[0m16:09:50.740142 [info ] [Thread-4 (]: 32 of 32 OK created sql view model gold_layer.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 0.63s]
[0m16:09:50.740762 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m16:09:50.740506 [info ] [Thread-2 (]: 31 of 32 OK created sql view model gold_layer.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 0.64s]
[0m16:09:50.741152 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:09:50.741953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:50.742103 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m16:09:50.742221 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m16:09:50.742331 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_overall' was properly closed.
[0m16:09:50.742442 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m16:09:50.742635 [info ] [MainThread]: 
[0m16:09:50.742781 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 35.76 seconds (35.76s).
[0m16:09:50.744558 [debug] [MainThread]: Command end result
[0m16:09:50.765259 [info ] [MainThread]: 
[0m16:09:50.765637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:50.765810 [info ] [MainThread]: 
[0m16:09:50.765962 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m16:09:50.768172 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.533234, "process_user_time": 4.094358, "process_kernel_time": 1.40181, "process_mem_max_rss": "207192064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:09:50.768431 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:50.768390 after 37.53 seconds
[0m16:09:50.768612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e8c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca1a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dbe250>]}
[0m16:09:50.768779 [debug] [MainThread]: Flushing usage events
[0m16:10:23.347330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11068b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106dcc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ebc10>]}


============================== 16:10:23.350241 | efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a ==============================
[0m16:10:23.350241 [info ] [MainThread]: Running with dbt=1.8.1
[0m16:10:23.350604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'send_anonymous_usage_stats': 'True'}
[0m16:10:24.073813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144650e90>]}
[0m16:10:24.097737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110143110>]}
[0m16:10:24.098389 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:10:24.111641 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m16:10:24.180983 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:10:24.181330 [debug] [MainThread]: previous checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, current checksum: 063d3ef175a5b1fcab0eecf34ba8e773844ff593c591f241a5b953bd6df8881d
[0m16:10:24.181526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738e750>]}
[0m16:10:24.641030 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m16:10:24.651115 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m16:10:24.657608 [info ] [MainThread]: import_crm: 
[0m16:10:24.885408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1447e0650>]}
[0m16:10:24.938167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e83ed0>]}
[0m16:10:24.938465 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m16:10:24.938640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144bc4950>]}
[0m16:10:24.939818 [info ] [MainThread]: 
[0m16:10:24.940111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:24.942825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:10:24.943062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:10:24.949667 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:10:24.950759 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:10:24.950936 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:10:24.951115 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:10:24.951263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:24.951422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:25.712773 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:10:25.713743 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:10:25.757820 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:10:25.758598 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:10:25.894703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now create_PROJECT_SEC2_DB_test_gold_layer)
[0m16:10:25.895082 [debug] [ThreadPool]: Creating schema "database: "PROJECT_SEC2_DB"
schema: "test_gold_layer"
"
[0m16:10:25.897609 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_SEC2_DB_test_gold_layer"
[0m16:10:25.897788 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "create_PROJECT_SEC2_DB_test_gold_layer"} */
create schema if not exists PROJECT_SEC2_DB.test_gold_layer
[0m16:10:25.897932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:26.354644 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:26.355241 [debug] [ThreadPool]: On create_PROJECT_SEC2_DB_test_gold_layer: Close
[0m16:10:26.539383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_gold_layer)
[0m16:10:26.539702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PROJECT_SEC2_DB_test_gold_layer, now list_PROJECT_SEC2_DB_SEEDS)
[0m16:10:26.539963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_test_silver_layer'
[0m16:10:26.543882 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m16:10:26.544917 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m16:10:26.545866 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m16:10:26.546033 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m16:10:26.546203 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m16:10:26.546357 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m16:10:26.546506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:26.546636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:26.546763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:27.010798 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m16:10:27.011625 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m16:10:27.026037 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:10:27.026356 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:10:27.027162 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m16:10:27.027960 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m16:10:27.161494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a67650>]}
[0m16:10:27.161883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:27.162078 [info ] [MainThread]: 
[0m16:10:27.163510 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m16:10:27.163726 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m16:10:27.163983 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m16:10:27.164240 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m16:10:27.164491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_gold_layer, now model.my_dbt_project.clean_crm_data)
[0m16:10:27.164683 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_device_data)
[0m16:10:27.164868 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m16:10:27.165049 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m16:10:27.169938 [info ] [Thread-1 (]: import_crm: 
[0m16:10:27.172351 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m16:10:27.172055 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m16:10:27.172748 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m16:10:27.172982 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m16:10:27.186648 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m16:10:27.206935 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m16:10:27.208881 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m16:10:27.212147 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m16:10:27.212518 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m16:10:27.212738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:27.215824 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m16:10:27.216134 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m16:10:27.216349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:28.271690 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:28.282471 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m16:10:28.369088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:28.370011 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m16:10:28.472476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685bd10>]}
[0m16:10:28.472881 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.31s]
[0m16:10:28.473172 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m16:10:28.502850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144736010>]}
[0m16:10:28.503291 [info ] [Thread-1 (]: 1 of 32 OK created sql table model test_silver_layer.clean_crm_data ............ [[32mSUCCESS 1[0m in 1.34s]
[0m16:10:28.503571 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m16:10:28.503995 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m16:10:28.504266 [info ] [Thread-4 (]: 3 of 32 START sql table model test_silver_layer.crm_device_data ................ [RUN]
[0m16:10:28.504516 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m16:10:28.504771 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m16:10:28.504980 [info ] [Thread-3 (]: 4 of 32 START sql table model test_silver_layer.enriched_data .................. [RUN]
[0m16:10:28.505221 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m16:10:28.505447 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_silver_layer, now model.my_dbt_project.enriched_data)
[0m16:10:28.507516 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m16:10:28.507709 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m16:10:28.510020 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m16:10:28.510583 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m16:10:28.510869 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m16:10:28.512694 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m16:10:28.513134 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m16:10:28.514660 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m16:10:28.515246 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m16:10:28.515509 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.crm_device_data
         as
        (
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m16:10:28.515717 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:10:28.516426 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m16:10:28.516653 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m16:10:28.517200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:29.408996 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:29.410342 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m16:10:29.441940 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:29.442826 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m16:10:29.601468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1447d2410>]}
[0m16:10:29.601748 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e83e10>]}
[0m16:10:29.602089 [info ] [Thread-3 (]: 4 of 32 OK created sql table model test_silver_layer.enriched_data ............. [[32mSUCCESS 1[0m in 1.10s]
[0m16:10:29.602404 [info ] [Thread-4 (]: 3 of 32 OK created sql table model test_silver_layer.crm_device_data ........... [[32mSUCCESS 1[0m in 1.10s]
[0m16:10:29.602709 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m16:10:29.602967 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m16:10:29.603583 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m16:10:29.603765 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m16:10:29.603957 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:10:29.604141 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:10:29.604335 [info ] [Thread-1 (]: 5 of 32 START sql view model test_gold_layer.brand_by_age_segment .............. [RUN]
[0m16:10:29.604578 [info ] [Thread-2 (]: 6 of 32 START sql view model test_gold_layer.customers_by_brand_overall ........ [RUN]
[0m16:10:29.604847 [info ] [Thread-3 (]: 7 of 32 START sql view model test_gold_layer.customers_by_brand_week_wise ...... [RUN]
[0m16:10:29.605107 [info ] [Thread-4 (]: 8 of 32 START sql view model test_gold_layer.customers_by_mobile_type_overall .. [RUN]
[0m16:10:29.605337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m16:10:29.605526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m16:10:29.605695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m16:10:29.605855 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m16:10:29.606018 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m16:10:29.606179 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m16:10:29.606341 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m16:10:29.606519 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:10:29.608778 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m16:10:29.610439 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:10:29.612079 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:10:29.614641 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:10:29.615245 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m16:10:29.615428 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m16:10:29.615613 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m16:10:29.625454 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m16:10:29.627042 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:10:29.627288 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:10:29.629207 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:10:29.631792 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:10:29.633380 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m16:10:29.634123 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m16:10:29.634973 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.brand_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m16:10:29.635498 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:10:29.636069 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:10:29.636517 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_brand_overall
  
   as (
    
select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m16:10:29.636945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:29.637195 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_brand_week_wise
  
   as (
    
select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m16:10:29.637639 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_mobile_type_overall
  
   as (
    
select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m16:10:29.638080 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:29.638814 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:29.639451 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:30.170552 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:30.172764 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m16:10:30.174110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:30.174875 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m16:10:30.185118 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:30.185921 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m16:10:30.188720 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:30.189502 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m16:10:30.316761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1450c2690>]}
[0m16:10:30.317132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1450bc310>]}
[0m16:10:30.317434 [info ] [Thread-2 (]: 6 of 32 OK created sql view model test_gold_layer.customers_by_brand_overall ... [[32mSUCCESS 1[0m in 0.71s]
[0m16:10:30.318169 [info ] [Thread-1 (]: 5 of 32 OK created sql view model test_gold_layer.brand_by_age_segment ......... [[32mSUCCESS 1[0m in 0.71s]
[0m16:10:30.318601 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m16:10:30.318954 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m16:10:30.319232 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:10:30.319517 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m16:10:30.319778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1450c3690>]}
[0m16:10:30.320009 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1450df350>]}
[0m16:10:30.320258 [info ] [Thread-2 (]: 9 of 32 START sql view model test_gold_layer.customers_by_mobile_type_week_wise  [RUN]
[0m16:10:30.320497 [info ] [Thread-1 (]: 10 of 32 START sql view model test_gold_layer.customers_by_os_overall .......... [RUN]
[0m16:10:30.320788 [info ] [Thread-3 (]: 7 of 32 OK created sql view model test_gold_layer.customers_by_brand_week_wise . [[32mSUCCESS 1[0m in 0.71s]
[0m16:10:30.321080 [info ] [Thread-4 (]: 8 of 32 OK created sql view model test_gold_layer.customers_by_mobile_type_overall  [[32mSUCCESS 1[0m in 0.71s]
[0m16:10:30.321310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m16:10:30.321505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m16:10:30.321752 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:10:30.321984 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:10:30.322147 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:10:30.322300 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m16:10:30.322478 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m16:10:30.322848 [debug] [Thread-4 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m16:10:30.325007 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:10:30.326770 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m16:10:30.327054 [info ] [Thread-3 (]: 11 of 32 START sql view model test_gold_layer.customers_by_os_week_wise ........ [RUN]
[0m16:10:30.327329 [info ] [Thread-4 (]: 12 of 32 START sql view model test_gold_layer.os_by_age_segment ................ [RUN]
[0m16:10:30.327821 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_week_wise)
[0m16:10:30.328141 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.os_by_age_segment)
[0m16:10:30.328576 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m16:10:30.328862 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m16:10:30.329051 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:10:30.329224 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m16:10:30.331749 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m16:10:30.333561 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:10:30.334840 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:10:30.336628 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m16:10:30.337155 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m16:10:30.337489 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m16:10:30.338727 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:10:30.338891 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m16:10:30.339257 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:10:30.339617 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_os_overall
  
   as (
    
select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by os_name
  );
[0m16:10:30.341967 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m16:10:30.342479 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m16:10:30.342928 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m16:10:30.343178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:30.343883 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_os_week_wise
  
   as (
    
select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m16:10:30.345208 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m16:10:30.345615 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:30.346925 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:30.347471 [debug] [Thread-4 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.os_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m16:10:30.351075 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:30.826879 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:30.827248 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:30.828231 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m16:10:30.829004 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m16:10:30.834393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:30.835235 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m16:10:30.840786 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:30.841553 [debug] [Thread-4 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m16:10:30.994035 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ad98d0>]}
[0m16:10:30.994412 [info ] [Thread-3 (]: 11 of 32 OK created sql view model test_gold_layer.customers_by_os_week_wise ... [[32mSUCCESS 1[0m in 0.67s]
[0m16:10:30.994897 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m16:10:30.995112 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m16:10:30.995368 [info ] [Thread-3 (]: 13 of 32 START sql view model test_gold_layer.revenue_by_age_overall ........... [RUN]
[0m16:10:30.995611 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m16:10:30.995789 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m16:10:30.996006 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14562ed50>]}
[0m16:10:30.998033 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:10:30.998289 [info ] [Thread-4 (]: 12 of 32 OK created sql view model test_gold_layer.os_by_age_segment ........... [[32mSUCCESS 1[0m in 0.67s]
[0m16:10:30.999029 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m16:10:30.999267 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:10:30.999615 [info ] [Thread-4 (]: 14 of 32 START sql view model test_gold_layer.revenue_by_age_week_wise ......... [RUN]
[0m16:10:31.000082 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_age_week_wise)
[0m16:10:31.000411 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m16:10:31.000705 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m16:10:31.002289 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:10:31.002530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1456561d0>]}
[0m16:10:31.002745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1447e1a90>]}
[0m16:10:31.004401 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:10:31.004733 [info ] [Thread-1 (]: 10 of 32 OK created sql view model test_gold_layer.customers_by_os_overall ..... [[32mSUCCESS 1[0m in 0.68s]
[0m16:10:31.005063 [info ] [Thread-2 (]: 9 of 32 OK created sql view model test_gold_layer.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.68s]
[0m16:10:31.005456 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m16:10:31.005805 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m16:10:31.006060 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:10:31.006210 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m16:10:31.006398 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m16:10:31.006616 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_age_overall
  
   as (
    
select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by age
order by age
  );
[0m16:10:31.006821 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:10:31.009004 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:10:31.009220 [info ] [Thread-1 (]: 15 of 32 START sql view model test_gold_layer.revenue_by_brand_overall ......... [RUN]
[0m16:10:31.009417 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:31.009660 [info ] [Thread-2 (]: 16 of 32 START sql view model test_gold_layer.revenue_by_brand_week_wise ....... [RUN]
[0m16:10:31.010151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_brand_overall)
[0m16:10:31.011251 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:10:31.011940 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m16:10:31.012343 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m16:10:31.012700 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_age_week_wise
  
   as (
    
select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m16:10:31.012933 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:10:31.065975 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:10:31.066342 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:31.068398 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:10:31.069442 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m16:10:31.070864 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:10:31.071039 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:10:31.072335 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:10:31.073072 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m16:10:31.073438 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:10:31.073620 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_brand_overall
  
   as (
    
select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m16:10:31.073850 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_brand_week_wise
  
   as (
    
select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m16:10:31.074030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:31.074184 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:31.602467 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:31.603450 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m16:10:31.645970 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:31.646297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:31.647146 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m16:10:31.647918 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m16:10:31.651116 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:31.652027 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m16:10:31.749085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1451df350>]}
[0m16:10:31.749511 [info ] [Thread-3 (]: 13 of 32 OK created sql view model test_gold_layer.revenue_by_age_overall ...... [[32mSUCCESS 1[0m in 0.75s]
[0m16:10:31.749807 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m16:10:31.750006 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m16:10:31.750252 [info ] [Thread-3 (]: 17 of 32 START sql view model test_gold_layer.revenue_by_gender_overall ........ [RUN]
[0m16:10:31.750487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m16:10:31.750667 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m16:10:31.752643 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:10:31.753006 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m16:10:31.754261 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:10:31.754733 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m16:10:31.754914 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_gender_overall
  
   as (
    
select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m16:10:31.755081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:31.776600 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b50250>]}
[0m16:10:31.777018 [info ] [Thread-4 (]: 14 of 32 OK created sql view model test_gold_layer.revenue_by_age_week_wise .... [[32mSUCCESS 1[0m in 0.78s]
[0m16:10:31.777372 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:10:31.777674 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:10:31.777950 [info ] [Thread-4 (]: 18 of 32 START sql view model test_gold_layer.revenue_by_gender_week_wise ...... [RUN]
[0m16:10:31.778223 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m16:10:31.778445 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:10:31.781196 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:10:31.781911 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:10:31.784212 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:10:31.784479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14479fcd0>]}
[0m16:10:31.784846 [info ] [Thread-1 (]: 15 of 32 OK created sql view model test_gold_layer.revenue_by_brand_overall .... [[32mSUCCESS 1[0m in 0.77s]
[0m16:10:31.785144 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m16:10:31.785354 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:10:31.785712 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:10:31.785962 [info ] [Thread-1 (]: 19 of 32 START sql view model test_gold_layer.revenue_by_mobile_type_overall ... [RUN]
[0m16:10:31.786175 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_gender_week_wise
  
   as (
    
select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m16:10:31.786379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m16:10:31.786553 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:31.786715 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:10:31.788389 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:10:31.789562 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:10:31.790983 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:10:31.791273 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1447e79d0>]}
[0m16:10:31.791710 [info ] [Thread-2 (]: 16 of 32 OK created sql view model test_gold_layer.revenue_by_brand_week_wise .. [[32mSUCCESS 1[0m in 0.78s]
[0m16:10:31.792023 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:10:31.792364 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:10:31.792737 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:10:31.793247 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_mobile_type_overall
  
   as (
    
select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m16:10:31.794098 [info ] [Thread-2 (]: 20 of 32 START sql view model test_gold_layer.revenue_by_mobile_type_week_wise . [RUN]
[0m16:10:31.794630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:31.795074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m16:10:31.796135 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:10:31.800110 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:10:31.800719 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:10:31.802382 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:10:31.803098 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:10:31.803467 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m16:10:31.803846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:32.224959 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:32.225953 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m16:10:32.259408 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:32.260220 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m16:10:32.272150 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:32.272943 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m16:10:32.274089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:32.274864 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m16:10:32.364016 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ade790>]}
[0m16:10:32.364471 [info ] [Thread-3 (]: 17 of 32 OK created sql view model test_gold_layer.revenue_by_gender_overall ... [[32mSUCCESS 1[0m in 0.61s]
[0m16:10:32.365069 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m16:10:32.365462 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m16:10:32.365750 [info ] [Thread-3 (]: 21 of 32 START sql view model test_gold_layer.revenue_by_os_overall ............ [RUN]
[0m16:10:32.366093 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m16:10:32.366318 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m16:10:32.368325 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:10:32.368687 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m16:10:32.369988 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:10:32.370484 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m16:10:32.370752 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_overall
  
   as (
    
select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m16:10:32.370998 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:32.414962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1451dfcd0>]}
[0m16:10:32.415385 [info ] [Thread-4 (]: 18 of 32 OK created sql view model test_gold_layer.revenue_by_gender_week_wise . [[32mSUCCESS 1[0m in 0.64s]
[0m16:10:32.415669 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:10:32.415874 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:10:32.416099 [info ] [Thread-4 (]: 22 of 32 START sql view model test_gold_layer.revenue_by_os_vendor_overall ..... [RUN]
[0m16:10:32.416353 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m16:10:32.416548 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:10:32.418327 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:10:32.418685 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:10:32.420748 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:10:32.421239 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:10:32.421503 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_vendor_overall
  
   as (
    
select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m16:10:32.421730 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:32.444887 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1447fef90>]}
[0m16:10:32.445474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ac2f10>]}
[0m16:10:32.446028 [info ] [Thread-2 (]: 20 of 32 OK created sql view model test_gold_layer.revenue_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.65s]
[0m16:10:32.446745 [info ] [Thread-1 (]: 19 of 32 OK created sql view model test_gold_layer.revenue_by_mobile_type_overall  [[32mSUCCESS 1[0m in 0.66s]
[0m16:10:32.447272 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:10:32.447697 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:10:32.447947 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:10:32.448162 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:10:32.448438 [info ] [Thread-2 (]: 23 of 32 START sql view model test_gold_layer.revenue_by_os_vendor_week_wise ... [RUN]
[0m16:10:32.448756 [info ] [Thread-1 (]: 24 of 32 START sql view model test_gold_layer.revenue_by_os_week_wise .......... [RUN]
[0m16:10:32.449058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m16:10:32.449264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_week_wise)
[0m16:10:32.449468 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:10:32.449643 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m16:10:32.451760 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:10:32.453894 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:10:32.454436 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m16:10:32.455833 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:10:32.456053 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:10:32.457309 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:10:32.457779 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:10:32.458002 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_week_wise
  
   as (
    
select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m16:10:32.458398 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:10:32.458546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:32.458726 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_vendor_week_wise
  
   as (
    
select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m16:10:32.458942 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:32.873492 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:32.874461 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m16:10:32.896263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:32.897070 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m16:10:32.897986 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:32.898761 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m16:10:33.027918 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14565d450>]}
[0m16:10:33.028313 [info ] [Thread-3 (]: 21 of 32 OK created sql view model test_gold_layer.revenue_by_os_overall ....... [[32mSUCCESS 1[0m in 0.66s]
[0m16:10:33.028642 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m16:10:33.028872 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:10:33.029378 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:33.029596 [info ] [Thread-3 (]: 25 of 32 START sql view model test_gold_layer.revenue_by_value_segment_overall . [RUN]
[0m16:10:33.030461 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m16:10:33.030660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m16:10:33.031298 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:10:33.033441 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:10:33.033841 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:10:33.035258 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:10:33.036040 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:10:33.036278 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_value_segment_overall
  
   as (
    
select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m16:10:33.036492 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:33.081618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448b16d0>]}
[0m16:10:33.081924 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144857290>]}
[0m16:10:33.183940 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a57610>]}
[0m16:10:33.590440 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:33.591427 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m16:10:33.758593 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144862b90>]}
[0m16:10:34.615285 [info ] [Thread-1 (]: 24 of 32 OK created sql view model test_gold_layer.revenue_by_os_week_wise ..... [[32mSUCCESS 1[0m in 0.63s]
[0m16:10:34.615581 [info ] [Thread-4 (]: 22 of 32 OK created sql view model test_gold_layer.revenue_by_os_vendor_overall  [[32mSUCCESS 1[0m in 0.67s]
[0m16:10:34.615856 [info ] [Thread-2 (]: 23 of 32 OK created sql view model test_gold_layer.revenue_by_os_vendor_week_wise  [[32mSUCCESS 1[0m in 0.73s]
[0m16:10:34.616092 [info ] [Thread-3 (]: 25 of 32 OK created sql view model test_gold_layer.revenue_by_value_segment_overall  [[32mSUCCESS 1[0m in 0.73s]
[0m16:10:34.616616 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:10:34.616849 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:10:34.617112 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:10:34.617339 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:10:34.617548 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:10:34.617774 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m16:10:34.617998 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m16:10:34.618215 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_overall
[0m16:10:34.618443 [info ] [Thread-1 (]: 26 of 32 START sql view model test_gold_layer.revenue_by_value_segment_week_wise  [RUN]
[0m16:10:34.618693 [info ] [Thread-4 (]: 27 of 32 START sql view model test_gold_layer.total_customers_overall .......... [RUN]
[0m16:10:34.618905 [info ] [Thread-2 (]: 28 of 32 START sql view model test_gold_layer.total_customers_week_wise ........ [RUN]
[0m16:10:34.619132 [info ] [Thread-3 (]: 29 of 32 START sql view model test_gold_layer.total_devices_overall ............ [RUN]
[0m16:10:34.619398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m16:10:34.619607 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.total_customers_overall)
[0m16:10:34.619791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m16:10:34.619965 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m16:10:34.620133 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:10:34.620285 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m16:10:34.620441 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m16:10:34.620608 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m16:10:34.622542 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:10:34.624467 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m16:10:34.626124 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m16:10:34.628112 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m16:10:34.628911 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:10:34.629180 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m16:10:34.629432 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m16:10:34.631395 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:10:34.633161 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m16:10:34.633350 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m16:10:34.634575 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m16:10:34.635893 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m16:10:34.636634 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m16:10:34.637011 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:10:34.637573 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m16:10:34.637776 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_customers_overall
  
   as (
    
with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m16:10:34.638324 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m16:10:34.638496 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_value_segment_week_wise
  
   as (
    
select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m16:10:34.638706 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_customers_week_wise
  
   as (
    
with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m16:10:34.638923 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:34.639155 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_devices_overall
  
   as (
    
with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m16:10:34.639497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:34.639768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:34.640666 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:35.345387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:35.346449 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m16:10:35.382563 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:35.383410 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m16:10:35.383867 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:35.384629 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:35.385549 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_overall: Close
[0m16:10:35.386245 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_overall: Close
[0m16:10:35.536131 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144831d10>]}
[0m16:10:35.536417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14480e090>]}
[0m16:10:35.536639 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105bcd10>]}
[0m16:10:35.536969 [info ] [Thread-2 (]: 28 of 32 OK created sql view model test_gold_layer.total_customers_week_wise ... [[32mSUCCESS 1[0m in 0.92s]
[0m16:10:35.537306 [info ] [Thread-1 (]: 26 of 32 OK created sql view model test_gold_layer.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.92s]
[0m16:10:35.537603 [info ] [Thread-3 (]: 29 of 32 OK created sql view model test_gold_layer.total_devices_overall ....... [[32mSUCCESS 1[0m in 0.92s]
[0m16:10:35.537891 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m16:10:35.538121 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:10:35.538363 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m16:10:35.538572 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m16:10:35.538808 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:10:35.539021 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m16:10:35.539239 [info ] [Thread-2 (]: 30 of 32 START sql view model test_gold_layer.total_devices_week_wise .......... [RUN]
[0m16:10:35.539471 [info ] [Thread-1 (]: 31 of 32 START sql view model test_gold_layer.weekly_revenue_by_brand .......... [RUN]
[0m16:10:35.539728 [info ] [Thread-3 (]: 32 of 32 START sql view model test_gold_layer.weekly_revenue_by_os ............. [RUN]
[0m16:10:35.539964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m16:10:35.540155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m16:10:35.540329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m16:10:35.540495 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m16:10:35.540654 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m16:10:35.540812 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m16:10:35.543913 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m16:10:35.545582 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:10:35.547158 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:10:35.547610 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m16:10:35.547773 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m16:10:35.547925 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m16:10:35.549244 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:10:35.550509 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:10:35.551702 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m16:10:35.552290 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m16:10:35.552648 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:10:35.553236 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m16:10:35.553423 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.weekly_revenue_by_os
  
   as (
    
SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m16:10:35.553621 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.weekly_revenue_by_brand
  
   as (
    
SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m16:10:35.553832 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_devices_week_wise
  
   as (
    
with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m16:10:35.554022 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:35.554173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:35.554319 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:35.827773 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14480c810>]}
[0m16:10:35.828191 [info ] [Thread-4 (]: 27 of 32 OK created sql view model test_gold_layer.total_customers_overall ..... [[32mSUCCESS 1[0m in 1.21s]
[0m16:10:35.828482 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m16:10:36.158592 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:36.160290 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m16:10:36.161806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:36.163050 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m16:10:36.167343 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:36.168455 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m16:10:36.306493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110116510>]}
[0m16:10:36.306806 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448e3010>]}
[0m16:10:36.307041 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcc4e6e-3c97-4aa0-bdf8-03ea4a87526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e32b90>]}
[0m16:10:36.307385 [info ] [Thread-1 (]: 31 of 32 OK created sql view model test_gold_layer.weekly_revenue_by_brand ..... [[32mSUCCESS 1[0m in 0.77s]
[0m16:10:36.307691 [info ] [Thread-3 (]: 32 of 32 OK created sql view model test_gold_layer.weekly_revenue_by_os ........ [[32mSUCCESS 1[0m in 0.77s]
[0m16:10:36.308012 [info ] [Thread-2 (]: 30 of 32 OK created sql view model test_gold_layer.total_devices_week_wise ..... [[32mSUCCESS 1[0m in 0.77s]
[0m16:10:36.308307 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:10:36.308535 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m16:10:36.308750 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m16:10:36.309565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:36.309710 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m16:10:36.309839 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m16:10:36.309950 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m16:10:36.310060 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_overall' was properly closed.
[0m16:10:36.310289 [info ] [MainThread]: 
[0m16:10:36.310496 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 11.37 seconds (11.37s).
[0m16:10:36.312355 [debug] [MainThread]: Command end result
[0m16:10:36.332537 [info ] [MainThread]: 
[0m16:10:36.332820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:36.333013 [info ] [MainThread]: 
[0m16:10:36.333191 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m16:10:36.335310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.016404, "process_user_time": 4.048923, "process_kernel_time": 1.39683, "process_mem_max_rss": "199049216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:10:36.335566 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:36.335526 after 13.02 seconds
[0m16:10:36.335745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a28710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106dfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495a250>]}
[0m16:10:36.335909 [debug] [MainThread]: Flushing usage events
[0m16:43:36.909473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d46ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d9ab90>]}


============================== 16:43:36.912379 | 414b7906-069a-4f8c-9486-69ac5db46bde ==============================
[0m16:43:36.912379 [info ] [MainThread]: Running with dbt=1.8.1
[0m16:43:36.912715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:37.844749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140f578d0>]}
[0m16:43:37.867117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037f71d0>]}
[0m16:43:37.867730 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:43:37.881927 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m16:43:37.973926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:37.974169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:37.994227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140fb4690>]}
[0m16:43:38.050798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140fd97d0>]}
[0m16:43:38.051125 [info ] [MainThread]: Found 32 models, 4 seeds, 3 sources, 447 macros
[0m16:43:38.051307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140fb5890>]}
[0m16:43:38.052620 [info ] [MainThread]: 
[0m16:43:38.052999 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:38.055739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:43:38.056026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m16:43:38.106717 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:43:38.107851 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m16:43:38.108061 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:43:38.108263 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m16:43:38.108418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:38.108595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:38.873355 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m16:43:38.874326 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:43:38.882748 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m16:43:38.883471 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m16:43:39.014398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_gold_layer)
[0m16:43:39.014714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_silver_layer)
[0m16:43:39.014974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m16:43:39.019263 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m16:43:39.020124 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m16:43:39.021075 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m16:43:39.021250 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m16:43:39.021419 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m16:43:39.021581 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m16:43:39.021744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:39.021901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:39.022068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:39.602114 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:43:39.603086 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m16:43:39.603574 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:43:39.604775 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m16:43:39.627106 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m16:43:39.628333 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m16:43:39.754656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140674d50>]}
[0m16:43:39.754987 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:39.755158 [info ] [MainThread]: 
[0m16:43:39.757053 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m16:43:39.757245 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m16:43:39.757508 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m16:43:39.757960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_gold_layer, now model.my_dbt_project.clean_crm_data)
[0m16:43:39.757769 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m16:43:39.758186 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m16:43:39.758384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_silver_layer, now model.my_dbt_project.clean_device_data)
[0m16:43:39.764551 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m16:43:39.765148 [info ] [Thread-1 (]: import_crm: 
[0m16:43:39.769018 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m16:43:39.769430 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m16:43:39.769703 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m16:43:39.770390 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m16:43:39.776566 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m16:43:39.786670 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m16:43:39.789060 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m16:43:39.790333 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m16:43:39.791216 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m16:43:39.791486 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m16:43:39.791811 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

mode_values AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE WHEN SYSTEM_STATUS = 'Active' THEN 1 ELSE 2 END,
            CASE WHEN GENDER = 'Male' OR GENDER = 'Female' THEN 1 ELSE 2 END,
            GENDER
        ) AS rank
    FROM cleaned_crm
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM mode_values
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m16:43:39.792095 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:39.792298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:41.272602 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:41.283309 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m16:43:41.346772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:43:41.347899 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m16:43:41.418635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ebff90>]}
[0m16:43:41.419041 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.66s]
[0m16:43:41.419332 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m16:43:41.479783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a6af50>]}
[0m16:43:41.480178 [info ] [Thread-1 (]: 1 of 32 OK created sql table model test_silver_layer.clean_crm_data ............ [[32mSUCCESS 1[0m in 1.72s]
[0m16:43:41.480478 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m16:43:41.480914 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m16:43:41.481107 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m16:43:41.481346 [info ] [Thread-4 (]: 3 of 32 START sql table model test_silver_layer.crm_device_data ................ [RUN]
[0m16:43:41.481620 [info ] [Thread-3 (]: 4 of 32 START sql table model test_silver_layer.enriched_data .................. [RUN]
[0m16:43:41.481895 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m16:43:41.482096 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.enriched_data)
[0m16:43:41.482269 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m16:43:41.482445 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m16:43:41.485139 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m16:43:41.489596 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m16:43:41.489942 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m16:43:41.490204 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m16:43:41.491422 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m16:43:41.491643 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m16:43:41.493459 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m16:43:41.494243 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m16:43:41.495148 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m16:43:41.495481 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.crm_device_data
         as
        (
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m16:43:41.496025 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m16:43:41.496310 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:43:41.496512 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:42.765493 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:42.766612 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m16:43:42.852719 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:42.853664 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m16:43:42.896880 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147987090>]}
[0m16:43:42.897248 [info ] [Thread-3 (]: 4 of 32 OK created sql table model test_silver_layer.enriched_data ............. [[32mSUCCESS 1[0m in 1.41s]
[0m16:43:42.897537 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m16:43:42.898034 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m16:43:42.898219 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m16:43:42.898427 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:43:42.898673 [info ] [Thread-1 (]: 5 of 32 START sql view model test_gold_layer.brand_by_age_segment .............. [RUN]
[0m16:43:42.898946 [info ] [Thread-2 (]: 6 of 32 START sql view model test_gold_layer.customers_by_brand_overall ........ [RUN]
[0m16:43:42.899206 [info ] [Thread-3 (]: 7 of 32 START sql view model test_gold_layer.customers_by_brand_week_wise ...... [RUN]
[0m16:43:42.899449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m16:43:42.899644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m16:43:42.899837 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m16:43:42.900017 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m16:43:42.900177 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m16:43:42.900325 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m16:43:42.902393 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m16:43:42.904142 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:43:42.905876 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:43:42.906314 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m16:43:42.906476 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m16:43:42.912537 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m16:43:42.916537 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m16:43:42.918501 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m16:43:42.920737 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:43:42.923313 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m16:43:42.924577 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m16:43:42.924945 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_brand_overall
  
   as (
    
select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m16:43:42.925964 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.brand_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m16:43:42.926755 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m16:43:42.927296 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:42.927614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:42.927823 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_brand_week_wise
  
   as (
    
select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m16:43:42.929195 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:42.998367 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a5ea10>]}
[0m16:43:42.998892 [info ] [Thread-4 (]: 3 of 32 OK created sql table model test_silver_layer.crm_device_data ........... [[32mSUCCESS 1[0m in 1.52s]
[0m16:43:42.999239 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m16:43:42.999528 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:43:43.000195 [info ] [Thread-4 (]: 8 of 32 START sql view model test_gold_layer.customers_by_mobile_type_overall .. [RUN]
[0m16:43:43.000567 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m16:43:43.000807 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:43:43.003272 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:43:43.003730 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:43:43.005496 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:43:43.007654 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m16:43:43.007922 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_mobile_type_overall
  
   as (
    
select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m16:43:43.008158 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:43.480411 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:43.481450 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m16:43:43.492995 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:43.493820 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m16:43:43.510305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:43.511107 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m16:43:43.512037 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:43.512861 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m16:43:43.624746 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104310310>]}
[0m16:43:43.625106 [info ] [Thread-3 (]: 7 of 32 OK created sql view model test_gold_layer.customers_by_brand_week_wise . [[32mSUCCESS 1[0m in 0.72s]
[0m16:43:43.625382 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m16:43:43.625575 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:43:43.625808 [info ] [Thread-3 (]: 9 of 32 START sql view model test_gold_layer.customers_by_mobile_type_week_wise  [RUN]
[0m16:43:43.626009 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m16:43:43.626167 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:43:43.628101 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:43:43.628509 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:43:43.629805 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:43:43.630288 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m16:43:43.630467 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m16:43:43.630635 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:43.634519 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147aeb090>]}
[0m16:43:43.634921 [info ] [Thread-4 (]: 8 of 32 OK created sql view model test_gold_layer.customers_by_mobile_type_overall  [[32mSUCCESS 1[0m in 0.63s]
[0m16:43:43.635202 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m16:43:43.635413 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m16:43:43.635661 [info ] [Thread-4 (]: 10 of 32 START sql view model test_gold_layer.customers_by_os_overall .......... [RUN]
[0m16:43:43.635861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_os_overall)
[0m16:43:43.636019 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m16:43:43.637733 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m16:43:43.638098 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m16:43:43.639555 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m16:43:43.640217 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m16:43:43.640477 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_os_overall
  
   as (
    
select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by os_name
  );
[0m16:43:43.640712 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:43.644996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140f01510>]}
[0m16:43:43.645378 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14793aa10>]}
[0m16:43:43.645787 [info ] [Thread-1 (]: 5 of 32 OK created sql view model test_gold_layer.brand_by_age_segment ......... [[32mSUCCESS 1[0m in 0.75s]
[0m16:43:43.646121 [info ] [Thread-2 (]: 6 of 32 OK created sql view model test_gold_layer.customers_by_brand_overall ... [[32mSUCCESS 1[0m in 0.75s]
[0m16:43:43.646418 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m16:43:43.646663 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m16:43:43.646875 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m16:43:43.647097 [debug] [Thread-2 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m16:43:43.647329 [info ] [Thread-1 (]: 11 of 32 START sql view model test_gold_layer.customers_by_os_week_wise ........ [RUN]
[0m16:43:43.647515 [info ] [Thread-2 (]: 12 of 32 START sql view model test_gold_layer.os_by_age_segment ................ [RUN]
[0m16:43:43.647789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_week_wise)
[0m16:43:43.647977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.os_by_age_segment)
[0m16:43:43.648150 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m16:43:43.648309 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m16:43:43.650114 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:43:43.653793 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m16:43:43.654268 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m16:43:43.656061 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m16:43:43.656328 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m16:43:43.658116 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m16:43:43.658529 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m16:43:43.658735 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_os_week_wise
  
   as (
    
select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m16:43:43.658942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:43.659675 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m16:43:43.659922 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.os_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m16:43:43.660437 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:44.095947 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:44.096936 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m16:43:44.110266 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:44.111062 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m16:43:44.145245 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:44.146223 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m16:43:44.146496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:44.147824 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m16:43:44.229913 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433ef910>]}
[0m16:43:44.230537 [info ] [Thread-3 (]: 9 of 32 OK created sql view model test_gold_layer.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.60s]
[0m16:43:44.231043 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m16:43:44.231310 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m16:43:44.231552 [info ] [Thread-3 (]: 13 of 32 START sql view model test_gold_layer.revenue_by_age_overall ........... [RUN]
[0m16:43:44.231794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m16:43:44.231971 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m16:43:44.233985 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:43:44.234378 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m16:43:44.235670 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m16:43:44.236288 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m16:43:44.236475 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_age_overall
  
   as (
    
select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by age
order by age
  );
[0m16:43:44.236647 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:44.245168 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a69e50>]}
[0m16:43:44.245504 [info ] [Thread-4 (]: 10 of 32 OK created sql view model test_gold_layer.customers_by_os_overall ..... [[32mSUCCESS 1[0m in 0.61s]
[0m16:43:44.245874 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m16:43:44.246164 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:43:44.246442 [info ] [Thread-4 (]: 14 of 32 START sql view model test_gold_layer.revenue_by_age_week_wise ......... [RUN]
[0m16:43:44.246776 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m16:43:44.247194 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m16:43:44.249573 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:43:44.249971 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m16:43:44.251873 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:43:44.252705 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m16:43:44.252941 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_age_week_wise
  
   as (
    
select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m16:43:44.253134 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:44.284276 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a5f1d0>]}
[0m16:43:44.284613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a45d50>]}
[0m16:43:44.285015 [info ] [Thread-2 (]: 12 of 32 OK created sql view model test_gold_layer.os_by_age_segment ........... [[32mSUCCESS 1[0m in 0.64s]
[0m16:43:44.285387 [info ] [Thread-1 (]: 11 of 32 OK created sql view model test_gold_layer.customers_by_os_week_wise ... [[32mSUCCESS 1[0m in 0.64s]
[0m16:43:44.285932 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m16:43:44.286295 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m16:43:44.286574 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m16:43:44.286857 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:43:44.287150 [info ] [Thread-2 (]: 15 of 32 START sql view model test_gold_layer.revenue_by_brand_overall ......... [RUN]
[0m16:43:44.287353 [info ] [Thread-1 (]: 16 of 32 START sql view model test_gold_layer.revenue_by_brand_week_wise ....... [RUN]
[0m16:43:44.287658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_overall)
[0m16:43:44.287867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m16:43:44.288047 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m16:43:44.288215 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:43:44.290012 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:43:44.291938 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:43:44.292569 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:43:44.292814 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m16:43:44.294751 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:43:44.296185 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m16:43:44.296938 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m16:43:44.297186 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_brand_week_wise
  
   as (
    
select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m16:43:44.297711 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m16:43:44.298013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.298321 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_brand_overall
  
   as (
    
select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m16:43:44.299266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:44.727760 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:44.728768 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m16:43:44.744347 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:44.745180 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m16:43:44.775094 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:44.775921 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m16:43:44.787750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:44.788571 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m16:43:44.860609 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479617d0>]}
[0m16:43:44.861035 [info ] [Thread-3 (]: 13 of 32 OK created sql view model test_gold_layer.revenue_by_age_overall ...... [[32mSUCCESS 1[0m in 0.63s]
[0m16:43:44.861419 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m16:43:44.861644 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m16:43:44.861911 [info ] [Thread-3 (]: 17 of 32 START sql view model test_gold_layer.revenue_by_gender_overall ........ [RUN]
[0m16:43:44.862162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m16:43:44.862340 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m16:43:44.864394 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:43:44.864792 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m16:43:44.866135 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m16:43:44.866641 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m16:43:44.866832 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_gender_overall
  
   as (
    
select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m16:43:44.867004 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:44.878511 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147940710>]}
[0m16:43:44.879006 [info ] [Thread-4 (]: 14 of 32 OK created sql view model test_gold_layer.revenue_by_age_week_wise .... [[32mSUCCESS 1[0m in 0.63s]
[0m16:43:44.879388 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m16:43:44.879659 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:43:44.879956 [info ] [Thread-4 (]: 18 of 32 START sql view model test_gold_layer.revenue_by_gender_week_wise ...... [RUN]
[0m16:43:44.880166 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m16:43:44.880366 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:43:44.883637 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:43:44.884247 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:43:44.886539 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:43:44.887256 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m16:43:44.887474 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_gender_week_wise
  
   as (
    
select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m16:43:44.887657 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:44.902861 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ef8490>]}
[0m16:43:44.903463 [info ] [Thread-2 (]: 15 of 32 OK created sql view model test_gold_layer.revenue_by_brand_overall .... [[32mSUCCESS 1[0m in 0.62s]
[0m16:43:44.903924 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m16:43:44.904208 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:43:44.904565 [info ] [Thread-2 (]: 19 of 32 START sql view model test_gold_layer.revenue_by_mobile_type_overall ... [RUN]
[0m16:43:44.904980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m16:43:44.905217 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:43:44.907215 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:43:44.907631 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:43:44.908959 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:43:44.909537 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m16:43:44.909734 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_mobile_type_overall
  
   as (
    
select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m16:43:44.909906 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:44.913970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140eea810>]}
[0m16:43:44.914306 [info ] [Thread-1 (]: 16 of 32 OK created sql view model test_gold_layer.revenue_by_brand_week_wise .. [[32mSUCCESS 1[0m in 0.63s]
[0m16:43:44.914606 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m16:43:44.914808 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:43:44.915038 [info ] [Thread-1 (]: 20 of 32 START sql view model test_gold_layer.revenue_by_mobile_type_week_wise . [RUN]
[0m16:43:44.915255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m16:43:44.915446 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:43:44.919385 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:43:44.919965 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:43:44.922962 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:43:44.923737 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m16:43:44.924137 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m16:43:44.924324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:45.341403 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.342392 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m16:43:45.380458 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:45.381350 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m16:43:45.416246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.417065 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m16:43:45.449177 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:45.449992 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m16:43:45.469773 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a61710>]}
[0m16:43:45.470122 [info ] [Thread-4 (]: 18 of 32 OK created sql view model test_gold_layer.revenue_by_gender_week_wise . [[32mSUCCESS 1[0m in 0.59s]
[0m16:43:45.470422 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m16:43:45.470624 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m16:43:45.470851 [info ] [Thread-4 (]: 21 of 32 START sql view model test_gold_layer.revenue_by_os_overall ............ [RUN]
[0m16:43:45.471063 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_overall)
[0m16:43:45.471238 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m16:43:45.473177 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:43:45.473572 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m16:43:45.474851 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m16:43:45.475319 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m16:43:45.475504 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_overall
  
   as (
    
select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m16:43:45.475665 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:45.515385 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479617d0>]}
[0m16:43:45.517967 [info ] [Thread-3 (]: 17 of 32 OK created sql view model test_gold_layer.revenue_by_gender_overall ... [[32mSUCCESS 1[0m in 0.65s]
[0m16:43:45.518363 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m16:43:45.518606 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:43:45.518910 [info ] [Thread-3 (]: 22 of 32 START sql view model test_gold_layer.revenue_by_os_vendor_overall ..... [RUN]
[0m16:43:45.519194 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m16:43:45.519385 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:43:45.521314 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:43:45.521710 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:43:45.523303 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:43:45.523828 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m16:43:45.524029 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_vendor_overall
  
   as (
    
select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m16:43:45.524240 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:45.544826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ea1ed0>]}
[0m16:43:45.545249 [info ] [Thread-1 (]: 20 of 32 OK created sql view model test_gold_layer.revenue_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.63s]
[0m16:43:45.545581 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m16:43:45.545816 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:43:45.546031 [info ] [Thread-1 (]: 23 of 32 START sql view model test_gold_layer.revenue_by_os_vendor_week_wise ... [RUN]
[0m16:43:45.546268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m16:43:45.546469 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:43:45.548404 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:43:45.548895 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:43:45.550758 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:43:45.551784 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m16:43:45.552057 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_vendor_week_wise
  
   as (
    
select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m16:43:45.552283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:45.600801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147e1be90>]}
[0m16:43:45.601425 [info ] [Thread-2 (]: 19 of 32 OK created sql view model test_gold_layer.revenue_by_mobile_type_overall  [[32mSUCCESS 1[0m in 0.70s]
[0m16:43:45.601811 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m16:43:45.602025 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:43:45.602281 [info ] [Thread-2 (]: 24 of 32 START sql view model test_gold_layer.revenue_by_os_week_wise .......... [RUN]
[0m16:43:45.602533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_week_wise)
[0m16:43:45.602710 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m16:43:45.604601 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:43:45.604977 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m16:43:45.607239 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:43:45.607865 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m16:43:45.608068 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_week_wise
  
   as (
    
select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m16:43:45.608258 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:45.943569 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.944562 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m16:43:45.984472 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.985400 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m16:43:46.028268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:46.029116 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m16:43:46.077401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147adde50>]}
[0m16:43:46.077746 [info ] [Thread-4 (]: 21 of 32 OK created sql view model test_gold_layer.revenue_by_os_overall ....... [[32mSUCCESS 1[0m in 0.61s]
[0m16:43:46.078018 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m16:43:46.078235 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:43:46.078489 [info ] [Thread-4 (]: 25 of 32 START sql view model test_gold_layer.revenue_by_value_segment_overall . [RUN]
[0m16:43:46.078727 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m16:43:46.078900 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:43:46.080815 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:43:46.081218 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:43:46.082522 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:43:46.083006 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m16:43:46.083187 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_value_segment_overall
  
   as (
    
select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m16:43:46.083355 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:46.101792 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:46.103458 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m16:43:46.119658 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1406ab090>]}
[0m16:43:46.120076 [info ] [Thread-3 (]: 22 of 32 OK created sql view model test_gold_layer.revenue_by_os_vendor_overall  [[32mSUCCESS 1[0m in 0.60s]
[0m16:43:46.120383 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m16:43:46.120610 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:43:46.120855 [info ] [Thread-3 (]: 26 of 32 START sql view model test_gold_layer.revenue_by_value_segment_week_wise  [RUN]
[0m16:43:46.121116 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m16:43:46.121311 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:43:46.123082 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:43:46.123449 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:43:46.124892 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:43:46.125392 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m16:43:46.125574 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_value_segment_week_wise
  
   as (
    
select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m16:43:46.125745 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:46.192424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ac5450>]}
[0m16:43:46.293389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d754d0>]}
[0m16:43:46.593797 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:46.594810 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m16:43:46.645067 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:46.645877 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m16:43:46.721203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a81050>]}
[0m16:43:46.776950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ac7210>]}
[0m16:43:47.894735 [info ] [Thread-1 (]: 23 of 32 OK created sql view model test_gold_layer.revenue_by_os_vendor_week_wise  [[32mSUCCESS 1[0m in 0.65s]
[0m16:43:47.895010 [info ] [Thread-2 (]: 24 of 32 OK created sql view model test_gold_layer.revenue_by_os_week_wise ..... [[32mSUCCESS 1[0m in 0.69s]
[0m16:43:47.895791 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m16:43:47.895277 [info ] [Thread-4 (]: 25 of 32 OK created sql view model test_gold_layer.revenue_by_value_segment_overall  [[32mSUCCESS 1[0m in 0.64s]
[0m16:43:47.895478 [info ] [Thread-3 (]: 26 of 32 OK created sql view model test_gold_layer.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.66s]
[0m16:43:47.896157 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m16:43:47.896369 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_customers_overall
[0m16:43:47.896617 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m16:43:47.896834 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m16:43:47.897007 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m16:43:47.897240 [info ] [Thread-1 (]: 27 of 32 START sql view model test_gold_layer.total_customers_overall .......... [RUN]
[0m16:43:47.897481 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_devices_overall
[0m16:43:47.897704 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m16:43:47.897937 [info ] [Thread-2 (]: 28 of 32 START sql view model test_gold_layer.total_customers_week_wise ........ [RUN]
[0m16:43:47.898192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m16:43:47.898419 [info ] [Thread-4 (]: 29 of 32 START sql view model test_gold_layer.total_devices_overall ............ [RUN]
[0m16:43:47.898654 [info ] [Thread-3 (]: 30 of 32 START sql view model test_gold_layer.total_devices_week_wise .......... [RUN]
[0m16:43:47.898881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m16:43:47.899055 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m16:43:47.899226 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m16:43:47.899391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m16:43:47.899553 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m16:43:47.901171 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m16:43:47.902118 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m16:43:47.902307 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m16:43:47.903990 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m16:43:47.906417 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m16:43:47.908194 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m16:43:47.908605 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m16:43:47.908826 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m16:43:47.908980 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m16:43:47.910507 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m16:43:47.911784 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m16:43:47.913051 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m16:43:47.913211 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m16:43:47.914506 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m16:43:47.915176 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m16:43:47.915762 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m16:43:47.916273 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m16:43:47.916473 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_customers_overall
  
   as (
    
with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m16:43:47.917109 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m16:43:47.917299 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_customers_week_wise
  
   as (
    
with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m16:43:47.917511 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_devices_overall
  
   as (
    
with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m16:43:47.917704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:47.917915 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_devices_week_wise
  
   as (
    
with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m16:43:47.918157 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:47.918486 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:47.920280 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:48.421613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.422639 [debug] [Thread-1 (]: On model.my_dbt_project.total_customers_overall: Close
[0m16:43:48.424125 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.424938 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_overall: Close
[0m16:43:48.481342 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.482239 [debug] [Thread-3 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m16:43:48.488062 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.489004 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m16:43:48.554793 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a82410>]}
[0m16:43:48.555070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433f55d0>]}
[0m16:43:48.555415 [info ] [Thread-4 (]: 29 of 32 OK created sql view model test_gold_layer.total_devices_overall ....... [[32mSUCCESS 1[0m in 0.66s]
[0m16:43:48.555721 [info ] [Thread-1 (]: 27 of 32 OK created sql view model test_gold_layer.total_customers_overall ..... [[32mSUCCESS 1[0m in 0.66s]
[0m16:43:48.556013 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m16:43:48.556294 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m16:43:48.556500 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:43:48.556709 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m16:43:48.556922 [info ] [Thread-4 (]: 31 of 32 START sql view model test_gold_layer.weekly_revenue_by_brand .......... [RUN]
[0m16:43:48.557148 [info ] [Thread-1 (]: 32 of 32 START sql view model test_gold_layer.weekly_revenue_by_os ............. [RUN]
[0m16:43:48.557374 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m16:43:48.557584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m16:43:48.557769 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m16:43:48.557941 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m16:43:48.559675 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:43:48.562308 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:43:48.563552 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m16:43:48.563728 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m16:43:48.565165 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:43:48.566567 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m16:43:48.567723 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m16:43:48.568270 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m16:43:48.568610 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.weekly_revenue_by_brand
  
   as (
    
SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m16:43:48.568862 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.weekly_revenue_by_os
  
   as (
    
SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m16:43:48.569052 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:48.569240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:48.612890 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147e820d0>]}
[0m16:43:48.613319 [info ] [Thread-3 (]: 30 of 32 OK created sql view model test_gold_layer.total_devices_week_wise ..... [[32mSUCCESS 1[0m in 0.71s]
[0m16:43:48.613598 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m16:43:48.615165 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116634590>]}
[0m16:43:48.615472 [info ] [Thread-2 (]: 28 of 32 OK created sql view model test_gold_layer.total_customers_week_wise ... [[32mSUCCESS 1[0m in 0.72s]
[0m16:43:48.615739 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m16:43:49.130250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:49.131351 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m16:43:49.163659 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:49.164487 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m16:43:49.261220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140fd9d90>]}
[0m16:43:49.261617 [info ] [Thread-1 (]: 32 of 32 OK created sql view model test_gold_layer.weekly_revenue_by_os ........ [[32mSUCCESS 1[0m in 0.70s]
[0m16:43:49.261922 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m16:43:49.295772 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414b7906-069a-4f8c-9486-69ac5db46bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035edb50>]}
[0m16:43:49.296185 [info ] [Thread-4 (]: 31 of 32 OK created sql view model test_gold_layer.weekly_revenue_by_brand ..... [[32mSUCCESS 1[0m in 0.74s]
[0m16:43:49.296466 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m16:43:49.297401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:49.297578 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m16:43:49.297708 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_week_wise' was properly closed.
[0m16:43:49.297843 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m16:43:49.297991 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m16:43:49.298294 [info ] [MainThread]: 
[0m16:43:49.298535 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 11.25 seconds (11.25s).
[0m16:43:49.300616 [debug] [MainThread]: Command end result
[0m16:43:49.321167 [info ] [MainThread]: 
[0m16:43:49.321595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:49.321831 [info ] [MainThread]: 
[0m16:43:49.322020 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m16:43:49.324130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.446489, "process_user_time": 3.336414, "process_kernel_time": 1.227963, "process_mem_max_rss": "201801728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:49.324432 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:49.324385 after 12.45 seconds
[0m16:43:49.324639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100978710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008aa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008e2790>]}
[0m16:43:49.324823 [debug] [MainThread]: Flushing usage events
[0m19:45:32.979166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105026bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053de790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105026b50>]}


============================== 19:45:32.982077 | 3337e5f9-d216-4b81-ac01-86b1c58cf636 ==============================
[0m19:45:32.982077 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:45:32.982399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:45:34.063904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3337e5f9-d216-4b81-ac01-86b1c58cf636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bc74250>]}
[0m19:45:34.084393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3337e5f9-d216-4b81-ac01-86b1c58cf636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b07d10>]}
[0m19:45:34.084971 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:45:34.096715 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:45:34.156014 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:45:34.156351 [debug] [MainThread]: previous checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, current checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4
[0m19:45:34.156531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3337e5f9-d216-4b81-ac01-86b1c58cf636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103996310>]}
[0m19:45:34.167895 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_dbt_project: tests/schema.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |         tests:
    14 |           - not_null        
    15 | 
    16 |    - name: crm_device_data
    17 |     columns:
    18 |       - name: msisdn
    19 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 16, column 4
[0m19:45:34.170049 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2228203, "process_user_time": 1.50046, "process_kernel_time": 1.679836, "process_mem_max_rss": "180699136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:45:34.170390 [debug] [MainThread]: Command `dbt test` failed at 19:45:34.170343 after 1.22 seconds
[0m19:45:34.170602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105404450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e08410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c010d10>]}
[0m19:45:34.170789 [debug] [MainThread]: Flushing usage events
[0m19:46:40.787549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089563d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ac4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089afa50>]}


============================== 19:46:40.790427 | 000b3ff3-857e-4124-b469-1b6f502fa4d2 ==============================
[0m19:46:40.790427 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:46:40.790741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:46:41.677431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '000b3ff3-857e-4124-b469-1b6f502fa4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e14f7d0>]}
[0m19:46:41.697804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '000b3ff3-857e-4124-b469-1b6f502fa4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108243150>]}
[0m19:46:41.698428 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:46:41.709895 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:46:41.769971 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:46:41.770301 [debug] [MainThread]: previous checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, current checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4
[0m19:46:41.770488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '000b3ff3-857e-4124-b469-1b6f502fa4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f14090>]}
[0m19:46:41.781880 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_dbt_project: tests/schema.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |         tests:
    14 |           - not_null        
    15 | 
    16 |    - name: crm_device_data
    17 |     columns:
    18 |       - name: msisdn
    19 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 16, column 4
[0m19:46:41.783991 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.0301023, "process_user_time": 1.51473, "process_kernel_time": 1.677362, "process_mem_max_rss": "181207040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:41.784296 [debug] [MainThread]: Command `dbt test` failed at 19:46:41.784250 after 1.03 seconds
[0m19:46:41.784503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030c8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ca790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c8910>]}
[0m19:46:41.784686 [debug] [MainThread]: Flushing usage events
[0m19:48:27.214433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa8acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa919d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa8af90>]}


============================== 19:48:27.217001 | cd2c1181-d978-450e-979c-327b6917627d ==============================
[0m19:48:27.217001 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:48:27.217304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:48:27.906686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd2c1181-d978-450e-979c-327b6917627d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f0a1a50>]}
[0m19:48:27.926982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd2c1181-d978-450e-979c-327b6917627d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a443050>]}
[0m19:48:27.930128 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:48:27.940998 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:48:28.000462 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:48:28.000800 [debug] [MainThread]: previous checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, current checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4
[0m19:48:28.000981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd2c1181-d978-450e-979c-327b6917627d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f127390>]}
[0m19:48:28.406422 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m19:48:28.414956 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m19:48:28.420472 [info ] [MainThread]: import_crm: 
[0m19:48:28.556382 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:48:28.556683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd2c1181-d978-450e-979c-327b6917627d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f45f2d0>]}
[0m19:48:28.681136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd2c1181-d978-450e-979c-327b6917627d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1a7c50>]}
[0m19:48:28.742387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd2c1181-d978-450e-979c-327b6917627d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbfbf10>]}
[0m19:48:28.742678 [info ] [MainThread]: Found 32 models, 4 seeds, 3 data tests, 3 sources, 447 macros
[0m19:48:28.742851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2c1181-d978-450e-979c-327b6917627d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f5fea50>]}
[0m19:48:28.743766 [info ] [MainThread]: 
[0m19:48:28.744016 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:48:28.746605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m19:48:28.746860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m19:48:28.747113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m19:48:28.753529 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m19:48:28.754502 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m19:48:28.755394 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m19:48:28.755585 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m19:48:28.755774 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m19:48:28.755922 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m19:48:28.756059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:28.756178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:28.756289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:29.497709 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:48:29.498615 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:48:29.502575 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m19:48:29.504967 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m19:48:29.565031 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m19:48:29.570330 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m19:48:29.777876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2c1181-d978-450e-979c-327b6917627d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1b9710>]}
[0m19:48:29.778710 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:29.779154 [info ] [MainThread]: 
[0m19:48:29.782636 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:48:29.783147 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:48:29.783673 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963
[0m19:48:29.784134 [info ] [Thread-1 (]: 1 of 3 START test not_null_clean_crm_data_msisdn ............................... [RUN]
[0m19:48:29.784637 [info ] [Thread-2 (]: 2 of 3 START test not_null_clean_device_data_msisdn ............................ [RUN]
[0m19:48:29.785208 [info ] [Thread-3 (]: 3 of 3 START test not_null_crm_device_data_msisdn .............................. [RUN]
[0m19:48:29.785778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m19:48:29.786218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580)
[0m19:48:29.786595 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963)
[0m19:48:29.786960 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:48:29.787308 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:48:29.787634 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963
[0m19:48:29.804451 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:48:29.808016 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:48:29.812374 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963"
[0m19:48:29.813448 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:48:29.813766 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:48:29.814104 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963
[0m19:48:29.871904 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:48:29.873079 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:48:29.874094 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963"
[0m19:48:29.874821 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:48:29.875151 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963"
[0m19:48:29.875334 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:48:29.875682 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:48:29.875867 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.crm_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:48:29.876039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:48:29.876195 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:48:29.876349 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:48:29.876875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:30.789409 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:48:30.804748 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: Close
[0m19:48:30.908793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:48:30.911449 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:48:30.915267 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: Close
[0m19:48:30.918198 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963: Close
[0m19:48:30.948664 [info ] [Thread-2 (]: 2 of 3 PASS not_null_clean_device_data_msisdn .................................. [[32mPASS[0m in 1.16s]
[0m19:48:30.949517 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:48:31.063921 [info ] [Thread-3 (]: 3 of 3 PASS not_null_crm_device_data_msisdn .................................... [[32mPASS[0m in 1.28s]
[0m19:48:31.064997 [info ] [Thread-1 (]: 1 of 3 PASS not_null_clean_crm_data_msisdn ..................................... [[32mPASS[0m in 1.28s]
[0m19:48:31.066187 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963
[0m19:48:31.066912 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:48:31.068700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:31.069134 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f' was properly closed.
[0m19:48:31.069489 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580' was properly closed.
[0m19:48:31.069821 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963' was properly closed.
[0m19:48:31.070220 [info ] [MainThread]: 
[0m19:48:31.070614 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m19:48:31.071649 [debug] [MainThread]: Command end result
[0m19:48:31.108393 [info ] [MainThread]: 
[0m19:48:31.108774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:31.109002 [info ] [MainThread]: 
[0m19:48:31.109236 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:48:31.111764 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.9264812, "process_user_time": 2.604488, "process_kernel_time": 1.667662, "process_mem_max_rss": "204554240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:48:31.112223 [debug] [MainThread]: Command `dbt test` succeeded at 19:48:31.112161 after 3.93 seconds
[0m19:48:31.112497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dc2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8ffb10>]}
[0m19:48:31.112760 [debug] [MainThread]: Flushing usage events
[0m19:50:32.562619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a257f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a255a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2afc50>]}


============================== 19:50:32.565351 | b583eaf1-9189-4541-b83c-81c0a9100d90 ==============================
[0m19:50:32.565351 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:50:32.565674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:50:33.465032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b583eaf1-9189-4541-b83c-81c0a9100d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14773e190>]}
[0m19:50:33.485480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b583eaf1-9189-4541-b83c-81c0a9100d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a43190>]}
[0m19:50:33.486156 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:50:33.497647 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:50:33.575049 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_dbt_project: tests/schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |         tests:
    24 |           - not_null
    25 |           -unique
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 25, column 11
    could not find expected ':'
      in "<unicode string>", line 26, column 1
[0m19:50:33.576932 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.0425211, "process_user_time": 1.498804, "process_kernel_time": 1.68902, "process_mem_max_rss": "182763520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:50:33.577246 [debug] [MainThread]: Command `dbt test` failed at 19:50:33.577200 after 1.04 seconds
[0m19:50:33.577465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1581b2450>]}
[0m19:50:33.577655 [debug] [MainThread]: Flushing usage events
[0m19:50:49.716161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10825be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a6250>]}


============================== 19:50:49.718293 | 912eeef5-1da1-44c7-a0ae-23dc5574844a ==============================
[0m19:50:49.718293 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:50:49.718593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:50:50.391703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912eeef5-1da1-44c7-a0ae-23dc5574844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082726d0>]}
[0m19:50:50.412301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912eeef5-1da1-44c7-a0ae-23dc5574844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0b0d0>]}
[0m19:50:50.412854 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:50:50.424256 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:50:50.516298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:50:50.516826 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/tests/schema.yml
[0m19:50:50.581613 [info ] [MainThread]: import_crm: 
[0m19:50:50.589418 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m19:50:50.655839 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:50:50.656175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '912eeef5-1da1-44c7-a0ae-23dc5574844a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d173bd0>]}
[0m19:50:50.738195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '912eeef5-1da1-44c7-a0ae-23dc5574844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d803b50>]}
[0m19:50:50.797167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '912eeef5-1da1-44c7-a0ae-23dc5574844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13daeff50>]}
[0m19:50:50.797455 [info ] [MainThread]: Found 32 models, 4 seeds, 6 data tests, 3 sources, 447 macros
[0m19:50:50.797621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912eeef5-1da1-44c7-a0ae-23dc5574844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d83a750>]}
[0m19:50:50.798643 [info ] [MainThread]: 
[0m19:50:50.798909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:50:50.801524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m19:50:50.801754 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m19:50:50.802003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m19:50:50.808374 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m19:50:50.809959 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m19:50:50.810866 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m19:50:50.811028 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m19:50:50.811170 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m19:50:50.811309 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m19:50:50.811438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:50.811552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:50.811666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:51.606126 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:50:51.607639 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m19:50:51.609366 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:50:51.612493 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m19:50:51.615702 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m19:50:51.617622 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m19:50:51.790182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912eeef5-1da1-44c7-a0ae-23dc5574844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d83ac10>]}
[0m19:50:51.791098 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:50:51.791548 [info ] [MainThread]: 
[0m19:50:51.795333 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:50:51.795763 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:50:51.796184 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963
[0m19:50:51.796561 [debug] [Thread-4 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:50:51.796922 [info ] [Thread-1 (]: 1 of 6 START test not_null_clean_crm_data_msisdn ............................... [RUN]
[0m19:50:51.797402 [info ] [Thread-2 (]: 2 of 6 START test not_null_clean_device_data_msisdn ............................ [RUN]
[0m19:50:51.797880 [info ] [Thread-3 (]: 3 of 6 START test not_null_crm_device_data_msisdn .............................. [RUN]
[0m19:50:51.798332 [info ] [Thread-4 (]: 4 of 6 START test unique_clean_crm_data_msisdn ................................. [RUN]
[0m19:50:51.798882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m19:50:51.799312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580)
[0m19:50:51.799969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963)
[0m19:50:51.800581 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e'
[0m19:50:51.800970 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:50:51.801338 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:50:51.801667 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963
[0m19:50:51.802006 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:50:51.817614 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:50:51.821086 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:50:51.824194 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963"
[0m19:50:51.828457 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:50:51.829175 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:50:51.829518 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:50:51.835833 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963
[0m19:50:51.841829 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:50:51.843251 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:50:51.845667 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:50:51.846986 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963"
[0m19:50:51.848262 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:50:51.848978 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:50:51.849361 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:50:51.849638 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:50:51.850081 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963"
[0m19:50:51.850301 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:50:51.850746 [debug] [Thread-4 (]: Using snowflake connection "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:50:51.850989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:51.851218 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.crm_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:50:51.851426 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:51.851616 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m19:50:51.851868 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:51.852792 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:50:52.273072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:50:52.288303 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: Close
[0m19:50:52.408674 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:50:52.413512 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963: Close
[0m19:50:52.417052 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:50:52.419999 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: Close
[0m19:50:52.428764 [info ] [Thread-1 (]: 1 of 6 PASS not_null_clean_crm_data_msisdn ..................................... [[32mPASS[0m in 0.63s]
[0m19:50:52.429516 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:50:52.429973 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c
[0m19:50:52.430467 [info ] [Thread-1 (]: 5 of 6 START test unique_clean_device_data_msisdn .............................. [RUN]
[0m19:50:52.430999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f, now test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c)
[0m19:50:52.431401 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c
[0m19:50:52.436204 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c"
[0m19:50:52.437091 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c
[0m19:50:52.439679 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c"
[0m19:50:52.440858 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c"
[0m19:50:52.441266 [debug] [Thread-1 (]: On test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m19:50:52.441629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:52.573646 [info ] [Thread-2 (]: 2 of 6 PASS not_null_clean_device_data_msisdn .................................. [[32mPASS[0m in 0.77s]
[0m19:50:52.574248 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:50:52.574586 [debug] [Thread-2 (]: Began running node test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4
[0m19:50:52.574950 [info ] [Thread-2 (]: 6 of 6 START test unique_crm_device_data_msisdn ................................ [RUN]
[0m19:50:52.575345 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580, now test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4)
[0m19:50:52.575635 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4
[0m19:50:52.579003 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4"
[0m19:50:52.579644 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4
[0m19:50:52.581575 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4"
[0m19:50:52.582407 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4"
[0m19:50:52.582703 [debug] [Thread-2 (]: On test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.crm_device_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m19:50:52.582981 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:52.595932 [info ] [Thread-3 (]: 3 of 6 PASS not_null_crm_device_data_msisdn .................................... [[32mPASS[0m in 0.80s]
[0m19:50:52.596465 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963
[0m19:50:53.962006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:50:53.966561 [debug] [Thread-1 (]: On test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c: Close
[0m19:50:54.012373 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:50:54.016747 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: Close
[0m19:50:54.106345 [error] [Thread-1 (]: 5 of 6 FAIL 57128 unique_clean_device_data_msisdn .............................. [[31mFAIL 57128[0m in 1.68s]
[0m19:50:54.107357 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c
[0m19:50:54.161115 [info ] [Thread-4 (]: 4 of 6 PASS unique_clean_crm_data_msisdn ....................................... [[32mPASS[0m in 2.36s]
[0m19:50:54.161950 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:50:54.925733 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:50:54.927096 [debug] [Thread-2 (]: On test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4: Close
[0m19:50:55.085184 [error] [Thread-2 (]: 6 of 6 FAIL 38614 unique_crm_device_data_msisdn ................................ [[31mFAIL 38614[0m in 2.51s]
[0m19:50:55.086149 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4
[0m19:50:55.087869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:55.088352 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c' was properly closed.
[0m19:50:55.088723 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_crm_device_data_msisdn.f53d5dbef4' was properly closed.
[0m19:50:55.089058 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_crm_device_data_msisdn.56fa6ce963' was properly closed.
[0m19:50:55.089392 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e' was properly closed.
[0m19:50:55.089826 [info ] [MainThread]: 
[0m19:50:55.090247 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m19:50:55.091806 [debug] [MainThread]: Command end result
[0m19:50:55.127618 [info ] [MainThread]: 
[0m19:50:55.127984 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:50:55.128199 [info ] [MainThread]: 
[0m19:50:55.128461 [error] [MainThread]: [31mFailure in test unique_clean_device_data_msisdn (models/tests/schema.yml)[0m
[0m19:50:55.128707 [error] [MainThread]:   Got 57128 results, configured to fail if != 0
[0m19:50:55.128894 [info ] [MainThread]: 
[0m19:50:55.129115 [info ] [MainThread]:   compiled code at target/compiled/my_dbt_project/models/tests/schema.yml/unique_clean_device_data_msisdn.sql
[0m19:50:55.129305 [info ] [MainThread]: 
[0m19:50:55.129538 [error] [MainThread]: [31mFailure in test unique_crm_device_data_msisdn (models/tests/schema.yml)[0m
[0m19:50:55.129761 [error] [MainThread]:   Got 38614 results, configured to fail if != 0
[0m19:50:55.129934 [info ] [MainThread]: 
[0m19:50:55.130145 [info ] [MainThread]:   compiled code at target/compiled/my_dbt_project/models/tests/schema.yml/unique_crm_device_data_msisdn.sql
[0m19:50:55.130332 [info ] [MainThread]: 
[0m19:50:55.130532 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m19:50:55.133644 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.442956, "process_user_time": 2.424459, "process_kernel_time": 1.718431, "process_mem_max_rss": "204783616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:50:55.134188 [debug] [MainThread]: Command `dbt test` failed at 19:50:55.134114 after 5.44 seconds
[0m19:50:55.134512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e84410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108258a50>]}
[0m19:50:55.134787 [debug] [MainThread]: Flushing usage events
[0m19:51:23.803416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d5310>]}


============================== 19:51:23.806140 | 9cb42345-9e48-4a95-8979-207f5648cc79 ==============================
[0m19:51:23.806140 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:51:23.806456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:24.501009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cb42345-9e48-4a95-8979-207f5648cc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d9c050>]}
[0m19:51:24.521319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cb42345-9e48-4a95-8979-207f5648cc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c130d0>]}
[0m19:51:24.522580 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:51:24.534044 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:51:24.625010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:51:24.625469 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/tests/schema.yml
[0m19:51:24.751067 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:51:24.751394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9cb42345-9e48-4a95-8979-207f5648cc79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12294ad90>]}
[0m19:51:24.830620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cb42345-9e48-4a95-8979-207f5648cc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408ddd0>]}
[0m19:51:24.891376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cb42345-9e48-4a95-8979-207f5648cc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122edb750>]}
[0m19:51:24.891667 [info ] [MainThread]: Found 32 models, 4 seeds, 6 data tests, 3 sources, 447 macros
[0m19:51:24.891834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cb42345-9e48-4a95-8979-207f5648cc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f00890>]}
[0m19:51:24.892822 [info ] [MainThread]: 
[0m19:51:24.893082 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:51:24.895749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m19:51:24.896024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m19:51:24.902468 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m19:51:24.903519 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m19:51:24.903725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m19:51:24.903898 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m19:51:24.904058 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m19:51:24.904963 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m19:51:24.905111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:24.905232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:24.905363 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m19:51:24.907531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:25.645232 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:51:25.646477 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:51:25.650024 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m19:51:25.652277 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m19:51:25.673191 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m19:51:25.677218 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m19:51:25.825652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cb42345-9e48-4a95-8979-207f5648cc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c03490>]}
[0m19:51:25.826586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:51:25.827051 [info ] [MainThread]: 
[0m19:51:25.830980 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:51:25.831485 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:51:25.831971 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:51:25.832436 [info ] [Thread-1 (]: 1 of 6 START test not_null_clean_crm_data_msisdn ............................... [RUN]
[0m19:51:25.832867 [debug] [Thread-4 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:51:25.833279 [info ] [Thread-2 (]: 2 of 6 START test not_null_clean_device_data_msisdn ............................ [RUN]
[0m19:51:25.833681 [info ] [Thread-3 (]: 3 of 6 START test not_null_enriched_data_msisdn ................................ [RUN]
[0m19:51:25.834169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m19:51:25.834558 [info ] [Thread-4 (]: 4 of 6 START test unique_clean_crm_data_msisdn ................................. [RUN]
[0m19:51:25.834975 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580)
[0m19:51:25.835357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925)
[0m19:51:25.835993 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:51:25.836476 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e'
[0m19:51:25.836842 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:51:25.837174 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:51:25.853683 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:51:25.854144 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:51:25.857533 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:51:25.860811 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m19:51:25.865410 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:51:25.865848 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:51:25.866401 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:51:25.866709 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:51:25.872456 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:51:25.880024 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:51:25.881561 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:51:25.882879 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m19:51:25.884205 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:51:25.885226 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:51:25.885702 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:51:25.886126 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m19:51:25.886369 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:51:25.886658 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:51:25.887073 [debug] [Thread-4 (]: Using snowflake connection "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:51:25.887291 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.enriched_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:51:25.887501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:51:25.887681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:25.887881 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m19:51:25.888077 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:51:25.890409 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:51:26.340025 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:51:26.355220 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: Close
[0m19:51:26.413188 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:51:26.416952 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: Close
[0m19:51:26.467780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:51:26.471959 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: Close
[0m19:51:26.480605 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:51:26.483664 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: Close
[0m19:51:26.520431 [info ] [Thread-2 (]: 2 of 6 PASS not_null_clean_device_data_msisdn .................................. [[32mPASS[0m in 0.69s]
[0m19:51:26.521349 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:51:26.521894 [debug] [Thread-2 (]: Began running node test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c
[0m19:51:26.522501 [info ] [Thread-2 (]: 5 of 6 START test unique_clean_device_data_msisdn .............................. [RUN]
[0m19:51:26.523144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580, now test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c)
[0m19:51:26.523641 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c
[0m19:51:26.529488 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c"
[0m19:51:26.530555 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c
[0m19:51:26.533249 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c"
[0m19:51:26.535484 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c"
[0m19:51:26.535935 [debug] [Thread-2 (]: On test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m19:51:26.536330 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:51:26.550828 [info ] [Thread-3 (]: 3 of 6 PASS not_null_enriched_data_msisdn ...................................... [[32mPASS[0m in 0.72s]
[0m19:51:26.551628 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:51:26.552125 [debug] [Thread-3 (]: Began running node test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c
[0m19:51:26.552473 [info ] [Thread-3 (]: 6 of 6 START test unique_enriched_data_msisdn .................................. [RUN]
[0m19:51:26.552962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925, now test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c)
[0m19:51:26.553308 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c
[0m19:51:26.557194 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c"
[0m19:51:26.557895 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c
[0m19:51:26.560092 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c"
[0m19:51:26.561075 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c"
[0m19:51:26.561431 [debug] [Thread-3 (]: On test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.enriched_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m19:51:26.561755 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:51:26.620915 [info ] [Thread-4 (]: 4 of 6 PASS unique_clean_crm_data_msisdn ....................................... [[32mPASS[0m in 0.78s]
[0m19:51:26.621380 [info ] [Thread-1 (]: 1 of 6 PASS not_null_clean_crm_data_msisdn ..................................... [[32mPASS[0m in 0.79s]
[0m19:51:26.621770 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:51:26.622049 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:51:26.942432 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:51:26.947107 [debug] [Thread-2 (]: On test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c: Close
[0m19:51:27.138476 [error] [Thread-2 (]: 5 of 6 FAIL 57128 unique_clean_device_data_msisdn .............................. [[31mFAIL 57128[0m in 0.62s]
[0m19:51:27.140068 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c
[0m19:51:27.684415 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:51:27.689072 [debug] [Thread-3 (]: On test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c: Close
[0m19:51:27.856777 [error] [Thread-3 (]: 6 of 6 FAIL 143176 unique_enriched_data_msisdn ................................. [[31mFAIL 143176[0m in 1.30s]
[0m19:51:27.858104 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c
[0m19:51:27.859925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:27.860401 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f' was properly closed.
[0m19:51:27.860774 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_device_data_msisdn.c28731596c' was properly closed.
[0m19:51:27.861112 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_enriched_data_msisdn.4df6acca7c' was properly closed.
[0m19:51:27.861429 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e' was properly closed.
[0m19:51:27.861849 [info ] [MainThread]: 
[0m19:51:27.862271 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m19:51:27.863733 [debug] [MainThread]: Command end result
[0m19:51:27.900050 [info ] [MainThread]: 
[0m19:51:27.900447 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:51:27.900673 [info ] [MainThread]: 
[0m19:51:27.900948 [error] [MainThread]: [31mFailure in test unique_clean_device_data_msisdn (models/tests/schema.yml)[0m
[0m19:51:27.901331 [error] [MainThread]:   Got 57128 results, configured to fail if != 0
[0m19:51:27.901601 [info ] [MainThread]: 
[0m19:51:27.901861 [info ] [MainThread]:   compiled code at target/compiled/my_dbt_project/models/tests/schema.yml/unique_clean_device_data_msisdn.sql
[0m19:51:27.902066 [info ] [MainThread]: 
[0m19:51:27.902304 [error] [MainThread]: [31mFailure in test unique_enriched_data_msisdn (models/tests/schema.yml)[0m
[0m19:51:27.902540 [error] [MainThread]:   Got 143176 results, configured to fail if != 0
[0m19:51:27.902718 [info ] [MainThread]: 
[0m19:51:27.902944 [info ] [MainThread]:   compiled code at target/compiled/my_dbt_project/models/tests/schema.yml/unique_enriched_data_msisdn.sql
[0m19:51:27.903132 [info ] [MainThread]: 
[0m19:51:27.903339 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m19:51:27.905841 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.129285, "process_user_time": 2.363896, "process_kernel_time": 1.62427, "process_mem_max_rss": "202670080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:51:27.906320 [debug] [MainThread]: Command `dbt test` failed at 19:51:27.906247 after 4.13 seconds
[0m19:51:27.906651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d8c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061afe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122bedad0>]}
[0m19:51:27.906944 [debug] [MainThread]: Flushing usage events
[0m19:55:56.313792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107595a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107595510>]}


============================== 19:55:56.316502 | f7775ae0-95e6-4504-bcb6-207be1594c5d ==============================
[0m19:55:56.316502 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:55:56.316799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:55:57.380864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7775ae0-95e6-4504-bcb6-207be1594c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1377f6e90>]}
[0m19:55:57.401503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7775ae0-95e6-4504-bcb6-207be1594c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106742fd0>]}
[0m19:55:57.402090 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:55:57.414306 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:55:57.505409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:55:57.505934 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/tests/schema.yml
[0m19:55:57.569635 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m19:55:57.577470 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m19:55:57.640386 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:55:57.640730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f7775ae0-95e6-4504-bcb6-207be1594c5d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14629e550>]}
[0m19:55:57.720910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7775ae0-95e6-4504-bcb6-207be1594c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462b7ad0>]}
[0m19:55:57.779035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7775ae0-95e6-4504-bcb6-207be1594c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1467f2e50>]}
[0m19:55:57.779322 [info ] [MainThread]: Found 32 models, 4 seeds, 4 data tests, 3 sources, 447 macros
[0m19:55:57.779496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7775ae0-95e6-4504-bcb6-207be1594c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14609ba10>]}
[0m19:55:57.780441 [info ] [MainThread]: 
[0m19:55:57.780703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:55:57.783324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m19:55:57.783590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m19:55:57.783835 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m19:55:57.790376 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m19:55:57.791330 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m19:55:57.792215 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m19:55:57.792400 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m19:55:57.792581 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m19:55:57.792733 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m19:55:57.792874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:57.792998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:57.793118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:58.512975 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:55:58.514110 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m19:55:58.514962 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:55:58.518403 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m19:55:58.521853 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m19:55:58.523762 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m19:55:58.675152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7775ae0-95e6-4504-bcb6-207be1594c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146846110>]}
[0m19:55:58.675960 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:55:58.676409 [info ] [MainThread]: 
[0m19:55:58.680813 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:55:58.681352 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:55:58.681933 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:55:58.682300 [debug] [Thread-4 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:55:58.682692 [info ] [Thread-2 (]: 2 of 4 START test not_null_clean_device_data_msisdn ............................ [RUN]
[0m19:55:58.683241 [info ] [Thread-3 (]: 3 of 4 START test not_null_enriched_data_msisdn ................................ [RUN]
[0m19:55:58.683701 [info ] [Thread-1 (]: 1 of 4 START test not_null_clean_crm_data_msisdn ............................... [RUN]
[0m19:55:58.684161 [info ] [Thread-4 (]: 4 of 4 START test unique_clean_crm_data_msisdn ................................. [RUN]
[0m19:55:58.684672 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580)
[0m19:55:58.685094 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925)
[0m19:55:58.685494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m19:55:58.685964 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e'
[0m19:55:58.686336 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:55:58.686675 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:55:58.687020 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:55:58.687360 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:55:58.707227 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m19:55:58.707694 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:55:58.710835 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:55:58.715663 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:55:58.716409 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:55:58.716680 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:55:58.716967 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:55:58.729849 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m19:55:58.730228 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:55:58.731749 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:55:58.733166 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:55:58.734574 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:55:58.735188 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m19:55:58.735687 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:55:58.736057 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:55:58.736297 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.enriched_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:55:58.736562 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:55:58.736817 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:55:58.737225 [debug] [Thread-4 (]: Using snowflake connection "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:55:58.737420 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:55:58.737611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:58.737806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:55:58.738009 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m19:55:58.739837 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:55:59.176205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:55:59.177884 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:55:59.192035 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: Close
[0m19:55:59.194992 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: Close
[0m19:55:59.195725 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:55:59.196416 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:55:59.201311 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: Close
[0m19:55:59.203267 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: Close
[0m19:55:59.354740 [info ] [Thread-3 (]: 3 of 4 PASS not_null_enriched_data_msisdn ...................................... [[32mPASS[0m in 0.67s]
[0m19:55:59.355689 [info ] [Thread-2 (]: 2 of 4 PASS not_null_clean_device_data_msisdn .................................. [[32mPASS[0m in 0.67s]
[0m19:55:59.356917 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:55:59.357645 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:55:59.360672 [info ] [Thread-4 (]: 4 of 4 PASS unique_clean_crm_data_msisdn ....................................... [[32mPASS[0m in 0.67s]
[0m19:55:59.361449 [info ] [Thread-1 (]: 1 of 4 PASS not_null_clean_crm_data_msisdn ..................................... [[32mPASS[0m in 0.68s]
[0m19:55:59.362161 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:55:59.362778 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:55:59.364422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:59.364889 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f' was properly closed.
[0m19:55:59.365259 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580' was properly closed.
[0m19:55:59.365592 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925' was properly closed.
[0m19:55:59.365878 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e' was properly closed.
[0m19:55:59.366216 [info ] [MainThread]: 
[0m19:55:59.366556 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m19:55:59.367521 [debug] [MainThread]: Command end result
[0m19:55:59.400815 [info ] [MainThread]: 
[0m19:55:59.401188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:55:59.401414 [info ] [MainThread]: 
[0m19:55:59.401636 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:55:59.404318 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1188705, "process_user_time": 2.419912, "process_kernel_time": 1.73168, "process_mem_max_rss": "202047488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:55:59.404746 [debug] [MainThread]: Command `dbt test` succeeded at 19:55:59.404683 after 3.12 seconds
[0m19:55:59.405040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030bc2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fee050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1377ca250>]}
[0m19:55:59.405300 [debug] [MainThread]: Flushing usage events
[0m19:56:42.210751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e913d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e91a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eebb90>]}


============================== 19:56:42.213377 | 0450e605-5f99-4d4d-98bd-2d0bcff2ee5e ==============================
[0m19:56:42.213377 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:56:42.213683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m19:56:42.904325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0450e605-5f99-4d4d-98bd-2d0bcff2ee5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f3dbd0>]}
[0m19:56:42.924529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0450e605-5f99-4d4d-98bd-2d0bcff2ee5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108430d0>]}
[0m19:56:42.925744 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:56:42.939176 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:56:43.029969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:56:43.030433 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/tests/schema.yml
[0m19:56:43.092222 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m19:56:43.160324 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:56:43.160645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0450e605-5f99-4d4d-98bd-2d0bcff2ee5e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f9e50>]}
[0m19:56:43.239139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0450e605-5f99-4d4d-98bd-2d0bcff2ee5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14719d110>]}
[0m19:56:43.297973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0450e605-5f99-4d4d-98bd-2d0bcff2ee5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1478dff10>]}
[0m19:56:43.298266 [info ] [MainThread]: Found 32 models, 4 seeds, 4 data tests, 3 sources, 447 macros
[0m19:56:43.298437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0450e605-5f99-4d4d-98bd-2d0bcff2ee5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1476f57d0>]}
[0m19:56:43.299397 [info ] [MainThread]: 
[0m19:56:43.299659 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:56:43.302338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m19:56:43.302578 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m19:56:43.309112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m19:56:43.309490 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m19:56:43.310473 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m19:56:43.311445 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m19:56:43.311642 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m19:56:43.311801 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m19:56:43.311946 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m19:56:43.312077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:43.312202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:43.312354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:43.980258 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:56:43.981333 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m19:56:43.984980 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m19:56:43.988289 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m19:56:43.999618 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:56:44.002366 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m19:56:44.153890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0450e605-5f99-4d4d-98bd-2d0bcff2ee5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147341550>]}
[0m19:56:44.154738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:56:44.155181 [info ] [MainThread]: 
[0m19:56:44.158710 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:56:44.159280 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:56:44.159740 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:56:44.160191 [info ] [Thread-1 (]: 1 of 4 START test not_null_clean_crm_data_msisdn ............................... [RUN]
[0m19:56:44.160703 [debug] [Thread-4 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:56:44.161196 [info ] [Thread-2 (]: 2 of 4 START test not_null_clean_device_data_msisdn ............................ [RUN]
[0m19:56:44.161695 [info ] [Thread-3 (]: 3 of 4 START test not_null_enriched_data_msisdn ................................ [RUN]
[0m19:56:44.162307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m19:56:44.162730 [info ] [Thread-4 (]: 4 of 4 START test unique_clean_crm_data_msisdn ................................. [RUN]
[0m19:56:44.163241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580)
[0m19:56:44.163745 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925)
[0m19:56:44.164154 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:56:44.165840 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e'
[0m19:56:44.166255 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:56:44.166620 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:56:44.182895 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:56:44.183418 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:56:44.186878 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:56:44.189874 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m19:56:44.194702 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:56:44.195519 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:56:44.195801 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:56:44.207890 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:56:44.208128 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:56:44.209379 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:56:44.210935 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:56:44.212265 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m19:56:44.213834 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:56:44.215008 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m19:56:44.215406 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m19:56:44.215776 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m19:56:44.216177 [debug] [Thread-4 (]: Using snowflake connection "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m19:56:44.216401 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.enriched_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:56:44.216637 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:56:44.216864 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is null



      
    ) dbt_internal_test
[0m19:56:44.217085 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m19:56:44.217290 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:56:44.217475 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:56:44.217653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:44.217826 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:56:44.719303 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:56:44.733043 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: Close
[0m19:56:44.748032 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:56:44.750413 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: Close
[0m19:56:44.753369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:56:44.755236 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: Close
[0m19:56:44.871894 [info ] [Thread-2 (]: 2 of 4 PASS not_null_clean_device_data_msisdn .................................. [[32mPASS[0m in 0.71s]
[0m19:56:44.873745 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m19:56:44.876708 [info ] [Thread-1 (]: 1 of 4 PASS not_null_clean_crm_data_msisdn ..................................... [[32mPASS[0m in 0.71s]
[0m19:56:44.877508 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m19:56:44.894982 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:56:44.897855 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: Close
[0m19:56:44.907928 [info ] [Thread-4 (]: 4 of 4 PASS unique_clean_crm_data_msisdn ....................................... [[32mPASS[0m in 0.74s]
[0m19:56:44.908725 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m19:56:45.108339 [info ] [Thread-3 (]: 3 of 4 PASS not_null_enriched_data_msisdn ...................................... [[32mPASS[0m in 0.94s]
[0m19:56:45.109830 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m19:56:45.111679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:45.112122 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f' was properly closed.
[0m19:56:45.112484 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580' was properly closed.
[0m19:56:45.112815 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925' was properly closed.
[0m19:56:45.113128 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e' was properly closed.
[0m19:56:45.113548 [info ] [MainThread]: 
[0m19:56:45.113951 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m19:56:45.115135 [debug] [MainThread]: Command end result
[0m19:56:45.153088 [info ] [MainThread]: 
[0m19:56:45.153461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:45.153694 [info ] [MainThread]: 
[0m19:56:45.153919 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:56:45.156374 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9734902, "process_user_time": 2.223195, "process_kernel_time": 1.705014, "process_mem_max_rss": "201375744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:56:45.156816 [debug] [MainThread]: Command `dbt test` succeeded at 19:56:45.156749 after 2.97 seconds
[0m19:56:45.157114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ebba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482a050>]}
[0m19:56:45.157384 [debug] [MainThread]: Flushing usage events
[0m20:00:03.318890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107962310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c3fd0>]}


============================== 20:00:03.321711 | 9f109e44-4b33-4247-b027-e97ee2e6fb47 ==============================
[0m20:00:03.321711 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:00:03.322028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:00:04.272038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f109e44-4b33-4247-b027-e97ee2e6fb47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b6d55d0>]}
[0m20:00:04.292316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f109e44-4b33-4247-b027-e97ee2e6fb47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c430d0>]}
[0m20:00:04.292889 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:00:04.304029 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:00:04.397588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:00:04.398071 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/tests/schema.yml
[0m20:00:04.461603 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m20:00:04.531442 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'clean_device_data', 'columns': [{'name': 'msisdn', 'tests': ['not_null']}, {'name': 'IMEI_TAC', 'tests': ['not null']}, {'dbt_utils.unique_combination_of_columns': {'combination_of_columns': ['IMEI_TAC', 'msisdn']}}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'my_dbt_project'} - at path ['columns'][2]: 'name' is a required property
[0m20:00:04.533664 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2443527, "process_user_time": 1.702562, "process_kernel_time": 1.752499, "process_mem_max_rss": "184238080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:00:04.533951 [debug] [MainThread]: Command `dbt test` failed at 20:00:04.533907 after 1.24 seconds
[0m20:00:04.534151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103720410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e9acdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dff29d0>]}
[0m20:00:04.534324 [debug] [MainThread]: Flushing usage events
[0m20:01:15.757254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104843f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044475d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104842450>]}


============================== 20:01:15.759928 | 49c54f39-6210-406c-ace3-73f0a0c514d1 ==============================
[0m20:01:15.759928 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:01:15.760240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:01:16.855556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49c54f39-6210-406c-ace3-73f0a0c514d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a82fcd0>]}
[0m20:01:16.876605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49c54f39-6210-406c-ace3-73f0a0c514d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f3150>]}
[0m20:01:16.877274 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:01:16.888762 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:01:16.979479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:01:16.979950 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/tests/schema.yml
[0m20:01:17.043907 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m20:01:17.113584 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'clean_device_data', 'columns': [{'name': 'msisdn', 'tests': ['not_null']}, {'name': 'IMEI_TAC', 'tests': ['not_null']}, {'dbt_utils.unique_combination_of_columns': {'combination_of_columns': ['IMEI_TAC', 'msisdn']}}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'my_dbt_project'} - at path ['columns'][2]: 'name' is a required property
[0m20:01:17.117164 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.3903298, "process_user_time": 1.655562, "process_kernel_time": 1.774047, "process_mem_max_rss": "184762368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:01:17.117477 [debug] [MainThread]: Command `dbt test` failed at 20:01:17.117425 after 1.39 seconds
[0m20:01:17.117670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10146c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12acd0d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aa997d0>]}
[0m20:01:17.117847 [debug] [MainThread]: Flushing usage events
[0m20:07:57.691189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aac4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac9090>]}


============================== 20:07:57.693966 | f707a5cb-5d99-4870-85f5-7f8946f901d4 ==============================
[0m20:07:57.693966 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:07:57.694273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:07:58.753842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f707a5cb-5d99-4870-85f5-7f8946f901d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6e2d0>]}
[0m20:07:58.774364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f707a5cb-5d99-4870-85f5-7f8946f901d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073430d0>]}
[0m20:07:58.774925 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:07:58.788029 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:07:58.887632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:07:58.888190 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/tests/schema.yml
[0m20:07:58.953288 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m20:07:59.024245 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:07:59.024597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f707a5cb-5d99-4870-85f5-7f8946f901d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1556fffd0>]}
[0m20:07:59.108580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f707a5cb-5d99-4870-85f5-7f8946f901d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15547cc50>]}
[0m20:07:59.168284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f707a5cb-5d99-4870-85f5-7f8946f901d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1562fbfd0>]}
[0m20:07:59.168586 [info ] [MainThread]: Found 32 models, 4 seeds, 6 data tests, 3 sources, 447 macros
[0m20:07:59.168756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f707a5cb-5d99-4870-85f5-7f8946f901d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1557a9fd0>]}
[0m20:07:59.169729 [info ] [MainThread]: 
[0m20:07:59.169998 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:07:59.172635 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m20:07:59.172899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m20:07:59.178963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m20:07:59.179796 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m20:07:59.180784 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m20:07:59.181694 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m20:07:59.181875 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m20:07:59.182041 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m20:07:59.182203 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m20:07:59.182349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:59.182480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:59.182606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:00.091967 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:08:00.093613 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:08:00.094776 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m20:08:00.097636 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m20:08:00.099820 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m20:08:00.102964 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m20:08:00.286134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f707a5cb-5d99-4870-85f5-7f8946f901d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155541110>]}
[0m20:08:00.287017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:08:00.287470 [info ] [MainThread]: 
[0m20:08:00.291024 [debug] [Thread-1 (]: Began running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:08:00.291526 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:08:00.291979 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:08:00.292364 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn  [RUN]
[0m20:08:00.292762 [debug] [Thread-4 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:08:00.293180 [info ] [Thread-2 (]: 2 of 6 START test not_null_clean_crm_data_msisdn ............................... [RUN]
[0m20:08:00.293611 [info ] [Thread-3 (]: 3 of 6 START test not_null_clean_device_data_IMEI_TAC .......................... [RUN]
[0m20:08:00.294109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9)
[0m20:08:00.294497 [info ] [Thread-4 (]: 4 of 6 START test not_null_clean_device_data_msisdn ............................ [RUN]
[0m20:08:00.294949 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m20:08:00.295354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873)
[0m20:08:00.295991 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:08:00.296479 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580'
[0m20:08:00.296838 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:08:00.297174 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:08:00.306780 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:08:00.314393 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:08:00.317915 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:08:00.321763 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:08:00.322661 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:08:00.336575 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:08:00.336980 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:08:00.337273 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:08:00.338953 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:08:00.340512 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:08:00.340949 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:08:00.341354 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select IMEI_TAC
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where IMEI_TAC is null



      
    ) dbt_internal_test
[0m20:08:00.341689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:08:00.342203 [debug] [Thread-4 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:08:00.342595 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:08:00.343232 [debug] [Thread-4 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:08:00.343567 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:08:00.344159 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:08:00.344456 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:08:00.348110 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn (models/tests/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:08:00.348632 [error] [Thread-1 (]: 1 of 6 ERROR dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn  [[31mERROR[0m in 0.05s]
[0m20:08:00.349265 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:08:00.349490 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:08:00.349733 [info ] [Thread-1 (]: 5 of 6 START test not_null_enriched_data_msisdn ................................ [RUN]
[0m20:08:00.350016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9, now test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925)
[0m20:08:00.350243 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:08:00.353495 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:08:00.354161 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:08:00.355489 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:08:00.356030 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:08:00.356232 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.enriched_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:08:00.356412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:00.768102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:00.769538 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:00.779966 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: Close
[0m20:08:00.781754 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: Close
[0m20:08:00.782441 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:00.787016 [debug] [Thread-4 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: Close
[0m20:08:00.955662 [info ] [Thread-1 (]: 5 of 6 PASS not_null_enriched_data_msisdn ...................................... [[32mPASS[0m in 0.61s]
[0m20:08:00.956429 [info ] [Thread-2 (]: 2 of 6 PASS not_null_clean_crm_data_msisdn ..................................... [[32mPASS[0m in 0.66s]
[0m20:08:00.957447 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:08:00.958123 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:08:00.958657 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:08:00.959332 [info ] [Thread-1 (]: 6 of 6 START test unique_clean_crm_data_msisdn ................................. [RUN]
[0m20:08:00.959918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925, now test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e)
[0m20:08:00.960409 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:08:00.968079 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:08:00.968996 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:08:00.971714 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:08:00.972912 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:08:00.973365 [debug] [Thread-1 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m20:08:00.973754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:01.624882 [info ] [Thread-4 (]: 4 of 6 PASS not_null_clean_device_data_msisdn .................................. [[32mPASS[0m in 1.33s]
[0m20:08:01.626057 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:08:01.741606 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:08:01.746275 [debug] [Thread-1 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: Close
[0m20:08:01.905016 [info ] [Thread-1 (]: 6 of 6 PASS unique_clean_crm_data_msisdn ....................................... [[32mPASS[0m in 0.94s]
[0m20:08:01.906143 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:08:02.696288 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:08:02.698713 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873: Close
[0m20:08:02.903294 [info ] [Thread-3 (]: 3 of 6 PASS not_null_clean_device_data_IMEI_TAC ................................ [[32mPASS[0m in 2.61s]
[0m20:08:02.904361 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:08:02.906370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:02.906867 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e' was properly closed.
[0m20:08:02.907248 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f' was properly closed.
[0m20:08:02.907581 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873' was properly closed.
[0m20:08:02.907902 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580' was properly closed.
[0m20:08:02.908316 [info ] [MainThread]: 
[0m20:08:02.908753 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m20:08:02.910174 [debug] [MainThread]: Command end result
[0m20:08:02.949155 [info ] [MainThread]: 
[0m20:08:02.949582 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:08:02.949802 [info ] [MainThread]: 
[0m20:08:02.950087 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn (models/tests/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:08:02.950318 [info ] [MainThread]: 
[0m20:08:02.950542 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:08:02.953502 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.292457, "process_user_time": 2.409321, "process_kernel_time": 1.810492, "process_mem_max_rss": "203505664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:08:02.953962 [debug] [MainThread]: Command `dbt test` failed at 20:08:02.953900 after 5.29 seconds
[0m20:08:02.954267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107acabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102da8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa2e10>]}
[0m20:08:02.954530 [debug] [MainThread]: Flushing usage events
[0m20:10:03.572687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108701d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108396ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875bf10>]}


============================== 20:10:03.575733 | 5374ce52-daa9-4c0c-8785-5f8b0b2f81d8 ==============================
[0m20:10:03.575733 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:10:03.576059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:03.636615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5374ce52-daa9-4c0c-8785-5f8b0b2f81d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108396950>]}
[0m20:10:03.647101 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:10:03.647567 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:10:03.649026 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10809696, "process_user_time": 0.562174, "process_kernel_time": 0.121863, "process_mem_max_rss": "93077504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:10:03.649318 [debug] [MainThread]: Command `dbt deps` succeeded at 20:10:03.649258 after 0.11 seconds
[0m20:10:03.649500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10872b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10532c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108396f90>]}
[0m20:10:03.649684 [debug] [MainThread]: Flushing usage events
[0m20:10:43.535874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11184ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c8e50>]}


============================== 20:10:43.538602 | 19216757-a9cb-4220-8e69-e9ead1c4c257 ==============================
[0m20:10:43.538602 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:10:43.538901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:44.422650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19216757-a9cb-4220-8e69-e9ead1c4c257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14673db10>]}
[0m20:10:44.443258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19216757-a9cb-4220-8e69-e9ead1c4c257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111143010>]}
[0m20:10:44.443906 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:10:44.454702 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:10:44.544786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:44.545038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:44.567765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19216757-a9cb-4220-8e69-e9ead1c4c257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471c9190>]}
[0m20:10:44.663906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19216757-a9cb-4220-8e69-e9ead1c4c257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14710d310>]}
[0m20:10:44.664188 [info ] [MainThread]: Found 32 models, 4 seeds, 6 data tests, 3 sources, 447 macros
[0m20:10:44.664360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19216757-a9cb-4220-8e69-e9ead1c4c257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147312ad0>]}
[0m20:10:44.665358 [info ] [MainThread]: 
[0m20:10:44.665651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:44.668260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m20:10:44.668522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m20:10:44.668807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m20:10:44.676781 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m20:10:44.677869 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m20:10:44.678788 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m20:10:44.678941 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m20:10:44.679081 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m20:10:44.679214 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m20:10:44.679346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:44.679467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:44.679577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:45.325905 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:10:45.327516 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:10:45.330807 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m20:10:45.332894 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m20:10:45.379176 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m20:10:45.383817 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m20:10:45.544140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19216757-a9cb-4220-8e69-e9ead1c4c257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1470dbf90>]}
[0m20:10:45.545097 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:45.545535 [info ] [MainThread]: 
[0m20:10:45.549119 [debug] [Thread-1 (]: Began running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:10:45.549652 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:10:45.550159 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:10:45.550583 [debug] [Thread-4 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:10:45.551027 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn  [RUN]
[0m20:10:45.551636 [info ] [Thread-2 (]: 2 of 6 START test not_null_clean_crm_data_msisdn ............................... [RUN]
[0m20:10:45.552243 [info ] [Thread-3 (]: 3 of 6 START test not_null_clean_device_data_IMEI_TAC .......................... [RUN]
[0m20:10:45.552710 [info ] [Thread-4 (]: 4 of 6 START test not_null_clean_device_data_msisdn ............................ [RUN]
[0m20:10:45.553237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9)
[0m20:10:45.553654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m20:10:45.554299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873)
[0m20:10:45.554802 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580'
[0m20:10:45.555188 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:10:45.555536 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:10:45.555894 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:10:45.556251 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:10:45.577150 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:10:45.580216 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:10:45.583414 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:10:45.584866 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:10:45.585200 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:10:45.591483 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:10:45.600092 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:10:45.601838 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:10:45.603179 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:10:45.603912 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:10:45.604344 [debug] [Thread-4 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:10:45.604682 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:10:45.605080 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:10:45.605373 [debug] [Thread-4 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:10:45.605602 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:45.605885 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select IMEI_TAC
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where IMEI_TAC is null



      
    ) dbt_internal_test
[0m20:10:45.606161 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:10:45.606606 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:45.609496 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn (models/tests/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:10:45.609853 [error] [Thread-1 (]: 1 of 6 ERROR dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn  [[31mERROR[0m in 0.06s]
[0m20:10:45.610500 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:10:45.610930 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:10:45.611175 [info ] [Thread-1 (]: 5 of 6 START test not_null_enriched_data_msisdn ................................ [RUN]
[0m20:10:45.611410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9, now test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925)
[0m20:10:45.611590 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:10:45.613781 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:10:45.614585 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:10:45.615930 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:10:45.616471 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:10:45.616701 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.enriched_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:10:45.616897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:46.050988 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:46.065318 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: Close
[0m20:10:46.067098 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:46.074681 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873: Close
[0m20:10:46.165674 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:46.167576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:46.170518 [debug] [Thread-4 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: Close
[0m20:10:46.172999 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: Close
[0m20:10:46.216648 [info ] [Thread-3 (]: 3 of 6 PASS not_null_clean_device_data_IMEI_TAC ................................ [[32mPASS[0m in 0.66s]
[0m20:10:46.217375 [info ] [Thread-2 (]: 2 of 6 PASS not_null_clean_crm_data_msisdn ..................................... [[32mPASS[0m in 0.66s]
[0m20:10:46.218338 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:10:46.218999 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:10:46.219557 [debug] [Thread-3 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:10:46.220259 [info ] [Thread-3 (]: 6 of 6 START test unique_clean_crm_data_msisdn ................................. [RUN]
[0m20:10:46.220819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873, now test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e)
[0m20:10:46.221284 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:10:46.229183 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:10:46.230083 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:10:46.232786 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:10:46.234002 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:10:46.234443 [debug] [Thread-3 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:46.234979 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:46.330472 [info ] [Thread-1 (]: 5 of 6 PASS not_null_enriched_data_msisdn ...................................... [[32mPASS[0m in 0.72s]
[0m20:10:46.330955 [info ] [Thread-4 (]: 4 of 6 PASS not_null_clean_device_data_msisdn .................................. [[32mPASS[0m in 0.78s]
[0m20:10:46.331580 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:10:46.331932 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:10:46.693536 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:46.698255 [debug] [Thread-3 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: Close
[0m20:10:46.861982 [info ] [Thread-3 (]: 6 of 6 PASS unique_clean_crm_data_msisdn ....................................... [[32mPASS[0m in 0.64s]
[0m20:10:46.863082 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:10:46.865089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:46.865488 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925' was properly closed.
[0m20:10:46.865843 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f' was properly closed.
[0m20:10:46.866173 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e' was properly closed.
[0m20:10:46.866490 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580' was properly closed.
[0m20:10:46.866890 [info ] [MainThread]: 
[0m20:10:46.867295 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m20:10:46.868932 [debug] [MainThread]: Command end result
[0m20:10:46.906857 [info ] [MainThread]: 
[0m20:10:46.907227 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:10:46.907453 [info ] [MainThread]: 
[0m20:10:46.907740 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn (models/tests/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:10:46.907965 [info ] [MainThread]: 
[0m20:10:46.908175 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:10:46.910675 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.402665, "process_user_time": 2.201716, "process_kernel_time": 1.733683, "process_mem_max_rss": "198639616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:10:46.911054 [debug] [MainThread]: Command `dbt test` failed at 20:10:46.910996 after 3.40 seconds
[0m20:10:46.911338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105410410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ca5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ca990>]}
[0m20:10:46.911599 [debug] [MainThread]: Flushing usage events
[0m20:11:39.767441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104586850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ebf90>]}


============================== 20:11:39.770116 | 08ac6625-544e-4818-90e4-06b5166297ef ==============================
[0m20:11:39.770116 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:11:39.770415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:11:39.859252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08ac6625-544e-4818-90e4-06b5166297ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d3b50>]}
[0m20:11:39.869238 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:11:39.869773 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:11:39.871204 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13359646, "process_user_time": 0.576355, "process_kernel_time": 0.11539, "process_mem_max_rss": "93110272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:11:39.871495 [debug] [MainThread]: Command `dbt deps` succeeded at 20:11:39.871436 after 0.13 seconds
[0m20:11:39.871670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045eb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1011b0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010e2050>]}
[0m20:11:39.871838 [debug] [MainThread]: Flushing usage events
[0m20:11:57.634087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108907e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894e790>]}


============================== 20:11:57.636235 | 842502a1-8ff1-4e17-b84e-eabd00db156c ==============================
[0m20:11:57.636235 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:11:57.636533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:11:57.720414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '842502a1-8ff1-4e17-b84e-eabd00db156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892f9d0>]}
[0m20:11:57.725968 [debug] [MainThread]: Set downloads directory='/var/folders/4l/01w8nw213fx2_n58nk4fjmk80000gp/T/dbt-downloads-z4ph0r2w'
[0m20:11:57.726227 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:11:58.227916 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:11:58.228816 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:11:58.642608 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:11:58.659369 [info ] [MainThread]: Updating lock file in file path: /Users/amanpandey/Desktop/mock/src/section2/package-lock.yml
[0m20:11:58.663927 [debug] [MainThread]: Set downloads directory='/var/folders/4l/01w8nw213fx2_n58nk4fjmk80000gp/T/dbt-downloads-sb1gvrtz'
[0m20:11:58.667613 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:11:59.264045 [info ] [MainThread]: Installed from version 1.2.0
[0m20:11:59.264379 [info ] [MainThread]: Up to date!
[0m20:11:59.264653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '842502a1-8ff1-4e17-b84e-eabd00db156c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ab010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089998d0>]}
[0m20:11:59.267285 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.6587228, "process_user_time": 0.727859, "process_kernel_time": 0.157184, "process_mem_max_rss": "99549184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:11:59.267764 [debug] [MainThread]: Command `dbt deps` succeeded at 20:11:59.267688 after 1.66 seconds
[0m20:11:59.268023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105530410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105462050>]}
[0m20:11:59.268255 [debug] [MainThread]: Flushing usage events
[0m20:12:03.554103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d12d0>]}


============================== 20:12:03.556313 | 4bf8db84-4256-4ec7-ac77-f2d58b978372 ==============================
[0m20:12:03.556313 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:12:03.556610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:12:04.519794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bf8db84-4256-4ec7-ac77-f2d58b978372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd31450>]}
[0m20:12:04.541111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bf8db84-4256-4ec7-ac77-f2d58b978372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e0f110>]}
[0m20:12:04.541697 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:12:04.556178 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:12:04.621601 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m20:12:04.621954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4bf8db84-4256-4ec7-ac77-f2d58b978372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034c6690>]}
[0m20:12:05.121204 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m20:12:05.129034 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m20:12:05.135336 [info ] [MainThread]: import_crm: 
[0m20:12:05.277679 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:12:05.277992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4bf8db84-4256-4ec7-ac77-f2d58b978372', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128232490>]}
[0m20:12:05.407915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bf8db84-4256-4ec7-ac77-f2d58b978372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12853fbd0>]}
[0m20:12:05.466816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bf8db84-4256-4ec7-ac77-f2d58b978372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1287c7190>]}
[0m20:12:05.467126 [info ] [MainThread]: Found 32 models, 4 seeds, 6 data tests, 3 sources, 563 macros
[0m20:12:05.467301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf8db84-4256-4ec7-ac77-f2d58b978372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128599b10>]}
[0m20:12:05.468313 [info ] [MainThread]: 
[0m20:12:05.468584 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:12:05.471201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m20:12:05.471455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m20:12:05.471736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m20:12:05.524562 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m20:12:05.525577 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m20:12:05.526485 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m20:12:05.526641 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m20:12:05.526783 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m20:12:05.526916 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m20:12:05.527040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:05.527165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:05.527279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:06.217433 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m20:12:06.221645 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m20:12:06.261223 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:12:06.264469 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m20:12:06.336608 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:12:06.340539 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m20:12:06.496484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf8db84-4256-4ec7-ac77-f2d58b978372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285b5f10>]}
[0m20:12:06.497650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:06.498322 [info ] [MainThread]: 
[0m20:12:06.501700 [debug] [Thread-1 (]: Began running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:12:06.502220 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:12:06.502745 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:12:06.503170 [debug] [Thread-4 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:12:06.503620 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn  [RUN]
[0m20:12:06.504131 [info ] [Thread-2 (]: 2 of 6 START test not_null_clean_crm_data_msisdn ............................... [RUN]
[0m20:12:06.504617 [info ] [Thread-3 (]: 3 of 6 START test not_null_clean_device_data_IMEI_TAC .......................... [RUN]
[0m20:12:06.505087 [info ] [Thread-4 (]: 4 of 6 START test not_null_clean_device_data_msisdn ............................ [RUN]
[0m20:12:06.505632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9)
[0m20:12:06.506112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m20:12:06.506863 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873)
[0m20:12:06.507459 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580'
[0m20:12:06.507910 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:12:06.508328 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:12:06.508736 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:12:06.509123 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:12:06.519240 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9"
[0m20:12:06.527636 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:12:06.531340 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:12:06.536348 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:12:06.537190 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:12:06.537575 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:12:06.537941 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:12:06.538225 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:12:06.552356 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9"
[0m20:12:06.554157 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:12:06.555697 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:12:06.557257 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:12:06.558098 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9"
[0m20:12:06.558396 [debug] [Thread-1 (]: On test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        IMEI_TAC, msisdn
    from PROJECT_SEC2_DB.silver_layer.clean_device_data
    group by IMEI_TAC, msisdn
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m20:12:06.558678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:06.559096 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:12:06.559968 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:12:06.560350 [debug] [Thread-4 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:12:06.560800 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:12:06.561071 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select IMEI_TAC
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where IMEI_TAC is null



      
    ) dbt_internal_test
[0m20:12:06.561318 [debug] [Thread-4 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:12:06.561529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:06.561720 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:12:06.561901 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:12:07.029070 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:12:07.034519 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873: Close
[0m20:12:07.066860 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:12:07.067338 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:12:07.068619 [debug] [Thread-4 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: Close
[0m20:12:07.069742 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: Close
[0m20:12:07.205900 [info ] [Thread-2 (]: 2 of 6 PASS not_null_clean_crm_data_msisdn ..................................... [[32mPASS[0m in 0.70s]
[0m20:12:07.206976 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:12:07.207565 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:12:07.208199 [info ] [Thread-2 (]: 5 of 6 START test not_null_enriched_data_msisdn ................................ [RUN]
[0m20:12:07.208804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f, now test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925)
[0m20:12:07.209282 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:12:07.215583 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:12:07.216597 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:12:07.222278 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:12:07.223677 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:12:07.224125 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.enriched_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:12:07.224537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:07.289469 [info ] [Thread-3 (]: 3 of 6 PASS not_null_clean_device_data_IMEI_TAC ................................ [[32mPASS[0m in 0.78s]
[0m20:12:07.290276 [info ] [Thread-4 (]: 4 of 6 PASS not_null_clean_device_data_msisdn .................................. [[32mPASS[0m in 0.78s]
[0m20:12:07.291369 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:12:07.292027 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:12:07.292539 [debug] [Thread-3 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:12:07.293119 [info ] [Thread-3 (]: 6 of 6 START test unique_clean_crm_data_msisdn ................................. [RUN]
[0m20:12:07.293613 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873, now test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e)
[0m20:12:07.294016 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:12:07.301116 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:12:07.302009 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:12:07.304687 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:12:07.305766 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:12:07.306115 [debug] [Thread-3 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m20:12:07.306451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:12:07.653789 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:12:07.656929 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: Close
[0m20:12:07.749508 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:12:07.753470 [debug] [Thread-3 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: Close
[0m20:12:07.804213 [info ] [Thread-2 (]: 5 of 6 PASS not_null_enriched_data_msisdn ...................................... [[32mPASS[0m in 0.60s]
[0m20:12:07.805270 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:12:07.921635 [info ] [Thread-3 (]: 6 of 6 PASS unique_clean_crm_data_msisdn ....................................... [[32mPASS[0m in 0.63s]
[0m20:12:07.923009 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:12:08.089111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:12:08.093544 [debug] [Thread-1 (]: On test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9: Close
[0m20:12:08.523974 [info ] [Thread-1 (]: 1 of 6 PASS dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn  [[32mPASS[0m in 2.02s]
[0m20:12:08.525932 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:12:08.528360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:08.529005 [debug] [MainThread]: Connection 'test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9' was properly closed.
[0m20:12:08.529447 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925' was properly closed.
[0m20:12:08.529788 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e' was properly closed.
[0m20:12:08.530104 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580' was properly closed.
[0m20:12:08.530513 [info ] [MainThread]: 
[0m20:12:08.530921 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m20:12:08.532354 [debug] [MainThread]: Command end result
[0m20:12:08.573751 [info ] [MainThread]: 
[0m20:12:08.574124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:08.574349 [info ] [MainThread]: 
[0m20:12:08.574572 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:12:08.576625 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.049554, "process_user_time": 3.095559, "process_kernel_time": 1.860595, "process_mem_max_rss": "203210752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:12:08.577011 [debug] [MainThread]: Command `dbt test` succeeded at 20:12:08.576948 after 5.05 seconds
[0m20:12:08.577295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f88410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100eba050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ef2510>]}
[0m20:12:08.577553 [debug] [MainThread]: Flushing usage events
[0m20:13:14.593182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b3fd0>]}


============================== 20:13:14.595401 | 259f7d9a-0718-4b0d-a473-251fc2de4a4f ==============================
[0m20:13:14.595401 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:13:14.595712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m20:13:15.145219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '259f7d9a-0718-4b0d-a473-251fc2de4a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2b4e50>]}
[0m20:13:15.166405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '259f7d9a-0718-4b0d-a473-251fc2de4a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0b090>]}
[0m20:13:15.166792 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:13:15.179841 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:13:15.263706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:13:15.264145 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/tests/schema.yml
[0m20:13:15.365510 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m20:13:15.392042 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:13:15.392367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '259f7d9a-0718-4b0d-a473-251fc2de4a4f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3c00d0>]}
[0m20:13:15.473082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '259f7d9a-0718-4b0d-a473-251fc2de4a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c30ab90>]}
[0m20:13:15.535284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '259f7d9a-0718-4b0d-a473-251fc2de4a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c4aabd0>]}
[0m20:13:15.535578 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 563 macros
[0m20:13:15.535747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '259f7d9a-0718-4b0d-a473-251fc2de4a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2f64d0>]}
[0m20:13:15.536749 [info ] [MainThread]: 
[0m20:13:15.537018 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:15.539645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m20:13:15.539879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m20:13:15.540131 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m20:13:15.546815 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m20:13:15.547800 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m20:13:15.548709 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m20:13:15.548864 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m20:13:15.549001 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m20:13:15.549133 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m20:13:15.549255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:15.549371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:15.549484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:16.215135 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:13:16.216285 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:13:16.219246 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m20:13:16.221329 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m20:13:16.236322 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m20:13:16.239635 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m20:13:16.422843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '259f7d9a-0718-4b0d-a473-251fc2de4a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d1c1810>]}
[0m20:13:16.423689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:16.424127 [info ] [MainThread]: 
[0m20:13:16.428853 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:13:16.428045 [debug] [Thread-1 (]: Began running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:13:16.429492 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:13:16.429924 [debug] [Thread-4 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:13:16.430328 [info ] [Thread-2 (]: 2 of 7 START test not_null_clean_crm_data_msisdn ............................... [RUN]
[0m20:13:16.430792 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn  [RUN]
[0m20:13:16.431213 [info ] [Thread-3 (]: 3 of 7 START test not_null_clean_device_data_IMEI_TAC .......................... [RUN]
[0m20:13:16.431616 [info ] [Thread-4 (]: 4 of 7 START test not_null_clean_device_data_msisdn ............................ [RUN]
[0m20:13:16.432092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m20:13:16.432501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9)
[0m20:13:16.432895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873)
[0m20:13:16.434287 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580'
[0m20:13:16.434783 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:13:16.435348 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:13:16.435929 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:13:16.436325 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:13:16.452779 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:13:16.460506 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9"
[0m20:13:16.463455 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:13:16.466102 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:13:16.466846 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:13:16.467136 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:13:16.467437 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:13:16.479676 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:13:16.481209 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9"
[0m20:13:16.481475 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:13:16.482976 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:13:16.484506 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:13:16.484979 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m20:13:16.485493 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9"
[0m20:13:16.485761 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:13:16.486127 [debug] [Thread-3 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m20:13:16.486450 [debug] [Thread-4 (]: Using snowflake connection "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m20:13:16.486662 [debug] [Thread-1 (]: On test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        IMEI_TAC, msisdn
    from PROJECT_SEC2_DB.silver_layer.clean_device_data
    group by IMEI_TAC, msisdn
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m20:13:16.486872 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:16.487088 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select IMEI_TAC
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where IMEI_TAC is null



      
    ) dbt_internal_test
[0m20:13:16.487302 [debug] [Thread-4 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.clean_device_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:13:16.487488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:16.487716 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:16.488242 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:13:17.022243 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:13:17.023671 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:13:17.035313 [debug] [Thread-4 (]: On test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580: Close
[0m20:13:17.037320 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f: Close
[0m20:13:17.044135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:13:17.046282 [debug] [Thread-1 (]: On test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9: Close
[0m20:13:17.128894 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:13:17.131384 [debug] [Thread-3 (]: On test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873: Close
[0m20:13:17.216358 [info ] [Thread-1 (]: 1 of 7 PASS dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn  [[32mPASS[0m in 0.78s]
[0m20:13:17.217769 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m20:13:17.218442 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:13:17.219180 [info ] [Thread-2 (]: 2 of 7 PASS not_null_clean_crm_data_msisdn ..................................... [[32mPASS[0m in 0.79s]
[0m20:13:17.219995 [info ] [Thread-4 (]: 4 of 7 PASS not_null_clean_device_data_msisdn .................................. [[32mPASS[0m in 0.79s]
[0m20:13:17.220600 [info ] [Thread-1 (]: 5 of 7 START test not_null_enriched_data_msisdn ................................ [RUN]
[0m20:13:17.221389 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m20:13:17.222015 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m20:13:17.222538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9, now test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925)
[0m20:13:17.223079 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc
[0m20:13:17.223640 [debug] [Thread-4 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:13:17.224199 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:13:17.224719 [info ] [Thread-2 (]: 6 of 7 START test not_null_enriched_data_week_number ........................... [RUN]
[0m20:13:17.225224 [info ] [Thread-4 (]: 7 of 7 START test unique_clean_crm_data_msisdn ................................. [RUN]
[0m20:13:17.228585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f, now test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc)
[0m20:13:17.231245 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:13:17.231757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580, now test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e)
[0m20:13:17.232184 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc
[0m20:13:17.232689 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:13:17.237051 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc"
[0m20:13:17.243345 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:13:17.244115 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:13:17.247121 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:13:17.247673 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc
[0m20:13:17.248019 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:13:17.250281 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc"
[0m20:13:17.252420 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:13:17.253082 [debug] [Thread-1 (]: Using snowflake connection "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m20:13:17.253680 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select msisdn
from PROJECT_SEC2_DB.silver_layer.enriched_data
where msisdn is null



      
    ) dbt_internal_test
[0m20:13:17.254082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:17.254754 [debug] [Thread-2 (]: Using snowflake connection "test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc"
[0m20:13:17.255353 [debug] [Thread-4 (]: Using snowflake connection "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m20:13:17.256266 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select week_number
from PROJECT_SEC2_DB.silver_layer.enriched_data
where week_number is null



      
    ) dbt_internal_test
[0m20:13:17.256943 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    msisdn as unique_field,
    count(*) as n_records

from PROJECT_SEC2_DB.silver_layer.clean_crm_data
where msisdn is not null
group by msisdn
having count(*) > 1



      
    ) dbt_internal_test
[0m20:13:17.257299 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:17.257603 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:17.286890 [info ] [Thread-3 (]: 3 of 7 PASS not_null_clean_device_data_IMEI_TAC ................................ [[32mPASS[0m in 0.85s]
[0m20:13:17.287467 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m20:13:17.691111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:13:17.692509 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:13:17.696213 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925: Close
[0m20:13:17.698700 [debug] [Thread-4 (]: On test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e: Close
[0m20:13:17.847007 [info ] [Thread-1 (]: 5 of 7 PASS not_null_enriched_data_msisdn ...................................... [[32mPASS[0m in 0.62s]
[0m20:13:17.849003 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m20:13:17.847938 [info ] [Thread-4 (]: 7 of 7 PASS unique_clean_crm_data_msisdn ....................................... [[32mPASS[0m in 0.62s]
[0m20:13:17.850212 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m20:13:17.892369 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:13:17.894811 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc: Close
[0m20:13:18.029598 [info ] [Thread-2 (]: 6 of 7 PASS not_null_enriched_data_week_number ................................. [[32mPASS[0m in 0.80s]
[0m20:13:18.030815 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc
[0m20:13:18.033079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:18.033575 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925' was properly closed.
[0m20:13:18.033944 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc' was properly closed.
[0m20:13:18.034272 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873' was properly closed.
[0m20:13:18.034599 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e' was properly closed.
[0m20:13:18.035017 [info ] [MainThread]: 
[0m20:13:18.035442 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m20:13:18.037028 [debug] [MainThread]: Command end result
[0m20:13:18.077269 [info ] [MainThread]: 
[0m20:13:18.077639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:18.077865 [info ] [MainThread]: 
[0m20:13:18.078091 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:13:18.080575 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.5128086, "process_user_time": 2.456267, "process_kernel_time": 1.868425, "process_mem_max_rss": "204881920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:13:18.081035 [debug] [MainThread]: Command `dbt test` succeeded at 20:13:18.080966 after 3.51 seconds
[0m20:13:18.081324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f84410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f842d0>]}
[0m20:13:18.081587 [debug] [MainThread]: Flushing usage events
[0m14:55:14.727795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106926690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106926f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106979650>]}


============================== 14:55:14.730419 | e03933ca-ad48-47ec-bd92-626fa6ea33a2 ==============================
[0m14:55:14.730419 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:55:14.730725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:55:15.409120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121246210>]}
[0m14:55:15.430550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d7250>]}
[0m14:55:15.431127 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:55:15.444819 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m14:55:15.516179 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:55:15.516510 [debug] [MainThread]: previous checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, current checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838
[0m14:55:15.516716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8a790>]}
[0m14:55:15.922672 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m14:55:15.930464 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m14:55:15.936267 [info ] [MainThread]: import_crm: 
[0m14:55:16.070209 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:55:16.070493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217c65d0>]}
[0m14:55:16.195418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217d7cd0>]}
[0m14:55:16.249704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121835c50>]}
[0m14:55:16.250021 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m14:55:16.250187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218e1150>]}
[0m14:55:16.251336 [info ] [MainThread]: 
[0m14:55:16.251591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:16.254079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:55:16.254338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:55:16.259923 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:55:16.260942 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:55:16.261136 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:55:16.261326 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:55:16.261512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:16.261653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:17.339847 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:55:17.343134 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:55:17.376502 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:55:17.379941 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:55:17.507775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m14:55:17.508371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_silver_layer)
[0m14:55:17.508886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_test_gold_layer'
[0m14:55:17.521458 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:55:17.521979 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m14:55:17.523716 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m14:55:17.524016 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:55:17.524286 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m14:55:17.524536 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m14:55:17.524772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:17.524993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:17.525202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:17.991244 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m14:55:17.997091 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m14:55:18.057168 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:55:18.060742 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:55:18.075214 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:55:18.077456 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m14:55:18.205402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e88250>]}
[0m14:55:18.206236 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:18.206678 [info ] [MainThread]: 
[0m14:55:18.210180 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m14:55:18.210772 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m14:55:18.211430 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m14:55:18.212095 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m14:55:18.212683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m14:55:18.213960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_silver_layer, now model.my_dbt_project.clean_device_data)
[0m14:55:18.214432 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m14:55:18.214904 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m14:55:18.226274 [info ] [Thread-1 (]: import_crm: 
[0m14:55:18.230449 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m14:55:18.230896 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m14:55:18.231366 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m14:55:18.232716 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m14:55:18.233084 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m14:55:18.262221 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m14:55:18.263719 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m14:55:18.266045 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m14:55:18.266992 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m14:55:18.267343 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

windowed_crm AS (
    SELECT
        *,
        LEAD(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_status,
        LEAD(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_yob,
        LEAD(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_gender,
        LAG(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_status,
        LAG(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_yob,
        LAG(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_gender
    FROM cleaned_crm
),

flagged_crm AS (
    SELECT
        *,
        CASE
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'SUSPEND' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'SUSPEND' AND prev_status = 'ACTIVE' AND YEAR_OF_BIRTH = prev_yob AND GENDER = prev_gender) THEN 1
            EN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'IDLE' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            ELSE 0
        END AS pair_flag
    FROM windowed_crm
),

filtered_crm AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE SYSTEM_STATUS 
                WHEN 'ACTIVE' THEN 1 
                WHEN 'IDLE' THEN 2 
                WHEN 'SUSPEND' THEN 3 
                WHEN 'DEACTIVATE' THEN 4 
                ELSE 5 
            END,
            (CASE WHEN GENDER IS NOT NULL THEN 1 ELSE 0 END + 
            CASE WHEN YEAR_OF_BIRTH IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN SYSTEM_STATUS IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN MOBILE_TYPE IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN VALUE_SEGMENT IS NOT NULL THEN 1 ELSE 0 END) DESC
        ) AS rank
    FROM flagged_crm
    WHERE pair_flag = 0
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM filtered_crm
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m14:55:18.267748 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m14:55:18.268018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:18.268236 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:18.749855 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b51115-3201-1d5a-0008-eb7e00073472
[0m14:55:18.750598 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 44 at position 12 unexpected 'EN'.
syntax error line 44 at position 15 unexpected '('.
syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
syntax error line 44 at position 121 unexpected 'THEN'.
syntax error line 71 at position 8 unexpected ')'.
[0m14:55:18.751319 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m14:55:18.891753 [debug] [Thread-1 (]: Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m14:55:18.893993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217bb210>]}
[0m14:55:18.894728 [error] [Thread-1 (]: 1 of 32 ERROR creating sql table model test_silver_layer.clean_crm_data ........ [[31mERROR[0m in 0.68s]
[0m14:55:18.895414 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m14:55:19.909226 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:55:19.939573 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m14:55:20.069646 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e03933ca-ad48-47ec-bd92-626fa6ea33a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105195f90>]}
[0m14:55:20.071028 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.86s]
[0m14:55:20.072015 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m14:55:20.073388 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m14:55:20.074040 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m14:55:20.074589 [info ] [Thread-4 (]: 3 of 32 SKIP relation test_silver_layer.crm_device_data ........................ [[33mSKIP[0m]
[0m14:55:20.075119 [info ] [Thread-3 (]: 4 of 32 SKIP relation test_silver_layer.enriched_data .......................... [[33mSKIP[0m]
[0m14:55:20.075642 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m14:55:20.076132 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m14:55:20.077637 [debug] [Thread-2 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m14:55:20.078205 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m14:55:20.078759 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:55:20.079298 [info ] [Thread-2 (]: 5 of 32 SKIP relation test_gold_layer.brand_by_age_segment ..................... [[33mSKIP[0m]
[0m14:55:20.079897 [info ] [Thread-1 (]: 6 of 32 SKIP relation test_gold_layer.customers_by_brand_overall ............... [[33mSKIP[0m]
[0m14:55:20.080409 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:55:20.080936 [info ] [Thread-4 (]: 7 of 32 SKIP relation test_gold_layer.customers_by_brand_week_wise ............. [[33mSKIP[0m]
[0m14:55:20.081485 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m14:55:20.081963 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m14:55:20.082453 [info ] [Thread-3 (]: 8 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_overall ......... [[33mSKIP[0m]
[0m14:55:20.082967 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:55:20.083471 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:55:20.083892 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m14:55:20.084334 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:55:20.084731 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m14:55:20.085168 [info ] [Thread-2 (]: 9 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_week_wise ....... [[33mSKIP[0m]
[0m14:55:20.085612 [info ] [Thread-1 (]: 10 of 32 SKIP relation test_gold_layer.customers_by_os_overall ................. [[33mSKIP[0m]
[0m14:55:20.086053 [debug] [Thread-3 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m14:55:20.086496 [info ] [Thread-4 (]: 11 of 32 SKIP relation test_gold_layer.customers_by_os_week_wise ............... [[33mSKIP[0m]
[0m14:55:20.086938 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:55:20.087326 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m14:55:20.087721 [info ] [Thread-3 (]: 12 of 32 SKIP relation test_gold_layer.os_by_age_segment ....................... [[33mSKIP[0m]
[0m14:55:20.088131 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m14:55:20.088529 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m14:55:20.088975 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:55:20.089409 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m14:55:20.089842 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m14:55:20.090278 [info ] [Thread-2 (]: 13 of 32 SKIP relation test_gold_layer.revenue_by_age_overall .................. [[33mSKIP[0m]
[0m14:55:20.090708 [info ] [Thread-1 (]: 14 of 32 SKIP relation test_gold_layer.revenue_by_age_week_wise ................ [[33mSKIP[0m]
[0m14:55:20.091172 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:55:20.091657 [info ] [Thread-4 (]: 15 of 32 SKIP relation test_gold_layer.revenue_by_brand_overall ................ [[33mSKIP[0m]
[0m14:55:20.092076 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m14:55:20.092466 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:55:20.092846 [info ] [Thread-3 (]: 16 of 32 SKIP relation test_gold_layer.revenue_by_brand_week_wise .............. [[33mSKIP[0m]
[0m14:55:20.093259 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m14:55:20.093655 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m14:55:20.094092 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:55:20.094571 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:55:20.094979 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:55:20.095415 [info ] [Thread-2 (]: 17 of 32 SKIP relation test_gold_layer.revenue_by_gender_overall ............... [[33mSKIP[0m]
[0m14:55:20.095798 [info ] [Thread-1 (]: 18 of 32 SKIP relation test_gold_layer.revenue_by_gender_week_wise ............. [[33mSKIP[0m]
[0m14:55:20.096170 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:55:20.096540 [info ] [Thread-4 (]: 19 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_overall .......... [[33mSKIP[0m]
[0m14:55:20.096906 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m14:55:20.097268 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:55:20.097605 [info ] [Thread-3 (]: 20 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_week_wise ........ [[33mSKIP[0m]
[0m14:55:20.097963 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:55:20.098311 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m14:55:20.098674 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:55:20.099051 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:55:20.099399 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:55:20.099781 [info ] [Thread-2 (]: 21 of 32 SKIP relation test_gold_layer.revenue_by_os_overall ................... [[33mSKIP[0m]
[0m14:55:20.100149 [info ] [Thread-1 (]: 22 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_overall ............ [[33mSKIP[0m]
[0m14:55:20.100519 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:55:20.100883 [info ] [Thread-4 (]: 23 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_week_wise .......... [[33mSKIP[0m]
[0m14:55:20.101247 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m14:55:20.101590 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:55:20.101917 [info ] [Thread-3 (]: 24 of 32 SKIP relation test_gold_layer.revenue_by_os_week_wise ................. [[33mSKIP[0m]
[0m14:55:20.102287 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:55:20.102628 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:55:20.102996 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:55:20.103368 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:55:20.103735 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m14:55:20.104096 [info ] [Thread-2 (]: 25 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_overall ........ [[33mSKIP[0m]
[0m14:55:20.104492 [info ] [Thread-1 (]: 26 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_week_wise ...... [[33mSKIP[0m]
[0m14:55:20.104855 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m14:55:20.105228 [info ] [Thread-4 (]: 27 of 32 SKIP relation test_gold_layer.total_customers_overall ................. [[33mSKIP[0m]
[0m14:55:20.105572 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:55:20.105875 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:55:20.106156 [info ] [Thread-3 (]: 28 of 32 SKIP relation test_gold_layer.total_customers_week_wise ............... [[33mSKIP[0m]
[0m14:55:20.106465 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m14:55:20.106757 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_overall
[0m14:55:20.107068 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m14:55:20.107385 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m14:55:20.107690 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:55:20.107993 [info ] [Thread-2 (]: 29 of 32 SKIP relation test_gold_layer.total_devices_overall ................... [[33mSKIP[0m]
[0m14:55:20.108327 [info ] [Thread-1 (]: 30 of 32 SKIP relation test_gold_layer.total_devices_week_wise ................. [[33mSKIP[0m]
[0m14:55:20.108664 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m14:55:20.108970 [info ] [Thread-4 (]: 31 of 32 SKIP relation test_gold_layer.weekly_revenue_by_brand ................. [[33mSKIP[0m]
[0m14:55:20.109291 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m14:55:20.109571 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m14:55:20.109850 [info ] [Thread-3 (]: 32 of 32 SKIP relation test_gold_layer.weekly_revenue_by_os .................... [[33mSKIP[0m]
[0m14:55:20.110148 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:55:20.110547 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m14:55:20.111581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:20.111825 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m14:55:20.112033 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m14:55:20.112233 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_test_gold_layer' was properly closed.
[0m14:55:20.112582 [info ] [MainThread]: 
[0m14:55:20.112835 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m14:55:20.113932 [debug] [MainThread]: Command end result
[0m14:55:20.138662 [info ] [MainThread]: 
[0m14:55:20.138920 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:55:20.139090 [info ] [MainThread]: 
[0m14:55:20.139315 [error] [MainThread]:   Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m14:55:20.139511 [info ] [MainThread]: 
[0m14:55:20.139686 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=30 TOTAL=32
[0m14:55:20.141270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.4448805, "process_user_time": 2.869586, "process_kernel_time": 1.933479, "process_mem_max_rss": "204062720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:55:20.141556 [debug] [MainThread]: Command `dbt run` failed at 14:55:20.141511 after 5.45 seconds
[0m14:55:20.141772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10355c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069797d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c2dd0>]}
[0m14:55:20.141968 [debug] [MainThread]: Flushing usage events
[0m14:56:38.609907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108063250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082eb910>]}


============================== 14:56:38.612114 | 765455ed-e7c0-4cce-b651-834934d50727 ==============================
[0m14:56:38.612114 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:56:38.612420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:56:39.199392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '765455ed-e7c0-4cce-b651-834934d50727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13df46cd0>]}
[0m14:56:39.220535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '765455ed-e7c0-4cce-b651-834934d50727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3b290>]}
[0m14:56:39.221267 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:56:39.234897 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m14:56:39.325060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:39.325309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:39.348152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '765455ed-e7c0-4cce-b651-834934d50727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ec45d50>]}
[0m14:56:39.440669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '765455ed-e7c0-4cce-b651-834934d50727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081babd0>]}
[0m14:56:39.440971 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m14:56:39.441147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765455ed-e7c0-4cce-b651-834934d50727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13df6b950>]}
[0m14:56:39.442323 [info ] [MainThread]: 
[0m14:56:39.442599 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:56:39.445140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:56:39.445398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:56:39.451829 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:56:39.452860 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:56:39.453042 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:56:39.453209 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:56:39.453368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:39.453514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:40.063432 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:56:40.064371 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:56:40.067319 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:56:40.069148 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:56:40.214730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_gold_layer)
[0m14:56:40.218074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m14:56:40.218893 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_test_silver_layer'
[0m14:56:40.227353 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m14:56:40.229682 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:56:40.231959 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m14:56:40.232385 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m14:56:40.232778 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:56:40.233132 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m14:56:40.233478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:40.233778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:40.234054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:40.704780 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:56:40.708361 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:56:40.781443 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:56:40.785931 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m14:56:40.798440 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:56:40.800895 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m14:56:40.934246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765455ed-e7c0-4cce-b651-834934d50727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ac210>]}
[0m14:56:40.936091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:56:40.936845 [info ] [MainThread]: 
[0m14:56:40.940975 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m14:56:40.941615 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m14:56:40.942519 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m14:56:40.943349 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m14:56:40.944398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_gold_layer, now model.my_dbt_project.clean_crm_data)
[0m14:56:40.945561 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m14:56:40.946196 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_device_data)
[0m14:56:40.959159 [info ] [Thread-1 (]: import_crm: 
[0m14:56:40.959658 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m14:56:40.960050 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m14:56:40.964480 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m14:56:40.965189 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m14:56:40.965757 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m14:56:40.978817 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m14:56:40.989482 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m14:56:40.991424 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m14:56:40.994025 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m14:56:40.995109 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m14:56:40.995541 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

windowed_crm AS (
    SELECT
        *,
        LEAD(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_status,
        LEAD(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_yob,
        LEAD(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_gender,
        LAG(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_status,
        LAG(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_yob,
        LAG(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_gender
    FROM cleaned_crm
),

flagged_crm AS (
    SELECT
        *,
        CASE
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'SUSPEND' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'SUSPEND' AND prev_status = 'ACTIVE' AND YEAR_OF_BIRTH = prev_yob AND GENDER = prev_gender) THEN 1
            EN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'IDLE' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            ELSE 0
        END AS pair_flag
    FROM windowed_crm
),

filtered_crm AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE SYSTEM_STATUS 
                WHEN 'ACTIVE' THEN 1 
                WHEN 'IDLE' THEN 2 
                WHEN 'SUSPEND' THEN 3 
                WHEN 'DEACTIVATE' THEN 4 
                ELSE 5 
            END,
            (CASE WHEN GENDER IS NOT NULL THEN 1 ELSE 0 END + 
            CASE WHEN YEAR_OF_BIRTH IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN SYSTEM_STATUS IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN MOBILE_TYPE IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN VALUE_SEGMENT IS NOT NULL THEN 1 ELSE 0 END) DESC
        ) AS rank
    FROM flagged_crm
    WHERE pair_flag = 0
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM filtered_crm
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m14:56:40.996001 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m14:56:40.996284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:40.996523 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:41.420695 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b51116-3201-1cd0-0008-eb7e0007505a
[0m14:56:41.421672 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 44 at position 12 unexpected 'EN'.
syntax error line 44 at position 15 unexpected '('.
syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
syntax error line 44 at position 121 unexpected 'THEN'.
syntax error line 71 at position 8 unexpected ')'.
[0m14:56:41.422556 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m14:56:41.570039 [debug] [Thread-1 (]: Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m14:56:41.574346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765455ed-e7c0-4cce-b651-834934d50727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ec46550>]}
[0m14:56:41.577280 [error] [Thread-1 (]: 1 of 32 ERROR creating sql table model test_silver_layer.clean_crm_data ........ [[31mERROR[0m in 0.63s]
[0m14:56:41.581866 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m14:56:42.510923 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:56:42.549359 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m14:56:42.690965 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765455ed-e7c0-4cce-b651-834934d50727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f1ace50>]}
[0m14:56:42.693394 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.75s]
[0m14:56:42.694637 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m14:56:42.696441 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m14:56:42.697341 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m14:56:42.698400 [info ] [Thread-4 (]: 3 of 32 SKIP relation test_silver_layer.crm_device_data ........................ [[33mSKIP[0m]
[0m14:56:42.699379 [info ] [Thread-3 (]: 4 of 32 SKIP relation test_silver_layer.enriched_data .......................... [[33mSKIP[0m]
[0m14:56:42.700288 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m14:56:42.700956 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m14:56:42.703107 [debug] [Thread-2 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m14:56:42.703806 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m14:56:42.704430 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:56:42.705011 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:56:42.705547 [info ] [Thread-2 (]: 5 of 32 SKIP relation test_gold_layer.brand_by_age_segment ..................... [[33mSKIP[0m]
[0m14:56:42.706095 [info ] [Thread-1 (]: 6 of 32 SKIP relation test_gold_layer.customers_by_brand_overall ............... [[33mSKIP[0m]
[0m14:56:42.706608 [info ] [Thread-4 (]: 7 of 32 SKIP relation test_gold_layer.customers_by_brand_week_wise ............. [[33mSKIP[0m]
[0m14:56:42.707143 [info ] [Thread-3 (]: 8 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_overall ......... [[33mSKIP[0m]
[0m14:56:42.707679 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m14:56:42.708164 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m14:56:42.709153 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:56:42.709867 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:56:42.710586 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:56:42.711410 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m14:56:42.712233 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m14:56:42.712858 [debug] [Thread-3 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m14:56:42.713502 [info ] [Thread-2 (]: 9 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_week_wise ....... [[33mSKIP[0m]
[0m14:56:42.714090 [info ] [Thread-1 (]: 10 of 32 SKIP relation test_gold_layer.customers_by_os_overall ................. [[33mSKIP[0m]
[0m14:56:42.714607 [info ] [Thread-4 (]: 11 of 32 SKIP relation test_gold_layer.customers_by_os_week_wise ............... [[33mSKIP[0m]
[0m14:56:42.715108 [info ] [Thread-3 (]: 12 of 32 SKIP relation test_gold_layer.os_by_age_segment ....................... [[33mSKIP[0m]
[0m14:56:42.715629 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:56:42.716108 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m14:56:42.716579 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m14:56:42.717036 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m14:56:42.717522 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m14:56:42.718075 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:56:42.718632 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m14:56:42.719175 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:56:42.719721 [info ] [Thread-2 (]: 13 of 32 SKIP relation test_gold_layer.revenue_by_age_overall .................. [[33mSKIP[0m]
[0m14:56:42.720223 [info ] [Thread-1 (]: 14 of 32 SKIP relation test_gold_layer.revenue_by_age_week_wise ................ [[33mSKIP[0m]
[0m14:56:42.720634 [info ] [Thread-4 (]: 15 of 32 SKIP relation test_gold_layer.revenue_by_brand_overall ................ [[33mSKIP[0m]
[0m14:56:42.721036 [info ] [Thread-3 (]: 16 of 32 SKIP relation test_gold_layer.revenue_by_brand_week_wise .............. [[33mSKIP[0m]
[0m14:56:42.721445 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m14:56:42.721826 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:56:42.722202 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m14:56:42.722579 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:56:42.722979 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m14:56:42.723437 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:56:42.723904 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:56:42.724350 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:56:42.724793 [info ] [Thread-2 (]: 17 of 32 SKIP relation test_gold_layer.revenue_by_gender_overall ............... [[33mSKIP[0m]
[0m14:56:42.725239 [info ] [Thread-1 (]: 18 of 32 SKIP relation test_gold_layer.revenue_by_gender_week_wise ............. [[33mSKIP[0m]
[0m14:56:42.725681 [info ] [Thread-4 (]: 19 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_overall .......... [[33mSKIP[0m]
[0m14:56:42.726091 [info ] [Thread-3 (]: 20 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_week_wise ........ [[33mSKIP[0m]
[0m14:56:42.726506 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m14:56:42.726887 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:56:42.727249 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:56:42.727652 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:56:42.728073 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m14:56:42.728444 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:56:42.728843 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:56:42.729242 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:56:42.729624 [info ] [Thread-2 (]: 21 of 32 SKIP relation test_gold_layer.revenue_by_os_overall ................... [[33mSKIP[0m]
[0m14:56:42.729987 [info ] [Thread-1 (]: 22 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_overall ............ [[33mSKIP[0m]
[0m14:56:42.730337 [info ] [Thread-4 (]: 23 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_week_wise .......... [[33mSKIP[0m]
[0m14:56:42.730681 [info ] [Thread-3 (]: 24 of 32 SKIP relation test_gold_layer.revenue_by_os_week_wise ................. [[33mSKIP[0m]
[0m14:56:42.731026 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m14:56:42.731346 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:56:42.731663 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:56:42.731982 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:56:42.732311 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:56:42.732673 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:56:42.733055 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m14:56:42.733430 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m14:56:42.733820 [info ] [Thread-2 (]: 25 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_overall ........ [[33mSKIP[0m]
[0m14:56:42.734182 [info ] [Thread-1 (]: 26 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_week_wise ...... [[33mSKIP[0m]
[0m14:56:42.734525 [info ] [Thread-4 (]: 27 of 32 SKIP relation test_gold_layer.total_customers_overall ................. [[33mSKIP[0m]
[0m14:56:42.734863 [info ] [Thread-3 (]: 28 of 32 SKIP relation test_gold_layer.total_customers_week_wise ............... [[33mSKIP[0m]
[0m14:56:42.735207 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:56:42.735535 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:56:42.735883 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m14:56:42.736195 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m14:56:42.736522 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_overall
[0m14:56:42.736883 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m14:56:42.737315 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:56:42.737692 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m14:56:42.738070 [info ] [Thread-2 (]: 29 of 32 SKIP relation test_gold_layer.total_devices_overall ................... [[33mSKIP[0m]
[0m14:56:42.738444 [info ] [Thread-1 (]: 30 of 32 SKIP relation test_gold_layer.total_devices_week_wise ................. [[33mSKIP[0m]
[0m14:56:42.738798 [info ] [Thread-4 (]: 31 of 32 SKIP relation test_gold_layer.weekly_revenue_by_brand ................. [[33mSKIP[0m]
[0m14:56:42.739147 [info ] [Thread-3 (]: 32 of 32 SKIP relation test_gold_layer.weekly_revenue_by_os .................... [[33mSKIP[0m]
[0m14:56:42.739496 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m14:56:42.739836 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m14:56:42.740148 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:56:42.740438 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m14:56:42.741731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:42.741983 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m14:56:42.742196 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m14:56:42.742399 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_test_silver_layer' was properly closed.
[0m14:56:42.742738 [info ] [MainThread]: 
[0m14:56:42.743010 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m14:56:42.744199 [debug] [MainThread]: Command end result
[0m14:56:42.767880 [info ] [MainThread]: 
[0m14:56:42.768135 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:56:42.768299 [info ] [MainThread]: 
[0m14:56:42.768506 [error] [MainThread]:   Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m14:56:42.768693 [info ] [MainThread]: 
[0m14:56:42.768858 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=30 TOTAL=32
[0m14:56:42.770418 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.187821, "process_user_time": 2.115891, "process_kernel_time": 1.798755, "process_mem_max_rss": "193757184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:56:42.770725 [debug] [MainThread]: Command `dbt run` failed at 14:56:42.770680 after 4.19 seconds
[0m14:56:42.770946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a78750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108302ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3b3d0>]}
[0m14:56:42.771144 [debug] [MainThread]: Flushing usage events
[0m14:57:18.994571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c42750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c49650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb8f10>]}


============================== 14:57:18.997200 | a850aab4-ff96-4354-9a5b-5a970ee437ea ==============================
[0m14:57:18.997200 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:57:18.997507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:57:19.633689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a850aab4-ff96-4354-9a5b-5a970ee437ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cc42250>]}
[0m14:57:19.654987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a850aab4-ff96-4354-9a5b-5a970ee437ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f3290>]}
[0m14:57:19.655604 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:57:19.669099 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m14:57:19.758622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:57:19.758863 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:57:19.781770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a850aab4-ff96-4354-9a5b-5a970ee437ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c624d0>]}
[0m14:57:19.879401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a850aab4-ff96-4354-9a5b-5a970ee437ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c88b90>]}
[0m14:57:19.879704 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m14:57:19.879880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a850aab4-ff96-4354-9a5b-5a970ee437ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a57bd10>]}
[0m14:57:19.881066 [info ] [MainThread]: 
[0m14:57:19.881347 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:57:19.883883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:57:19.884156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:57:19.890638 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:57:19.891635 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:57:19.891816 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:57:19.891980 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:57:19.892125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:19.892257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:20.489242 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:57:20.495025 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:57:20.500194 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:57:20.503958 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:57:20.649423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m14:57:20.650580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_silver_layer)
[0m14:57:20.651409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_test_gold_layer'
[0m14:57:20.670052 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m14:57:20.676216 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:57:20.678615 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m14:57:20.679191 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m14:57:20.679573 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:57:20.682445 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m14:57:20.682896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:20.683234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:20.683537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:21.212990 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:57:21.219784 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m14:57:21.238985 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:57:21.242252 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:57:21.246008 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:57:21.248658 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m14:57:21.389803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a850aab4-ff96-4354-9a5b-5a970ee437ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b80d0>]}
[0m14:57:21.390878 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:57:21.391327 [info ] [MainThread]: 
[0m14:57:21.395850 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m14:57:21.396484 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m14:57:21.397244 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m14:57:21.397944 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m14:57:21.398603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m14:57:21.399153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_silver_layer, now model.my_dbt_project.clean_device_data)
[0m14:57:21.399625 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m14:57:21.400082 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m14:57:21.420870 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m14:57:21.421387 [info ] [Thread-1 (]: import_crm: 
[0m14:57:21.421881 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m14:57:21.422231 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m14:57:21.423017 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m14:57:21.423335 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m14:57:21.443666 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m14:57:21.445208 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m14:57:21.447517 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m14:57:21.448471 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m14:57:21.448839 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

windowed_crm AS (
    SELECT
        *,
        LEAD(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_status,
        LEAD(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_yob,
        LEAD(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_gender,
        LAG(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_status,
        LAG(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_yob,
        LAG(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_gender
    FROM cleaned_crm
),

flagged_crm AS (
    SELECT
        *,
        CASE
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'SUSPEND' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'SUSPEND' AND prev_status = 'ACTIVE' AND YEAR_OF_BIRTH = prev_yob AND GENDER = prev_gender) THEN 1
            EN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'IDLE' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            ELSE 0
        END AS pair_flag
    FROM windowed_crm
),

filtered_crm AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE SYSTEM_STATUS 
                WHEN 'ACTIVE' THEN 1 
                WHEN 'IDLE' THEN 2 
                WHEN 'SUSPEND' THEN 3 
                WHEN 'DEACTIVATE' THEN 4 
                ELSE 5 
            END,
            (CASE WHEN GENDER IS NOT NULL THEN 1 ELSE 0 END + 
            CASE WHEN YEAR_OF_BIRTH IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN SYSTEM_STATUS IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN MOBILE_TYPE IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN VALUE_SEGMENT IS NOT NULL THEN 1 ELSE 0 END) DESC
        ) AS rank
    FROM flagged_crm
    WHERE pair_flag = 0
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM filtered_crm
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m14:57:21.449254 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m14:57:21.449518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:21.449724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:21.966125 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b51117-3201-1d5a-0008-eb7e00073486
[0m14:57:21.967477 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 44 at position 12 unexpected 'EN'.
syntax error line 44 at position 15 unexpected '('.
syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
syntax error line 44 at position 121 unexpected 'THEN'.
syntax error line 71 at position 8 unexpected ')'.
[0m14:57:21.968447 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m14:57:22.123301 [debug] [Thread-1 (]: Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m14:57:22.127166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a850aab4-ff96-4354-9a5b-5a970ee437ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ce0e690>]}
[0m14:57:22.128852 [error] [Thread-1 (]: 1 of 32 ERROR creating sql table model test_silver_layer.clean_crm_data ........ [[31mERROR[0m in 0.73s]
[0m14:57:22.129824 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m14:57:22.647722 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:22.688859 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m14:57:22.830135 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a850aab4-ff96-4354-9a5b-5a970ee437ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f280550>]}
[0m14:57:22.831355 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.43s]
[0m14:57:22.832324 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m14:57:22.833465 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m14:57:22.834066 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m14:57:22.834550 [info ] [Thread-4 (]: 3 of 32 SKIP relation test_silver_layer.crm_device_data ........................ [[33mSKIP[0m]
[0m14:57:22.835089 [info ] [Thread-3 (]: 4 of 32 SKIP relation test_silver_layer.enriched_data .......................... [[33mSKIP[0m]
[0m14:57:22.835607 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m14:57:22.836092 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m14:57:22.837544 [debug] [Thread-2 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m14:57:22.838080 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m14:57:22.838626 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:57:22.839076 [info ] [Thread-2 (]: 5 of 32 SKIP relation test_gold_layer.brand_by_age_segment ..................... [[33mSKIP[0m]
[0m14:57:22.839641 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:57:22.840241 [info ] [Thread-1 (]: 6 of 32 SKIP relation test_gold_layer.customers_by_brand_overall ............... [[33mSKIP[0m]
[0m14:57:22.840754 [info ] [Thread-4 (]: 7 of 32 SKIP relation test_gold_layer.customers_by_brand_week_wise ............. [[33mSKIP[0m]
[0m14:57:22.841193 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m14:57:22.841583 [info ] [Thread-3 (]: 8 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_overall ......... [[33mSKIP[0m]
[0m14:57:22.841990 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m14:57:22.842374 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:57:22.842769 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:57:22.843244 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:57:22.843718 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m14:57:22.844173 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m14:57:22.844635 [info ] [Thread-2 (]: 9 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_week_wise ....... [[33mSKIP[0m]
[0m14:57:22.845116 [debug] [Thread-3 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m14:57:22.845584 [info ] [Thread-1 (]: 10 of 32 SKIP relation test_gold_layer.customers_by_os_overall ................. [[33mSKIP[0m]
[0m14:57:22.846014 [info ] [Thread-4 (]: 11 of 32 SKIP relation test_gold_layer.customers_by_os_week_wise ............... [[33mSKIP[0m]
[0m14:57:22.846442 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:57:22.846819 [info ] [Thread-3 (]: 12 of 32 SKIP relation test_gold_layer.os_by_age_segment ....................... [[33mSKIP[0m]
[0m14:57:22.847228 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m14:57:22.847606 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m14:57:22.847991 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m14:57:22.848413 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m14:57:22.848833 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:57:22.849278 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m14:57:22.849711 [info ] [Thread-2 (]: 13 of 32 SKIP relation test_gold_layer.revenue_by_age_overall .................. [[33mSKIP[0m]
[0m14:57:22.850165 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:57:22.850608 [info ] [Thread-1 (]: 14 of 32 SKIP relation test_gold_layer.revenue_by_age_week_wise ................ [[33mSKIP[0m]
[0m14:57:22.851049 [info ] [Thread-4 (]: 15 of 32 SKIP relation test_gold_layer.revenue_by_brand_overall ................ [[33mSKIP[0m]
[0m14:57:22.851457 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m14:57:22.851831 [info ] [Thread-3 (]: 16 of 32 SKIP relation test_gold_layer.revenue_by_brand_week_wise .............. [[33mSKIP[0m]
[0m14:57:22.852226 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:57:22.852604 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m14:57:22.852946 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m14:57:22.853306 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:57:22.853658 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:57:22.854049 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:57:22.854417 [info ] [Thread-2 (]: 17 of 32 SKIP relation test_gold_layer.revenue_by_gender_overall ............... [[33mSKIP[0m]
[0m14:57:22.854799 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:57:22.855156 [info ] [Thread-1 (]: 18 of 32 SKIP relation test_gold_layer.revenue_by_gender_week_wise ............. [[33mSKIP[0m]
[0m14:57:22.855519 [info ] [Thread-4 (]: 19 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_overall .......... [[33mSKIP[0m]
[0m14:57:22.855874 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m14:57:22.856200 [info ] [Thread-3 (]: 20 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_week_wise ........ [[33mSKIP[0m]
[0m14:57:22.856542 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:57:22.856866 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:57:22.857200 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m14:57:22.857565 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:57:22.857922 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:57:22.858298 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:57:22.858668 [info ] [Thread-2 (]: 21 of 32 SKIP relation test_gold_layer.revenue_by_os_overall ................... [[33mSKIP[0m]
[0m14:57:22.859043 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:57:22.859407 [info ] [Thread-1 (]: 22 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_overall ............ [[33mSKIP[0m]
[0m14:57:22.859770 [info ] [Thread-4 (]: 23 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_week_wise .......... [[33mSKIP[0m]
[0m14:57:22.860118 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m14:57:22.860438 [info ] [Thread-3 (]: 24 of 32 SKIP relation test_gold_layer.revenue_by_os_week_wise ................. [[33mSKIP[0m]
[0m14:57:22.860753 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:57:22.861027 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:57:22.861317 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:57:22.861603 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:57:22.861905 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:57:22.862230 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m14:57:22.862556 [info ] [Thread-2 (]: 25 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_overall ........ [[33mSKIP[0m]
[0m14:57:22.862877 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m14:57:22.863193 [info ] [Thread-1 (]: 26 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_week_wise ...... [[33mSKIP[0m]
[0m14:57:22.863516 [info ] [Thread-4 (]: 27 of 32 SKIP relation test_gold_layer.total_customers_overall ................. [[33mSKIP[0m]
[0m14:57:22.863833 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:57:22.864135 [info ] [Thread-3 (]: 28 of 32 SKIP relation test_gold_layer.total_customers_week_wise ............... [[33mSKIP[0m]
[0m14:57:22.864460 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:57:22.864747 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m14:57:22.865032 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_overall
[0m14:57:22.865351 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m14:57:22.865656 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m14:57:22.865975 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:57:22.866293 [info ] [Thread-2 (]: 29 of 32 SKIP relation test_gold_layer.total_devices_overall ................... [[33mSKIP[0m]
[0m14:57:22.866617 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m14:57:22.866926 [info ] [Thread-1 (]: 30 of 32 SKIP relation test_gold_layer.total_devices_week_wise ................. [[33mSKIP[0m]
[0m14:57:22.867233 [info ] [Thread-4 (]: 31 of 32 SKIP relation test_gold_layer.weekly_revenue_by_brand ................. [[33mSKIP[0m]
[0m14:57:22.867540 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m14:57:22.867817 [info ] [Thread-3 (]: 32 of 32 SKIP relation test_gold_layer.weekly_revenue_by_os .................... [[33mSKIP[0m]
[0m14:57:22.868115 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m14:57:22.868383 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:57:22.868696 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m14:57:22.869700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:22.869919 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m14:57:22.870111 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m14:57:22.870289 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_test_gold_layer' was properly closed.
[0m14:57:22.870611 [info ] [MainThread]: 
[0m14:57:22.870845 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m14:57:22.871807 [debug] [MainThread]: Command end result
[0m14:57:22.893745 [info ] [MainThread]: 
[0m14:57:22.894012 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:57:22.894166 [info ] [MainThread]: 
[0m14:57:22.894364 [error] [MainThread]:   Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m14:57:22.894536 [info ] [MainThread]: 
[0m14:57:22.894690 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=30 TOTAL=32
[0m14:57:22.896150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9289072, "process_user_time": 2.223993, "process_kernel_time": 1.685154, "process_mem_max_rss": "196018176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:57:22.896420 [debug] [MainThread]: Command `dbt run` failed at 14:57:22.896380 after 3.93 seconds
[0m14:57:22.896624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058786d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c48bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c48ad0>]}
[0m14:57:22.896806 [debug] [MainThread]: Flushing usage events
[0m14:58:28.107001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c4ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cc4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cc52d0>]}


============================== 14:58:28.109587 | 14a750d4-abec-4f23-9c36-562fc317cf80 ==============================
[0m14:58:28.109587 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:58:28.109890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'send_anonymous_usage_stats': 'True'}
[0m14:58:28.759028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14a750d4-abec-4f23-9c36-562fc317cf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ff0a790>]}
[0m14:58:28.780577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14a750d4-abec-4f23-9c36-562fc317cf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d3b350>]}
[0m14:58:28.781759 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:58:28.795505 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m14:58:28.887483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:28.887839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:28.914727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14a750d4-abec-4f23-9c36-562fc317cf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168af9210>]}
[0m14:58:29.012446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14a750d4-abec-4f23-9c36-562fc317cf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a33850>]}
[0m14:58:29.012758 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m14:58:29.012939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14a750d4-abec-4f23-9c36-562fc317cf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1688c7c90>]}
[0m14:58:29.014120 [info ] [MainThread]: 
[0m14:58:29.014391 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:58:29.016959 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:58:29.017252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m14:58:29.023770 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:58:29.024802 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m14:58:29.024971 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:58:29.025130 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m14:58:29.025289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:29.025421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:29.624394 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:58:29.628694 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:58:29.631420 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:58:29.636762 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m14:58:29.783072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m14:58:29.783951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_gold_layer)
[0m14:58:29.784725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_test_silver_layer'
[0m14:58:29.800989 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m14:58:29.804138 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m14:58:29.806880 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m14:58:29.807368 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m14:58:29.807825 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m14:58:29.808264 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m14:58:29.808648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:29.808996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:29.809335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:30.367070 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:58:30.369585 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m14:58:30.392559 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:58:30.395711 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m14:58:30.400194 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m14:58:30.407151 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m14:58:30.554090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14a750d4-abec-4f23-9c36-562fc317cf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c4ec10>]}
[0m14:58:30.555724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:30.556405 [info ] [MainThread]: 
[0m14:58:30.561051 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m14:58:30.561706 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m14:58:30.563040 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m14:58:30.564044 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m14:58:30.564902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m14:58:30.566298 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m14:58:30.573467 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_gold_layer, now model.my_dbt_project.clean_device_data)
[0m14:58:30.583082 [info ] [Thread-1 (]: import_crm: 
[0m14:58:30.583597 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m14:58:30.584058 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m14:58:30.588470 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m14:58:30.589134 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m14:58:30.589800 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m14:58:30.590149 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m14:58:30.611596 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m14:58:30.613248 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m14:58:30.615556 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m14:58:30.615934 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

windowed_crm AS (
    SELECT
        *,
        LEAD(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_status,
        LEAD(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_yob,
        LEAD(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_gender,
        LAG(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_status,
        LAG(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_yob,
        LAG(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_gender
    FROM cleaned_crm
),

flagged_crm AS (
    SELECT
        *,
        CASE
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'SUSPEND' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'SUSPEND' AND prev_status = 'ACTIVE' AND YEAR_OF_BIRTH = prev_yob AND GENDER = prev_gender) THEN 1
            EN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'IDLE' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            ELSE 0
        END AS pair_flag
    FROM windowed_crm
),

filtered_crm AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE SYSTEM_STATUS 
                WHEN 'ACTIVE' THEN 1 
                WHEN 'IDLE' THEN 2 
                WHEN 'SUSPEND' THEN 3 
                WHEN 'DEACTIVATE' THEN 4 
                ELSE 5 
            END,
            (CASE WHEN GENDER IS NOT NULL THEN 1 ELSE 0 END + 
            CASE WHEN YEAR_OF_BIRTH IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN SYSTEM_STATUS IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN MOBILE_TYPE IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN VALUE_SEGMENT IS NOT NULL THEN 1 ELSE 0 END) DESC
        ) AS rank
    FROM flagged_crm
    WHERE pair_flag = 0
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM filtered_crm
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m14:58:30.617021 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m14:58:30.617240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:30.617521 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m14:58:30.618015 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:58:31.053903 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b51118-3201-1cd0-0008-eb7e0007506a
[0m14:58:31.055225 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 44 at position 12 unexpected 'EN'.
syntax error line 44 at position 15 unexpected '('.
syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
syntax error line 44 at position 121 unexpected 'THEN'.
syntax error line 71 at position 8 unexpected ')'.
[0m14:58:31.056072 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m14:58:31.196955 [debug] [Thread-1 (]: Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m14:58:31.200512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14a750d4-abec-4f23-9c36-562fc317cf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168fc9ed0>]}
[0m14:58:31.202352 [error] [Thread-1 (]: 1 of 32 ERROR creating sql table model test_silver_layer.clean_crm_data ........ [[31mERROR[0m in 0.63s]
[0m14:58:31.204053 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m14:58:31.670067 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:58:31.710789 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m14:58:31.852505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14a750d4-abec-4f23-9c36-562fc317cf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110506050>]}
[0m14:58:31.855272 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.29s]
[0m14:58:31.857026 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m14:58:31.859126 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m14:58:31.859948 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m14:58:31.861283 [info ] [Thread-4 (]: 3 of 32 SKIP relation test_silver_layer.crm_device_data ........................ [[33mSKIP[0m]
[0m14:58:31.862349 [info ] [Thread-3 (]: 4 of 32 SKIP relation test_silver_layer.enriched_data .......................... [[33mSKIP[0m]
[0m14:58:31.863242 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m14:58:31.864080 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m14:58:31.866513 [debug] [Thread-2 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m14:58:31.867159 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m14:58:31.867834 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:58:31.868533 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:58:31.869129 [info ] [Thread-2 (]: 5 of 32 SKIP relation test_gold_layer.brand_by_age_segment ..................... [[33mSKIP[0m]
[0m14:58:31.870134 [info ] [Thread-1 (]: 6 of 32 SKIP relation test_gold_layer.customers_by_brand_overall ............... [[33mSKIP[0m]
[0m14:58:31.870857 [info ] [Thread-4 (]: 7 of 32 SKIP relation test_gold_layer.customers_by_brand_week_wise ............. [[33mSKIP[0m]
[0m14:58:31.871413 [info ] [Thread-3 (]: 8 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_overall ......... [[33mSKIP[0m]
[0m14:58:31.871996 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m14:58:31.872504 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m14:58:31.873217 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m14:58:31.874110 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m14:58:31.874872 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:58:31.875766 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m14:58:31.876607 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m14:58:31.877249 [debug] [Thread-3 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m14:58:31.877889 [info ] [Thread-2 (]: 9 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_week_wise ....... [[33mSKIP[0m]
[0m14:58:31.878446 [info ] [Thread-1 (]: 10 of 32 SKIP relation test_gold_layer.customers_by_os_overall ................. [[33mSKIP[0m]
[0m14:58:31.878961 [info ] [Thread-4 (]: 11 of 32 SKIP relation test_gold_layer.customers_by_os_week_wise ............... [[33mSKIP[0m]
[0m14:58:31.879467 [info ] [Thread-3 (]: 12 of 32 SKIP relation test_gold_layer.os_by_age_segment ....................... [[33mSKIP[0m]
[0m14:58:31.879987 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m14:58:31.880447 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m14:58:31.880907 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m14:58:31.881384 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m14:58:31.881879 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m14:58:31.882403 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:58:31.882942 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m14:58:31.883499 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:58:31.884067 [info ] [Thread-2 (]: 13 of 32 SKIP relation test_gold_layer.revenue_by_age_overall .................. [[33mSKIP[0m]
[0m14:58:31.884594 [info ] [Thread-1 (]: 14 of 32 SKIP relation test_gold_layer.revenue_by_age_week_wise ................ [[33mSKIP[0m]
[0m14:58:31.885015 [info ] [Thread-4 (]: 15 of 32 SKIP relation test_gold_layer.revenue_by_brand_overall ................ [[33mSKIP[0m]
[0m14:58:31.885414 [info ] [Thread-3 (]: 16 of 32 SKIP relation test_gold_layer.revenue_by_brand_week_wise .............. [[33mSKIP[0m]
[0m14:58:31.885832 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m14:58:31.886246 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m14:58:31.886660 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m14:58:31.887097 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m14:58:31.887503 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m14:58:31.887935 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:58:31.888401 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:58:31.888841 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:58:31.889274 [info ] [Thread-2 (]: 17 of 32 SKIP relation test_gold_layer.revenue_by_gender_overall ............... [[33mSKIP[0m]
[0m14:58:31.889684 [info ] [Thread-1 (]: 18 of 32 SKIP relation test_gold_layer.revenue_by_gender_week_wise ............. [[33mSKIP[0m]
[0m14:58:31.890103 [info ] [Thread-4 (]: 19 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_overall .......... [[33mSKIP[0m]
[0m14:58:31.890507 [info ] [Thread-3 (]: 20 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_week_wise ........ [[33mSKIP[0m]
[0m14:58:31.890923 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m14:58:31.891330 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m14:58:31.891704 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m14:58:31.892071 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m14:58:31.892463 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m14:58:31.892887 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:58:31.893342 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:58:31.893779 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:58:31.894225 [info ] [Thread-2 (]: 21 of 32 SKIP relation test_gold_layer.revenue_by_os_overall ................... [[33mSKIP[0m]
[0m14:58:31.894668 [info ] [Thread-1 (]: 22 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_overall ............ [[33mSKIP[0m]
[0m14:58:31.895092 [info ] [Thread-4 (]: 23 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_week_wise .......... [[33mSKIP[0m]
[0m14:58:31.895525 [info ] [Thread-3 (]: 24 of 32 SKIP relation test_gold_layer.revenue_by_os_week_wise ................. [[33mSKIP[0m]
[0m14:58:31.895941 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m14:58:31.896325 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m14:58:31.896661 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m14:58:31.896982 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m14:58:31.897342 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:58:31.897713 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:58:31.898082 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m14:58:31.898445 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m14:58:31.898815 [info ] [Thread-2 (]: 25 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_overall ........ [[33mSKIP[0m]
[0m14:58:31.899197 [info ] [Thread-1 (]: 26 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_week_wise ...... [[33mSKIP[0m]
[0m14:58:31.899551 [info ] [Thread-4 (]: 27 of 32 SKIP relation test_gold_layer.total_customers_overall ................. [[33mSKIP[0m]
[0m14:58:31.899896 [info ] [Thread-3 (]: 28 of 32 SKIP relation test_gold_layer.total_customers_week_wise ............... [[33mSKIP[0m]
[0m14:58:31.900238 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m14:58:31.900568 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m14:58:31.900889 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m14:58:31.901226 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m14:58:31.901554 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_overall
[0m14:58:31.901900 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m14:58:31.902260 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:58:31.902617 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m14:58:31.902967 [info ] [Thread-2 (]: 29 of 32 SKIP relation test_gold_layer.total_devices_overall ................... [[33mSKIP[0m]
[0m14:58:31.903316 [info ] [Thread-1 (]: 30 of 32 SKIP relation test_gold_layer.total_devices_week_wise ................. [[33mSKIP[0m]
[0m14:58:31.903657 [info ] [Thread-4 (]: 31 of 32 SKIP relation test_gold_layer.weekly_revenue_by_brand ................. [[33mSKIP[0m]
[0m14:58:31.904015 [info ] [Thread-3 (]: 32 of 32 SKIP relation test_gold_layer.weekly_revenue_by_os .................... [[33mSKIP[0m]
[0m14:58:31.904354 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m14:58:31.904663 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m14:58:31.904939 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m14:58:31.905217 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m14:58:31.906518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:31.906777 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m14:58:31.906995 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m14:58:31.907220 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_test_silver_layer' was properly closed.
[0m14:58:31.907560 [info ] [MainThread]: 
[0m14:58:31.907822 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m14:58:31.909026 [debug] [MainThread]: Command end result
[0m14:58:31.932905 [info ] [MainThread]: 
[0m14:58:31.933176 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:58:31.933340 [info ] [MainThread]: 
[0m14:58:31.933550 [error] [MainThread]:   Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m14:58:31.933735 [info ] [MainThread]: 
[0m14:58:31.933899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=30 TOTAL=32
[0m14:58:31.935438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8559084, "process_user_time": 2.324688, "process_kernel_time": 1.546942, "process_mem_max_rss": "195182592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:58:31.935734 [debug] [MainThread]: Command `dbt run` failed at 14:58:31.935692 after 3.86 seconds
[0m14:58:31.935947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cc7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cc5810>]}
[0m14:58:31.936136 [debug] [MainThread]: Flushing usage events
[0m15:00:46.255823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ae8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c12dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c73910>]}


============================== 15:00:46.258524 | 6529f7a3-1742-4fbd-b7c9-b831476e958c ==============================
[0m15:00:46.258524 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:00:46.258833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:00:47.047949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6529f7a3-1742-4fbd-b7c9-b831476e958c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282dc810>]}
[0m15:00:47.070172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6529f7a3-1742-4fbd-b7c9-b831476e958c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046cb110>]}
[0m15:00:47.070846 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:00:47.086101 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:00:47.182328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:47.182603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:47.208372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6529f7a3-1742-4fbd-b7c9-b831476e958c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285fd2d0>]}
[0m15:00:47.311291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6529f7a3-1742-4fbd-b7c9-b831476e958c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c37150>]}
[0m15:00:47.311631 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m15:00:47.311817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6529f7a3-1742-4fbd-b7c9-b831476e958c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1283f9f50>]}
[0m15:00:47.313079 [info ] [MainThread]: 
[0m15:00:47.313390 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:47.316072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:00:47.316340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:00:47.323783 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:00:47.325112 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:00:47.325330 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:00:47.325494 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:00:47.325639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:47.325762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:47.903741 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:00:47.904820 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:00:47.983098 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:00:47.984020 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:00:48.108839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_silver_layer)
[0m15:00:48.109334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_gold_layer)
[0m15:00:48.109808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:00:48.116698 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m15:00:48.118317 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m15:00:48.119728 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:00:48.119977 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m15:00:48.120215 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m15:00:48.120444 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:00:48.120653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:48.120837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:48.121022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:48.582923 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 0.0 seconds
[0m15:00:48.586761 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m15:00:48.643077 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:00:48.644112 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m15:00:48.662734 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:00:48.663691 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:00:48.790067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6529f7a3-1742-4fbd-b7c9-b831476e958c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b45950>]}
[0m15:00:48.790904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:48.791368 [info ] [MainThread]: 
[0m15:00:48.794613 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:00:48.795123 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:00:48.795711 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m15:00:48.796315 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m15:00:48.796887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_silver_layer, now model.my_dbt_project.clean_crm_data)
[0m15:00:48.797808 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:00:48.798564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_gold_layer, now model.my_dbt_project.clean_device_data)
[0m15:00:48.811876 [info ] [Thread-1 (]: import_crm: 
[0m15:00:48.812355 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:00:48.812724 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:00:48.816601 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:00:48.817163 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:00:48.817742 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:00:48.818033 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:00:48.838808 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:00:48.841089 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:00:48.843580 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:00:48.843978 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

windowed_crm AS (
    SELECT
        *,
        LEAD(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_status,
        LEAD(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_yob,
        LEAD(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_gender,
        LAG(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_status,
        LAG(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_yob,
        LAG(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_gender
    FROM cleaned_crm
),

flagged_crm AS (
    SELECT
        *,
        CASE
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'SUSPEND' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'SUSPEND' AND prev_status = 'ACTIVE' AND YEAR_OF_BIRTH = prev_yob AND GENDER = prev_gender) THEN 1
            EN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'IDLE' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            ELSE 0
        END AS pair_flag
    FROM windowed_crm
),

filtered_crm AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE SYSTEM_STATUS 
                WHEN 'ACTIVE' THEN 1 
                WHEN 'IDLE' THEN 2 
                WHEN 'SUSPEND' THEN 3 
                WHEN 'DEACTIVATE' THEN 4 
                ELSE 5 
            END,
            (CASE WHEN GENDER IS NOT NULL THEN 1 ELSE 0 END + 
            CASE WHEN YEAR_OF_BIRTH IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN SYSTEM_STATUS IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN MOBILE_TYPE IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN VALUE_SEGMENT IS NOT NULL THEN 1 ELSE 0 END) DESC
        ) AS rank
    FROM flagged_crm
    WHERE pair_flag = 0
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM filtered_crm
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:00:48.844325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:48.845251 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:00:48.845778 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:00:48.846254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:49.240962 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5111a-3201-1c75-0008-eb7e0006da6e
[0m15:00:49.241255 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 44 at position 12 unexpected 'EN'.
syntax error line 44 at position 15 unexpected '('.
syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
syntax error line 44 at position 121 unexpected 'THEN'.
syntax error line 71 at position 8 unexpected ')'.
[0m15:00:49.241524 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:00:49.368584 [debug] [Thread-1 (]: Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m15:00:49.369412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6529f7a3-1742-4fbd-b7c9-b831476e958c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1299c1390>]}
[0m15:00:49.369735 [error] [Thread-1 (]: 1 of 32 ERROR creating sql table model test_silver_layer.clean_crm_data ........ [[31mERROR[0m in 0.57s]
[0m15:00:49.370025 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:00:49.813414 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:00:49.823982 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:00:49.949233 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6529f7a3-1742-4fbd-b7c9-b831476e958c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12834a310>]}
[0m15:00:49.949716 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.15s]
[0m15:00:49.950017 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:00:49.950472 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:00:49.950663 [info ] [Thread-4 (]: 3 of 32 SKIP relation test_silver_layer.crm_device_data ........................ [[33mSKIP[0m]
[0m15:00:49.950859 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:00:49.951027 [debug] [Thread-4 (]: Began running node model.my_dbt_project.enriched_data
[0m15:00:49.951188 [info ] [Thread-4 (]: 4 of 32 SKIP relation test_silver_layer.enriched_data .......................... [[33mSKIP[0m]
[0m15:00:49.951434 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:00:49.951995 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:00:49.952193 [info ] [Thread-1 (]: 5 of 32 SKIP relation test_gold_layer.brand_by_age_segment ..................... [[33mSKIP[0m]
[0m15:00:49.952403 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:00:49.952591 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:00:49.952751 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:00:49.952929 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:00:49.953084 [info ] [Thread-2 (]: 6 of 32 SKIP relation test_gold_layer.customers_by_brand_overall ............... [[33mSKIP[0m]
[0m15:00:49.953273 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:00:49.953438 [info ] [Thread-3 (]: 7 of 32 SKIP relation test_gold_layer.customers_by_brand_week_wise ............. [[33mSKIP[0m]
[0m15:00:49.953647 [info ] [Thread-4 (]: 8 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_overall ......... [[33mSKIP[0m]
[0m15:00:49.953844 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:00:49.954008 [info ] [Thread-1 (]: 9 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_week_wise ....... [[33mSKIP[0m]
[0m15:00:49.954187 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:00:49.954357 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:00:49.954534 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:00:49.954739 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:00:49.954906 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:00:49.955069 [debug] [Thread-4 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:00:49.955275 [info ] [Thread-2 (]: 10 of 32 SKIP relation test_gold_layer.customers_by_os_overall ................. [[33mSKIP[0m]
[0m15:00:49.955472 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:00:49.955642 [info ] [Thread-3 (]: 11 of 32 SKIP relation test_gold_layer.customers_by_os_week_wise ............... [[33mSKIP[0m]
[0m15:00:49.955834 [info ] [Thread-4 (]: 12 of 32 SKIP relation test_gold_layer.os_by_age_segment ....................... [[33mSKIP[0m]
[0m15:00:49.956019 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:00:49.956173 [info ] [Thread-1 (]: 13 of 32 SKIP relation test_gold_layer.revenue_by_age_overall .................. [[33mSKIP[0m]
[0m15:00:49.956342 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:00:49.956490 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:00:49.956659 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:00:49.956813 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:00:49.956995 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:00:49.957157 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:00:49.957334 [info ] [Thread-2 (]: 14 of 32 SKIP relation test_gold_layer.revenue_by_age_week_wise ................ [[33mSKIP[0m]
[0m15:00:49.957514 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:00:49.957673 [info ] [Thread-3 (]: 15 of 32 SKIP relation test_gold_layer.revenue_by_brand_overall ................ [[33mSKIP[0m]
[0m15:00:49.957868 [info ] [Thread-4 (]: 16 of 32 SKIP relation test_gold_layer.revenue_by_brand_week_wise .............. [[33mSKIP[0m]
[0m15:00:49.958054 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:00:49.958211 [info ] [Thread-1 (]: 17 of 32 SKIP relation test_gold_layer.revenue_by_gender_overall ............... [[33mSKIP[0m]
[0m15:00:49.958378 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:00:49.958533 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:00:49.958694 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:00:49.958852 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:00:49.959026 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:00:49.959194 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:00:49.959370 [info ] [Thread-2 (]: 18 of 32 SKIP relation test_gold_layer.revenue_by_gender_week_wise ............. [[33mSKIP[0m]
[0m15:00:49.959556 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:00:49.959716 [info ] [Thread-3 (]: 19 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_overall .......... [[33mSKIP[0m]
[0m15:00:49.959885 [info ] [Thread-4 (]: 20 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_week_wise ........ [[33mSKIP[0m]
[0m15:00:49.960066 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:00:49.960224 [info ] [Thread-1 (]: 21 of 32 SKIP relation test_gold_layer.revenue_by_os_overall ................... [[33mSKIP[0m]
[0m15:00:49.960388 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:00:49.960545 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:00:49.960717 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:00:49.960906 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:00:49.961079 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:00:49.961291 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:00:49.961562 [info ] [Thread-2 (]: 22 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_overall ............ [[33mSKIP[0m]
[0m15:00:49.961862 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:00:49.962084 [info ] [Thread-3 (]: 23 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_week_wise .......... [[33mSKIP[0m]
[0m15:00:49.962317 [info ] [Thread-4 (]: 24 of 32 SKIP relation test_gold_layer.revenue_by_os_week_wise ................. [[33mSKIP[0m]
[0m15:00:49.962528 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:00:49.962705 [info ] [Thread-1 (]: 25 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_overall ........ [[33mSKIP[0m]
[0m15:00:49.962894 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:00:49.963064 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:00:49.963248 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:00:49.963418 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:00:49.963604 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:00:49.963815 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:00:49.964017 [info ] [Thread-2 (]: 26 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_week_wise ...... [[33mSKIP[0m]
[0m15:00:49.964260 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:00:49.964446 [info ] [Thread-3 (]: 27 of 32 SKIP relation test_gold_layer.total_customers_overall ................. [[33mSKIP[0m]
[0m15:00:49.964637 [info ] [Thread-4 (]: 28 of 32 SKIP relation test_gold_layer.total_customers_week_wise ............... [[33mSKIP[0m]
[0m15:00:49.964822 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:00:49.964989 [info ] [Thread-1 (]: 29 of 32 SKIP relation test_gold_layer.total_devices_overall ................... [[33mSKIP[0m]
[0m15:00:49.965179 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:00:49.965338 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:00:49.965509 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:00:49.965673 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:00:49.965852 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:00:49.966028 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:00:49.966213 [info ] [Thread-2 (]: 30 of 32 SKIP relation test_gold_layer.total_devices_week_wise ................. [[33mSKIP[0m]
[0m15:00:49.966500 [info ] [Thread-3 (]: 31 of 32 SKIP relation test_gold_layer.weekly_revenue_by_brand ................. [[33mSKIP[0m]
[0m15:00:49.966688 [info ] [Thread-4 (]: 32 of 32 SKIP relation test_gold_layer.weekly_revenue_by_os .................... [[33mSKIP[0m]
[0m15:00:49.966874 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:00:49.967034 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:00:49.967195 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:00:49.968111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:49.968284 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:00:49.968406 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:00:49.968516 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_SEEDS' was properly closed.
[0m15:00:49.968729 [info ] [MainThread]: 
[0m15:00:49.968885 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m15:00:49.969542 [debug] [MainThread]: Command end result
[0m15:00:49.989687 [info ] [MainThread]: 
[0m15:00:49.990006 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:00:49.990156 [info ] [MainThread]: 
[0m15:00:49.990355 [error] [MainThread]:   Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m15:00:49.990539 [info ] [MainThread]: 
[0m15:00:49.990702 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=30 TOTAL=32
[0m15:00:49.992366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7638443, "process_user_time": 2.065275, "process_kernel_time": 1.744461, "process_mem_max_rss": "195117056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:00:49.992663 [debug] [MainThread]: Command `dbt run` failed at 15:00:49.992624 after 3.76 seconds
[0m15:00:49.992869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101844710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8abd0>]}
[0m15:00:49.993040 [debug] [MainThread]: Flushing usage events
[0m15:04:50.942670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c93a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cde790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c92d10>]}


============================== 15:04:50.945248 | aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524 ==============================
[0m15:04:50.945248 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:04:50.945557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:04:51.757485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e4bb10>]}
[0m15:04:51.778954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e430d0>]}
[0m15:04:51.779522 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:04:51.793368 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:04:51.885505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:51.885974 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m15:04:51.953654 [info ] [MainThread]: import_crm: 
[0m15:04:52.026482 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:04:52.026813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145fa8c10>]}
[0m15:04:52.109379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1461c7350>]}
[0m15:04:52.165622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145f48a10>]}
[0m15:04:52.165933 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m15:04:52.166117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145de9090>]}
[0m15:04:52.167332 [info ] [MainThread]: 
[0m15:04:52.167612 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:04:52.170266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:04:52.170543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:04:52.176512 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:04:52.177694 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:04:52.177883 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:04:52.178056 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:04:52.178211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:52.178341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:52.874779 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:04:52.876061 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:04:52.880120 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:04:52.881043 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:04:53.006648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_gold_layer)
[0m15:04:53.007277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:04:53.007852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_test_silver_layer'
[0m15:04:53.016895 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m15:04:53.018841 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:04:53.020682 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m15:04:53.021012 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m15:04:53.021349 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:04:53.021637 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m15:04:53.021924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:53.022180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:53.022410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:53.567760 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:04:53.568787 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:04:53.571275 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m15:04:53.573266 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:04:53.591219 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:04:53.594145 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m15:04:53.731799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462265d0>]}
[0m15:04:53.732754 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:53.733238 [info ] [MainThread]: 
[0m15:04:53.737159 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:04:53.737698 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:04:53.738420 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m15:04:53.739065 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m15:04:53.739570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_gold_layer, now model.my_dbt_project.clean_crm_data)
[0m15:04:53.739981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_device_data)
[0m15:04:53.740346 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:04:53.740696 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:04:53.752289 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:04:53.756066 [info ] [Thread-1 (]: import_crm: 
[0m15:04:53.756812 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:04:53.757173 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:04:53.757971 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:04:53.758386 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:04:53.780534 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:04:53.782334 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:04:53.784934 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:04:53.785970 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:04:53.786366 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql



-- 


WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

windowed_crm AS (
    SELECT
        *,
        LEAD(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_status,
        LEAD(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_yob,
        LEAD(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_gender,
        LAG(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_status,
        LAG(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_yob,
        LAG(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_gender
    FROM cleaned_crm
),

flagged_crm AS (
    SELECT
        *,
        CASE
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'SUSPEND' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'SUSPEND' AND prev_status = 'ACTIVE' AND YEAR_OF_BIRTH = prev_yob AND GENDER = prev_gender) THEN 1
            EN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'IDLE' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            ELSE 0
        END AS pair_flag
    FROM windowed_crm
),

filtered_crm AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE SYSTEM_STATUS 
                WHEN 'ACTIVE' THEN 1 
                WHEN 'IDLE' THEN 2 
                WHEN 'SUSPEND' THEN 3 
                WHEN 'DEACTIVATE' THEN 4 
                ELSE 5 
            END,
            (CASE WHEN GENDER IS NOT NULL THEN 1 ELSE 0 END + 
            CASE WHEN YEAR_OF_BIRTH IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN SYSTEM_STATUS IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN MOBILE_TYPE IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN VALUE_SEGMENT IS NOT NULL THEN 1 ELSE 0 END) DESC
        ) AS rank
    FROM flagged_crm
    WHERE pair_flag = 0
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM filtered_crm
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:04:53.786848 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:04:53.787187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:53.787429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:54.254844 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5111e-3201-1cd0-0008-eb7e0007507a
[0m15:04:54.255190 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 44 at position 12 unexpected 'EN'.
syntax error line 44 at position 15 unexpected '('.
syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
syntax error line 44 at position 121 unexpected 'THEN'.
syntax error line 71 at position 8 unexpected ')'.
[0m15:04:54.255465 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:04:54.380536 [debug] [Thread-1 (]: Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m15:04:54.381365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466f6910>]}
[0m15:04:54.381682 [error] [Thread-1 (]: 1 of 32 ERROR creating sql table model test_silver_layer.clean_crm_data ........ [[31mERROR[0m in 0.64s]
[0m15:04:54.381972 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:04:55.156886 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:55.167138 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:04:55.291957 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aecfeecd-dd81-46d4-bf9e-d6ba1f5d8524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1464ef3d0>]}
[0m15:04:55.292349 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.55s]
[0m15:04:55.292637 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:04:55.293031 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:04:55.293216 [info ] [Thread-4 (]: 3 of 32 SKIP relation test_silver_layer.crm_device_data ........................ [[33mSKIP[0m]
[0m15:04:55.293405 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:04:55.293638 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:04:55.293805 [info ] [Thread-3 (]: 4 of 32 SKIP relation test_silver_layer.enriched_data .......................... [[33mSKIP[0m]
[0m15:04:55.294039 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:04:55.294455 [debug] [Thread-2 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:04:55.294626 [info ] [Thread-2 (]: 5 of 32 SKIP relation test_gold_layer.brand_by_age_segment ..................... [[33mSKIP[0m]
[0m15:04:55.294823 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:04:55.295061 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:04:55.295208 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:04:55.295352 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:04:55.295532 [info ] [Thread-1 (]: 6 of 32 SKIP relation test_gold_layer.customers_by_brand_overall ............... [[33mSKIP[0m]
[0m15:04:55.295709 [info ] [Thread-4 (]: 7 of 32 SKIP relation test_gold_layer.customers_by_brand_week_wise ............. [[33mSKIP[0m]
[0m15:04:55.295896 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:04:55.296055 [info ] [Thread-3 (]: 8 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_overall ......... [[33mSKIP[0m]
[0m15:04:55.296248 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:04:55.296411 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:04:55.296570 [info ] [Thread-2 (]: 9 of 32 SKIP relation test_gold_layer.customers_by_mobile_type_week_wise ....... [[33mSKIP[0m]
[0m15:04:55.296744 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:04:55.296903 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:04:55.297060 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:04:55.297236 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:04:55.297396 [debug] [Thread-3 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:04:55.297560 [info ] [Thread-1 (]: 10 of 32 SKIP relation test_gold_layer.customers_by_os_overall ................. [[33mSKIP[0m]
[0m15:04:55.297750 [info ] [Thread-4 (]: 11 of 32 SKIP relation test_gold_layer.customers_by_os_week_wise ............... [[33mSKIP[0m]
[0m15:04:55.297932 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:04:55.298154 [info ] [Thread-3 (]: 12 of 32 SKIP relation test_gold_layer.os_by_age_segment ....................... [[33mSKIP[0m]
[0m15:04:55.298370 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:04:55.298557 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:04:55.298737 [info ] [Thread-2 (]: 13 of 32 SKIP relation test_gold_layer.revenue_by_age_overall .................. [[33mSKIP[0m]
[0m15:04:55.298925 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:04:55.299104 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:04:55.299275 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:04:55.299451 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:04:55.299616 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:04:55.299777 [info ] [Thread-1 (]: 14 of 32 SKIP relation test_gold_layer.revenue_by_age_week_wise ................ [[33mSKIP[0m]
[0m15:04:55.299996 [info ] [Thread-4 (]: 15 of 32 SKIP relation test_gold_layer.revenue_by_brand_overall ................ [[33mSKIP[0m]
[0m15:04:55.300222 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:04:55.300418 [info ] [Thread-3 (]: 16 of 32 SKIP relation test_gold_layer.revenue_by_brand_week_wise .............. [[33mSKIP[0m]
[0m15:04:55.300606 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:04:55.300764 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:04:55.300936 [info ] [Thread-2 (]: 17 of 32 SKIP relation test_gold_layer.revenue_by_gender_overall ............... [[33mSKIP[0m]
[0m15:04:55.301136 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:04:55.301322 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:04:55.301529 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:04:55.301718 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:04:55.301900 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:04:55.302083 [info ] [Thread-1 (]: 18 of 32 SKIP relation test_gold_layer.revenue_by_gender_week_wise ............. [[33mSKIP[0m]
[0m15:04:55.302270 [info ] [Thread-4 (]: 19 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_overall .......... [[33mSKIP[0m]
[0m15:04:55.302461 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:04:55.302889 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:04:55.302675 [info ] [Thread-3 (]: 20 of 32 SKIP relation test_gold_layer.revenue_by_mobile_type_week_wise ........ [[33mSKIP[0m]
[0m15:04:55.303117 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:04:55.303292 [info ] [Thread-2 (]: 21 of 32 SKIP relation test_gold_layer.revenue_by_os_overall ................... [[33mSKIP[0m]
[0m15:04:55.303498 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:04:55.303759 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:04:55.304040 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:04:55.304281 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:04:55.304481 [info ] [Thread-1 (]: 22 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_overall ............ [[33mSKIP[0m]
[0m15:04:55.304699 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:04:55.304890 [info ] [Thread-4 (]: 23 of 32 SKIP relation test_gold_layer.revenue_by_os_vendor_week_wise .......... [[33mSKIP[0m]
[0m15:04:55.305097 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:04:55.305281 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:04:55.305465 [info ] [Thread-3 (]: 24 of 32 SKIP relation test_gold_layer.revenue_by_os_week_wise ................. [[33mSKIP[0m]
[0m15:04:55.305657 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:04:55.305830 [info ] [Thread-2 (]: 25 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_overall ........ [[33mSKIP[0m]
[0m15:04:55.306023 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:04:55.306208 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:04:55.306382 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:04:55.306563 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:04:55.306731 [info ] [Thread-1 (]: 26 of 32 SKIP relation test_gold_layer.revenue_by_value_segment_week_wise ...... [[33mSKIP[0m]
[0m15:04:55.306925 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:04:55.307110 [info ] [Thread-4 (]: 27 of 32 SKIP relation test_gold_layer.total_customers_overall ................. [[33mSKIP[0m]
[0m15:04:55.307301 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:04:55.307478 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:04:55.307641 [info ] [Thread-3 (]: 28 of 32 SKIP relation test_gold_layer.total_customers_week_wise ............... [[33mSKIP[0m]
[0m15:04:55.307926 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:04:55.308106 [info ] [Thread-2 (]: 29 of 32 SKIP relation test_gold_layer.total_devices_overall ................... [[33mSKIP[0m]
[0m15:04:55.308291 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:04:55.308491 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:04:55.308697 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:04:55.308892 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:04:55.309054 [info ] [Thread-1 (]: 30 of 32 SKIP relation test_gold_layer.total_devices_week_wise ................. [[33mSKIP[0m]
[0m15:04:55.309235 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:04:55.309397 [info ] [Thread-4 (]: 31 of 32 SKIP relation test_gold_layer.weekly_revenue_by_brand ................. [[33mSKIP[0m]
[0m15:04:55.309623 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:04:55.309789 [info ] [Thread-3 (]: 32 of 32 SKIP relation test_gold_layer.weekly_revenue_by_os .................... [[33mSKIP[0m]
[0m15:04:55.309961 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:04:55.310164 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:04:55.310959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:55.311108 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:04:55.311228 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:04:55.311343 [debug] [MainThread]: Connection 'list_PROJECT_SEC2_DB_test_silver_layer' was properly closed.
[0m15:04:55.311549 [info ] [MainThread]: 
[0m15:04:55.311697 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m15:04:55.312333 [debug] [MainThread]: Command end result
[0m15:04:55.331067 [info ] [MainThread]: 
[0m15:04:55.331377 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:04:55.331534 [info ] [MainThread]: 
[0m15:04:55.331731 [error] [MainThread]:   Database Error in model clean_crm_data (models/silver/clean_crm_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 12 unexpected 'EN'.
  syntax error line 44 at position 15 unexpected '('.
  syntax error line 44 at position 16 unexpected 'SYSTEM_STATUS'.
  syntax error line 44 at position 121 unexpected 'THEN'.
  syntax error line 71 at position 8 unexpected ')'.
  compiled Code at target/run/my_dbt_project/models/silver/clean_crm_data.sql
[0m15:04:55.331895 [info ] [MainThread]: 
[0m15:04:55.332039 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=30 TOTAL=32
[0m15:04:55.333792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4201803, "process_user_time": 2.260453, "process_kernel_time": 1.743189, "process_mem_max_rss": "200785920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:04:55.334113 [debug] [MainThread]: Command `dbt run` failed at 15:04:55.334069 after 4.42 seconds
[0m15:04:55.334319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d02310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14622eb50>]}
[0m15:04:55.334493 [debug] [MainThread]: Flushing usage events
[0m15:05:51.865767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df8f90>]}


============================== 15:05:51.869215 | 77ec8496-e1e6-495d-8978-86110fb5f6bb ==============================
[0m15:05:51.869215 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:05:51.869566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'send_anonymous_usage_stats': 'True'}
[0m15:05:52.785455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225f5910>]}
[0m15:05:52.807132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783b150>]}
[0m15:05:52.807728 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:05:52.823363 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:05:52.917262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:52.917729 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/silver/clean_crm_data.sql
[0m15:05:52.985783 [info ] [MainThread]: import_crm: 
[0m15:05:53.056935 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:05:53.057257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c3cc10>]}
[0m15:05:53.140634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b6410>]}
[0m15:05:53.196545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cfdcd0>]}
[0m15:05:53.196862 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m15:05:53.197036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cc3d90>]}
[0m15:05:53.198267 [info ] [MainThread]: 
[0m15:05:53.198544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:05:53.201301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:05:53.201564 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:05:53.208563 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:05:53.209762 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:05:53.210124 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:05:53.209959 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:05:53.210265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:53.210402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:53.814124 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:05:53.814708 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:05:53.815638 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:05:53.816283 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:05:53.948872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_gold_layer)
[0m15:05:53.949427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_silver_layer)
[0m15:05:53.949926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:05:53.962015 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m15:05:53.962486 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m15:05:53.964081 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:05:53.964317 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m15:05:53.964539 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m15:05:53.964742 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:05:53.964937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:53.965114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:53.965287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:54.418505 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:05:54.420325 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:05:54.535836 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:05:54.538597 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m15:05:54.549624 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:05:54.552942 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m15:05:54.696169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122871bd0>]}
[0m15:05:54.697119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:54.697583 [info ] [MainThread]: 
[0m15:05:54.700326 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:05:54.700882 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:05:54.701544 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m15:05:54.703257 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m15:05:54.704479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_gold_layer, now model.my_dbt_project.clean_crm_data)
[0m15:05:54.705802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_silver_layer, now model.my_dbt_project.clean_device_data)
[0m15:05:54.706517 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:05:54.707561 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:05:54.718469 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:05:54.719141 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:05:54.719851 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:05:54.731185 [info ] [Thread-1 (]: import_crm: 
[0m15:05:54.731672 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:05:54.747053 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:05:54.747431 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:05:54.749288 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:05:54.750529 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:05:54.750979 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:05:54.753172 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:05:54.753470 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:54.753835 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

windowed_crm AS (
    SELECT
        *,
        LEAD(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_status,
        LEAD(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_yob,
        LEAD(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_gender,
        LAG(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_status,
        LAG(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_yob,
        LAG(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_gender
    FROM cleaned_crm
),

flagged_crm AS (
    SELECT
        *,
        CASE
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'SUSPEND' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'SUSPEND' AND prev_status = 'ACTIVE' AND YEAR_OF_BIRTH = prev_yob AND GENDER = prev_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'IDLE' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            ELSE 0
        END AS pair_flag
    FROM windowed_crm
),

filtered_crm AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE SYSTEM_STATUS 
                WHEN 'ACTIVE' THEN 1 
                WHEN 'IDLE' THEN 2 
                WHEN 'SUSPEND' THEN 3 
                WHEN 'DEACTIVATE' THEN 4 
                ELSE 5 
            END,
            (CASE WHEN GENDER IS NOT NULL THEN 1 ELSE 0 END + 
            CASE WHEN YEAR_OF_BIRTH IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN SYSTEM_STATUS IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN MOBILE_TYPE IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN VALUE_SEGMENT IS NOT NULL THEN 1 ELSE 0 END) DESC
        ) AS rank
    FROM flagged_crm
    WHERE pair_flag = 0
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM filtered_crm
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:05:54.754258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:55.750573 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:05:55.761191 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:05:55.884350 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106983090>]}
[0m15:05:55.884966 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.18s]
[0m15:05:55.885393 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:05:56.082756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:05:56.087070 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:05:56.223894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e80510>]}
[0m15:05:56.225316 [info ] [Thread-1 (]: 1 of 32 OK created sql table model test_silver_layer.clean_crm_data ............ [[32mSUCCESS 1[0m in 1.52s]
[0m15:05:56.226312 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:05:56.227558 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:05:56.228101 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:05:56.228741 [info ] [Thread-4 (]: 3 of 32 START sql table model test_silver_layer.crm_device_data ................ [RUN]
[0m15:05:56.229417 [info ] [Thread-3 (]: 4 of 32 START sql table model test_silver_layer.enriched_data .................. [RUN]
[0m15:05:56.230257 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m15:05:56.230890 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.enriched_data)
[0m15:05:56.231406 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:05:56.231868 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:05:56.237410 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:05:56.244910 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:05:56.245839 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:05:56.246866 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:05:56.247274 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:05:56.250018 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:05:56.252325 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:05:56.253918 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:05:56.254431 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.crm_device_data
         as
        (
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:05:56.254818 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:56.256138 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:05:56.257316 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m15:05:56.258077 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:57.521686 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:05:57.522657 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:05:57.645224 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122deca10>]}
[0m15:05:57.646380 [info ] [Thread-4 (]: 3 of 32 OK created sql table model test_silver_layer.crm_device_data ........... [[32mSUCCESS 1[0m in 1.42s]
[0m15:05:57.646690 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:05:57.651706 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:05:57.652564 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m15:05:57.780602 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e17750>]}
[0m15:05:57.781104 [info ] [Thread-3 (]: 4 of 32 OK created sql table model test_silver_layer.enriched_data ............. [[32mSUCCESS 1[0m in 1.55s]
[0m15:05:57.781420 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:05:57.782050 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:05:57.782325 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:05:57.782575 [info ] [Thread-1 (]: 5 of 32 START sql view model test_gold_layer.brand_by_age_segment .............. [RUN]
[0m15:05:57.782810 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:57.783030 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:57.783241 [info ] [Thread-2 (]: 6 of 32 START sql view model test_gold_layer.customers_by_brand_overall ........ [RUN]
[0m15:05:57.783509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m15:05:57.783733 [info ] [Thread-4 (]: 7 of 32 START sql view model test_gold_layer.customers_by_brand_week_wise ...... [RUN]
[0m15:05:57.783949 [info ] [Thread-3 (]: 8 of 32 START sql view model test_gold_layer.customers_by_mobile_type_overall .. [RUN]
[0m15:05:57.784147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m15:05:57.784315 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:05:57.784476 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:05:57.784648 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:05:57.784798 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:05:57.786968 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:05:57.787194 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:57.787370 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:57.789042 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:05:57.790817 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:05:57.792681 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:05:57.793033 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:05:57.799686 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:05:57.799921 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:57.805735 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m15:05:57.807360 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:05:57.807578 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:57.808799 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:05:57.811257 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:05:57.811922 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m15:05:57.812653 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m15:05:57.812924 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_brand_overall
  
   as (
    
select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m15:05:57.813292 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:05:57.813536 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.brand_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m15:05:57.813902 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:05:57.814062 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:57.814254 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_brand_week_wise
  
   as (
    
select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m15:05:57.814444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:57.814614 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_mobile_type_overall
  
   as (
    
select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m15:05:57.814835 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:05:57.815778 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:58.311381 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:05:58.316751 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m15:05:58.326697 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:05:58.327609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:05:58.330002 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m15:05:58.332105 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m15:05:58.355048 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:05:58.357404 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m15:05:58.450441 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fbead0>]}
[0m15:05:58.451931 [info ] [Thread-2 (]: 6 of 32 OK created sql view model test_gold_layer.customers_by_brand_overall ... [[32mSUCCESS 1[0m in 0.67s]
[0m15:05:58.452986 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:05:58.453646 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:58.454334 [info ] [Thread-2 (]: 9 of 32 START sql view model test_gold_layer.customers_by_mobile_type_week_wise  [RUN]
[0m15:05:58.454975 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:05:58.455504 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:58.460360 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:05:58.461336 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:58.465051 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:05:58.466265 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:05:58.466710 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m15:05:58.468045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:58.471911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ef0f10>]}
[0m15:05:58.472732 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b6ed10>]}
[0m15:05:58.473770 [info ] [Thread-1 (]: 5 of 32 OK created sql view model test_gold_layer.brand_by_age_segment ......... [[32mSUCCESS 1[0m in 0.69s]
[0m15:05:58.474571 [info ] [Thread-4 (]: 7 of 32 OK created sql view model test_gold_layer.customers_by_brand_week_wise . [[32mSUCCESS 1[0m in 0.69s]
[0m15:05:58.475242 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:05:58.475751 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:05:58.476163 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:05:58.476581 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:58.477029 [info ] [Thread-1 (]: 10 of 32 START sql view model test_gold_layer.customers_by_os_overall .......... [RUN]
[0m15:05:58.477496 [info ] [Thread-4 (]: 11 of 32 START sql view model test_gold_layer.customers_by_os_week_wise ........ [RUN]
[0m15:05:58.477979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m15:05:58.478387 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:05:58.478737 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:05:58.479064 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:58.482644 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:05:58.485592 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:05:58.486410 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:58.486723 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:05:58.489224 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:05:58.492302 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m15:05:58.493505 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m15:05:58.494154 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m15:05:58.494455 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_os_overall
  
   as (
    
select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by os_name
  );
[0m15:05:58.494831 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fd0790>]}
[0m15:05:58.495115 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_os_week_wise
  
   as (
    
select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m15:05:58.495388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:58.496064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:05:58.495847 [info ] [Thread-3 (]: 8 of 32 OK created sql view model test_gold_layer.customers_by_mobile_type_overall  [[32mSUCCESS 1[0m in 0.71s]
[0m15:05:58.497611 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:05:58.498135 [debug] [Thread-3 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:05:58.498525 [info ] [Thread-3 (]: 12 of 32 START sql view model test_gold_layer.os_by_age_segment ................ [RUN]
[0m15:05:58.498853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.os_by_age_segment)
[0m15:05:58.499111 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:05:58.503273 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:05:58.504555 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:05:58.506581 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m15:05:58.507874 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m15:05:58.508179 [debug] [Thread-3 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.os_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m15:05:58.508443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:58.968888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:05:58.969887 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m15:05:58.974710 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:05:58.975573 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m15:05:58.985240 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:05:58.986104 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m15:05:59.000894 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:05:59.001780 [debug] [Thread-3 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m15:05:59.095018 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af0410>]}
[0m15:05:59.095581 [info ] [Thread-2 (]: 9 of 32 OK created sql view model test_gold_layer.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.64s]
[0m15:05:59.095889 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:05:59.096109 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:05:59.096358 [info ] [Thread-2 (]: 13 of 32 START sql view model test_gold_layer.revenue_by_age_overall ........... [RUN]
[0m15:05:59.096601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d49c10>]}
[0m15:05:59.096824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:05:59.097104 [info ] [Thread-1 (]: 10 of 32 OK created sql view model test_gold_layer.customers_by_os_overall ..... [[32mSUCCESS 1[0m in 0.62s]
[0m15:05:59.097332 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:05:59.097592 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:05:59.099540 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:05:59.099773 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:59.100066 [info ] [Thread-1 (]: 14 of 32 START sql view model test_gold_layer.revenue_by_age_week_wise ......... [RUN]
[0m15:05:59.100269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:05:59.100572 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:59.102357 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:05:59.102577 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:05:59.103938 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:05:59.104234 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:59.105497 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:05:59.105880 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m15:05:59.106188 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_age_overall
  
   as (
    
select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by age
order by age
  );
[0m15:05:59.106392 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:59.106967 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:05:59.107177 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_age_week_wise
  
   as (
    
select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m15:05:59.107591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:59.112373 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b62190>]}
[0m15:05:59.112751 [info ] [Thread-4 (]: 11 of 32 OK created sql view model test_gold_layer.customers_by_os_week_wise ... [[32mSUCCESS 1[0m in 0.63s]
[0m15:05:59.113035 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:05:59.113235 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:59.113456 [info ] [Thread-4 (]: 15 of 32 START sql view model test_gold_layer.revenue_by_brand_overall ......... [RUN]
[0m15:05:59.113650 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:05:59.113810 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:59.116386 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:05:59.116812 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:59.118173 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:05:59.118828 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m15:05:59.119007 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_brand_overall
  
   as (
    
select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m15:05:59.119172 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:05:59.124408 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bad410>]}
[0m15:05:59.124842 [info ] [Thread-3 (]: 12 of 32 OK created sql view model test_gold_layer.os_by_age_segment ........... [[32mSUCCESS 1[0m in 0.63s]
[0m15:05:59.125117 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:05:59.125315 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:59.125541 [info ] [Thread-3 (]: 16 of 32 START sql view model test_gold_layer.revenue_by_brand_week_wise ....... [RUN]
[0m15:05:59.125743 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:05:59.125916 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:59.127758 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:05:59.128158 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:59.129479 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:05:59.129993 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:05:59.130170 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_brand_week_wise
  
   as (
    
select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m15:05:59.130329 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:59.554738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:05:59.555729 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m15:05:59.566930 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:05:59.567848 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m15:05:59.570102 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:05:59.571039 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m15:05:59.662113 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:05:59.663065 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m15:05:59.682353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122edb0d0>]}
[0m15:05:59.682745 [info ] [Thread-1 (]: 14 of 32 OK created sql view model test_gold_layer.revenue_by_age_week_wise .... [[32mSUCCESS 1[0m in 0.58s]
[0m15:05:59.683024 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:05:59.683225 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:59.683451 [info ] [Thread-1 (]: 17 of 32 START sql view model test_gold_layer.revenue_by_gender_overall ........ [RUN]
[0m15:05:59.683658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:05:59.683828 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:59.685810 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:05:59.686197 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:05:59.687521 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:05:59.688009 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m15:05:59.688195 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_gender_overall
  
   as (
    
select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m15:05:59.688359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:59.690792 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fbd6d0>]}
[0m15:05:59.691169 [info ] [Thread-2 (]: 13 of 32 OK created sql view model test_gold_layer.revenue_by_age_overall ...... [[32mSUCCESS 1[0m in 0.59s]
[0m15:05:59.691686 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:05:59.691927 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:59.692181 [info ] [Thread-2 (]: 18 of 32 START sql view model test_gold_layer.revenue_by_gender_week_wise ...... [RUN]
[0m15:05:59.692430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:05:59.692631 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:59.692861 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e0fcd0>]}
[0m15:05:59.694638 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:05:59.694948 [info ] [Thread-3 (]: 16 of 32 OK created sql view model test_gold_layer.revenue_by_brand_week_wise .. [[32mSUCCESS 1[0m in 0.57s]
[0m15:05:59.695246 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:05:59.695452 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:59.695809 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:05:59.695680 [info ] [Thread-3 (]: 19 of 32 START sql view model test_gold_layer.revenue_by_mobile_type_overall ... [RUN]
[0m15:05:59.697328 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:05:59.697593 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:05:59.697851 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:59.700525 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:05:59.701003 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:05:59.701303 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_gender_week_wise
  
   as (
    
select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m15:05:59.701515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:59.701935 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:05:59.703828 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:05:59.704876 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:05:59.705149 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_mobile_type_overall
  
   as (
    
select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m15:05:59.705339 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:59.789201 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ea7450>]}
[0m15:05:59.789705 [info ] [Thread-4 (]: 15 of 32 OK created sql view model test_gold_layer.revenue_by_brand_overall .... [[32mSUCCESS 1[0m in 0.68s]
[0m15:05:59.790011 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:05:59.790224 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:59.790439 [info ] [Thread-4 (]: 20 of 32 START sql view model test_gold_layer.revenue_by_mobile_type_week_wise . [RUN]
[0m15:05:59.790732 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:05:59.790935 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:59.792945 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:05:59.793439 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:05:59.794819 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:05:59.795388 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:05:59.795568 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m15:05:59.795733 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:00.176683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:00.182165 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m15:06:00.186969 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:00.189485 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m15:06:00.202266 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:00.204350 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m15:06:00.253434 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:00.255811 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m15:06:00.321432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bf7950>]}
[0m15:06:00.322617 [info ] [Thread-1 (]: 17 of 32 OK created sql view model test_gold_layer.revenue_by_gender_overall ... [[32mSUCCESS 1[0m in 0.64s]
[0m15:06:00.324150 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:00.324859 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:06:00.325564 [info ] [Thread-1 (]: 21 of 32 START sql view model test_gold_layer.revenue_by_os_overall ............ [RUN]
[0m15:06:00.326242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:06:00.326746 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:06:00.327375 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e6a410>]}
[0m15:06:00.332881 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:00.333728 [info ] [Thread-2 (]: 18 of 32 OK created sql view model test_gold_layer.revenue_by_gender_week_wise . [[32mSUCCESS 1[0m in 0.63s]
[0m15:06:00.334581 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:00.335032 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:00.335617 [info ] [Thread-2 (]: 22 of 32 START sql view model test_gold_layer.revenue_by_os_vendor_overall ..... [RUN]
[0m15:06:00.336145 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:06:00.336559 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:06:00.336892 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:00.340256 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:00.344494 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:00.346078 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:00.346478 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:00.346851 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_overall
  
   as (
    
select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m15:06:00.347335 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e0fcd0>]}
[0m15:06:00.351334 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:00.351781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:00.352342 [info ] [Thread-3 (]: 19 of 32 OK created sql view model test_gold_layer.revenue_by_mobile_type_overall  [[32mSUCCESS 1[0m in 0.65s]
[0m15:06:00.353487 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:00.354755 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:00.355686 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:00.356059 [info ] [Thread-3 (]: 23 of 32 START sql view model test_gold_layer.revenue_by_os_vendor_week_wise ... [RUN]
[0m15:06:00.356428 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_vendor_overall
  
   as (
    
select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m15:06:00.356831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:06:00.357257 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:00.357803 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:00.362042 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:00.362751 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:00.365154 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:00.366423 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:00.366722 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_vendor_week_wise
  
   as (
    
select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m15:06:00.367049 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:00.387400 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bc8690>]}
[0m15:06:00.388054 [info ] [Thread-4 (]: 20 of 32 OK created sql view model test_gold_layer.revenue_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.60s]
[0m15:06:00.388482 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:00.388782 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:00.389148 [info ] [Thread-4 (]: 24 of 32 START sql view model test_gold_layer.revenue_by_os_week_wise .......... [RUN]
[0m15:06:00.389484 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:06:00.389740 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:00.392487 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:00.393032 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:00.394960 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:00.395685 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:00.395924 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_week_wise
  
   as (
    
select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m15:06:00.396152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:00.842332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:00.843843 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:00.848543 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m15:06:00.849707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:00.852001 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m15:06:00.855628 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m15:06:00.877276 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:00.879632 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m15:06:00.982273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e9f950>]}
[0m15:06:00.983264 [info ] [Thread-1 (]: 21 of 32 OK created sql view model test_gold_layer.revenue_by_os_overall ....... [[32mSUCCESS 1[0m in 0.66s]
[0m15:06:00.983888 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:06:00.984281 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:00.984699 [info ] [Thread-1 (]: 25 of 32 START sql view model test_gold_layer.revenue_by_value_segment_overall . [RUN]
[0m15:06:00.985148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e9ec90>]}
[0m15:06:00.985552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:06:00.986431 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:00.989865 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:00.991538 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:00.993812 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:00.994213 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fbf2d0>]}
[0m15:06:00.995083 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:00.995399 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_value_segment_overall
  
   as (
    
select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m15:06:00.995664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:01.004088 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b16a90>]}
[0m15:06:01.450446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:01.451448 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m15:06:01.577989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e49390>]}
[0m15:06:02.290673 [info ] [Thread-2 (]: 22 of 32 OK created sql view model test_gold_layer.revenue_by_os_vendor_overall  [[32mSUCCESS 1[0m in 0.65s]
[0m15:06:02.291417 [info ] [Thread-3 (]: 23 of 32 OK created sql view model test_gold_layer.revenue_by_os_vendor_week_wise  [[32mSUCCESS 1[0m in 0.64s]
[0m15:06:02.292162 [info ] [Thread-4 (]: 24 of 32 OK created sql view model test_gold_layer.revenue_by_os_week_wise ..... [[32mSUCCESS 1[0m in 0.61s]
[0m15:06:02.292743 [info ] [Thread-1 (]: 25 of 32 OK created sql view model test_gold_layer.revenue_by_value_segment_overall  [[32mSUCCESS 1[0m in 0.59s]
[0m15:06:02.293785 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:02.294476 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:02.295079 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:02.295370 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:02.295596 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:02.295843 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:06:02.296075 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:06:02.296248 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:06:02.296475 [info ] [Thread-2 (]: 26 of 32 START sql view model test_gold_layer.revenue_by_value_segment_week_wise  [RUN]
[0m15:06:02.296718 [info ] [Thread-3 (]: 27 of 32 START sql view model test_gold_layer.total_customers_overall .......... [RUN]
[0m15:06:02.296923 [info ] [Thread-4 (]: 28 of 32 START sql view model test_gold_layer.total_customers_week_wise ........ [RUN]
[0m15:06:02.297147 [info ] [Thread-1 (]: 29 of 32 START sql view model test_gold_layer.total_devices_overall ............ [RUN]
[0m15:06:02.297435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:06:02.297667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:06:02.297875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:06:02.298057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:06:02.298223 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:02.298383 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:06:02.298534 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:06:02.298681 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:06:02.300456 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:02.302605 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:06:02.305090 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:06:02.307384 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:06:02.307956 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:02.308160 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:06:02.309488 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:02.310799 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m15:06:02.310957 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:06:02.311104 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:06:02.312366 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m15:06:02.312796 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:02.313924 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m15:06:02.314431 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m15:06:02.314640 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_value_segment_week_wise
  
   as (
    
select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m15:06:02.315230 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m15:06:02.315430 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_customers_overall
  
   as (
    
with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m15:06:02.315633 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:02.316193 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m15:06:02.316393 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_devices_overall
  
   as (
    
with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m15:06:02.316597 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:02.316837 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_customers_week_wise
  
   as (
    
with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m15:06:02.317367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:02.318149 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:07.342346 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m15:06:07.342883 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m15:06:07.343846 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m15:06:07.344578 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m15:06:07.361902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m15:06:07.362851 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: Close
[0m15:06:07.376733 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m15:06:07.377640 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_overall: Close
[0m15:06:07.470182 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ea57d0>]}
[0m15:06:07.470611 [info ] [Thread-4 (]: 28 of 32 OK created sql view model test_gold_layer.total_customers_week_wise ... [[32mSUCCESS 1[0m in 5.17s]
[0m15:06:07.470893 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:06:07.471094 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:06:07.471291 [info ] [Thread-4 (]: 30 of 32 START sql view model test_gold_layer.total_devices_week_wise .......... [RUN]
[0m15:06:07.471538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m15:06:07.471748 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:06:07.473812 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:06:07.474519 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:06:07.475858 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m15:06:07.476182 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e39f90>]}
[0m15:06:07.476506 [info ] [Thread-2 (]: 26 of 32 OK created sql view model test_gold_layer.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 5.18s]
[0m15:06:07.476810 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:07.477150 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:07.477414 [info ] [Thread-2 (]: 31 of 32 START sql view model test_gold_layer.weekly_revenue_by_brand .......... [RUN]
[0m15:06:07.478057 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m15:06:07.478281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:06:07.478486 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_devices_week_wise
  
   as (
    
with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m15:06:07.478684 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:07.478839 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:07.480632 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:07.481439 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:07.482883 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:07.484012 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:07.484281 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.weekly_revenue_by_brand
  
   as (
    
SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m15:06:07.484457 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:07.505568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b44950>]}
[0m15:06:07.506040 [info ] [Thread-1 (]: 29 of 32 OK created sql view model test_gold_layer.total_devices_overall ....... [[32mSUCCESS 1[0m in 5.21s]
[0m15:06:07.506390 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:06:07.506615 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:07.506824 [info ] [Thread-1 (]: 32 of 32 START sql view model test_gold_layer.weekly_revenue_by_os ............. [RUN]
[0m15:06:07.507101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:06:07.507305 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:07.509166 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:07.509557 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:07.510868 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:07.511391 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:07.511566 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.weekly_revenue_by_os
  
   as (
    
SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m15:06:07.511731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:07.524713 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832ef10>]}
[0m15:06:07.525150 [info ] [Thread-3 (]: 27 of 32 OK created sql view model test_gold_layer.total_customers_overall ..... [[32mSUCCESS 1[0m in 5.23s]
[0m15:06:07.525432 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:06:07.939655 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:07.940781 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m15:06:07.967848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:07.968920 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m15:06:08.026714 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:08.027780 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m15:06:08.063505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e2ac10>]}
[0m15:06:08.063975 [info ] [Thread-2 (]: 31 of 32 OK created sql view model test_gold_layer.weekly_revenue_by_brand ..... [[32mSUCCESS 1[0m in 0.59s]
[0m15:06:08.064271 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:08.093933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e48d10>]}
[0m15:06:08.094372 [info ] [Thread-1 (]: 32 of 32 OK created sql view model test_gold_layer.weekly_revenue_by_os ........ [[32mSUCCESS 1[0m in 0.59s]
[0m15:06:08.094658 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:08.480499 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ec8496-e1e6-495d-8978-86110fb5f6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122dec3d0>]}
[0m15:06:08.481562 [info ] [Thread-4 (]: 30 of 32 OK created sql view model test_gold_layer.total_devices_week_wise ..... [[32mSUCCESS 1[0m in 1.01s]
[0m15:06:08.482330 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:06:08.484058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:08.484469 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:06:08.484777 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:06:08.485058 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_overall' was properly closed.
[0m15:06:08.485323 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m15:06:08.485774 [info ] [MainThread]: 
[0m15:06:08.486121 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m15:06:08.490185 [debug] [MainThread]: Command end result
[0m15:06:08.569053 [info ] [MainThread]: 
[0m15:06:08.569343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:08.569511 [info ] [MainThread]: 
[0m15:06:08.569661 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m15:06:08.571242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.74137, "process_user_time": 3.802522, "process_kernel_time": 1.913691, "process_mem_max_rss": "206880768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:06:08.571580 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:08.571534 after 16.74 seconds
[0m15:06:08.571788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491e790>]}
[0m15:06:08.571970 [debug] [MainThread]: Flushing usage events
[0m15:06:29.692521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ca910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104923d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104939310>]}


============================== 15:06:29.695104 | ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5 ==============================
[0m15:06:29.695104 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:06:29.695414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars {"unit_testing": true}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:30.345047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e75a10>]}
[0m15:06:30.366644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104373290>]}
[0m15:06:30.367238 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:06:30.380924 [debug] [MainThread]: checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4, vars: {'unit_testing': True}, profile: , target: , version: 1.8.1
[0m15:06:30.470413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:30.470659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:30.493838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306f9d50>]}
[0m15:06:30.587326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e0190>]}
[0m15:06:30.587628 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m15:06:30.587802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130526b90>]}
[0m15:06:30.588984 [info ] [MainThread]: 
[0m15:06:30.589270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:30.591775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:06:30.598275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:06:30.598168 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:06:30.599438 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:06:30.599614 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:06:30.599773 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:06:30.599923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:30.600053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:31.237264 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:06:31.242706 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:06:31.249346 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:06:31.252839 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:06:31.400856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:06:31.402144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_test_silver_layer)
[0m15:06:31.403260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_test_gold_layer'
[0m15:06:31.417769 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_silver_layer"
[0m15:06:31.420316 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:06:31.422638 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_test_gold_layer"
[0m15:06:31.423042 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_silver_layer"} */
show objects in PROJECT_SEC2_DB.test_silver_layer limit 10000
[0m15:06:31.423409 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:06:31.423758 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_test_gold_layer"} */
show objects in PROJECT_SEC2_DB.test_gold_layer limit 10000
[0m15:06:31.424098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:31.424389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:31.424674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:31.885906 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:06:31.892063 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_silver_layer: Close
[0m15:06:31.897150 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:06:31.900608 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:06:32.000902 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:06:32.008981 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_test_gold_layer: Close
[0m15:06:32.162832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103138250>]}
[0m15:06:32.164739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:32.165482 [info ] [MainThread]: 
[0m15:06:32.170915 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:06:32.171851 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:06:32.173083 [info ] [Thread-1 (]: 1 of 32 START sql table model test_silver_layer.clean_crm_data ................. [RUN]
[0m15:06:32.174292 [info ] [Thread-2 (]: 2 of 32 START sql table model test_silver_layer.clean_device_data .............. [RUN]
[0m15:06:32.175165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m15:06:32.176683 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:06:32.177450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_silver_layer, now model.my_dbt_project.clean_device_data)
[0m15:06:32.193582 [info ] [Thread-1 (]: import_crm: 
[0m15:06:32.194068 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:06:32.194539 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:06:32.199098 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.SEEDS.input_device
[0m15:06:32.199753 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:06:32.200343 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:06:32.207037 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:06:32.222513 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:06:32.224184 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:06:32.226468 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:06:32.226854 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.SEEDS.input_crm
    WHERE YEAR_OF_BIRTH <= 2023
),

windowed_crm AS (
    SELECT
        *,
        LEAD(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_status,
        LEAD(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_yob,
        LEAD(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_gender,
        LAG(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_status,
        LAG(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_yob,
        LAG(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_gender
    FROM cleaned_crm
),

flagged_crm AS (
    SELECT
        *,
        CASE
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'SUSPEND' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'SUSPEND' AND prev_status = 'ACTIVE' AND YEAR_OF_BIRTH = prev_yob AND GENDER = prev_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'IDLE' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            ELSE 0
        END AS pair_flag
    FROM windowed_crm
),

filtered_crm AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE SYSTEM_STATUS 
                WHEN 'ACTIVE' THEN 1 
                WHEN 'IDLE' THEN 2 
                WHEN 'SUSPEND' THEN 3 
                WHEN 'DEACTIVATE' THEN 4 
                ELSE 5 
            END,
            (CASE WHEN GENDER IS NOT NULL THEN 1 ELSE 0 END + 
            CASE WHEN YEAR_OF_BIRTH IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN SYSTEM_STATUS IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN MOBILE_TYPE IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN VALUE_SEGMENT IS NOT NULL THEN 1 ELSE 0 END) DESC
        ) AS rank
    FROM flagged_crm
    WHERE pair_flag = 0
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM filtered_crm
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:06:32.227211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:32.228130 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:06:32.228648 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.SEEDS.input_device
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_device d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:06:32.229107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:33.214099 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:33.257382 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:06:33.481153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa9050>]}
[0m15:06:33.481864 [info ] [Thread-2 (]: 2 of 32 OK created sql table model test_silver_layer.clean_device_data ......... [[32mSUCCESS 1[0m in 1.30s]
[0m15:06:33.482341 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:06:33.576934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:33.581827 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:06:33.719474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa9050>]}
[0m15:06:33.721737 [info ] [Thread-1 (]: 1 of 32 OK created sql table model test_silver_layer.clean_crm_data ............ [[32mSUCCESS 1[0m in 1.54s]
[0m15:06:33.723314 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:06:33.725458 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:06:33.726270 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:06:33.727699 [info ] [Thread-4 (]: 3 of 32 START sql table model test_silver_layer.crm_device_data ................ [RUN]
[0m15:06:33.728666 [info ] [Thread-3 (]: 4 of 32 START sql table model test_silver_layer.enriched_data .................. [RUN]
[0m15:06:33.729891 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m15:06:33.730749 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_test_gold_layer, now model.my_dbt_project.enriched_data)
[0m15:06:33.731535 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:06:33.732226 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:06:33.741205 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:06:33.748902 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.SEEDS.input_rev
[0m15:06:33.749957 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:06:33.750800 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:06:33.754106 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:06:33.754559 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:06:33.757391 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:06:33.758936 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:06:33.759442 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.crm_device_data
         as
        (
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.test_silver_layer.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:06:33.760928 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:06:33.761300 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:06:33.761812 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.test_silver_layer.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.SEEDS.input_rev AS revenue
    LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.test_silver_layer.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m15:06:33.762387 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:34.993889 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:35.000173 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:06:35.129979 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:35.136325 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m15:06:35.146344 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313c50d0>]}
[0m15:06:35.148780 [info ] [Thread-4 (]: 3 of 32 OK created sql table model test_silver_layer.crm_device_data ........... [[32mSUCCESS 1[0m in 1.42s]
[0m15:06:35.150340 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:06:35.281100 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311e2710>]}
[0m15:06:35.283269 [info ] [Thread-3 (]: 4 of 32 OK created sql table model test_silver_layer.enriched_data ............. [[32mSUCCESS 1[0m in 1.55s]
[0m15:06:35.284793 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:06:35.287877 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:06:35.288706 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:06:35.289593 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:35.290293 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:35.291222 [info ] [Thread-1 (]: 5 of 32 START sql view model test_gold_layer.brand_by_age_segment .............. [RUN]
[0m15:06:35.292191 [info ] [Thread-2 (]: 6 of 32 START sql view model test_gold_layer.customers_by_brand_overall ........ [RUN]
[0m15:06:35.293026 [info ] [Thread-4 (]: 7 of 32 START sql view model test_gold_layer.customers_by_brand_week_wise ...... [RUN]
[0m15:06:35.293786 [info ] [Thread-3 (]: 8 of 32 START sql view model test_gold_layer.customers_by_mobile_type_overall .. [RUN]
[0m15:06:35.294591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.brand_by_age_segment)
[0m15:06:35.295115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.customers_by_brand_overall)
[0m15:06:35.295644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:06:35.296193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m15:06:35.296688 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:06:35.297216 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:06:35.297673 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:35.298800 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:35.304983 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:06:35.309868 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:06:35.313845 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:06:35.317527 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:06:35.318768 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:06:35.319206 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:35.319632 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:06:35.338064 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:06:35.338394 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:35.341753 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:06:35.343730 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m15:06:35.345667 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:06:35.346434 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m15:06:35.346970 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:06:35.347263 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_brand_overall
  
   as (
    
select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m15:06:35.348294 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m15:06:35.348538 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_brand_week_wise
  
   as (
    
select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m15:06:35.348985 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:06:35.349195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:35.349463 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.brand_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m15:06:35.349732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:35.349947 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_mobile_type_overall
  
   as (
    
select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m15:06:35.350368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:35.351523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:35.845536 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:35.847364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:35.854339 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m15:06:35.858499 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m15:06:35.861815 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:35.862948 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:35.871063 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m15:06:35.874388 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m15:06:36.011652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306f6c90>]}
[0m15:06:36.014364 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130714c10>]}
[0m15:06:36.015345 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130753290>]}
[0m15:06:36.013446 [info ] [Thread-1 (]: 5 of 32 OK created sql view model test_gold_layer.brand_by_age_segment ......... [[32mSUCCESS 1[0m in 0.72s]
[0m15:06:36.016562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311a8bd0>]}
[0m15:06:36.017884 [info ] [Thread-4 (]: 7 of 32 OK created sql view model test_gold_layer.customers_by_brand_week_wise . [[32mSUCCESS 1[0m in 0.72s]
[0m15:06:36.019602 [info ] [Thread-3 (]: 8 of 32 OK created sql view model test_gold_layer.customers_by_mobile_type_overall  [[32mSUCCESS 1[0m in 0.72s]
[0m15:06:36.020622 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:06:36.021487 [info ] [Thread-2 (]: 6 of 32 OK created sql view model test_gold_layer.customers_by_brand_overall ... [[32mSUCCESS 1[0m in 0.72s]
[0m15:06:36.022266 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:06:36.022935 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:06:36.023602 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:36.024404 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:06:36.025042 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:06:36.025923 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:36.027019 [info ] [Thread-1 (]: 9 of 32 START sql view model test_gold_layer.customers_by_mobile_type_week_wise  [RUN]
[0m15:06:36.027875 [debug] [Thread-2 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:06:36.028746 [info ] [Thread-4 (]: 10 of 32 START sql view model test_gold_layer.customers_by_os_overall .......... [RUN]
[0m15:06:36.029585 [info ] [Thread-3 (]: 11 of 32 START sql view model test_gold_layer.customers_by_os_week_wise ........ [RUN]
[0m15:06:36.030226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:06:36.030829 [info ] [Thread-2 (]: 12 of 32 START sql view model test_gold_layer.os_by_age_segment ................ [RUN]
[0m15:06:36.031367 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_overall)
[0m15:06:36.031860 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:06:36.032333 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:36.032808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.os_by_age_segment)
[0m15:06:36.033258 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:06:36.033688 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:36.038860 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:06:36.039243 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:06:36.042950 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:06:36.046611 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:06:36.051957 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:06:36.052612 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:36.052990 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:06:36.055725 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:06:36.056100 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:36.058347 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m15:06:36.058680 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:06:36.060901 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:06:36.061689 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:06:36.063823 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m15:06:36.064504 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m15:06:36.064825 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m15:06:36.065488 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m15:06:36.065729 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_os_overall
  
   as (
    
select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by os_name
  );
[0m15:06:36.066020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:36.067069 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m15:06:36.067331 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.customers_by_os_week_wise
  
   as (
    
select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m15:06:36.067578 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:36.068248 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.os_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.test_silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m15:06:36.068789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:36.069915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:36.596217 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:36.602829 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m15:06:36.620341 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:36.622488 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:36.627285 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m15:06:36.630769 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m15:06:36.634209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:36.640705 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m15:06:36.746887 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026326d0>]}
[0m15:06:36.749108 [info ] [Thread-3 (]: 11 of 32 OK created sql view model test_gold_layer.customers_by_os_week_wise ... [[32mSUCCESS 1[0m in 0.71s]
[0m15:06:36.750523 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:06:36.751941 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:06:36.753230 [info ] [Thread-3 (]: 13 of 32 START sql view model test_gold_layer.revenue_by_age_overall ........... [RUN]
[0m15:06:36.754244 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:06:36.754997 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:06:36.764094 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:06:36.765668 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:06:36.771816 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:06:36.773237 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m15:06:36.774397 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_age_overall
  
   as (
    
select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by age
order by age
  );
[0m15:06:36.775908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:36.779210 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316d4f50>]}
[0m15:06:36.780002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316c0c90>]}
[0m15:06:36.780588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316cfcd0>]}
[0m15:06:36.781841 [info ] [Thread-4 (]: 10 of 32 OK created sql view model test_gold_layer.customers_by_os_overall ..... [[32mSUCCESS 1[0m in 0.75s]
[0m15:06:36.782601 [info ] [Thread-1 (]: 9 of 32 OK created sql view model test_gold_layer.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.75s]
[0m15:06:36.783395 [info ] [Thread-2 (]: 12 of 32 OK created sql view model test_gold_layer.os_by_age_segment ........... [[32mSUCCESS 1[0m in 0.75s]
[0m15:06:36.784019 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:06:36.784545 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:06:36.785046 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:06:36.785481 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:36.785964 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:36.786451 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:36.786968 [info ] [Thread-4 (]: 14 of 32 START sql view model test_gold_layer.revenue_by_age_week_wise ......... [RUN]
[0m15:06:36.787496 [info ] [Thread-1 (]: 15 of 32 START sql view model test_gold_layer.revenue_by_brand_overall ......... [RUN]
[0m15:06:36.787981 [info ] [Thread-2 (]: 16 of 32 START sql view model test_gold_layer.revenue_by_brand_week_wise ....... [RUN]
[0m15:06:36.788379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:06:36.788728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:06:36.789080 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:06:36.789400 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:36.789710 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:36.790003 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:36.793535 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:06:36.796598 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:06:36.799277 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:06:36.799900 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:36.800216 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:36.802463 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:06:36.804487 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:06:36.804742 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:36.806815 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:06:36.807479 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:06:36.807789 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_age_week_wise
  
   as (
    
select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m15:06:36.808333 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m15:06:36.808613 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:36.809134 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:06:36.809402 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_brand_overall
  
   as (
    
select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m15:06:36.809773 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_brand_week_wise
  
   as (
    
select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m15:06:36.810432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:36.810951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:37.300079 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:37.303990 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:37.305712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:37.310678 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m15:06:37.314227 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m15:06:37.318268 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m15:06:37.319519 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:37.327944 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m15:06:37.463114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313fb0d0>]}
[0m15:06:37.466691 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313f90d0>]}
[0m15:06:37.465637 [info ] [Thread-1 (]: 15 of 32 OK created sql view model test_gold_layer.revenue_by_brand_overall .... [[32mSUCCESS 1[0m in 0.67s]
[0m15:06:37.469797 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:06:37.468249 [info ] [Thread-2 (]: 16 of 32 OK created sql view model test_gold_layer.revenue_by_brand_week_wise .. [[32mSUCCESS 1[0m in 0.68s]
[0m15:06:37.470993 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:37.472305 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130717b50>]}
[0m15:06:37.473306 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:06:37.474056 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130799cd0>]}
[0m15:06:37.474904 [info ] [Thread-1 (]: 17 of 32 START sql view model test_gold_layer.revenue_by_gender_overall ........ [RUN]
[0m15:06:37.476093 [info ] [Thread-4 (]: 14 of 32 OK created sql view model test_gold_layer.revenue_by_age_week_wise .... [[32mSUCCESS 1[0m in 0.68s]
[0m15:06:37.476907 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:37.477726 [info ] [Thread-3 (]: 13 of 32 OK created sql view model test_gold_layer.revenue_by_age_overall ...... [[32mSUCCESS 1[0m in 0.72s]
[0m15:06:37.478388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:06:37.479145 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:06:37.479734 [info ] [Thread-2 (]: 18 of 32 START sql view model test_gold_layer.revenue_by_gender_week_wise ...... [RUN]
[0m15:06:37.480433 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:06:37.481073 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:37.481982 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:37.482810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:06:37.483629 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:37.486256 [info ] [Thread-4 (]: 19 of 32 START sql view model test_gold_layer.revenue_by_mobile_type_overall ... [RUN]
[0m15:06:37.490112 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:06:37.490663 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:37.491249 [info ] [Thread-3 (]: 20 of 32 START sql view model test_gold_layer.revenue_by_mobile_type_week_wise . [RUN]
[0m15:06:37.491822 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:06:37.498029 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:06:37.498576 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:06:37.499026 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:37.499396 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:37.499839 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:37.502991 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:06:37.505751 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:06:37.506095 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:37.509287 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:06:37.512070 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:06:37.512968 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m15:06:37.513276 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:37.513619 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_gender_overall
  
   as (
    
select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m15:06:37.515847 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:06:37.516143 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:37.516740 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:06:37.517042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:37.519180 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:06:37.519551 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_gender_week_wise
  
   as (
    
select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m15:06:37.520122 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:06:37.521204 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:37.521542 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_mobile_type_overall
  
   as (
    
select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m15:06:37.522078 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:06:37.522525 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:37.523476 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m15:06:37.524667 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:38.036077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:38.042961 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m15:06:38.048332 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:38.050538 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:38.054301 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m15:06:38.057352 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m15:06:38.063872 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:38.066454 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m15:06:38.188744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131672410>]}
[0m15:06:38.191432 [info ] [Thread-1 (]: 17 of 32 OK created sql view model test_gold_layer.revenue_by_gender_overall ... [[32mSUCCESS 1[0m in 0.71s]
[0m15:06:38.193248 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:06:38.194560 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:06:38.195754 [info ] [Thread-1 (]: 21 of 32 START sql view model test_gold_layer.revenue_by_os_overall ............ [RUN]
[0m15:06:38.196845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m15:06:38.197628 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:06:38.206431 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:38.208117 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:06:38.214618 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:38.217240 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m15:06:38.217906 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_overall
  
   as (
    
select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m15:06:38.218562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:38.220436 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130716050>]}
[0m15:06:38.220996 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313f0850>]}
[0m15:06:38.221513 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316e7c50>]}
[0m15:06:38.222242 [info ] [Thread-4 (]: 19 of 32 OK created sql view model test_gold_layer.revenue_by_mobile_type_overall  [[32mSUCCESS 1[0m in 0.73s]
[0m15:06:38.223004 [info ] [Thread-2 (]: 18 of 32 OK created sql view model test_gold_layer.revenue_by_gender_week_wise . [[32mSUCCESS 1[0m in 0.74s]
[0m15:06:38.224183 [info ] [Thread-3 (]: 20 of 32 OK created sql view model test_gold_layer.revenue_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.72s]
[0m15:06:38.224844 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:06:38.225469 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:06:38.226001 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:06:38.226434 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:38.226892 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:38.227362 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:38.227896 [info ] [Thread-4 (]: 22 of 32 START sql view model test_gold_layer.revenue_by_os_vendor_overall ..... [RUN]
[0m15:06:38.228432 [info ] [Thread-2 (]: 23 of 32 START sql view model test_gold_layer.revenue_by_os_vendor_week_wise ... [RUN]
[0m15:06:38.228990 [info ] [Thread-3 (]: 24 of 32 START sql view model test_gold_layer.revenue_by_os_week_wise .......... [RUN]
[0m15:06:38.229506 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:06:38.229964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:06:38.230392 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:06:38.230767 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:38.231087 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:38.231387 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:38.234931 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:38.238120 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:38.240836 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:38.241513 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:38.241805 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:38.242093 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:38.244222 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:38.246253 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:38.248134 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:38.248991 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:06:38.249563 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:06:38.249848 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_vendor_week_wise
  
   as (
    
select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m15:06:38.250389 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:06:38.250670 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_vendor_overall
  
   as (
    
select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m15:06:38.250952 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:38.251223 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_os_week_wise
  
   as (
    
select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m15:06:38.251484 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:38.252140 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:38.695739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:38.702929 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m15:06:38.739089 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:38.745345 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m15:06:38.749826 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:06:38.754308 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m15:06:38.806808 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:38.813229 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m15:06:38.832055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306f6c90>]}
[0m15:06:38.833340 [info ] [Thread-1 (]: 21 of 32 OK created sql view model test_gold_layer.revenue_by_os_overall ....... [[32mSUCCESS 1[0m in 0.64s]
[0m15:06:38.834324 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:06:38.835051 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:38.835832 [info ] [Thread-1 (]: 25 of 32 START sql view model test_gold_layer.revenue_by_value_segment_overall . [RUN]
[0m15:06:38.836499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:06:38.837018 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:38.842485 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:38.843511 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:38.849476 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:38.850606 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:06:38.851045 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_value_segment_overall
  
   as (
    
select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m15:06:38.851464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:38.889949 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131616590>]}
[0m15:06:38.890898 [info ] [Thread-4 (]: 22 of 32 OK created sql view model test_gold_layer.revenue_by_os_vendor_overall  [[32mSUCCESS 1[0m in 0.66s]
[0m15:06:38.891700 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:06:38.892579 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:38.893262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311e0110>]}
[0m15:06:38.893821 [info ] [Thread-4 (]: 26 of 32 START sql view model test_gold_layer.revenue_by_value_segment_week_wise  [RUN]
[0m15:06:38.895266 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:06:38.895889 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:38.900073 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:38.901609 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:38.904559 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:38.905648 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:06:38.906058 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.revenue_by_value_segment_week_wise
  
   as (
    
select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.test_silver_layer.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m15:06:38.906585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:38.945985 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313a2950>]}
[0m15:06:39.390972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:39.393764 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m15:06:39.620001 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:39.626517 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m15:06:39.672787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313a3810>]}
[0m15:06:39.770101 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311c5250>]}
[0m15:06:40.149724 [info ] [Thread-2 (]: 23 of 32 OK created sql view model test_gold_layer.revenue_by_os_vendor_week_wise  [[32mSUCCESS 1[0m in 0.66s]
[0m15:06:40.151260 [info ] [Thread-3 (]: 24 of 32 OK created sql view model test_gold_layer.revenue_by_os_week_wise ..... [[32mSUCCESS 1[0m in 0.72s]
[0m15:06:40.152865 [info ] [Thread-1 (]: 25 of 32 OK created sql view model test_gold_layer.revenue_by_value_segment_overall  [[32mSUCCESS 1[0m in 0.84s]
[0m15:06:40.155952 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:06:40.153978 [info ] [Thread-4 (]: 26 of 32 OK created sql view model test_gold_layer.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.87s]
[0m15:06:40.157259 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:06:40.158284 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:06:40.159564 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:06:40.160955 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:06:40.161805 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:06:40.162712 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:06:40.163752 [info ] [Thread-2 (]: 27 of 32 START sql view model test_gold_layer.total_customers_overall .......... [RUN]
[0m15:06:40.164502 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:06:40.165221 [info ] [Thread-3 (]: 28 of 32 START sql view model test_gold_layer.total_customers_week_wise ........ [RUN]
[0m15:06:40.166023 [info ] [Thread-1 (]: 29 of 32 START sql view model test_gold_layer.total_devices_overall ............ [RUN]
[0m15:06:40.167509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m15:06:40.168484 [info ] [Thread-4 (]: 30 of 32 START sql view model test_gold_layer.total_devices_week_wise .......... [RUN]
[0m15:06:40.169160 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m15:06:40.169687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m15:06:40.170226 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:06:40.170750 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m15:06:40.171224 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:06:40.171693 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:06:40.178881 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:06:40.179430 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:06:40.184052 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:06:40.188063 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:06:40.192424 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:06:40.193152 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:06:40.196473 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m15:06:40.196883 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:06:40.197307 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:06:40.197648 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:06:40.200280 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m15:06:40.202700 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m15:06:40.203639 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m15:06:40.206983 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m15:06:40.207584 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_customers_overall
  
   as (
    
with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m15:06:40.208741 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m15:06:40.209674 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m15:06:40.209995 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:40.210351 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_customers_week_wise
  
   as (
    
with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m15:06:40.211358 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m15:06:40.211657 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_devices_overall
  
   as (
    
with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.test_silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m15:06:40.212218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:06:40.213040 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.total_devices_week_wise
  
   as (
    
with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.test_silver_layer.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m15:06:40.213397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:40.214040 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:06:40.763414 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:40.769239 [debug] [Thread-2 (]: On model.my_dbt_project.total_customers_overall: Close
[0m15:06:40.795008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:40.800059 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: Close
[0m15:06:40.807866 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:40.812101 [debug] [Thread-4 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m15:06:40.850117 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:40.855130 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m15:06:40.906288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ca32d0>]}
[0m15:06:40.908570 [info ] [Thread-2 (]: 27 of 32 OK created sql view model test_gold_layer.total_customers_overall ..... [[32mSUCCESS 1[0m in 0.74s]
[0m15:06:40.910029 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:06:40.910934 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:40.911845 [info ] [Thread-2 (]: 31 of 32 START sql view model test_gold_layer.weekly_revenue_by_brand .......... [RUN]
[0m15:06:40.912657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:06:40.913312 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:40.921901 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:40.924396 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:40.928278 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:40.930403 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:06:40.930909 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.weekly_revenue_by_brand
  
   as (
    
SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m15:06:40.931399 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:40.937824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13070fb10>]}
[0m15:06:40.938625 [info ] [Thread-1 (]: 29 of 32 OK created sql view model test_gold_layer.total_devices_overall ....... [[32mSUCCESS 1[0m in 0.77s]
[0m15:06:40.939707 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:06:40.940187 [debug] [Thread-1 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:40.940743 [info ] [Thread-1 (]: 32 of 32 START sql view model test_gold_layer.weekly_revenue_by_os ............. [RUN]
[0m15:06:40.941296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:06:40.941862 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316d4310>]}
[0m15:06:40.942281 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:40.942882 [info ] [Thread-4 (]: 30 of 32 OK created sql view model test_gold_layer.total_devices_week_wise ..... [[32mSUCCESS 1[0m in 0.77s]
[0m15:06:40.946916 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:40.947524 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:06:40.948330 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:40.951325 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:40.952278 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m15:06:40.952664 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.test_gold_layer.weekly_revenue_by_os
  
   as (
    
SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.test_silver_layer.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m15:06:40.953017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:40.999944 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313cf0d0>]}
[0m15:06:41.000605 [info ] [Thread-3 (]: 28 of 32 OK created sql view model test_gold_layer.total_customers_week_wise ... [[32mSUCCESS 1[0m in 0.83s]
[0m15:06:41.001120 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:06:41.462032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:41.464899 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:41.470662 [debug] [Thread-1 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m15:06:41.474360 [debug] [Thread-2 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m15:06:41.622483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131397710>]}
[0m15:06:41.623893 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a5632-dd8b-4b20-a1ea-5c80cd9ea2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c823d0>]}
[0m15:06:41.625884 [info ] [Thread-1 (]: 32 of 32 OK created sql view model test_gold_layer.weekly_revenue_by_os ........ [[32mSUCCESS 1[0m in 0.68s]
[0m15:06:41.627356 [info ] [Thread-2 (]: 31 of 32 OK created sql view model test_gold_layer.weekly_revenue_by_brand ..... [[32mSUCCESS 1[0m in 0.71s]
[0m15:06:41.628634 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:06:41.629656 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:06:41.632560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:41.633182 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:06:41.633626 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:06:41.634003 [debug] [MainThread]: Connection 'model.my_dbt_project.total_customers_week_wise' was properly closed.
[0m15:06:41.634353 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m15:06:41.635231 [info ] [MainThread]: 
[0m15:06:41.635756 [info ] [MainThread]: Finished running 4 table models, 28 view models in 0 hours 0 minutes and 11.05 seconds (11.05s).
[0m15:06:41.642234 [debug] [MainThread]: Command end result
[0m15:06:41.678997 [info ] [MainThread]: 
[0m15:06:41.679392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:41.679655 [info ] [MainThread]: 
[0m15:06:41.679890 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m15:06:41.681930 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.018331, "process_user_time": 4.764144, "process_kernel_time": 2.002861, "process_mem_max_rss": "200540160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:06:41.682324 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:41.682267 after 12.02 seconds
[0m15:06:41.682607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014f86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101426310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10145e810>]}
[0m15:06:41.682869 [debug] [MainThread]: Flushing usage events
[0m15:06:46.820714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f61650>]}


============================== 15:06:46.823171 | 745c4db1-7803-4765-aca7-be0aeed40810 ==============================
[0m15:06:46.823171 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:06:46.823474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models silver', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:47.450422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f41990>]}
[0m15:06:47.471942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bf350>]}
[0m15:06:47.473197 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:06:47.486582 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:06:47.552085 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:06:47.552557 [debug] [MainThread]: previous checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, current checksum: 5bab37f7c628cc2c85663f7d6f82181d69fffb29aede7b4bb4e34e961ba5a4a4
[0m15:06:47.552770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288d35d0>]}
[0m15:06:47.961482 [info ] [MainThread]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.enriched_data
[0m15:06:47.969288 [info ] [MainThread]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.clean_device_data
[0m15:06:47.975139 [info ] [MainThread]: import_crm: 
[0m15:06:48.112078 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:06:48.112380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128baea90>]}
[0m15:06:48.234928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128c07ad0>]}
[0m15:06:48.288428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a59490>]}
[0m15:06:48.288728 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m15:06:48.288897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ab8250>]}
[0m15:06:48.289682 [info ] [MainThread]: 
[0m15:06:48.289933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:48.291836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:06:48.297462 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:06:48.297631 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:06:48.297780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:48.789564 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m15:06:48.795605 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:06:48.948201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_SEEDS)
[0m15:06:48.950765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m15:06:48.952168 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m15:06:48.973785 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m15:06:48.975755 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:06:48.978119 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m15:06:48.978589 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m15:06:48.978992 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:06:48.979353 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m15:06:48.979670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:48.979977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:48.980270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:49.449346 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:06:49.450802 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:06:49.524450 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:06:49.526584 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m15:06:49.551959 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:06:49.555974 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m15:06:50.437746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e41c10>]}
[0m15:06:50.439439 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:50.440156 [info ] [MainThread]: 
[0m15:06:50.445580 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m15:06:50.446357 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m15:06:50.447428 [info ] [Thread-1 (]: 1 of 4 START sql table model silver_layer.clean_crm_data ....................... [RUN]
[0m15:06:50.448171 [info ] [Thread-2 (]: 2 of 4 START sql table model silver_layer.clean_device_data .................... [RUN]
[0m15:06:50.448935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.clean_crm_data)
[0m15:06:50.452206 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m15:06:50.454331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now model.my_dbt_project.clean_device_data)
[0m15:06:50.466896 [info ] [Thread-1 (]: import_crm: 
[0m15:06:50.467415 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m15:06:50.467863 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m15:06:50.472800 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
[0m15:06:50.473559 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m15:06:50.474264 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m15:06:50.480529 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m15:06:50.504848 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.clean_device_data"
[0m15:06:50.507155 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.clean_crm_data"
[0m15:06:50.508404 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.clean_device_data"
[0m15:06:50.510436 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.clean_crm_data"
[0m15:06:50.510708 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_device_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.clean_device_data
         as
        (-- models/marts/clean_device_data.sql
WITH non_null_device AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        COUNT(*) AS count
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
    WHERE OS_NAME IS NOT NULL AND OS_VENDOR IS NOT NULL
    GROUP BY BRAND_NAME, OS_NAME, OS_VENDOR
),

ranked_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME,
        OS_VENDOR,
        ROW_NUMBER() OVER (PARTITION BY BRAND_NAME ORDER BY count DESC) AS rank
    FROM non_null_device
),

most_frequent_os AS (
    SELECT
        BRAND_NAME,
        OS_NAME AS most_frequent_os_name,
        OS_VENDOR AS most_frequent_os_vendor
    FROM ranked_os
    WHERE rank = 1
),

device_with_os AS (
    SELECT
        d.IMEI_TAC,
        d.MODEL_NAME,
        d.MSISDN,
        d.BRAND_NAME,
        COALESCE(d.OS_NAME, mfo.most_frequent_os_name) AS OS_NAME,
        COALESCE(d.OS_VENDOR, mfo.most_frequent_os_vendor) AS OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE d
    LEFT JOIN most_frequent_os mfo ON d.BRAND_NAME = mfo.BRAND_NAME
)

SELECT
    MSISDN,
    IMEI_TAC,
    MODEL_NAME,
    BRAND_NAME,
    OS_NAME,
    OS_VENDOR
FROM device_with_os
        );
[0m15:06:50.511105 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.clean_crm_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.clean_crm_data
         as
        (-- models/marts/clean_crm_data.sql






WITH cleaned_crm AS (
    SELECT
        MSISDN,
        CASE
            WHEN LOWER(GENDER) LIKE 'f%' THEN 'Female'
            WHEN LOWER(GENDER) LIKE 'm%' THEN 'Male'
            ELSE 'Not Available'
        END AS GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.CRM
    WHERE YEAR_OF_BIRTH <= 2023
),

windowed_crm AS (
    SELECT
        *,
        LEAD(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_status,
        LEAD(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_yob,
        LEAD(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS next_gender,
        LAG(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_status,
        LAG(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_yob,
        LAG(GENDER) OVER (PARTITION BY MSISDN ORDER BY YEAR_OF_BIRTH, GENDER, MOBILE_TYPE, SYSTEM_STATUS, VALUE_SEGMENT) AS prev_gender
    FROM cleaned_crm
),

flagged_crm AS (
    SELECT
        *,
        CASE
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'SUSPEND' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'SUSPEND' AND prev_status = 'ACTIVE' AND YEAR_OF_BIRTH = prev_yob AND GENDER = prev_gender) THEN 1
            WHEN (SYSTEM_STATUS = 'ACTIVE' AND next_status = 'IDLE' AND YEAR_OF_BIRTH = next_yob AND GENDER = next_gender) THEN 1
            ELSE 0
        END AS pair_flag
    FROM windowed_crm
),

filtered_crm AS (
    SELECT
        MSISDN,
        GENDER,
        YEAR_OF_BIRTH,
        SYSTEM_STATUS,
        MOBILE_TYPE,
        VALUE_SEGMENT,
        ROW_NUMBER() OVER (PARTITION BY MSISDN ORDER BY 
            CASE SYSTEM_STATUS 
                WHEN 'ACTIVE' THEN 1 
                WHEN 'IDLE' THEN 2 
                WHEN 'SUSPEND' THEN 3 
                WHEN 'DEACTIVATE' THEN 4 
                ELSE 5 
            END,
            (CASE WHEN GENDER IS NOT NULL THEN 1 ELSE 0 END + 
            CASE WHEN YEAR_OF_BIRTH IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN SYSTEM_STATUS IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN MOBILE_TYPE IS NOT NULL THEN 1 ELSE 0 END +
            CASE WHEN VALUE_SEGMENT IS NOT NULL THEN 1 ELSE 0 END) DESC
        ) AS rank
    FROM flagged_crm
    WHERE pair_flag = 0
),

crm_final AS (
    SELECT
        MSISDN,
        FIRST_VALUE(GENDER) OVER (PARTITION BY MSISDN ORDER BY rank) AS GENDER,
        FIRST_VALUE(YEAR_OF_BIRTH) OVER (PARTITION BY MSISDN ORDER BY rank) AS YEAR_OF_BIRTH,
        FIRST_VALUE(SYSTEM_STATUS) OVER (PARTITION BY MSISDN ORDER BY rank) AS SYSTEM_STATUS,
        FIRST_VALUE(MOBILE_TYPE) OVER (PARTITION BY MSISDN ORDER BY rank) AS MOBILE_TYPE,
        FIRST_VALUE(VALUE_SEGMENT) OVER (PARTITION BY MSISDN ORDER BY rank) AS VALUE_SEGMENT
    FROM filtered_crm
    WHERE rank = 1
)

SELECT DISTINCT
    MSISDN,
    GENDER,
    YEAR_OF_BIRTH,
    SYSTEM_STATUS,
    MOBILE_TYPE,
    VALUE_SEGMENT
FROM crm_final
        );
[0m15:06:50.511426 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:50.511623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:57.937161 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m15:06:57.977711 [debug] [Thread-2 (]: On model.my_dbt_project.clean_device_data: Close
[0m15:06:58.119294 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129816f10>]}
[0m15:06:58.121136 [info ] [Thread-2 (]: 2 of 4 OK created sql table model silver_layer.clean_device_data ............... [[32mSUCCESS 1[0m in 7.67s]
[0m15:06:58.122372 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m15:07:15.959111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 25.0 seconds
[0m15:07:15.966255 [debug] [Thread-1 (]: On model.my_dbt_project.clean_crm_data: Close
[0m15:07:16.160719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12980b4d0>]}
[0m15:07:16.162913 [info ] [Thread-1 (]: 1 of 4 OK created sql table model silver_layer.clean_crm_data .................. [[32mSUCCESS 1[0m in 25.71s]
[0m15:07:16.164111 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m15:07:16.165897 [debug] [Thread-4 (]: Began running node model.my_dbt_project.crm_device_data
[0m15:07:16.168156 [debug] [Thread-3 (]: Began running node model.my_dbt_project.enriched_data
[0m15:07:16.167221 [info ] [Thread-4 (]: 3 of 4 START sql table model silver_layer.crm_device_data ...................... [RUN]
[0m15:07:16.169198 [info ] [Thread-3 (]: 4 of 4 START sql table model silver_layer.enriched_data ........................ [RUN]
[0m15:07:16.170141 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.crm_device_data'
[0m15:07:16.170874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now model.my_dbt_project.enriched_data)
[0m15:07:16.171490 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m15:07:16.171981 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.enriched_data
[0m15:07:16.180482 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m15:07:16.187137 [info ] [Thread-3 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m15:07:16.188050 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m15:07:16.188767 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.crm_device_data
[0m15:07:16.193554 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.crm_device_data"
[0m15:07:16.193984 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.enriched_data
[0m15:07:16.196567 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.enriched_data"
[0m15:07:16.197895 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.crm_device_data"
[0m15:07:16.198374 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.crm_device_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.crm_device_data
         as
        (
-- Create first table with left join of CRM and Device
WITH crm AS (
    SELECT MSISDN, GENDER, YEAR_OF_BIRTH, SYSTEM_STATUS, MOBILE_TYPE, VALUE_SEGMENT 
    FROM PROJECT_SEC2_DB.silver_layer.clean_crm_data
),
device AS (
    SELECT MSISDN, IMEI_TAC, BRAND_NAME, MODEL_NAME, OS_NAME, OS_VENDOR 
    FROM PROJECT_SEC2_DB.silver_layer.clean_device_data
)
SELECT
    crm.MSISDN,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT,
    device.IMEI_TAC,
    device.BRAND_NAME,
    device.MODEL_NAME,
    device.OS_NAME,
    device.OS_VENDOR
FROM crm
LEFT JOIN device ON crm.MSISDN = device.MSISDN
        );
[0m15:07:16.199637 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.enriched_data"
[0m15:07:16.199971 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:07:16.200366 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.enriched_data"} */
create or replace transient table PROJECT_SEC2_DB.silver_layer.enriched_data
         as
        (

WITH revenue_device AS (
    SELECT 
        revenue.MSISDN,
        revenue.WEEK_NUMBER,
        revenue.REVENUE_USD,
        device.IMEI_TAC,
        device.BRAND_NAME,
        device.MODEL_NAME,
        device.OS_NAME,
        device.OS_VENDOR
    FROM PROJECT_SEC2_DB.BRONZE_LAYER.REV AS revenue
    LEFT JOIN PROJECT_SEC2_DB.silver_layer.clean_device_data AS device
    ON revenue.MSISDN = device.MSISDN
)
SELECT 
    rd.MSISDN,
    rd.WEEK_NUMBER,
    rd.REVENUE_USD as REVENUE,
    rd.IMEI_TAC,
    rd.BRAND_NAME,
    rd.MODEL_NAME,
    rd.OS_NAME,
    rd.OS_VENDOR,
    crm.GENDER,
    crm.YEAR_OF_BIRTH,
    crm.SYSTEM_STATUS,
    crm.MOBILE_TYPE,
    crm.VALUE_SEGMENT
FROM revenue_device AS rd
LEFT JOIN PROJECT_SEC2_DB.silver_layer.clean_crm_data AS crm
ON rd.MSISDN = crm.MSISDN
        );
[0m15:07:16.201489 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:23.130551 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m15:07:23.137155 [debug] [Thread-3 (]: On model.my_dbt_project.enriched_data: Close
[0m15:07:23.280796 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1299d6fd0>]}
[0m15:07:23.282894 [info ] [Thread-3 (]: 4 of 4 OK created sql table model silver_layer.enriched_data ................... [[32mSUCCESS 1[0m in 7.11s]
[0m15:07:23.284665 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.enriched_data
[0m15:07:26.054453 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 10.0 seconds
[0m15:07:26.060885 [debug] [Thread-4 (]: On model.my_dbt_project.crm_device_data: Close
[0m15:07:26.206724 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '745c4db1-7803-4765-aca7-be0aeed40810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129954050>]}
[0m15:07:26.208966 [info ] [Thread-4 (]: 3 of 4 OK created sql table model silver_layer.crm_device_data ................. [[32mSUCCESS 1[0m in 10.04s]
[0m15:07:26.210610 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.crm_device_data
[0m15:07:26.213556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:26.214120 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_crm_data' was properly closed.
[0m15:07:26.214555 [debug] [MainThread]: Connection 'model.my_dbt_project.clean_device_data' was properly closed.
[0m15:07:26.214989 [debug] [MainThread]: Connection 'model.my_dbt_project.enriched_data' was properly closed.
[0m15:07:26.215438 [debug] [MainThread]: Connection 'model.my_dbt_project.crm_device_data' was properly closed.
[0m15:07:26.216410 [info ] [MainThread]: 
[0m15:07:26.216990 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 37.93 seconds (37.93s).
[0m15:07:26.218548 [debug] [MainThread]: Command end result
[0m15:07:26.301798 [info ] [MainThread]: 
[0m15:07:26.302085 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:26.302239 [info ] [MainThread]: 
[0m15:07:26.302388 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:07:26.303762 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 39.510014, "process_user_time": 3.050427, "process_kernel_time": 1.765329, "process_mem_max_rss": "203948032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:26.304018 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:26.303980 after 39.51 seconds
[0m15:07:26.304194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b44750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a72310>]}
[0m15:07:26.304354 [debug] [MainThread]: Flushing usage events
[0m15:07:30.895004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c58990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c590d0>]}


============================== 15:07:30.897613 | 070c1849-8413-42b0-b05e-17b9165c4639 ==============================
[0m15:07:30.897613 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:07:30.897928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:07:31.534717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c40350>]}
[0m15:07:31.556110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104693290>]}
[0m15:07:31.556768 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:07:31.570365 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:07:31.658801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:31.659060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:31.681906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee32a50>]}
[0m15:07:31.774739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e29cc50>]}
[0m15:07:31.775054 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m15:07:31.775232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503d710>]}
[0m15:07:31.776390 [info ] [MainThread]: 
[0m15:07:31.776671 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:07:31.779169 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB'
[0m15:07:31.785518 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB"
[0m15:07:31.785712 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB"} */
show terse schemas in database PROJECT_SEC2_DB
    limit 10000
[0m15:07:31.785862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:32.321490 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:07:32.326919 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB: Close
[0m15:07:32.527198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB, now list_PROJECT_SEC2_DB_silver_layer)
[0m15:07:32.528714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m15:07:32.529759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m15:07:32.550426 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m15:07:32.553695 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m15:07:32.556125 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m15:07:32.556532 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m15:07:32.556893 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m15:07:32.557260 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m15:07:32.557577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:32.557868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:32.558165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:33.103691 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:07:33.112339 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:07:33.110923 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m15:07:33.116092 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m15:07:33.247809 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m15:07:33.256606 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m15:07:33.413179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eaeff50>]}
[0m15:07:33.415013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:33.415603 [info ] [MainThread]: 
[0m15:07:33.422431 [debug] [Thread-1 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m15:07:33.423221 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m15:07:33.424553 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:07:33.425356 [info ] [Thread-1 (]: 1 of 28 START sql view model gold_layer.brand_by_age_segment ................... [RUN]
[0m15:07:33.425971 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:07:33.426703 [info ] [Thread-2 (]: 2 of 28 START sql view model gold_layer.customers_by_brand_overall ............. [RUN]
[0m15:07:33.427436 [info ] [Thread-3 (]: 3 of 28 START sql view model gold_layer.customers_by_brand_week_wise ........... [RUN]
[0m15:07:33.428196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now model.my_dbt_project.brand_by_age_segment)
[0m15:07:33.428862 [info ] [Thread-4 (]: 4 of 28 START sql view model gold_layer.customers_by_mobile_type_overall ....... [RUN]
[0m15:07:33.429491 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now model.my_dbt_project.customers_by_brand_overall)
[0m15:07:33.430005 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now model.my_dbt_project.customers_by_brand_week_wise)
[0m15:07:33.430511 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m15:07:33.431118 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.my_dbt_project.customers_by_mobile_type_overall'
[0m15:07:33.431587 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m15:07:33.432050 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m15:07:33.443800 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m15:07:33.444290 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:07:33.447632 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:07:33.450748 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:07:33.454026 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:07:33.454655 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m15:07:33.461434 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m15:07:33.461675 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m15:07:33.473959 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:07:33.475063 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.brand_by_age_segment"
[0m15:07:33.476785 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_overall"
[0m15:07:33.478325 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:07:33.479854 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:07:33.481925 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.brand_by_age_segment"
[0m15:07:33.482337 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_overall"
[0m15:07:33.482762 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_brand_week_wise"
[0m15:07:33.483020 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.brand_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.brand_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.brand_name,
    COUNT(*) AS brand_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE brand_name is not null
GROUP BY age_range, ed.brand_name
ORDER BY age_range, ed.brand_name
  );
[0m15:07:33.483289 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_brand_overall
  
   as (
    
select brand_name, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where brand_name is not null
group by brand_name
order by total_customers desc
  );
[0m15:07:33.483674 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_overall"
[0m15:07:33.483880 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_brand_week_wise
  
   as (
    
select week_number, brand_name ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where brand_name is not null
group by week_number , brand_name
order by week_number , total_customers desc
  );
[0m15:07:33.484091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:33.484287 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:33.484486 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_mobile_type_overall
  
   as (
    
select mobile_type, count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where mobile_type is not null
group by mobile_type
order by total_customers desc
  );
[0m15:07:33.484669 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:33.485682 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:07:34.029128 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:34.041394 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_brand_week_wise: Close
[0m15:07:34.041973 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:34.043406 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_mobile_type_overall: Close
[0m15:07:34.048254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:34.049126 [debug] [Thread-1 (]: On model.my_dbt_project.brand_by_age_segment: Close
[0m15:07:34.052466 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:34.053330 [debug] [Thread-2 (]: On model.my_dbt_project.customers_by_brand_overall: Close
[0m15:07:34.179795 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f394750>]}
[0m15:07:34.180659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0bd050>]}
[0m15:07:34.181284 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11edf5e10>]}
[0m15:07:34.182407 [info ] [Thread-3 (]: 3 of 28 OK created sql view model gold_layer.customers_by_brand_week_wise ...... [[32mSUCCESS 1[0m in 0.75s]
[0m15:07:34.183180 [info ] [Thread-1 (]: 1 of 28 OK created sql view model gold_layer.brand_by_age_segment .............. [[32mSUCCESS 1[0m in 0.75s]
[0m15:07:34.183888 [info ] [Thread-4 (]: 4 of 28 OK created sql view model gold_layer.customers_by_mobile_type_overall .. [[32mSUCCESS 1[0m in 0.75s]
[0m15:07:34.184612 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m15:07:34.185165 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3eaa90>]}
[0m15:07:34.185716 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m15:07:34.186282 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m15:07:34.186751 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:07:34.187401 [info ] [Thread-2 (]: 2 of 28 OK created sql view model gold_layer.customers_by_brand_overall ........ [[32mSUCCESS 1[0m in 0.76s]
[0m15:07:34.187898 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m15:07:34.188363 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m15:07:34.188911 [info ] [Thread-3 (]: 5 of 28 START sql view model gold_layer.customers_by_mobile_type_week_wise ..... [RUN]
[0m15:07:34.189431 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m15:07:34.189823 [info ] [Thread-1 (]: 6 of 28 START sql view model gold_layer.customers_by_os_overall ................ [RUN]
[0m15:07:34.190220 [info ] [Thread-4 (]: 7 of 28 START sql view model gold_layer.customers_by_os_week_wise .............. [RUN]
[0m15:07:34.190621 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m15:07:34.191010 [debug] [Thread-2 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m15:07:34.191387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_os_overall)
[0m15:07:34.191735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.customers_by_os_week_wise)
[0m15:07:34.192072 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:07:34.192477 [info ] [Thread-2 (]: 8 of 28 START sql view model gold_layer.os_by_age_segment ...................... [RUN]
[0m15:07:34.192820 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m15:07:34.193120 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m15:07:34.196903 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:07:34.197275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.os_by_age_segment)
[0m15:07:34.200043 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m15:07:34.202746 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:07:34.203143 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m15:07:34.206158 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m15:07:34.206457 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:07:34.206738 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m15:07:34.208929 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:07:34.210914 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_overall"
[0m15:07:34.211158 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m15:07:34.211406 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m15:07:34.214061 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.customers_by_os_week_wise"
[0m15:07:34.215794 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.os_by_age_segment"
[0m15:07:34.216314 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m15:07:34.216750 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_overall"
[0m15:07:34.217154 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type ,count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where mobile_type is not null
group by week_number , mobile_type
order by week_number , total_customers desc
  );
[0m15:07:34.217698 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.customers_by_os_week_wise"
[0m15:07:34.217919 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_os_overall
  
   as (
    
select os_name, count(distinct msisdn) as total_customers_by_os_name
from PROJECT_SEC2_DB.silver_layer.enriched_data
where os_name is not null
group by os_name
  );
[0m15:07:34.218949 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.os_by_age_segment"
[0m15:07:34.219179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:34.219427 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customers_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.customers_by_os_week_wise
  
   as (
    
select week_number , os_name , count(distinct msisdn) as total_customers
from PROJECT_SEC2_DB.silver_layer.enriched_data
where os_name is not null
group by week_number , os_name
order by week_number , os_name
  );
[0m15:07:34.219672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:34.219958 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.os_by_age_segment"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.os_by_age_segment
  
   as (
    
WITH AgeSegments AS (
    SELECT 
        msisdn,
        FLOOR((YEAR(CURRENT_DATE) - year_of_birth) / 10) * 10 AS age_segment
    FROM PROJECT_SEC2_DB.silver_layer.enriched_data
)
SELECT 
    CASE 
        WHEN age_segment >=  0 AND age_segment < 10 THEN '0-9'
        WHEN age_segment >= 10 AND age_segment < 20 THEN '10-19'
        WHEN age_segment >= 20 AND age_segment < 30 THEN '20-29'
        WHEN age_segment >= 30 AND age_segment < 40 THEN '30-39'
        WHEN age_segment >= 40 AND age_segment < 50 THEN '40-49'
        WHEN age_segment >= 50 AND age_segment < 60 THEN '50-59'
        WHEN age_segment >= 60 AND age_segment < 70 THEN '60-69'
        WHEN age_segment >= 70 AND age_segment < 80 THEN '70-79'
        WHEN age_segment >= 80 AND age_segment < 90 THEN '80-89'
        WHEN age_segment >= 90 AND age_segment < 100 THEN '90-99'
        WHEN age_segment >= 100 THEN '>=100'
        ELSE 'Unknown'
    END AS age_range,
    ed.os_name,
    COUNT(*) AS os_count
FROM AgeSegments AS a
JOIN PROJECT_SEC2_DB.silver_layer.enriched_data AS ed ON a.msisdn = ed.msisdn
WHERE os_name is not null
GROUP BY age_range, ed.os_name
ORDER BY age_range, ed.os_name
  );
[0m15:07:34.220473 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:07:34.221420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:34.761714 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:34.768275 [debug] [Thread-3 (]: On model.my_dbt_project.customers_by_mobile_type_week_wise: Close
[0m15:07:34.773934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:34.778654 [debug] [Thread-1 (]: On model.my_dbt_project.customers_by_os_overall: Close
[0m15:07:34.829327 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:34.835902 [debug] [Thread-2 (]: On model.my_dbt_project.os_by_age_segment: Close
[0m15:07:34.875639 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:34.881150 [debug] [Thread-4 (]: On model.my_dbt_project.customers_by_os_week_wise: Close
[0m15:07:34.917830 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee32d10>]}
[0m15:07:34.919428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ed71190>]}
[0m15:07:34.920870 [info ] [Thread-3 (]: 5 of 28 OK created sql view model gold_layer.customers_by_mobile_type_week_wise  [[32mSUCCESS 1[0m in 0.73s]
[0m15:07:34.921816 [info ] [Thread-1 (]: 6 of 28 OK created sql view model gold_layer.customers_by_os_overall ........... [[32mSUCCESS 1[0m in 0.73s]
[0m15:07:34.922812 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m15:07:34.923742 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m15:07:34.924491 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m15:07:34.925684 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:07:34.926435 [info ] [Thread-3 (]: 9 of 28 START sql view model gold_layer.revenue_by_age_overall ................. [RUN]
[0m15:07:34.927046 [info ] [Thread-1 (]: 10 of 28 START sql view model gold_layer.revenue_by_age_week_wise .............. [RUN]
[0m15:07:34.927751 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_age_overall)
[0m15:07:34.928736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m15:07:34.929516 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m15:07:34.930153 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m15:07:34.935969 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:07:34.940369 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:07:34.941327 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m15:07:34.941756 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m15:07:34.944894 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_overall"
[0m15:07:34.947713 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:07:34.949789 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_week_wise"
[0m15:07:34.950501 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_age_overall"
[0m15:07:34.950875 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_age_week_wise
  
   as (
    
select (year(current_date) - year_of_birth) AS age, week_number, round(sum(revenue),4) as revenue_by_age_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data
where age is not null
group by week_number, age
order by week_number, age
  );
[0m15:07:34.951422 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_age_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_age_overall
  
   as (
    
select (year(current_date) - year_of_birth) AS age, round(sum(revenue),4) as revenue_by_age_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data
where age is not null
group by age
order by age
  );
[0m15:07:34.952152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:34.952609 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:34.975367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104489810>]}
[0m15:07:34.976126 [info ] [Thread-2 (]: 8 of 28 OK created sql view model gold_layer.os_by_age_segment ................. [[32mSUCCESS 1[0m in 0.78s]
[0m15:07:34.976735 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m15:07:34.977180 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m15:07:34.977758 [info ] [Thread-2 (]: 11 of 28 START sql view model gold_layer.revenue_by_brand_overall .............. [RUN]
[0m15:07:34.978271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_overall)
[0m15:07:34.978673 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m15:07:34.982313 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:07:34.982983 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m15:07:34.986954 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_overall"
[0m15:07:34.987879 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_overall"
[0m15:07:34.988246 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_brand_overall
  
   as (
    
select brand_name, round(sum(revenue),4) as revenue_by_brand_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where brand_name is not null 
group by brand_name
order by revenue_by_brand_overall desc
  );
[0m15:07:34.988572 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:35.019786 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f09db90>]}
[0m15:07:35.020389 [info ] [Thread-4 (]: 7 of 28 OK created sql view model gold_layer.customers_by_os_week_wise ......... [[32mSUCCESS 1[0m in 0.83s]
[0m15:07:35.020851 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m15:07:35.021194 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:07:35.021623 [info ] [Thread-4 (]: 12 of 28 START sql view model gold_layer.revenue_by_brand_week_wise ............ [RUN]
[0m15:07:35.022048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m15:07:35.022359 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:07:35.025425 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:07:35.026030 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:07:35.028059 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:07:35.028789 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_brand_week_wise"
[0m15:07:35.029079 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_brand_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_brand_week_wise
  
   as (
    
select week_number,brand_name,round(sum(revenue),4) as revenue_by_brand_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where brand_name is not null
group by week_number, brand_name
order by week_number , brand_name
  );
[0m15:07:35.029346 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:07:35.477604 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:07:35.479754 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:35.481240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:35.485779 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_brand_overall: Close
[0m15:07:35.489276 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_age_overall: Close
[0m15:07:35.492309 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_age_week_wise: Close
[0m15:07:35.531561 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:35.536338 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_brand_week_wise: Close
[0m15:07:35.639485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f09b5d0>]}
[0m15:07:35.641655 [info ] [Thread-1 (]: 10 of 28 OK created sql view model gold_layer.revenue_by_age_week_wise ......... [[32mSUCCESS 1[0m in 0.71s]
[0m15:07:35.643668 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m15:07:35.644605 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m15:07:35.646077 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103deda50>]}
[0m15:07:35.649578 [info ] [Thread-3 (]: 9 of 28 OK created sql view model gold_layer.revenue_by_age_overall ............ [[32mSUCCESS 1[0m in 0.72s]
[0m15:07:35.647100 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee3e3d0>]}
[0m15:07:35.650816 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m15:07:35.648141 [info ] [Thread-1 (]: 13 of 28 START sql view model gold_layer.revenue_by_gender_overall ............. [RUN]
[0m15:07:35.651989 [info ] [Thread-2 (]: 11 of 28 OK created sql view model gold_layer.revenue_by_brand_overall ......... [[32mSUCCESS 1[0m in 0.67s]
[0m15:07:35.652868 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:07:35.653814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_overall)
[0m15:07:35.654717 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m15:07:35.655456 [info ] [Thread-3 (]: 14 of 28 START sql view model gold_layer.revenue_by_gender_week_wise ........... [RUN]
[0m15:07:35.656117 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m15:07:35.656851 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:07:35.657521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m15:07:35.662112 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:07:35.662725 [info ] [Thread-2 (]: 15 of 28 START sql view model gold_layer.revenue_by_mobile_type_overall ........ [RUN]
[0m15:07:35.663187 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:07:35.663759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m15:07:35.667532 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:07:35.668029 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:07:35.668465 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m15:07:35.672903 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:07:35.675993 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_overall"
[0m15:07:35.676488 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:07:35.679612 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:07:35.680241 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4ba790>]}
[0m15:07:35.680806 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:07:35.682006 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_overall"
[0m15:07:35.681363 [info ] [Thread-4 (]: 12 of 28 OK created sql view model gold_layer.revenue_by_brand_week_wise ....... [[32mSUCCESS 1[0m in 0.66s]
[0m15:07:35.686037 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:07:35.686762 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_gender_week_wise"
[0m15:07:35.687149 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_gender_overall
  
   as (
    
select gender, round(sum(revenue), 4) as revenue_by_gender_overall 
from PROJECT_SEC2_DB.silver_layer.enriched_data
where gender = 'Male' or gender = 'Female'
group by gender
  );
[0m15:07:35.687678 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m15:07:35.688122 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_gender_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_gender_week_wise
  
   as (
    
select gender, week_number, round(sum(revenue),4) as revenue_by_gender_weekwise 
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where gender = 'Male' or gender = 'Female'
group by gender, week_number
order by week_number, gender
  );
[0m15:07:35.688455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:35.688830 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:07:35.689386 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m15:07:35.689719 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:35.690428 [info ] [Thread-4 (]: 16 of 28 START sql view model gold_layer.revenue_by_mobile_type_week_wise ...... [RUN]
[0m15:07:35.691401 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_mobile_type_overall
  
   as (
    
select mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where mobile_type is not null 
group by mobile_type
  );
[0m15:07:35.692406 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m15:07:35.693022 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:35.693363 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:07:35.697518 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:07:35.698720 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:07:35.700709 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:07:35.701565 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m15:07:35.701851 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_mobile_type_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_mobile_type_week_wise
  
   as (
    
select week_number, mobile_type, round(sum(revenue),4) as revenue_by_mobile_type_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data
where mobile_type is not null
group by week_number, mobile_type
order by week_number ,mobile_type
  );
[0m15:07:35.702116 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:07:36.226397 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:36.232252 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_gender_week_wise: Close
[0m15:07:36.272259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:36.278996 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_gender_overall: Close
[0m15:07:36.281693 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:36.289172 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_mobile_type_week_wise: Close
[0m15:07:36.297749 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:36.301920 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_mobile_type_overall: Close
[0m15:07:36.395223 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448b890>]}
[0m15:07:36.397201 [info ] [Thread-3 (]: 14 of 28 OK created sql view model gold_layer.revenue_by_gender_week_wise ...... [[32mSUCCESS 1[0m in 0.74s]
[0m15:07:36.398394 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m15:07:36.399325 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m15:07:36.400373 [info ] [Thread-3 (]: 17 of 28 START sql view model gold_layer.revenue_by_os_overall ................. [RUN]
[0m15:07:36.401777 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_overall)
[0m15:07:36.402629 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m15:07:36.412110 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:07:36.413480 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m15:07:36.417466 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_overall"
[0m15:07:36.418841 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_overall"
[0m15:07:36.419413 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_os_overall
  
   as (
    
select os_name, round(sum(revenue),4) as revenue_by_os_name_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_name is not null 
group by os_name
order by revenue_by_os_name_overall desc
  );
[0m15:07:36.419931 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:36.426846 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f48d990>]}
[0m15:07:36.427620 [info ] [Thread-4 (]: 16 of 28 OK created sql view model gold_layer.revenue_by_mobile_type_week_wise . [[32mSUCCESS 1[0m in 0.73s]
[0m15:07:36.428226 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m15:07:36.428671 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:07:36.429235 [info ] [Thread-4 (]: 18 of 28 START sql view model gold_layer.revenue_by_os_vendor_overall .......... [RUN]
[0m15:07:36.429775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m15:07:36.430200 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:07:36.434049 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:07:36.435518 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:07:36.438482 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:07:36.438989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f472e50>]}
[0m15:07:36.439462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee3f250>]}
[0m15:07:36.440115 [info ] [Thread-2 (]: 15 of 28 OK created sql view model gold_layer.revenue_by_mobile_type_overall ... [[32mSUCCESS 1[0m in 0.78s]
[0m15:07:36.440686 [info ] [Thread-1 (]: 13 of 28 OK created sql view model gold_layer.revenue_by_gender_overall ........ [[32mSUCCESS 1[0m in 0.79s]
[0m15:07:36.441456 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m15:07:36.442016 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m15:07:36.442493 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m15:07:36.442869 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_os_vendor_overall
  
   as (
    
select os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_vendor is not null 
group by os_vendor
order by revenue_by_os_vendor_overall desc
  );
[0m15:07:36.443294 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:07:36.443724 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:07:36.444098 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:07:36.444509 [info ] [Thread-2 (]: 19 of 28 START sql view model gold_layer.revenue_by_os_vendor_week_wise ........ [RUN]
[0m15:07:36.444971 [info ] [Thread-1 (]: 20 of 28 START sql view model gold_layer.revenue_by_os_week_wise ............... [RUN]
[0m15:07:36.445992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m15:07:36.446740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_week_wise)
[0m15:07:36.447115 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:07:36.447416 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m15:07:36.451653 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:07:36.454478 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:07:36.455416 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:07:36.455717 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m15:07:36.457868 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:07:36.459795 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:07:36.460636 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m15:07:36.460942 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_vendor_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_os_vendor_week_wise
  
   as (
    
select week_number, os_vendor, round(sum(revenue),4) as revenue_by_os_vendor_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_vendor is not null 
group by week_number,os_vendor
order by week_number,revenue_by_os_vendor_weekwise
  );
[0m15:07:36.461516 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_os_week_wise"
[0m15:07:36.461764 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:36.462022 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_os_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_os_week_wise
  
   as (
    
select week_number, os_name, round(sum(revenue),4) as revenue_by_os_name_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where os_name is not null
group by week_number,os_name
order by week_number,revenue_by_os_name_weekwise
  );
[0m15:07:36.462659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:36.934767 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:36.942079 [debug] [Thread-3 (]: On model.my_dbt_project.revenue_by_os_overall: Close
[0m15:07:36.946531 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:07:36.950324 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_os_vendor_week_wise: Close
[0m15:07:36.954871 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:36.958684 [debug] [Thread-4 (]: On model.my_dbt_project.revenue_by_os_vendor_overall: Close
[0m15:07:36.963008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:36.966128 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_os_week_wise: Close
[0m15:07:37.100219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c29550>]}
[0m15:07:37.102332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec8fc50>]}
[0m15:07:37.103406 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11efe3910>]}
[0m15:07:37.105366 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f808390>]}
[0m15:07:37.104599 [info ] [Thread-2 (]: 19 of 28 OK created sql view model gold_layer.revenue_by_os_vendor_week_wise ... [[32mSUCCESS 1[0m in 0.65s]
[0m15:07:37.106452 [info ] [Thread-1 (]: 20 of 28 OK created sql view model gold_layer.revenue_by_os_week_wise .......... [[32mSUCCESS 1[0m in 0.66s]
[0m15:07:37.107490 [info ] [Thread-4 (]: 18 of 28 OK created sql view model gold_layer.revenue_by_os_vendor_overall ..... [[32mSUCCESS 1[0m in 0.67s]
[0m15:07:37.108854 [info ] [Thread-3 (]: 17 of 28 OK created sql view model gold_layer.revenue_by_os_overall ............ [[32mSUCCESS 1[0m in 0.70s]
[0m15:07:37.109798 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m15:07:37.110519 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m15:07:37.111170 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m15:07:37.111785 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m15:07:37.112359 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:07:37.113040 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:07:37.113741 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_customers_overall
[0m15:07:37.114369 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m15:07:37.115092 [info ] [Thread-2 (]: 21 of 28 START sql view model gold_layer.revenue_by_value_segment_overall ...... [RUN]
[0m15:07:37.115721 [info ] [Thread-1 (]: 22 of 28 START sql view model gold_layer.revenue_by_value_segment_week_wise .... [RUN]
[0m15:07:37.116302 [info ] [Thread-4 (]: 23 of 28 START sql view model gold_layer.total_customers_overall ............... [RUN]
[0m15:07:37.116870 [info ] [Thread-3 (]: 24 of 28 START sql view model gold_layer.total_customers_week_wise ............. [RUN]
[0m15:07:37.117468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m15:07:37.118013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m15:07:37.118496 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.total_customers_overall)
[0m15:07:37.118965 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.total_customers_week_wise)
[0m15:07:37.119397 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:07:37.119755 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:07:37.120105 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m15:07:37.120454 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m15:07:37.125372 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:07:37.129235 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:07:37.132889 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m15:07:37.136298 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m15:07:37.137260 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:07:37.137693 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:07:37.138092 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m15:07:37.140507 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:07:37.140796 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m15:07:37.144231 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:07:37.146331 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_overall"
[0m15:07:37.148403 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.total_customers_week_wise"
[0m15:07:37.149178 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m15:07:37.149864 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.revenue_by_value_segment_overall"
[0m15:07:37.150228 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_value_segment_week_wise
  
   as (
    
select week_number, value_segment, round(sum(revenue),4) as revenue_by_value_segment_weekwise
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where value_segment is not null
group by week_number,value_segment
order by week_number,value_segment
  );
[0m15:07:37.151013 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.total_customers_overall"
[0m15:07:37.151341 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.revenue_by_value_segment_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.revenue_by_value_segment_overall
  
   as (
    
select value_segment, round(sum(revenue),4) as revenue_by_value_segment_overall
from PROJECT_SEC2_DB.silver_layer.enriched_data 
where value_segment is not null
group by value_segment
  );
[0m15:07:37.152245 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.total_customers_week_wise"
[0m15:07:37.152509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:37.152801 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.total_customers_overall
  
   as (
    
with total_customers as (
  select 
    count(distinct msisdn) as total_customers_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
),
total_active_customers as (
  select 
    count(distinct msisdn) as total_active_customers_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
)
select 
  (select total_customers_overall from total_customers) as total_customers_overall,
  (select total_active_customers_overall from total_active_customers) as total_active_customers_overall
  );
[0m15:07:37.153079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:37.153385 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_customers_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.total_customers_week_wise
  
   as (
    
with total_customers_week as (
    select week_number, count(distinct msisdn) as total_customers_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    group by week_number
),
total_active_customers_week as (
  select week_number, count(distinct msisdn) as total_active_customers_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    where system_status = 'ACTIVE'
    group by week_number
)
select 
    tcw.week_number,
    tcw.total_customers_weekwise as total_customers,
    tacw.total_active_customers_weekwise as total_active_customers
from 
    total_customers_week tcw
left join 
    total_active_customers_week tacw
on 
    tcw.week_number = tacw.week_number
order by 
    tcw.week_number
  );
[0m15:07:37.153959 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:07:37.154742 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:37.685967 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:37.688802 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:37.690383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:37.695677 [debug] [Thread-2 (]: On model.my_dbt_project.revenue_by_value_segment_overall: Close
[0m15:07:37.699832 [debug] [Thread-4 (]: On model.my_dbt_project.total_customers_overall: Close
[0m15:07:37.701345 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:37.704356 [debug] [Thread-1 (]: On model.my_dbt_project.revenue_by_value_segment_week_wise: Close
[0m15:07:37.711351 [debug] [Thread-3 (]: On model.my_dbt_project.total_customers_week_wise: Close
[0m15:07:37.858073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3e2790>]}
[0m15:07:37.859768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3d2c50>]}
[0m15:07:37.860765 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3e02d0>]}
[0m15:07:37.861560 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee96810>]}
[0m15:07:37.862950 [info ] [Thread-1 (]: 22 of 28 OK created sql view model gold_layer.revenue_by_value_segment_week_wise  [[32mSUCCESS 1[0m in 0.74s]
[0m15:07:37.863844 [info ] [Thread-2 (]: 21 of 28 OK created sql view model gold_layer.revenue_by_value_segment_overall . [[32mSUCCESS 1[0m in 0.74s]
[0m15:07:37.866649 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m15:07:37.868310 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m15:07:37.869403 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_overall
[0m15:07:37.871442 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m15:07:37.872485 [info ] [Thread-1 (]: 25 of 28 START sql view model gold_layer.total_devices_overall ................. [RUN]
[0m15:07:37.873158 [info ] [Thread-2 (]: 26 of 28 START sql view model gold_layer.total_devices_week_wise ............... [RUN]
[0m15:07:37.873775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_overall)
[0m15:07:37.874293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_week_wise)
[0m15:07:37.874780 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m15:07:37.875236 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m15:07:37.881523 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m15:07:37.885764 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m15:07:37.886678 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m15:07:37.887094 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m15:07:37.890353 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_week_wise"
[0m15:07:37.893027 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.total_devices_overall"
[0m15:07:37.894475 [debug] [Thread-1 (]: Using snowflake connection "model.my_dbt_project.total_devices_overall"
[0m15:07:37.895689 [debug] [Thread-2 (]: Using snowflake connection "model.my_dbt_project.total_devices_week_wise"
[0m15:07:37.896199 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_overall"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.total_devices_overall
  
   as (
    
with total_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_devices_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
  where 
    imei_tac is not null
),
total_active_devices as (
  select 
    count(distinct msisdn, imei_tac) as total_active_devices_overall
  from 
    PROJECT_SEC2_DB.silver_layer.enriched_data
  where 
    system_status = 'ACTIVE'
    and imei_tac is not null
)
select 
  (select total_devices_overall from total_devices) as total_devices_overall,
  (select total_active_devices_overall from total_active_devices) as total_active_devices_overall
  );
[0m15:07:37.896660 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.total_devices_week_wise"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.total_devices_week_wise
  
   as (
    
with total_devices_week as (
    select week_number, count(distinct msisdn, imei_tac) as total_devices_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    where imei_tac is not null
    group by week_number
),
total_active_devices_week as (
  select week_number, count(distinct msisdn, imei_tac) as total_active_devices_weekwise
    from PROJECT_SEC2_DB.silver_layer.enriched_data
    where system_status = 'ACTIVE' and imei_tac is not null
    group by week_number
)
select 
    tdw.week_number,
    tdw.total_devices_weekwise as total_devices,
    tadw.total_active_devices_weekwise as total_active_devices
from 
    total_devices_week tdw
left join 
    total_active_devices_week tadw
on 
    tdw.week_number = tadw.week_number
order by 
    tdw.week_number
  );
[0m15:07:37.897069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:37.897451 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:38.440361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:38.445214 [debug] [Thread-1 (]: On model.my_dbt_project.total_devices_overall: Close
[0m15:07:38.450186 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:38.454268 [debug] [Thread-2 (]: On model.my_dbt_project.total_devices_week_wise: Close
[0m15:07:38.597267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec66910>]}
[0m15:07:38.598617 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2b8e10>]}
[0m15:07:39.209650 [info ] [Thread-3 (]: 24 of 28 OK created sql view model gold_layer.total_customers_week_wise ........ [[32mSUCCESS 1[0m in 0.74s]
[0m15:07:39.210941 [info ] [Thread-4 (]: 23 of 28 OK created sql view model gold_layer.total_customers_overall .......... [[32mSUCCESS 1[0m in 0.74s]
[0m15:07:39.211635 [info ] [Thread-1 (]: 25 of 28 OK created sql view model gold_layer.total_devices_overall ............ [[32mSUCCESS 1[0m in 0.72s]
[0m15:07:39.212277 [info ] [Thread-2 (]: 26 of 28 OK created sql view model gold_layer.total_devices_week_wise .......... [[32mSUCCESS 1[0m in 0.72s]
[0m15:07:39.213331 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m15:07:39.214404 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m15:07:39.215512 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m15:07:39.216763 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m15:07:39.218042 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:07:39.219263 [debug] [Thread-4 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m15:07:39.220914 [info ] [Thread-3 (]: 27 of 28 START sql view model gold_layer.weekly_revenue_by_brand ............... [RUN]
[0m15:07:39.221825 [info ] [Thread-4 (]: 28 of 28 START sql view model gold_layer.weekly_revenue_by_os .................. [RUN]
[0m15:07:39.222794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_brand)
[0m15:07:39.223916 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_os)
[0m15:07:39.225230 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m15:07:39.226092 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m15:07:39.232880 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:07:39.240348 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:07:39.241034 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m15:07:39.244278 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:07:39.244811 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m15:07:39.247654 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.weekly_revenue_by_os"
[0m15:07:39.248652 [debug] [Thread-3 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_brand"
[0m15:07:39.249130 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_brand: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_brand"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.weekly_revenue_by_brand
  
   as (
    
SELECT week_number, brand_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.silver_layer.enriched_data
GROUP BY week_number, brand_name
ORDER BY week_number, brand_name
  );
[0m15:07:39.249584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:39.250461 [debug] [Thread-4 (]: Using snowflake connection "model.my_dbt_project.weekly_revenue_by_os"
[0m15:07:39.251213 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_os: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.my_dbt_project.weekly_revenue_by_os"} */
create or replace   view PROJECT_SEC2_DB.gold_layer.weekly_revenue_by_os
  
   as (
    
SELECT week_number, os_name,
    MAX(round(revenue,4)) AS highest_revenue,
    MIN(round(revenue,4)) AS lowest_revenue
FROM PROJECT_SEC2_DB.silver_layer.enriched_data
GROUP BY week_number, os_name
ORDER BY week_number, os_name
  );
[0m15:07:39.251931 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:07:39.812356 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:39.819115 [debug] [Thread-3 (]: On model.my_dbt_project.weekly_revenue_by_brand: Close
[0m15:07:39.821803 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:39.828026 [debug] [Thread-4 (]: On model.my_dbt_project.weekly_revenue_by_os: Close
[0m15:07:39.977178 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3afbd0>]}
[0m15:07:39.978543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070c1849-8413-42b0-b05e-17b9165c4639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4f2e10>]}
[0m15:07:39.980237 [info ] [Thread-4 (]: 28 of 28 OK created sql view model gold_layer.weekly_revenue_by_os ............. [[32mSUCCESS 1[0m in 0.75s]
[0m15:07:39.981374 [info ] [Thread-3 (]: 27 of 28 OK created sql view model gold_layer.weekly_revenue_by_brand .......... [[32mSUCCESS 1[0m in 0.76s]
[0m15:07:39.982592 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m15:07:39.983754 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m15:07:39.986773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:39.987409 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_overall' was properly closed.
[0m15:07:39.987826 [debug] [MainThread]: Connection 'model.my_dbt_project.total_devices_week_wise' was properly closed.
[0m15:07:39.988179 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m15:07:39.988532 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m15:07:39.989346 [info ] [MainThread]: 
[0m15:07:39.989828 [info ] [MainThread]: Finished running 28 view models in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m15:07:39.995772 [debug] [MainThread]: Command end result
[0m15:07:40.033544 [info ] [MainThread]: 
[0m15:07:40.033949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:40.034213 [info ] [MainThread]: 
[0m15:07:40.034463 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 TOTAL=28
[0m15:07:40.036391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.172088, "process_user_time": 4.19657, "process_kernel_time": 1.902213, "process_mem_max_rss": "201162752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:40.036790 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:40.036736 after 9.17 seconds
[0m15:07:40.037308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c580d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c35750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101818610>]}
[0m15:07:40.037630 [debug] [MainThread]: Flushing usage events
[0m12:50:27.448128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c86e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce7bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf4fd0>]}


============================== 12:50:27.451095 | e6d26e28-54bd-451c-b441-c9831d923344 ==============================
[0m12:50:27.451095 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:50:27.451443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m12:50:28.506944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6d26e28-54bd-451c-b441-c9831d923344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f04cb10>]}
[0m12:50:28.528707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6d26e28-54bd-451c-b441-c9831d923344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773f0d0>]}
[0m12:50:28.529304 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m12:50:28.545437 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:50:28.637761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:28.638002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:28.660799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6d26e28-54bd-451c-b441-c9831d923344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b1f5ed0>]}
[0m12:50:28.674576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6d26e28-54bd-451c-b441-c9831d923344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13efe9bd0>]}
[0m12:50:28.674853 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 447 macros
[0m12:50:28.675023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d26e28-54bd-451c-b441-c9831d923344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f018990>]}
[0m12:50:28.676296 [info ] [MainThread]: 
[0m12:50:28.676581 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:28.679179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m12:50:28.679435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m12:50:28.680521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m12:50:28.688041 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m12:50:28.689068 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m12:50:28.690017 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m12:50:28.690194 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m12:50:28.690350 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m12:50:28.690493 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m12:50:28.690637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:28.690752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:28.690868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:29.555156 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:50:29.557929 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m12:50:29.589513 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:50:29.591138 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m12:50:29.651368 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m12:50:29.653638 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m12:50:32.218089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d26e28-54bd-451c-b441-c9831d923344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f00d610>]}
[0m12:50:32.219032 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:50:32.219486 [info ] [MainThread]: 
[0m12:50:32.223070 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.input_crm
[0m12:50:32.223636 [debug] [Thread-2 (]: Began running node seed.my_dbt_project.input_device
[0m12:50:32.224149 [debug] [Thread-3 (]: Began running node seed.my_dbt_project.input_enriched_data
[0m12:50:32.224693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now seed.my_dbt_project.input_crm)
[0m12:50:32.225098 [debug] [Thread-4 (]: Began running node seed.my_dbt_project.input_rev
[0m12:50:32.225538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now seed.my_dbt_project.input_device)
[0m12:50:32.225942 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now seed.my_dbt_project.input_enriched_data)
[0m12:50:32.226322 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.input_crm
[0m12:50:32.227043 [debug] [Thread-4 (]: Acquiring new snowflake connection 'seed.my_dbt_project.input_rev'
[0m12:50:32.227428 [debug] [Thread-2 (]: Began compiling node seed.my_dbt_project.input_device
[0m12:50:32.227798 [debug] [Thread-3 (]: Began compiling node seed.my_dbt_project.input_enriched_data
[0m12:50:32.235705 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.input_crm
[0m12:50:32.236093 [debug] [Thread-4 (]: Began compiling node seed.my_dbt_project.input_rev
[0m12:50:32.237857 [debug] [Thread-2 (]: Began executing node seed.my_dbt_project.input_device
[0m12:50:32.239679 [debug] [Thread-3 (]: Began executing node seed.my_dbt_project.input_enriched_data
[0m12:50:32.240346 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.input_crm
[0m12:50:32.243073 [debug] [Thread-4 (]: Began executing node seed.my_dbt_project.input_rev
[0m12:50:32.243716 [debug] [Thread-2 (]: Finished running node seed.my_dbt_project.input_device
[0m12:50:32.244236 [debug] [Thread-3 (]: Finished running node seed.my_dbt_project.input_enriched_data
[0m12:50:32.245014 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m12:50:32.245550 [debug] [Thread-4 (]: Finished running node seed.my_dbt_project.input_rev
[0m12:50:32.246060 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m12:50:32.246550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_crm, now model.my_dbt_project.clean_crm_data)
[0m12:50:32.246926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_device, now model.my_dbt_project.clean_device_data)
[0m12:50:32.247204 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m12:50:32.247457 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m12:50:32.254400 [info ] [Thread-1 (]: import_crm: 
[0m12:50:32.257970 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
[0m12:50:32.258338 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m12:50:32.258679 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m12:50:32.259333 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m12:50:32.259611 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m12:50:32.260087 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m12:50:32.260497 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m12:50:32.261012 [debug] [Thread-1 (]: Began running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m12:50:32.261303 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m12:50:32.261622 [debug] [Thread-4 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m12:50:32.261975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9)
[0m12:50:32.262231 [debug] [Thread-2 (]: Began running node model.my_dbt_project.crm_device_data
[0m12:50:32.262517 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_enriched_data, now test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873)
[0m12:50:32.262808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_rev, now test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580)
[0m12:50:32.263079 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m12:50:32.263333 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.crm_device_data)
[0m12:50:32.263565 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m12:50:32.263797 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m12:50:32.269611 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m12:50:32.274746 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m12:50:32.277471 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m12:50:32.280462 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m12:50:32.281593 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.crm_device_data
[0m12:50:32.281885 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m12:50:32.282084 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m12:50:32.282440 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.crm_device_data
[0m12:50:32.282819 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m12:50:32.283202 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m12:50:32.283445 [debug] [Thread-2 (]: Began running node model.my_dbt_project.enriched_data
[0m12:50:32.283733 [debug] [Thread-4 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m12:50:32.283990 [debug] [Thread-3 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m12:50:32.284215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now model.my_dbt_project.enriched_data)
[0m12:50:32.284450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m12:50:32.284702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873, now test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e)
[0m12:50:32.284990 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.enriched_data
[0m12:50:32.285187 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m12:50:32.285404 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m12:50:32.288033 [info ] [Thread-2 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m12:50:32.290140 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m12:50:32.293197 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m12:50:32.293970 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn (models/tests/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:50:32.294249 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m12:50:32.294654 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m12:50:32.295163 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m12:50:32.295334 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m12:50:32.295660 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m12:50:32.295824 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.enriched_data
[0m12:50:32.296114 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m12:50:32.296463 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.enriched_data
[0m12:50:32.296740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:32.296953 [debug] [MainThread]: Connection 'test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9' was properly closed.
[0m12:50:32.297093 [debug] [MainThread]: Connection 'model.my_dbt_project.enriched_data' was properly closed.
[0m12:50:32.297215 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e' was properly closed.
[0m12:50:32.297336 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f' was properly closed.
[0m12:50:32.297560 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn (models/tests/schema.yml)
    'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:50:32.299556 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 4.8850985, "process_user_time": 1.854308, "process_kernel_time": 1.728499, "process_mem_max_rss": "193118208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:50:32.299860 [debug] [MainThread]: Command `dbt docs generate` failed at 12:50:32.299819 after 4.89 seconds
[0m12:50:32.300044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce7bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107922d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f5b6c50>]}
[0m12:50:32.300222 [debug] [MainThread]: Flushing usage events
[0m12:51:59.561122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107392bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f7fd0>]}


============================== 12:51:59.563822 | 4ae37857-9ec9-42a7-a11b-78a2bbe70b99 ==============================
[0m12:51:59.563822 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:51:59.564126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m12:51:59.628150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ae37857-9ec9-42a7-a11b-78a2bbe70b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b9b50>]}
[0m12:51:59.648968 [debug] [MainThread]: Set downloads directory='/var/folders/4l/01w8nw213fx2_n58nk4fjmk80000gp/T/dbt-downloads-22kqsth9'
[0m12:51:59.649252 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:51:59.837302 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:51:59.837733 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:51:59.905339 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:51:59.907926 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:52:00.512242 [info ] [MainThread]: Installed from version 1.2.0
[0m12:52:00.512553 [info ] [MainThread]: Up to date!
[0m12:52:00.512800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ae37857-9ec9-42a7-a11b-78a2bbe70b99', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b3d90>]}
[0m12:52:00.514734 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9873602, "process_user_time": 0.685823, "process_kernel_time": 0.173342, "process_mem_max_rss": "98418688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:52:00.515141 [debug] [MainThread]: Command `dbt deps` succeeded at 12:52:00.515075 after 0.99 seconds
[0m12:52:00.515373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e84490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102db6010>]}
[0m12:52:00.515601 [debug] [MainThread]: Flushing usage events
[0m12:52:04.080658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109161fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109197bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c3ad0>]}


============================== 12:52:04.082741 | 34b9f21d-35ee-4e9a-ace2-daaaae74c3d7 ==============================
[0m12:52:04.082741 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:52:04.083035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:04.963790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34b9f21d-35ee-4e9a-ace2-daaaae74c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c7dc8d0>]}
[0m12:52:04.985090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34b9f21d-35ee-4e9a-ace2-daaaae74c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084430d0>]}
[0m12:52:04.985858 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m12:52:05.000039 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:52:05.092853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m12:52:05.093226 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m12:52:05.093382 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m12:52:05.093521 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m12:52:05.093647 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m12:52:05.093772 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m12:52:05.093890 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m12:52:05.094009 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m12:52:05.094135 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m12:52:05.094253 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m12:52:05.094377 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m12:52:05.094497 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m12:52:05.094617 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m12:52:05.094737 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m12:52:05.094854 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m12:52:05.094970 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m12:52:05.095087 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m12:52:05.095203 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m12:52:05.095317 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m12:52:05.095440 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m12:52:05.095555 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m12:52:05.095670 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m12:52:05.095787 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m12:52:05.095903 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m12:52:05.096043 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m12:52:05.096161 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m12:52:05.096279 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m12:52:05.096403 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m12:52:05.096517 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m12:52:05.096633 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m12:52:05.096750 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m12:52:05.096864 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m12:52:05.096977 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m12:52:05.097095 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m12:52:05.097211 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m12:52:05.097325 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m12:52:05.097438 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m12:52:05.097551 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m12:52:05.097670 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m12:52:05.097784 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m12:52:05.097899 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m12:52:05.098012 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m12:52:05.098126 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m12:52:05.098247 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m12:52:05.098366 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m12:52:05.098481 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m12:52:05.098596 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m12:52:05.098709 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m12:52:05.098828 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m12:52:05.098941 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m12:52:05.099060 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m12:52:05.099175 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m12:52:05.282741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34b9f21d-35ee-4e9a-ace2-daaaae74c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1f910>]}
[0m12:52:05.294984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34b9f21d-35ee-4e9a-ace2-daaaae74c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c84fed0>]}
[0m12:52:05.295257 [info ] [MainThread]: Found 32 models, 4 seeds, 7 data tests, 3 sources, 563 macros
[0m12:52:05.295429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34b9f21d-35ee-4e9a-ace2-daaaae74c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8253d0>]}
[0m12:52:05.296659 [info ] [MainThread]: 
[0m12:52:05.296919 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:52:05.299479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_gold_layer'
[0m12:52:05.299744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_SEEDS'
[0m12:52:05.308508 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_gold_layer"
[0m12:52:05.308796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_SEC2_DB_silver_layer'
[0m12:52:05.309915 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_SEEDS"
[0m12:52:05.310084 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_gold_layer"} */
show objects in PROJECT_SEC2_DB.gold_layer limit 10000
[0m12:52:05.311027 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_SEC2_DB_silver_layer"
[0m12:52:05.311174 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_SEEDS"} */
show objects in PROJECT_SEC2_DB.SEEDS limit 10000
[0m12:52:05.311306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:05.311441 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_PROJECT_SEC2_DB_silver_layer"} */
show objects in PROJECT_SEC2_DB.silver_layer limit 10000
[0m12:52:05.311559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:05.312616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:05.975321 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:52:05.979708 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_silver_layer: Close
[0m12:52:06.015177 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:52:06.018611 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_SEEDS: Close
[0m12:52:06.032507 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.0 seconds
[0m12:52:06.036148 [debug] [ThreadPool]: On list_PROJECT_SEC2_DB_gold_layer: Close
[0m12:52:06.178799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34b9f21d-35ee-4e9a-ace2-daaaae74c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc4f250>]}
[0m12:52:06.179624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:06.180079 [info ] [MainThread]: 
[0m12:52:06.184005 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.input_crm
[0m12:52:06.184514 [debug] [Thread-2 (]: Began running node seed.my_dbt_project.input_device
[0m12:52:06.185578 [debug] [Thread-4 (]: Began running node seed.my_dbt_project.input_rev
[0m12:52:06.186096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_gold_layer, now seed.my_dbt_project.input_crm)
[0m12:52:06.186737 [debug] [Thread-3 (]: Began running node seed.my_dbt_project.input_enriched_data
[0m12:52:06.187264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_SEEDS, now seed.my_dbt_project.input_device)
[0m12:52:06.187758 [debug] [Thread-4 (]: Acquiring new snowflake connection 'seed.my_dbt_project.input_rev'
[0m12:52:06.188116 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.input_crm
[0m12:52:06.188498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_PROJECT_SEC2_DB_silver_layer, now seed.my_dbt_project.input_enriched_data)
[0m12:52:06.188849 [debug] [Thread-2 (]: Began compiling node seed.my_dbt_project.input_device
[0m12:52:06.189177 [debug] [Thread-4 (]: Began compiling node seed.my_dbt_project.input_rev
[0m12:52:06.196743 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.input_crm
[0m12:52:06.197257 [debug] [Thread-3 (]: Began compiling node seed.my_dbt_project.input_enriched_data
[0m12:52:06.200038 [debug] [Thread-2 (]: Began executing node seed.my_dbt_project.input_device
[0m12:52:06.201902 [debug] [Thread-4 (]: Began executing node seed.my_dbt_project.input_rev
[0m12:52:06.202560 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.input_crm
[0m12:52:06.204396 [debug] [Thread-3 (]: Began executing node seed.my_dbt_project.input_enriched_data
[0m12:52:06.204951 [debug] [Thread-2 (]: Finished running node seed.my_dbt_project.input_device
[0m12:52:06.205618 [debug] [Thread-4 (]: Finished running node seed.my_dbt_project.input_rev
[0m12:52:06.206274 [debug] [Thread-1 (]: Began running node model.my_dbt_project.clean_crm_data
[0m12:52:06.206923 [debug] [Thread-3 (]: Finished running node seed.my_dbt_project.input_enriched_data
[0m12:52:06.207577 [debug] [Thread-2 (]: Began running node model.my_dbt_project.clean_device_data
[0m12:52:06.207940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_crm, now model.my_dbt_project.clean_crm_data)
[0m12:52:06.208397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_device, now model.my_dbt_project.clean_device_data)
[0m12:52:06.208738 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.clean_crm_data
[0m12:52:06.209013 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.clean_device_data
[0m12:52:06.216238 [info ] [Thread-1 (]: import_crm: 
[0m12:52:06.220180 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.clean_crm_data"
[0m12:52:06.219845 [info ] [Thread-2 (]: import_device: PROJECT_SEC2_DB.BRONZE_LAYER.DEVICE
[0m12:52:06.220665 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.clean_device_data"
[0m12:52:06.221073 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.clean_crm_data
[0m12:52:06.221534 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.clean_crm_data
[0m12:52:06.221863 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.clean_device_data
[0m12:52:06.222366 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.clean_device_data
[0m12:52:06.222640 [debug] [Thread-4 (]: Began running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m12:52:06.222890 [debug] [Thread-3 (]: Began running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m12:52:06.223319 [debug] [Thread-1 (]: Began running node model.my_dbt_project.crm_device_data
[0m12:52:06.223541 [debug] [Thread-2 (]: Began running node model.my_dbt_project.enriched_data
[0m12:52:06.223827 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_rev, now test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f)
[0m12:52:06.224266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.input_enriched_data, now test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e)
[0m12:52:06.224543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_crm_data, now model.my_dbt_project.crm_device_data)
[0m12:52:06.224818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.clean_device_data, now model.my_dbt_project.enriched_data)
[0m12:52:06.225070 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m12:52:06.225306 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m12:52:06.225595 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.crm_device_data
[0m12:52:06.225897 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.enriched_data
[0m12:52:06.233756 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f"
[0m12:52:06.237587 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e"
[0m12:52:06.239856 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.crm_device_data"
[0m12:52:06.243027 [info ] [Thread-2 (]: import_rev: PROJECT_SEC2_DB.BRONZE_LAYER.REV
[0m12:52:06.243675 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.enriched_data"
[0m12:52:06.243903 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m12:52:06.244126 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m12:52:06.244339 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.crm_device_data
[0m12:52:06.244719 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f
[0m12:52:06.245075 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e
[0m12:52:06.245236 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.enriched_data
[0m12:52:06.245537 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.crm_device_data
[0m12:52:06.245750 [debug] [Thread-4 (]: Began running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m12:52:06.245990 [debug] [Thread-3 (]: Began running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m12:52:06.246324 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.enriched_data
[0m12:52:06.246525 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m12:52:06.246758 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_crm_data_msisdn.db3a782d2f, now test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9)
[0m12:52:06.246970 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.unique_clean_crm_data_msisdn.d2fabbef1e, now test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873)
[0m12:52:06.247467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.crm_device_data, now test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580)
[0m12:52:06.247639 [debug] [Thread-2 (]: Began running node model.my_dbt_project.brand_by_age_segment
[0m12:52:06.247834 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m12:52:06.248011 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m12:52:06.248184 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m12:52:06.248370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.enriched_data, now model.my_dbt_project.brand_by_age_segment)
[0m12:52:06.254634 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9"
[0m12:52:06.256667 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873"
[0m12:52:06.258786 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580"
[0m12:52:06.259055 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.brand_by_age_segment
[0m12:52:06.261997 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.brand_by_age_segment"
[0m12:52:06.262215 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m12:52:06.262392 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m12:52:06.262746 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580
[0m12:52:06.262893 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m12:52:06.263195 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873
[0m12:52:06.263340 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.brand_by_age_segment
[0m12:52:06.263520 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_brand_overall
[0m12:52:06.263808 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9
[0m12:52:06.263976 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_brand_week_wise
[0m12:52:06.264239 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.brand_by_age_segment
[0m12:52:06.264412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_device_data_msisdn.2ef3cdd580, now model.my_dbt_project.customers_by_brand_overall)
[0m12:52:06.264591 [debug] [Thread-4 (]: Began running node model.my_dbt_project.customers_by_mobile_type_overall
[0m12:52:06.264765 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_clean_device_data_IMEI_TAC.b80e6e9873, now model.my_dbt_project.customers_by_brand_week_wise)
[0m12:52:06.264936 [debug] [Thread-2 (]: Began running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m12:52:06.265095 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_brand_overall
[0m12:52:06.265259 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.dbt_utils_unique_combination_of_columns_clean_device_data_IMEI_TAC__msisdn.ad3c285aa9, now model.my_dbt_project.customers_by_mobile_type_overall)
[0m12:52:06.265411 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_brand_week_wise
[0m12:52:06.265565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.brand_by_age_segment, now model.my_dbt_project.customers_by_mobile_type_week_wise)
[0m12:52:06.267270 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_overall"
[0m12:52:06.267437 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_overall
[0m12:52:06.269081 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_brand_week_wise"
[0m12:52:06.269267 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m12:52:06.270931 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_overall"
[0m12:52:06.273143 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_mobile_type_week_wise"
[0m12:52:06.273430 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_brand_overall
[0m12:52:06.273696 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_brand_week_wise
[0m12:52:06.274056 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_brand_overall
[0m12:52:06.274394 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_brand_week_wise
[0m12:52:06.274535 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m12:52:06.274668 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.customers_by_mobile_type_overall
[0m12:52:06.274856 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customers_by_os_overall
[0m12:52:06.275053 [debug] [Thread-3 (]: Began running node model.my_dbt_project.customers_by_os_week_wise
[0m12:52:06.275324 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_week_wise
[0m12:52:06.275593 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.customers_by_mobile_type_overall
[0m12:52:06.275762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_overall, now model.my_dbt_project.customers_by_os_overall)
[0m12:52:06.275943 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_brand_week_wise, now model.my_dbt_project.customers_by_os_week_wise)
[0m12:52:06.276115 [debug] [Thread-2 (]: Began running node model.my_dbt_project.os_by_age_segment
[0m12:52:06.276290 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_age_overall
[0m12:52:06.276451 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customers_by_os_overall
[0m12:52:06.276598 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.customers_by_os_week_wise
[0m12:52:06.276755 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_week_wise, now model.my_dbt_project.os_by_age_segment)
[0m12:52:06.276920 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_mobile_type_overall, now model.my_dbt_project.revenue_by_age_overall)
[0m12:52:06.278575 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_overall"
[0m12:52:06.280134 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.customers_by_os_week_wise"
[0m12:52:06.280307 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.os_by_age_segment
[0m12:52:06.280472 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_age_overall
[0m12:52:06.282269 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.os_by_age_segment"
[0m12:52:06.284968 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_overall"
[0m12:52:06.285235 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customers_by_os_overall
[0m12:52:06.285394 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.customers_by_os_week_wise
[0m12:52:06.285753 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customers_by_os_overall
[0m12:52:06.285918 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.os_by_age_segment
[0m12:52:06.286199 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.customers_by_os_week_wise
[0m12:52:06.286396 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_age_week_wise
[0m12:52:06.286534 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_age_overall
[0m12:52:06.286807 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.os_by_age_segment
[0m12:52:06.286973 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_brand_overall
[0m12:52:06.287145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_overall, now model.my_dbt_project.revenue_by_age_week_wise)
[0m12:52:06.287405 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_age_overall
[0m12:52:06.287570 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_brand_week_wise
[0m12:52:06.287742 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customers_by_os_week_wise, now model.my_dbt_project.revenue_by_brand_overall)
[0m12:52:06.287900 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_age_week_wise
[0m12:52:06.288063 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_gender_overall
[0m12:52:06.288225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.os_by_age_segment, now model.my_dbt_project.revenue_by_brand_week_wise)
[0m12:52:06.288372 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_brand_overall
[0m12:52:06.290185 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_age_week_wise"
[0m12:52:06.290520 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_overall, now model.my_dbt_project.revenue_by_gender_overall)
[0m12:52:06.290706 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_brand_week_wise
[0m12:52:06.292600 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_overall"
[0m12:52:06.292826 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_gender_overall
[0m12:52:06.294371 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_brand_week_wise"
[0m12:52:06.296075 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_overall"
[0m12:52:06.296268 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_age_week_wise
[0m12:52:06.296482 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_brand_overall
[0m12:52:06.296812 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_age_week_wise
[0m12:52:06.296954 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_brand_week_wise
[0m12:52:06.297221 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_brand_overall
[0m12:52:06.297354 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_gender_overall
[0m12:52:06.297526 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_gender_week_wise
[0m12:52:06.297805 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_brand_week_wise
[0m12:52:06.297982 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m12:52:06.298250 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_gender_overall
[0m12:52:06.298436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_age_week_wise, now model.my_dbt_project.revenue_by_gender_week_wise)
[0m12:52:06.298630 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m12:52:06.298813 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_overall, now model.my_dbt_project.revenue_by_mobile_type_overall)
[0m12:52:06.298985 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_os_overall
[0m12:52:06.299148 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_gender_week_wise
[0m12:52:06.299308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_brand_week_wise, now model.my_dbt_project.revenue_by_mobile_type_week_wise)
[0m12:52:06.299473 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_overall
[0m12:52:06.299633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_overall, now model.my_dbt_project.revenue_by_os_overall)
[0m12:52:06.301205 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_gender_week_wise"
[0m12:52:06.301362 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m12:52:06.302909 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_overall"
[0m12:52:06.303073 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_os_overall
[0m12:52:06.304629 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_mobile_type_week_wise"
[0m12:52:06.306272 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_overall"
[0m12:52:06.306452 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_gender_week_wise
[0m12:52:06.306664 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_overall
[0m12:52:06.307142 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_gender_week_wise
[0m12:52:06.307283 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m12:52:06.307557 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_overall
[0m12:52:06.307700 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_os_overall
[0m12:52:06.307897 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m12:52:06.308191 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_mobile_type_week_wise
[0m12:52:06.308360 [debug] [Thread-3 (]: Began running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m12:52:06.308621 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_os_overall
[0m12:52:06.308793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_gender_week_wise, now model.my_dbt_project.revenue_by_os_vendor_overall)
[0m12:52:06.308997 [debug] [Thread-2 (]: Began running node model.my_dbt_project.revenue_by_os_week_wise
[0m12:52:06.309180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_overall, now model.my_dbt_project.revenue_by_os_vendor_week_wise)
[0m12:52:06.309361 [debug] [Thread-4 (]: Began running node model.my_dbt_project.revenue_by_value_segment_overall
[0m12:52:06.309533 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_overall
[0m12:52:06.309699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_mobile_type_week_wise, now model.my_dbt_project.revenue_by_os_week_wise)
[0m12:52:06.309856 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m12:52:06.310018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_overall, now model.my_dbt_project.revenue_by_value_segment_overall)
[0m12:52:06.311695 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_overall"
[0m12:52:06.311875 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.revenue_by_os_week_wise
[0m12:52:06.313443 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_vendor_week_wise"
[0m12:52:06.313624 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_overall
[0m12:52:06.316269 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_os_week_wise"
[0m12:52:06.317921 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_overall"
[0m12:52:06.318076 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_overall
[0m12:52:06.318271 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m12:52:06.318620 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_overall
[0m12:52:06.318764 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.revenue_by_os_week_wise
[0m12:52:06.319046 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.revenue_by_os_vendor_week_wise
[0m12:52:06.319191 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_overall
[0m12:52:06.319379 [debug] [Thread-1 (]: Began running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m12:52:06.319666 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.revenue_by_os_week_wise
[0m12:52:06.319828 [debug] [Thread-3 (]: Began running node model.my_dbt_project.total_customers_overall
[0m12:52:06.320084 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_overall
[0m12:52:06.320257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_overall, now model.my_dbt_project.revenue_by_value_segment_week_wise)
[0m12:52:06.320433 [debug] [Thread-2 (]: Began running node model.my_dbt_project.total_customers_week_wise
[0m12:52:06.320602 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_vendor_week_wise, now model.my_dbt_project.total_customers_overall)
[0m12:52:06.320763 [debug] [Thread-4 (]: Began running node model.my_dbt_project.total_devices_overall
[0m12:52:06.320917 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m12:52:06.321070 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_os_week_wise, now model.my_dbt_project.total_customers_week_wise)
[0m12:52:06.321213 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.total_customers_overall
[0m12:52:06.321360 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_overall, now model.my_dbt_project.total_devices_overall)
[0m12:52:06.322933 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.revenue_by_value_segment_week_wise"
[0m12:52:06.323116 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.total_customers_week_wise
[0m12:52:06.324733 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_overall"
[0m12:52:06.324898 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.total_devices_overall
[0m12:52:06.326545 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.total_customers_week_wise"
[0m12:52:06.328262 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_overall"
[0m12:52:06.328453 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m12:52:06.328661 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.total_customers_overall
[0m12:52:06.328959 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.revenue_by_value_segment_week_wise
[0m12:52:06.329100 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.total_customers_week_wise
[0m12:52:06.329388 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.total_customers_overall
[0m12:52:06.329524 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.total_devices_overall
[0m12:52:06.329692 [debug] [Thread-1 (]: Began running node model.my_dbt_project.total_devices_week_wise
[0m12:52:06.329953 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.total_customers_week_wise
[0m12:52:06.330125 [debug] [Thread-3 (]: Began running node model.my_dbt_project.weekly_revenue_by_brand
[0m12:52:06.330415 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.total_devices_overall
[0m12:52:06.330594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.revenue_by_value_segment_week_wise, now model.my_dbt_project.total_devices_week_wise)
[0m12:52:06.330783 [debug] [Thread-2 (]: Began running node model.my_dbt_project.weekly_revenue_by_os
[0m12:52:06.330960 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_overall, now model.my_dbt_project.weekly_revenue_by_brand)
[0m12:52:06.331136 [debug] [Thread-4 (]: Began running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m12:52:06.331295 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.total_devices_week_wise
[0m12:52:06.331451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_customers_week_wise, now model.my_dbt_project.weekly_revenue_by_os)
[0m12:52:06.331599 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_brand
[0m12:52:06.331757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_overall, now test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925)
[0m12:52:06.333491 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.total_devices_week_wise"
[0m12:52:06.333657 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.weekly_revenue_by_os
[0m12:52:06.335224 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_brand"
[0m12:52:06.335393 [debug] [Thread-4 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m12:52:06.337010 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.weekly_revenue_by_os"
[0m12:52:06.338753 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925"
[0m12:52:06.338939 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.total_devices_week_wise
[0m12:52:06.339148 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.weekly_revenue_by_brand
[0m12:52:06.339459 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.total_devices_week_wise
[0m12:52:06.339748 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.weekly_revenue_by_brand
[0m12:52:06.339897 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.weekly_revenue_by_os
[0m12:52:06.340041 [debug] [Thread-4 (]: Began executing node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m12:52:06.340217 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc
[0m12:52:06.340564 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.weekly_revenue_by_os
[0m12:52:06.340831 [debug] [Thread-4 (]: Finished running node test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925
[0m12:52:06.341003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.total_devices_week_wise, now test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc)
[0m12:52:06.341246 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc
[0m12:52:06.344011 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc"
[0m12:52:06.344316 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc
[0m12:52:06.344581 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc
[0m12:52:06.345071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:06.345215 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_enriched_data_week_number.1d0e9279fc' was properly closed.
[0m12:52:06.345329 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_os' was properly closed.
[0m12:52:06.345431 [debug] [MainThread]: Connection 'model.my_dbt_project.weekly_revenue_by_brand' was properly closed.
[0m12:52:06.345531 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_enriched_data_msisdn.d65b657925' was properly closed.
[0m12:52:06.347422 [debug] [MainThread]: Command end result
[0m12:52:06.397460 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m12:52:06.397660 [info ] [MainThread]: Building catalog
[0m12:52:06.403460 [debug] [ThreadPool]: Acquiring new snowflake connection 'PROJECT_SEC2_DB.information_schema'
[0m12:52:06.415566 [debug] [ThreadPool]: Using snowflake connection "PROJECT_SEC2_DB.information_schema"
[0m12:52:06.416551 [debug] [ThreadPool]: On PROJECT_SEC2_DB.information_schema: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "connection_name": "PROJECT_SEC2_DB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from PROJECT_SEC2_DB.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_age_overall' and upper("table_name") = upper('revenue_by_age_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'SEEDS' and upper("table_schema") = upper('SEEDS')

                    and 
    "table_name" ilike 'input_device' and upper("table_name") = upper('input_device')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_gender_week_wise' and upper("table_name") = upper('revenue_by_gender_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'SEEDS' and upper("table_schema") = upper('SEEDS')

                    and 
    "table_name" ilike 'input_crm' and upper("table_name") = upper('input_crm')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'total_devices_week_wise' and upper("table_name") = upper('total_devices_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'weekly_revenue_by_brand' and upper("table_name") = upper('weekly_revenue_by_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'brand_by_age_segment' and upper("table_name") = upper('brand_by_age_segment')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'weekly_revenue_by_os' and upper("table_name") = upper('weekly_revenue_by_os')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_age_week_wise' and upper("table_name") = upper('revenue_by_age_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_os_vendor_week_wise' and upper("table_name") = upper('revenue_by_os_vendor_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'silver_layer' and upper("table_schema") = upper('silver_layer')

                    and 
    "table_name" ilike 'enriched_data' and upper("table_name") = upper('enriched_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_os_week_wise' and upper("table_name") = upper('revenue_by_os_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_brand_week_wise' and upper("table_name") = upper('customers_by_brand_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_mobile_type_overall' and upper("table_name") = upper('revenue_by_mobile_type_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'silver_layer' and upper("table_schema") = upper('silver_layer')

                    and 
    "table_name" ilike 'crm_device_data' and upper("table_name") = upper('crm_device_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_mobile_type_week_wise' and upper("table_name") = upper('customers_by_mobile_type_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'total_customers_overall' and upper("table_name") = upper('total_customers_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'BRONZE_LAYER' and upper("table_schema") = upper('BRONZE_LAYER')

                    and 
    "table_name" ilike 'REV' and upper("table_name") = upper('REV')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'os_by_age_segment' and upper("table_name") = upper('os_by_age_segment')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_gender_overall' and upper("table_name") = upper('revenue_by_gender_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_os_overall' and upper("table_name") = upper('customers_by_os_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_mobile_type_week_wise' and upper("table_name") = upper('revenue_by_mobile_type_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_mobile_type_overall' and upper("table_name") = upper('customers_by_mobile_type_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'silver_layer' and upper("table_schema") = upper('silver_layer')

                    and 
    "table_name" ilike 'clean_crm_data' and upper("table_name") = upper('clean_crm_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_value_segment_overall' and upper("table_name") = upper('revenue_by_value_segment_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'silver_layer' and upper("table_schema") = upper('silver_layer')

                    and 
    "table_name" ilike 'clean_device_data' and upper("table_name") = upper('clean_device_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'total_devices_overall' and upper("table_name") = upper('total_devices_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_brand_overall' and upper("table_name") = upper('revenue_by_brand_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'SEEDS' and upper("table_schema") = upper('SEEDS')

                    and 
    "table_name" ilike 'input_enriched_data' and upper("table_name") = upper('input_enriched_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_os_vendor_overall' and upper("table_name") = upper('revenue_by_os_vendor_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_brand_overall' and upper("table_name") = upper('customers_by_brand_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'BRONZE_LAYER' and upper("table_schema") = upper('BRONZE_LAYER')

                    and 
    "table_name" ilike 'CRM' and upper("table_name") = upper('CRM')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'total_customers_week_wise' and upper("table_name") = upper('total_customers_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'SEEDS' and upper("table_schema") = upper('SEEDS')

                    and 
    "table_name" ilike 'input_rev' and upper("table_name") = upper('input_rev')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_brand_week_wise' and upper("table_name") = upper('revenue_by_brand_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_value_segment_week_wise' and upper("table_name") = upper('revenue_by_value_segment_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_os_week_wise' and upper("table_name") = upper('customers_by_os_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_os_overall' and upper("table_name") = upper('revenue_by_os_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'BRONZE_LAYER' and upper("table_schema") = upper('BRONZE_LAYER')

                    and 
    "table_name" ilike 'DEVICE' and upper("table_name") = upper('DEVICE')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from PROJECT_SEC2_DB.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_age_overall' and upper("table_name") = upper('revenue_by_age_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'SEEDS' and upper("table_schema") = upper('SEEDS')

                    and 
    "table_name" ilike 'input_device' and upper("table_name") = upper('input_device')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_gender_week_wise' and upper("table_name") = upper('revenue_by_gender_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'SEEDS' and upper("table_schema") = upper('SEEDS')

                    and 
    "table_name" ilike 'input_crm' and upper("table_name") = upper('input_crm')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'total_devices_week_wise' and upper("table_name") = upper('total_devices_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'weekly_revenue_by_brand' and upper("table_name") = upper('weekly_revenue_by_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'brand_by_age_segment' and upper("table_name") = upper('brand_by_age_segment')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'weekly_revenue_by_os' and upper("table_name") = upper('weekly_revenue_by_os')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_age_week_wise' and upper("table_name") = upper('revenue_by_age_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_os_vendor_week_wise' and upper("table_name") = upper('revenue_by_os_vendor_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'silver_layer' and upper("table_schema") = upper('silver_layer')

                    and 
    "table_name" ilike 'enriched_data' and upper("table_name") = upper('enriched_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_os_week_wise' and upper("table_name") = upper('revenue_by_os_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_brand_week_wise' and upper("table_name") = upper('customers_by_brand_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_mobile_type_overall' and upper("table_name") = upper('revenue_by_mobile_type_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'silver_layer' and upper("table_schema") = upper('silver_layer')

                    and 
    "table_name" ilike 'crm_device_data' and upper("table_name") = upper('crm_device_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_mobile_type_week_wise' and upper("table_name") = upper('customers_by_mobile_type_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'total_customers_overall' and upper("table_name") = upper('total_customers_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'BRONZE_LAYER' and upper("table_schema") = upper('BRONZE_LAYER')

                    and 
    "table_name" ilike 'REV' and upper("table_name") = upper('REV')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'os_by_age_segment' and upper("table_name") = upper('os_by_age_segment')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_gender_overall' and upper("table_name") = upper('revenue_by_gender_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_os_overall' and upper("table_name") = upper('customers_by_os_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_mobile_type_week_wise' and upper("table_name") = upper('revenue_by_mobile_type_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_mobile_type_overall' and upper("table_name") = upper('customers_by_mobile_type_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'silver_layer' and upper("table_schema") = upper('silver_layer')

                    and 
    "table_name" ilike 'clean_crm_data' and upper("table_name") = upper('clean_crm_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_value_segment_overall' and upper("table_name") = upper('revenue_by_value_segment_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'silver_layer' and upper("table_schema") = upper('silver_layer')

                    and 
    "table_name" ilike 'clean_device_data' and upper("table_name") = upper('clean_device_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'total_devices_overall' and upper("table_name") = upper('total_devices_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_brand_overall' and upper("table_name") = upper('revenue_by_brand_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'SEEDS' and upper("table_schema") = upper('SEEDS')

                    and 
    "table_name" ilike 'input_enriched_data' and upper("table_name") = upper('input_enriched_data')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_os_vendor_overall' and upper("table_name") = upper('revenue_by_os_vendor_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_brand_overall' and upper("table_name") = upper('customers_by_brand_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'BRONZE_LAYER' and upper("table_schema") = upper('BRONZE_LAYER')

                    and 
    "table_name" ilike 'CRM' and upper("table_name") = upper('CRM')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'total_customers_week_wise' and upper("table_name") = upper('total_customers_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'SEEDS' and upper("table_schema") = upper('SEEDS')

                    and 
    "table_name" ilike 'input_rev' and upper("table_name") = upper('input_rev')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_brand_week_wise' and upper("table_name") = upper('revenue_by_brand_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_value_segment_week_wise' and upper("table_name") = upper('revenue_by_value_segment_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'customers_by_os_week_wise' and upper("table_name") = upper('customers_by_os_week_wise')

                )
             or 
                (
                    
    "table_schema" ilike 'gold_layer' and upper("table_schema") = upper('gold_layer')

                    and 
    "table_name" ilike 'revenue_by_os_overall' and upper("table_name") = upper('revenue_by_os_overall')

                )
             or 
                (
                    
    "table_schema" ilike 'BRONZE_LAYER' and upper("table_schema") = upper('BRONZE_LAYER')

                    and 
    "table_name" ilike 'DEVICE' and upper("table_name") = upper('DEVICE')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:52:06.417461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:18.361663 [debug] [ThreadPool]: SQL status: SUCCESS 153 in 12.0 seconds
[0m12:52:18.388254 [debug] [ThreadPool]: On PROJECT_SEC2_DB.information_schema: Close
[0m12:52:18.562757 [info ] [MainThread]: Catalog written to /Users/amanpandey/Desktop/mock/src/section2/target/catalog.json
[0m12:52:18.564452 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 14.51001, "process_user_time": 2.288188, "process_kernel_time": 1.708636, "process_mem_max_rss": "196591616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:52:18.564754 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:52:18.564712 after 14.51 seconds
[0m12:52:18.564916 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:52:18.565038 [debug] [MainThread]: Connection 'PROJECT_SEC2_DB.information_schema' was properly closed.
[0m12:52:18.565192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700bd50>]}
[0m12:52:18.565372 [debug] [MainThread]: Flushing usage events
[0m12:59:30.712877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17bd0>]}


============================== 12:59:30.715633 | ee1459e5-f12b-4a48-bd00-81d18ffc436a ==============================
[0m12:59:30.715633 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:59:30.715942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:59:31.683673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee1459e5-f12b-4a48-bd00-81d18ffc436a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1336bd250>]}
[0m12:59:31.704982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee1459e5-f12b-4a48-bd00-81d18ffc436a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596f090>]}
[0m12:59:31.972131 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m12:59:31.977156 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/main.py", line 302, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 23, in run
    with socketserver.TCPServer(("127.0.0.1", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/socketserver.py", line 456, in __init__
    self.server_bind()
  File "/Users/amanpandey/anaconda3/lib/python3.11/socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m12:59:31.980557 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 1.29679, "process_user_time": 1.453637, "process_kernel_time": 1.646366, "process_mem_max_rss": "177717248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:59:31.981830 [debug] [MainThread]: Command `dbt docs serve` failed at 12:59:31.981513 after 1.30 seconds
[0m12:59:31.982343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f14490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133826750>]}
[0m12:59:31.982805 [debug] [MainThread]: Flushing usage events
[0m12:59:51.781207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c9290>]}


============================== 12:59:51.783352 | 2f43061c-3f43-451e-af2d-7010aab5e6b5 ==============================
[0m12:59:51.783352 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:59:51.783656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8082', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:59:52.369434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f43061c-3f43-451e-af2d-7010aab5e6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3390d0>]}
[0m12:59:52.390540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f43061c-3f43-451e-af2d-7010aab5e6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3b250>]}
[0m15:09:58.161097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd5150>]}


============================== 15:09:58.164021 | 9914c390-515a-4e44-85b0-acd53037ace9 ==============================
[0m15:09:58.164021 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:09:58.164327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanpandey/Desktop/mock/src/section2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanpandey/Desktop/mock/src/section2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8082', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:59.417469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9914c390-515a-4e44-85b0-acd53037ace9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9cfa10>]}
[0m15:09:59.439190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9914c390-515a-4e44-85b0-acd53037ace9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0b250>]}
[0m00:56:14.014439 [error] [MainThread]: Encountered an error:

[0m00:56:14.026268 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/cli/main.py", line 302, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 28, in run
    httpd.serve_forever()
  File "/Users/amanpandey/anaconda3/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amanpandey/anaconda3/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m00:56:14.040344 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 15823.095, "process_user_time": 2.968614, "process_kernel_time": 2.657582, "process_mem_max_rss": "180371456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:56:14.041891 [debug] [MainThread]: Command `dbt docs serve` failed at 00:56:14.041702 after 15823.10 seconds
[0m00:56:14.043082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f63110>]}
[0m00:56:14.044058 [debug] [MainThread]: Flushing usage events
